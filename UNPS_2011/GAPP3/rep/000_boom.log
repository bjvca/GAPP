------------------------------------------------------------
      name:  log_000_boom
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/000_boom.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:22

. 
. display "* # * # * # * # * # * # * # * # * # * # * # * # *
>  # * # * # * # *"
* # * # * # * # * # * # * # * # * # * # * # * # * # * # * # 
> * # *

. display ""


. display "Generel information:"
Generel information:

. display "   UGANDA HOUSEHOLD BUDGET SURVEY 2009/10"
   UGANDA HOUSEHOLD BUDGET SURVEY 2009/10

. display "   Poverty rate estimation"
   Poverty rate estimation

. display "   Methodology: Iterative procedure and revealed 
> preferences tests"
   Methodology: Iterative procedure and revealed preferences
>  tests

. display ""


. display "* # * # * # * # * # * # * # * # * # * # * # * # *
>  # * # * # * # *"
* # * # * # * # * # * # * # * # * # * # * # * # * # * # * # 
> * # *

. 
. 
. **********************************************************
> ****************

. * 000_boom.do(start)

. *

. * Reminders:

. *1) Check very top of this file to make sure you are on th
> e right path! 

. *2) GAMS 22.5 must be placed onto the path. See 190_revpre
> f13_m1.bat.

. *   Typically this needs to be edited.

. *   3) In case of implementing a new survey the user must 
> make necessary

. *      changes in 010_initial.do, 020_hhdata.do and 030_ra
> wdata.do.

. *

. * Process:

. * - The do-file prefix indicates first time a do-file is c
> alled

. *

. * KS, 2003

. * CA, 2009-2010

. * MAH, Apr. 2012

. **********************************************************
> ****************

. 
. clear all

. set more off

. set mem 700m

. 
. noisily display "Start time: " "$S_TIME"
Start time: 16:01:24

. 
. 
. 
. **********************************************************
> ****************

. * Macros. Region definitions. Demographic definitions.

. **********************************************************
> ****************

. do "$path/new/final_tableA1-A5-Haruna-2011.do"

. 
. **********************************************************
> ***********
. **********************************************************
> ***********
. **
. **     PROGRAMME:    preparing_household data_2010-2011 fo
> r Uganda_tables_A1_to_A5      
. **     AUTHOR:       HARUNA SEKABIRA
. **     OBJECTIVE:    Create standard tables A1 to A5 for U
> NPS 2010/2011
. **
. **     DATA IN:      GSEC1.dta
. **                                       GSEC2.dta
. **                                       GSEC3.dta
. **                   GSEC15B.dta
. **
. **
. **
. **     DATA OUT:     hhdata.dta (table A1)
. **                                       indata.dta (table
>  A2)
. **                                       calperg.dta (tabl
> e A3)
. **                   cons_cod_trans.dta (table A4)
. **                   cons_cod.dta (table A5)
. **
. **     NOTES:           the files in the in folder here ha
> ve been copied from C:\Users\Templeton\Desktop\GAPP\UNHS_2
> 005\UNHS_III_SOCIO_DATA
. **                  originally from UBOS and pasted in the
>  in folder as the original files for use              
. **
. **********************************************************
> ****************
. 
. clear

. set logtype text

. capture log close

. set more off

. 
. if c(os)=="Unix" {
. global path "/home/bjvca/data/data/GAP/Haruna/UNPS_2011/GA
> PP3/"
. }

. else{
. global path "C:\Users\Templeton\Desktop\GAPP\GAPP-UGANDA-H
> ARUNA\UNPS_2011\GAPP3"
. }

. 
. 
. **********************************************************
> ****
. * Table A1: Household Characteristics and interview detail
> s
. **********************************************************
> ****
. 
. use "$path/in/GSEC1.dta" 
(Household master record (1 record per household))

. *keep
. 
. ***------- Primary Sampling Unit
. * The primary sampling unit for the 2011 is the comm, usin
> g codes as of 2005/6 UNHS and is the enumeration area.
. codebook comm 

------------------------------------------------------------
comm                      Current EA Code as in 2005/06 Data
------------------------------------------------------------

                  type:  string (str8), but longest is str7

         unique values:  324                      missing ""
> :  0/2716

              examples:  "1080033"
                         "2080001"
                         "3030033"
                         "3210030"

.         /* There are 324 unique values, the UNHS 10/11 rep
> ort mentions 322, located in C:\Users\Templeton\Desktop\GA
> PP\UNHS_2011\GAPP3\working-files */
. rename comm psu

. label variable psu "Primary Sampling Unit"

. 
. ***------Interview date
. ** the interview date was in three propotions, the day, mo
> nth and year and all these had been entered separately. Ho
> wever, this infromation is 
. ** replicated below in the survey quarters and months bett
> er thus might be a repeat to do it here.
. 
. ***------- Interview Quarter
. * For the Mozambique Data, instead of using the regular qu
> arter definition for their "surquar" variable they defined
>  the quarters
. * relative to the time period covered by the survey: the s
> urvey ran from Sept 2008 to August 2009 so they defined th
> e quarters
. * as follows: Sept-Nov 08, Dec08-Feb09, Mar-May 08 and Jun
> e-Aug 08.
. * I will use the same framework
. tab month year,m 

 Month  of |        Year of interview
 interview |      2010       2011          . |     Total
-----------+---------------------------------+----------
         1 |         0        234          0 |       234 
         2 |         0        220          0 |       220 
         3 |         0        238          0 |       238 
         4 |         0        249          0 |       249 
         5 |         0        257          0 |       257 
         6 |         0        170          0 |       170 
         7 |         0        200          0 |       200 
         8 |         0        212          0 |       212 
         9 |         0        198          0 |       198 
        10 |       215          0          0 |       215 
        11 |       192          0          0 |       192 
        12 |       283          0          0 |       283 
         . |         0          0         48 |        48 
-----------+---------------------------------+----------
     Total |       690      1,978         48 |     2,716 


.         /* According to the repartition of months and year
> , the survey ran from Oct 2010 to Sept 2011. I will define
>  the
>          * the quarters accordingly */
. gen float survquar=1 if month>=10 & month<=12 & year==2010
(2026 missing values generated)

. replace survquar=2 if month>=1 & month<=3  & year==2011
(692 real changes made)

. replace survquar=3 if month>=4 & month<=6  & year==2011
(676 real changes made)

. replace survquar=4 if month>=7 & month<=9  & year==2011
(610 real changes made)

. label define lsurvquar 1 "Oct-Dec 10" 2 "Jan-Marc 11" 3 "A
> pr-June 11" 4 "July-Sept 2011"

. label values survquar lsurvquar

. label variable survquar "Sequential Survey Quarter (Oct-De
> c 10 = 1)"

. 
. ***------- Sequential Interview month 
. * Following the Mozambique file, I am creating a survey mo
> nth variable rather than an interview date variable as per
>  the excel sheet
. * Number 1 corresponds to the first month of the survey an
> d not to January.
. gen float survmon=1 if month==10 & year==2010
(2501 missing values generated)

. replace survmon=2 if month==11 & year==2010
(192 real changes made)

. replace survmon=3 if month==12 & year==2010
(283 real changes made)

. replace survmon=4 if month==1 & year==2011
(234 real changes made)

. replace survmon=5 if month==2 & year==2011
(220 real changes made)

. replace survmon=6 if month==3 & year==2011
(238 real changes made)

. replace survmon=7 if month==4 & year==2011
(249 real changes made)

. replace survmon=8 if month==5 & year==2011
(257 real changes made)

. replace survmon=9 if month==6 & year==2011
(170 real changes made)

. replace survmon=10 if month==7 & year==2011
(200 real changes made)

. replace survmon=11 if month==8 & year==2011               
>               
(212 real changes made)

. replace survmon=12 if month==9 & year==2011
(198 real changes made)

. label define lsurvmon 1 "Oct 10" 2 "Nov 10" 3 "Dec 10" 4 "
> Jan 11" 5 "Feb 11" 6 "Mac 11" 7 "Apr 11" 8 "May 11" 9 "Jun
>  11" 10 "Jul 11" 11 "Aug 11" 12 "Sep 11"

. 
. label values survmon lsurvmon

. tab survmon,m

    survmon |      Freq.     Percent        Cum.
------------+-----------------------------------
     Oct 10 |        215        7.92        7.92
     Nov 10 |        192        7.07       14.99
     Dec 10 |        283       10.42       25.41
     Jan 11 |        234        8.62       34.02
     Feb 11 |        220        8.10       42.12
     Mac 11 |        238        8.76       50.88
     Apr 11 |        249        9.17       60.05
     May 11 |        257        9.46       69.51
     Jun 11 |        170        6.26       75.77
     Jul 11 |        200        7.36       83.14
     Aug 11 |        212        7.81       90.94
     Sep 11 |        198        7.29       98.23
          . |         48        1.77      100.00
------------+-----------------------------------
      Total |      2,716      100.00

. label variable survmon "Sequential Survey Month (Oct 2010 
> = 1)"

. 
. ***------- Household Sample Weight
. rename wgt10 hhweight

. label variable hhweight "Household sample weight"

. 
. ***------- Household id
. codebook HHID /*there are  2,716 different values and 2,71
> 6 observations in the dataset so the variable "hh" uniquel
> y identifies the observations */

------------------------------------------------------------
HHID                 Unique HH Identifier Across Panel Waves
------------------------------------------------------------

                  type:  string (str15)

         unique values:  2716                     missing ""
> :  0/2716

              examples:  "109300040903"
                         "2083000510"
                         "3033001511"
                         "3213003002"

. rename HHID hhid

. label variable hhid "Household ID"

. 
. 
. ***------- Geographical Stratification during sampling
. 
. tab stratum

  UNPS Strata |
           of |
Representativ |
        eness |      Freq.     Percent        Cum.
--------------+-----------------------------------
      Kampala |        185        6.81        6.81
  Other Urban |        427       15.72       22.53
Central rural |        528       19.44       41.97
   East rural |        554       20.40       62.37
  North rural |        568       20.91       83.28
   West rural |        454       16.72      100.00
--------------+-----------------------------------
        Total |      2,716      100.00

. 
. *  UNPS Strata |
. *           of |
. *Representativ |
. *        eness |      Freq.     Percent        Cum.
. *--------------+-----------------------------------
. *      Kampala |        185        6.81        6.81
. *  Other Urban |        427       15.72       22.53
. *Central rural |        528       19.44       41.97
. *   East rural |        554       20.40       62.37
. *  North rural |        568       20.91       83.28
. *   West rural |        454       16.72      100.00
. *--------------+-----------------------------------
. *        Total |      2,716      100.00
. 
. * the 2010/2011 survey uses a tratification that aggregate
> s all other urban except kampala and this is an interestin
> g way
. * that we have not used before so I choose to maintain it 
> for the tool kit analysis
. rename stratum strata

. label variable strata "Geographical stratification variabl
> e during sampling (ranging from 1 to 6 sub regions)"
note: label truncated to 80 characters

. 
. ***----------------------rural/urban identifier 
. tab urban

Urban/Rural |
 Identifier |      Freq.     Percent        Cum.
------------+-----------------------------------
      Rural |      2,105       77.50       77.50
      Urban |        611       22.50      100.00
------------+-----------------------------------
      Total |      2,716      100.00

. 
. *Urban/Rural |
. * Identifier |      Freq.     Percent        Cum.
. *------------+-----------------------------------
. *      Rural |      2,105       77.50       77.50
. *      Urban |        611       22.50      100.00
. *------------+-----------------------------------
. *      Total |      2,716      100.00
. 
. gen rural=1 if urban==0
(611 missing values generated)

. replace rural=0 if urban==1
(611 real changes made)

. label variable rural "Rural/Urban Location"

. tab rural,m

Rural/Urban |
   Location |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        611       22.50       22.50
          1 |      2,105       77.50      100.00
------------+-----------------------------------
      Total |      2,716      100.00

. 
. *Rural/Urban |
. *   Location |      Freq.     Percent        Cum.
. *------------+-----------------------------------
. *      Urban |        611       22.50       22.50
. *      Rural |      2,105       77.50      100.00
. *------------+-----------------------------------
. *      Total |      2,716      100.00
. 
. ** just to confirm that the rural urban specification was 
> not changed, we tabbed again to see if totals are still as
>  before with substrat*
. 
. ***-----Regions used for temporal price index calculations
. tab region,m

  Region of |
  Residence |
 in 2009/10 |      Freq.     Percent        Cum.
------------+-----------------------------------
    Kampala |        184        6.77        6.77
    Central |        657       24.19       30.96
    Eastern |        647       23.82       54.79
   Northern |        693       25.52       80.30
    Western |        535       19.70      100.00
------------+-----------------------------------
      Total |      2,716      100.00

. replace region=1 if region==0
(184 real changes made)

. * Region of |
. *  Residence |
. * in 2009/10 |      Freq.     Percent        Cum.
. *------------+-----------------------------------
. *    Kampala |        184        6.77        6.77
. *    Central |        657       24.19       30.96
. *    Eastern |        647       23.82       54.79
. *   Northern |        693       25.52       80.30
. *    Western |        535       19.70      100.00
. *------------+-----------------------------------
. *      Total |      2,716      100.00
. 
. ** since Kampala has close to 200 respondents and we have 
> so for not experienced a scenario of an index involving Ka
> mpala olone, 
. ** I choose to maintain Kampala for price indices 
. clonevar reg_tpi = region 

. label variable reg_tpi "Regions used for temporal price in
> dex calculations"

. 
. ***------ Spatial domains (each with its own poverty line)
. 
. tab regurb

RegionXUrban- |
   Subregions |      Freq.     Percent        Cum.
--------------+-----------------------------------
Central rural |        529       19.53       19.53
Central urban |        304       11.23       30.76
   East rural |        554       20.46       51.22
   East urban |         93        3.43       54.65
  North rural |        568       20.97       75.63
  North urban |        125        4.62       80.24
   West rural |        454       16.77       97.01
   West urban |         81        2.99      100.00
--------------+-----------------------------------
        Total |      2,708      100.00

. 
. *RegionXUrban- |
. *   Subregions |      Freq.     Percent        Cum.
. *--------------+-----------------------------------
. *Central rural |        529       19.53       19.53
. *Central urban |        304       11.23       30.76
. *   East rural |        554       20.46       51.22
. *   East urban |         93        3.43       54.65
. *  North rural |        568       20.97       75.63
. *  North urban |        125        4.62       80.24
. *   West rural |        454       16.77       97.01
. *   West urban |         81        2.99      100.00
. *--------------+-----------------------------------
. *        Total |      2,708      100.00
. 
. * In the Arndt & Simler 2010 paper the spatial domains are
>  a combinaison of regions and rural/urban delimitations + 
> the capital
. * city, however in the 2010/11 some urban sections have fa
> r less than 200 respondents, so we shall combine all other
>  regions 
. * (rural + urban)except the central since its urban would 
> be boosted by Kampala, getting us 5 spatial domains
. 
. 
. gen float spdomain=1  if regurb==10 | regurb==11
(1883 missing values generated)

. replace spdomain=2 if regurb==20 | regurb==21
(647 real changes made)

. replace spdomain=3 if regurb==30 | regurb==31
(693 real changes made)

. replace spdomain=4 if regurb==40 | regurb==41
(535 real changes made)

. 
. tab spdomain

   spdomain |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        833       30.76       30.76
          2 |        647       23.89       54.65
          3 |        693       25.59       80.24
          4 |        535       19.76      100.00
------------+-----------------------------------
      Total |      2,708      100.00

. 
. 
. *   spdomain |      Freq.     Percent        Cum.
. *------------+-----------------------------------
. *          1 |        304       11.23       11.23
. *          2 |        529       19.53       30.76
. *          3 |        647       23.89       54.65
. *          4 |        693       25.59       80.24
. *          5 |        535       19.76      100.00
. *------------+-----------------------------------
. *      Total |      2,708      100.00
. 
. label define lspdomain 1 "Central" 2 "Eastern" 3 "Northern
> " 4 "Western" 

. label values spdomain lspdomain

. label variable spdomain "Spatial domains: each with own po
> verty line (they are 4)"

. *just to confirm allocations
. tab spdomain rural

   Spatial |
  domains: |
 each with |
       own |
   poverty |
line (they | Rural/Urban Location
    are 4) |         0          1 |     Total
-----------+----------------------+----------
   Central |       304        529 |       833 
   Eastern |        93        554 |       647 
  Northern |       125        568 |       693 
   Western |        81        454 |       535 
-----------+----------------------+----------
     Total |       603      2,105 |     2,708 


. 
. *      Spatial |
. *domains: each |
. *     with own |
. * poverty line | Rural/Urban Location
. * (they are 5) |         0          1 |     Total
. *--------------+----------------------+----------
. *Central Urban |       304          0 |       304 
. *Central Rural |         0        529 |       529 
. *      Eastern |        93        554 |       647 
. *     Northern |       125        568 |       693 
. *      Western |        81        454 |       535 
. *--------------+----------------------+----------
. *        Total |       603      2,105 |     2,708 
. 
. 
. ***---------------News; another way to specify variables, 
> is the traditional Uganda regions, North east central and 
> western, represented in region
. 
. gen new = spdomain
(8 missing values generated)

. 
. label define lnew 1 n 1 "Central" 2 "Eastern" 3 "Northern"
>  4 "Western" 

. label values new lnew

. 
. label variable new "other ways to dissagregate poverty lin
> es"

. rename new news

. 
. ****-------geo1-geo?; other administrative geographical bo
> undariies where a survey is representative is not required
>  as also done in news rural and others
. 
. *** -------------------Bootstrap weights: the toolkit requ
> ires that this should be=1 for all households and we gener
> ate it below
. 
. gen float bswt=1

. label variable bswt "bootstrap weights; and all equal to 1
>  for all households, as a toolkit requirement"
note: label truncated to 80 characters

. sort hhid

. save "$path/in/hhdata_hhsize.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/hh
> data_hhsize.dta saved

. 
. **** --------------------------------Household size
. ** Since we need Household size in the hhdata.dta, and it 
> was unavailable in the GSEC1.dta, we use the Unique person
>  identifier in GSEC2.dta
. 
. clear 

. use "$path/in/GSEC2.dta"
(Household master record (1 record per household))

. bysort HHID: gen pid=_n

. order HH pid

. collapse (count) pid, by (HHID)

. rename pid hhsize

. la var hhsize "number of household menbers"

. rename HHID hhid

. sort hhid

. save "$path/in/hhsize.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/hh
> size.dta saved

. 
. clear 

. use "$path/in/hhdata_hhsize.dta"
(Household master record (1 record per household))

. merge 1:1 hhid using "$path/in/hhsize.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                             2
        from master                         2  (_merge==1)
        from using                          0  (_merge==2)

    matched                             2,714  (_merge==3)
    -----------------------------------------

. tab _m

                 _merge |      Freq.     Percent        Cum.
------------------------+-----------------------------------
        master only (1) |          2        0.07        0.07
            matched (3) |      2,714       99.93      100.00
------------------------+-----------------------------------
                  Total |      2,716      100.00

. drop _m 

. sort hhid

. destring hhid, replace
hhid has all characters numeric; replaced as double

. destring psu, replace
psu has all characters numeric; replaced as long

. save "$path/out/hhdata.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdata.dta saved

. save "$path/in/hhdata.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/hh
> data.dta saved

. save "$path/work/hhdata.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> hhdata.dta saved

. 
. 
. **********************************************************
> **
. * Table A2: Individual characteristics - demographics
. **********************************************************
> **
. 
. clear

. 
. use "$path/in/GSEC2.dta" 
(Household master record (1 record per household))

. sort HHID

. 
. ***----- Household members
. *According to the enumerator manual of 2010/11, Usual and 
> Regular household members are defined as follows:
. 
. *Usual members are defined as those persons who have been 
> living in the household for 6 months or
. *more during the last 12 months. However, members who have
>  come to stay in the household permanently
. *are to be included as usual members, even though they hav
> e lived in this household for less than 6
. *months. Furthermore, children born to usual members on an
> y date during the last 12 months will be taken
. *as usual members. Both these categories will be given cod
> e "1" or "2" depending upon whether they are
. *present or absent on the date of the interview.
. 
. *Regular members refer to those persons who would have bee
> n usual members of this household, but
. *have been away for more than six months during the last 1
> 2 months, for education purposes, search of
. *employment, business transactions etc. and living in boar
> ding schools, lodging houses or hostels etc.
. *These categories will be given code "3" or "4" depending 
> upon presence or absence on the date of the
. *interview. */
. 
. /* 
> * For the purposes of the calculation of a poverty line we
> 'll exclude from the household the members who have left 
> the household permanently or died
> *  We'll keep the members away for more than 6 months but 
> present on the day of the interview
> */
. 
. rename  h2q7 resident

. drop if resident==7
(2588 observations deleted)

. 
. ***------ Household ID
. rename HHID hhid

. label variable hhid "Household ID"

. 
. ***------ Individual ID
. destring hhid PID, replace
hhid has all characters numeric; replaced as double
PID has all characters numeric; replaced as double

. gen double indid = hhid*100 +  PID

. 
. codebook indid

------------------------------------------------------------
indid                                            (unlabeled)
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.244e+11,4.231e+16]        units:
>   100
         unique values:  16592                    missing .:
>   0/16592

                  mean:   1.0e+13
              std. dev:   3.3e+14

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           2.1e+11   2.3e+11   6.0e+11   8.1
> e+11                                                      
>        8.4e+11

.         * There are 16,592 different values, and there are
>  16,592 observations in the dataset so indid uniquely iden
> tifies
.                 * the individuals
. label variable indid "Individual ID"

. 
. ***------ Sex
. rename  h2q3 sex

. label variable sex "Sex"

. 
. ***------ Age
. rename  h2q8 age

. label variable age "Age in years"

. 
. * In order to have the information on whether the mother r
> esides in the house or not we need the file "hsec3"
. sort indid

. save "$path/in/temp_A2_1.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/te
> mp_A2_1.dta saved

. 
. clear

. use "$path/in/GSEC3.dta" 
(One record per person per household (i.e. The roster inform
> ation) Sections 2 -5)

. 
. ***------ Individual ID
. rename HHID hhid

. destring hhid PID,replace
hhid has all characters numeric; replaced as double
PID has all characters numeric; replaced as double

. gen double indid=hhid*100 +  PID

. label variable indid "Individual ID"

. codebook indid

------------------------------------------------------------
indid                                          Individual ID
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.244e+11,4.231e+16]        units:
>   100
         unique values:  15196                    missing .:
>   0/15196

                  mean:   1.1e+13
              std. dev:   3.5e+14

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           2.1e+11   2.3e+11   6.0e+11   8.1
> e+11                                                      
>        8.4e+11

.         * There are 15,196 different values, and there are
>  15,196 observations in the dataset so indid uniquely iden
> tifies
.                 * the individuals
. 
. ***----- Mother lives in household?
. tab h3q5a,m

     Is the |
    natural |
  mother of |
     [NAME] |
  living in |
       this |
 household? |      Freq.     Percent        Cum.
------------+-----------------------------------
        Yes |      6,378       41.97       41.97
         No |      1,899       12.50       54.47
       Dead |        370        2.43       56.90
          . |      6,549       43.10      100.00
------------+-----------------------------------
      Total |     15,196      100.00

. *There are 6,549  (ie 43.2 %) missing responses, 
. * They have four categories: 1: Yes = 6,378 2: No = 1,899 
> 3: No, Dead = 370 4: Missing = 6,549. I will group them 
. gen motherhh=1 if h3q5a==1 
(8818 missing values generated)

. replace motherhh=0 if h3q5a==2 | h3q5a==3 | h3q5a==.
(8818 real changes made)

. label variable motherhh "Mother lives in hh"

. label define lmoth 0 "No" 1 "Yes"

. label values motherhh lmoth

. 
. keep indid motherhh

. sort indid

. merge 1:1 indid using "$path/in/temp_A2_1.dta"
(label df_YN already defined)
(label df_REGION already defined)
(label df_DISTRCICT already defined)

    Result                           # of obs.
    -----------------------------------------
    not matched                         1,662
        from master                       133  (_merge==1)
        from using                      1,529  (_merge==2)

    matched                            15,063  (_merge==3)
    -----------------------------------------

. tab _merge

                 _merge |      Freq.     Percent        Cum.
------------------------+-----------------------------------
        master only (1) |        133        0.80        0.80
         using only (2) |      1,529        9.14        9.94
            matched (3) |     15,063       90.06      100.00
------------------------+-----------------------------------
                  Total |     16,725      100.00

.         * There are some obs coming only from the using da
> ta. The explanation is that Section 3 of the questionnaire
>  
.         * is administered only to usual and regular househ
> old members, as is confirmed by the cross tab below
.         tab resident _merge

          What is the |
residential status of |        _merge
              [NAME]? | using onl  matched ( |     Total
----------------------+----------------------+----------
 Usual member present |       381     12,255 |    12,636 
  Usual member absent |        54      1,576 |     1,630 
Regular member presen |        14        394 |       408 
Regular member absent |        30        796 |       826 
                Guest |       765         15 |       780 
Usual member left 6 m |       116         13 |       129 
             Deceased |       169          4 |       173 
----------------------+----------------------+----------
                Total |     1,529     15,053 |    16,582 


.         * We leave the variable as is, with additional mis
> sing values for the variable "motherhh".
. drop _merge

. 
. keep hhid indid sex age motherhh

. 
. save "$path/out/indata.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/i
> ndata.dta saved

. save "$path/in/indata.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/in
> data.dta saved

. save "$path/work/indata.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> indata.dta saved

. 
. **********************************************
. * Table A3: Calorie content of food items
. **********************************************
. * since the food products were the same across the surveys
> , we compiled the calorie content and edible portion in an
>  excel file then converted that file into a STATA file
. * The excel file (with more detailed information, inculdin
> g the sources) is in the "in" folder
. 
. clear

. use "$path/in/foodcomp_uganda_PANNELsurvey2011.dta"

. 
. * Since they did not include edible portions in the file I
>  assume that the calorie per gram is only for the edible p
> ortion.
. * I will therefore compute calperg that way
. destring kcal_100g edible, replace
kcal_100g has all characters numeric; replaced as int
edible has all characters numeric; replaced as byte

. gen double calperg=((kcal_100g*edible)/100)/100

. keep product descript calperg

. label variable product "Food product code: numerical"

. label variable descript "Product Description: incl. produc
> t code in the beginning"

. label variable calperg "Calorie content of food product: c
> alories per gram"

. destring product, replace
product has all characters numeric; replaced as int

. sort product

. save "$path/out/calperg.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/c
> alperg.dta saved

. save "$path/in/calperg.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/ca
> lperg.dta saved

. save "$path/work/calperg.dta",replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> calperg.dta saved

. 
. clear

. **********************************************************
> *****************
. * Table A4: Amount and Quantity of food transactoin - Tran
> saction level
. **********************************************************
> *****************
. 
. 
. use "$path/in/GSEC15B.dta"
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

. sort HHID

. rename HHID hhid

. la var hhid "household id"

. ** we drop alcoholic and tobacco as these were not conside
> red basic in foods generally and by GAPP, these included b
> eer-152, other alcoholic dricns-153
. ** cigarettes-155, other tobacco-156 and beer taken in res
> taurants-159, just like we did in the 2009 poverty calcula
> tions
. drop if inlist( itmcd ,152,153,155,156,159)
(1111 observations deleted)

. duplicates report  hhid itmcd

Duplicates in terms of hhid itmcd

--------------------------------------
   copies | observations       surplus
----------+---------------------------
        1 |        34121             0
--------------------------------------

. duplicates list  hhid itmcd

Duplicates in terms of hhid itmcd

(0 observations are duplicates)

. codebook hhid

------------------------------------------------------------
hhid                                            household id
------------------------------------------------------------

                  type:  string (str15)

         unique values:  2656                     missing ""
> :  0/34121

              examples:  "1083001606"
                         "2053001303"
                         "302300030403"
                         "3191000505"

. egen quantity=rowtotal( h15bq4 h15bq6 h15bq8 h15bq10)

.  
. la var quantity "quantity of food consumed by the househol
> d including purchases, at home, away from home & kind"
note: label truncated to 80 characters

. ** these quantities and values are collected by UBOS at a 
> 7 days basis, thus we divide by 7 to get the daily figures
>  as a requirement by GAPP 
. gen quantityd = quantity/7

. drop quantity h15bq10 h15bq8 h15bq6 h15bq4

. la var quantityd "daily household food consumption"

. egen value=rowtotal ( h15bq5 h15bq7 h15bq9 h15bq11 )

. la var value "household food consumption in seven days"

. gen valuez = value/7 

. la var valuez "daily value of food consumed by the househo
> ld"

. rename quantityd quantityz

. drop value h15bq11 h15bq9 h15bq7 h15bq5 h15bq13 h15bq12

. gen unit = 1

. la var unit "set equal to one since all observations are c
> onverted into kg"

. gen food_cat = 1

. la var food_cat "food category equals 1, if product is foo
> d and 0 if non food"

. 
. des hhid

              storage  display     value
variable name   type   format      label      variable label
------------------------------------------------------------
hhid            str15  %15s                   household id

. des food_cat

              storage  display     value
variable name   type   format      label      variable label
------------------------------------------------------------
food_cat        float  %9.0g                  food category
                                        equals 1, if product
                                        is food and 0 if non
                                        food

. des valuez

              storage  display     value
variable name   type   format      label      variable label
------------------------------------------------------------
valuez          float  %9.0g                  daily value of
                                        food consumed by the
                                        household

. rename itmcd product

. la var product "Food product code: numerical"

. destring product, replace
product already numeric; no replace

. save "$path/in/household_table4.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/ho
> usehold_table4.dta saved

. save "$path/out/household_table4.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> ousehold_table4.dta saved

. save "$path/work/household_table4.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> household_table4.dta saved

. set more off

. count
34121

. sort product untcd

. 
. ** to the quantities of the food in standard unite, the Ki
> lograms, a file called conversion factors was generated in
>  excel with details
. ** of the sources of information, located in the "in" fold
> er named "ucf_uganda_UNSH2005.xls" and a STATA extract of 
> both excel and STATA use named
. ** "conversionfactors.xls AND .dta" is also in the in fold
> er for use below. The file has equivalents of local units 
> into kilograms and 
. ** we need it to convert the local units used in food cons
> umption bundles into kilograms. Since the foods and the lo
> cal units were the same, this file is 
. ** similar to the one used for the 2009 data
. merge m:1 product untcd using  "$path/in/Conversionfactors
> .dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                        15,406
        from master                    15,123  (_merge==1)
        from using                        283  (_merge==2)

    matched                            18,998  (_merge==3)
    -----------------------------------------

. tab _m

                 _merge |      Freq.     Percent        Cum.
------------------------+-----------------------------------
        master only (1) |     15,123       43.96       43.96
         using only (2) |        283        0.82       44.78
            matched (3) |     18,998       55.22      100.00
------------------------+-----------------------------------
                  Total |     34,404      100.00

. drop _m

. ** I had to destring all the variables of the "conversionf
> actors.dta" file to match type with that of "--table4.dta"
>  to enable the merge successful
. save "$path/in/household_table4cf.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/ho
> usehold_table4cf.dta saved

. save "$path/out/household_table4cf.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> ousehold_table4cf.dta saved

. save "$path/work/household_table4cf.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> household_table4cf.dta saved

. gen quantity = quantityz* convfactor
(15406 missing values generated)

. 
. la var quantity "daily quantity consumed in Kgs per househ
> old"

. la var value  "daily value of consumption in UGX per per h
> ousehold"

. 
. drop convfactor

. sort hhid

. label drop _all

. destring hhid, replace
hhid has all characters numeric; replaced as double
(283 missing values generated)

. 
. save "$path/out/cons_cod_trans.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/c
> ons_cod_trans.dta saved

. save "$path/in/cons_cod_trans.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/co
> ns_cod_trans.dta saved

. save "$path/work/cons_cod_trans.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_cod_trans.dta saved

. 
. **   Generating Standard Table 5: TOTAL AMOUNT AND QUANTIT
> Y OF PRODUCTS: Food as well as non food
. **
. **********************************************************
> *************************************
. **  DATA IN:       hsec4.dta : On Education costs, column 
> 13f which has all total school expenses, it is on 365 days
> s basis
. **                 hsec5.dta : On Medical Expenditure, col
> umn 10 and 11, on 30 days basis
. **                 hsec12a.dta : On assets Expenditure, co
> lumn h8q5 on total estimated present value, considering 10
> % value used per 365 days basis
. **                 hsec14b.dta: On non-durables and freque
> ntly purchased items e.g imputed rent, electricity, soap e
> tc, on 30 days basis, columns 5,7 & 9 for value
. **                 hsec14c.dta: On semi-durable goods and 
> services, column 3, 4 & 5, on 365 days basis for value
. **                 hsec14d.dta:     On Non-consumption exp
> enses like taxes, remitances away, subscriptions etc, on 3
> 65 days basis, colum 3
. **
. **  DATA OUT: cons_cod.dta
. **********************************************************
> **********************************************************
> **********************************
. clear

. use "$path/in/GSEC4.dta"

.  
. rename HHID hhid

. codebook hhid

------------------------------------------------------------
hhid                 Unique HH Identifier Across Panel Waves
------------------------------------------------------------

                  type:  string (str15)

         unique values:  2650                     missing ""
> :  0/12836

              examples:  "1103000906"
                         "208300070403"
                         "3033001507"
                         "3213003003"

. keep hhid h4q15g

. sort hhid

.  ** since total education expenses were clooected in h4q10
> f and since is at yearly basis, we divided it by 365 to ge
> t daily expenses on education
. gen educationd = h4q15g/365
(7341 missing values generated)

. la var educationd "daily household expense on education"

. drop h4q15g

. save "$path/out/hhdeducationexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdeducationexp.dta saved

. // 
. // clear
. // 
. use "$path/in/GSEC5.dta"

. // 
. des

Contains data from /home/bjvca/data/data/GAP/Haruna/UNPS_201
> 1/GAPP3//in/GSEC5.dta
  obs:        15,008                          
 vars:            15                          11 Apr 2013 16
> :55
 size:     1,095,584                          (_dta has note
> s)
------------------------------------------------------------
              storage  display     value
variable name   type   format      label      variable label
------------------------------------------------------------
HHID            str15  %15s                   Unique HH
                                        Identifier Across
                                        Panel Waves
PID             str15  %15s                   Unique Person
                                        Identifier Across
                                        Panel Waves
h5q2            byte   %8.0g       df_YN      IS [NAME]
                                        ANSWERING FOR
                                        HIMSELF OR HERSELF?
h5q3            str17  %-17s                  WHAT IS THE
                                        NAME OF THE PERSON
                                        RESPONDING FOR
                                        [NAME]?
h5q4            byte   %8.0g       df_YN      During the
                                        past 30 days, did
                                        [NAME] suffer from
                                        any illness or
                                        injury?
h5q5            byte   %8.0g                  For how many
                                        days did [NAME]
                                        suffer due to
                                        illness or injury
                                        during the past 30
h5q6            byte   %8.0g                  For how many
                                        days did [NAME] have
                                        to stop doing
                                        [NAME]’susual
                                        activities due to
h5q7a           byte   %36.0g      df_SYMPTOMS
                                              Can you
                                        describe the
                                        symptoms that [NAME]
                                        primarily suffered
                                        due to the major il
h5q7b           byte   %36.0g      df_SYMPTOMS
                                              Can you
                                        describe the
                                        symptoms that [NAME]
                                        primarily suffered
                                        due to the major il
h5q8            byte   %8.0g       df_YN      Was anyone
                                        consulted (e.g. a
                                        doctor, nurse,
                                        pharmacist or
                                        traditional healer)
                                        fo
h5q9            byte   %35.0g      df_REASONNTCONSULT
                                              Why was no one
                                        consulted for the
                                        major illness?
h5q10           byte   %38.0g      df_FIRSTCONSULT
                                              Where did
                                        [NAME] go for the
                                        first consultation
                                        during the past 30
                                        days?
h5q11           double %10.0g                 Distance to
                                        the place where this
                                        treatment was sought
                                        for(IN KMS)?
h5q12           double %10.0g                 What was the
                                        cost of this
                                        consultation,
                                        including any
                                        medicine prescribed
                                        even i
h2q1            byte   %8.0g                  Individual
                                        Line Number in
                                        2010/11 Roster
------------------------------------------------------------
Sorted by:  

. rename HHID hhid

. sort hhid

. keep hhid h5q12

. gen medicalexp = h5q12
(10699 missing values generated)

. gen medicalexpd = medicalexp/30
(10699 missing values generated)

. la var medicalexpd "household daily expenditure"

. drop h5q12 medicalexp

. save "$path/out/hhdmedicalexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdmedicalexp.dta saved

.  
.  clear

.  set more off 

. use "$path/in/GSEC14.dta"
(Household asset data (1 record per asset per household))

. // des
. save "$path/out/hhddurables.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hddurables.dta saved

. * keep if inlist( h14q2 ,010,011,012)
.   
.  gen assetvalue = h14q7
(58474 missing values generated)

. // 
. // *******************************************************
> *******************************************************
. // ** i took land, bicycle, motor cycle and other transpor
> t equipment-012, that in 2009 were motor vehicles, as dura
> bles and assumed that a year, the household can use 1% of 
> these assests. there was no land in 2005 assets
. // ** house not treated as an asset as the toolkit takes c
> are of imputed rent
. // *******************************************************
> **********************************************************
> *******
.  gen dassetvalue = (assetvalue*0.2)/365
(58474 missing values generated)

. la var dassetvalue "household daily durables expenditure"

. rename HHID hhid

. sort hhid

. save "$path/out/hhddurablesexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hddurablesexp.dta saved

. // 
. // clear
. // 
. // use "$path/in/hsec12a.dta"
. // save "$path/out/hhnondurables.dta", replace
. // rename hh hhid
. // drop if inlist(  h12aq2 ,010,011,012 ,001)
. // gen nondurablevalue = h12aq5
. // **h12aq4 multiple has been dropped since UBOS had recor
> ded h12aq5 as total estimated value in Ush and also discou
> nted them by 1% to get rough value used per year
. // *** we considered other buildings-002, furniture-003, B
> ednets-005, Hh appliances as Kettle,flat iron-006, electro
> nics as tv,radio-007, generators-008, solar-panel-009
. // *** , jewelry&watches-013, mobilephone-014, otherassets
>  as lawn mores-015, Enterprise assests like; home-101, plo
> ughs-102, wheelbarrows-104, pangas-103
. // **  others-105, 106 and 107 and financial assets-201, N
> OTE: figures are codes in data set
. // la var nondurablevalue "household daily non-durables ex
> penditure"
. // sort hhid
. // gen dnondurables = (nondurablevalue*0.01)/365
. // la var dnondurables "household daily non-durables expen
> diture"
. // save "$path/out/hhdnondurablesexp.dta", replace
. // 
. // clear
. 
. use "$path/in/GSEC15C.dta"
(HH consumption data (1 rec. per consumption item in cons. c
> ategory C-E per HH))

. des

Contains data from /home/bjvca/data/data/GAP/Haruna/UNPS_201
> 1/GAPP3//in/GSEC15C.dta
  obs:        24,857                          HH
                                                consumption
                                                data (1 rec.
                                                per
                                                consumption
                                                item in
                                                cons.
                                                category C-E
                                                per HH)
 vars:            11                          11 Apr 2013 16
> :55
 size:     1,541,134                          (_dta has note
> s)
------------------------------------------------------------
              storage  display     value
variable name   type   format      label      variable label
------------------------------------------------------------
HHID            str13  %13s                   Unique HH
                                        Identifier Across
                                        Panel Waves
h15cq2          int    %10.0g                 
h15cq2_1        byte   %8.0g       df_YN      In the past
                                        [RECALL] did
                                        household purchase
                                        any [ITEM]?
h15cq3          int    %39.0g      unts       Unit code
h15cq4          double %10.0g                 How much came
                                        from purchases in
                                        the past [RECALL]?
                                        QUANTITY
h15cq5          double %10.0g                 How much came
                                        from purchases in
                                        the past [RECALL]?
                                        VALUE
h15cq6          double %10.0g                 How much came
                                        from own-production
                                        in the past
                                        [RECALL]? QUANTITY
h15cq7          long   %10.0g                 How much came
                                        from own-production
                                        in the past
                                        [RECALL]? VALUE
h15cq8          double %10.0g                 How much came
                                        from gifts\in-kind
                                        sources in the past
                                        [RECALL]? QUANTIY
h15cq9          long   %10.0g                 How much came
                                        from gifts\in-kind
                                        sources in the past
                                        [RECALL]? VALUE
h15cq10         long   %10.0g                 Market Price
------------------------------------------------------------
Sorted by:  

. rename HHID hhid

. sort hhid

. 
. 
. ** here we considered rent of rented house-301, imputed re
> nt of own house-302, imputed rent of free given house-303,
>  repair expenses-304, water-305 
. ** electricity-306, generator fuels-307, parafin-308, char
> coal-309, firewood-310, matches-451, washing soap-452, bat
> hing soap-453, toothpaste-454, 
. ** taxifares-463, and expenditure on phones not owned-468
. ** and we dropped others-311, cosmetics-455, handbags-456,
>  batteries-drycells-457, newspapers-458, others-459, tires
> -461, petrol-462, 
. *** bus fares-464, bodaboda fare-465, stamps/envelops-466,
>  mobilephoneairtime-467 and others-469,health fees as cons
> ultation-501, medicine-502
. *** hospitalcharges-503, traditionaldoctors-504, others-50
> 9 since medical expenses were cosidered in section 5, spor
> ts/theater-701,
. **  drycleaning-702, houseboys-703, barbers&beauty shops-7
> 04 and lodging-705. THESE HAVE BEEN CONSIDERED NON BASIC
. 
. // drop if inlist( h14bq2 ,311,455,456,457,458,459,461,462
> ,464,465,466,467,469,501,502,503,504,509,701,702,703,704,7
> 05)
.  
. egen hhfrequents = rowtotal ( h15cq5 h15cq7 h15cq9)

. gen dhhfrequents = hhfrequents/30

. la var dhhfrequents "daily household expenditure on freque
> ntly bought commodities"

. 
. 
. save "$path/out/hhdfrequentsexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdfrequentsexp.dta saved

. 
. clear

. /*
> **********************************************************
> *********************************
> **   in considering semi durable goods and services, the v
> alue of those services and goods recieved in kind, column 
> 5 of hsec14c.dta has been excluded
> **   just as in kind food consumptions were eliminated in 
> table 4 as per the GAPP guidelines, These have also been d
> iscounted by 10% usage per year
> **********************************************************
> **********************************************************
> *******************************
> 
> use "$path/in/hsec14c.dta"
> save "$path/out/hhsemidurables.dta", replace
> des
> sort hh
> rename hh hhid
> ** we have considered the following men clothing-201, wome
> nclothing-202, childrenclothing-203, men footware-221, wom
> en footware-222, children footware-223
> ** bedding mattress-404, blankets-405, charcoal/parafin st
> oves-422, plastic plates and tumblers-442
> ** and dropped other clothing-209, tailoring materials-210
> , other footware-229, furniture items-401, carpets-402, cu
> rtains&bedsheets-403, others-409
> ** kettles-421, tv&radio-423, byclcles-424, radio-425, mot
> ors-426, motorcycles-427,computers-428, phone handsets-429
> , others-430, jewelry&watches-431, 
> ** glass/table ware of codes 441-449, education cost (601-
> 609) as education done in section 4, and others like funct
> ions & premiums (801-809)
> ** as these have been consideered NON BASIC
> drop if inlist( h14cq2 ,209,210,229,401,402,403,409,421,42
> 3,424,425,426,427,428,429,430,431,441,443,444,445,449,601,
> 602,603,604,609,801,802,803)
> egen hhsemidurables = rowtotal ( h14cq3 h14cq4)
> sort hhid
> gen hhdsemidurs = (hhsemidurables*0.01)/365
> la var hhdsemidurs "household daily semi durables goods an
> d seervices expenses"
> drop hhsemidurables
> save "$path/out/hhdsemidurablesexp.dta", replace
> 
> clear
> 
> use "$path/in/hsec14d.dta"
> save "$path/in/hhnonconsmpexptaxes.dta", replace
> sort hh
> rename hh hhid
> ** we only considered graduated tax-904, that may cause ar
> rest if not paid and it used to be per head paid to local 
> government annually
> ** and dropped income tax-901, property tax-902, user fees
> -903, social security payments-905, remmitances-906, funer
> als-907 and others-909
> drop if inlist( h14dq2 ,901,902,903,905,906,907,909)
> gen hhdnonconsumpexp = h14dq3/365
> la var hhdnonconsumpexp "hh daily expenditure on taxes, co
> ntributions, donations, duties, etc"
> sort hhid
> save "$path/out/hhdnonconsumpexp.dta", replace
> clear
> **********************************************************
> ********************
> ** after generating all daily non food total household exp
> enditures of various considered items, then we start mergi
> ng these  seven hhd--- prefixed files, and ending with suf
> ix exp to get all non food hh daily expenditure
> **
> **********************************************************
> ************************************
> 
> */
. 
. use "$path/out/hhdeducationexp.dta", clear

. collapse (sum) educationd , by(hhid)

. sort hhid

. save "$path/out/hhdeducationexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdeducationexp.dta saved

. 
. use "$path/out/hhdmedicalexp.dta", clear

. collapse (sum) medicalexpd , by(hhid)

. sort hhid

. save "$path/out/hhdmedicalexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdmedicalexp.dta saved

. 
. use "$path/out/hhdeducationexp.dta", clear

. merge 1:1 hhid using "$path/out/hhdmedicalexp.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                            22
        from master                        18  (_merge==1)
        from using                          4  (_merge==2)

    matched                             2,632  (_merge==3)
    -----------------------------------------

. drop _merge

. sort hhid

. save "$path/out/hhdeduc&medicex.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdeduc&medicex.dta saved

. 
. 
. use "$path/out/hhddurablesexp.dta"
(Household asset data (1 record per asset per household))

. collapse (sum) dassetvalue , by(hhid)

. sort hhid

. save "$path/out/hhddurablesexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hddurablesexp.dta saved

. 
. use "$path/out/hhdeduc&medicex.dta"

. merge 1:1 hhid using "$path/out/hhddurablesexp.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                            61
        from master                         3  (_merge==1)
        from using                         58  (_merge==2)

    matched                             2,651  (_merge==3)
    -----------------------------------------

. drop _merge

. sort hhid

. save "$path/out/hhdeduc&medic&durabex.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdeduc&medic&durabex.dta saved

. 
. // use "$path/out/hhdnondurablesexp.dta"
. // collapse (sum) dnondurables , by(hhid)
. // sort hhid
. // save "$path/out/hhdnondurablesexp.dta", replace
. // 
. // use "$path/out/hhdeduc&medic&durabex.dta"
. // merge 1:1 hhid using "$path/out/hhdnondurablesexp.dta"
. // drop _merge
. // sort hhid
. // save "$path/out/hhdeduc&medic&durab&nondurabex.dta", re
> place
. 
. 
. 
. use "$path/out/hhdfrequentsexp.dta"
(HH consumption data (1 rec. per consumption item in cons. c
> ategory C-E per HH))

. collapse (sum) dhhfrequents , by(hhid)

. 
. sort hhid

. save "$path/out/hhdfrequentsexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdfrequentsexp.dta saved

. 
. use "$path/out/hhdeduc&medic&durabex.dta"

. merge 1:1 hhid using "$path/out/hhdfrequentsexp.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                            69
        from master                        69  (_merge==1)
        from using                          0  (_merge==2)

    matched                             2,643  (_merge==3)
    -----------------------------------------

. drop _merge

. sort hhid

. save "$path/out/hhdeduc&medic&durabex&freq.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> hdeduc&medic&durabex&freq.dta saved

. 
. // use "$path/out/hhdeduc&medic&durab&nondurabex.dta"
. // merge 1:1 hhid using "$path/out/hhdfrequentsexp.dta" 
. // drop _merge
. // sort hhid
. // save "$path/out/hhdeduc&medic&durab&nondurab&freqsex.dt
> a", replace
. // 
. // use "$path/out/hhdsemidurablesexp.dta"
. // collapse (sum) hhdsemidurs , by(hhid)
. // sort hhid
. // save "$path/out/hhdsemidurablesexp.dta", replace
. // 
. // use "$path/out/hhdeduc&medic&durab&nondurab&freqsex.dta
> "
. // merge 1:1 hhid using "$path/out/hhdsemidurablesexp.dta"
. // drop _merge
. // replace hhdsemidurs=0 if hhdsemidurs==.
. // sort hhid
. // save "$path/out/hhdeduc&medic&durab&nondurab&freqs&semi
> durabex.dta", replace
. // // use "$path/in/HSEC5.dta"
. // use "$path/out/hhdnonconsumpexp.dta"
. // collapse (sum) hhdnonconsumpexp , by(hhid)
. // replace hhdnonconsumpexp=0 if hhdnonconsumpexp==.
. // sort hhid
. // save "$path/out/hhdnonconsumpexp.dta", replace
. // 
. // use "$path/out/hhdeduc&medic&durabex&freq.dta"
. // merge 1:1 hhid using "$path/out/hhdnonconsumpexp.dta"
. // drop _merge
. // sort hhid
. // save "$path/out/hhdeduc&medic&durabex&noncons.dta", rep
> lace
. 
. // 
. // use "$path/out/hhdeduc&medic&durab&nondurab&freqs&semid
> urabex.dta"
. // merge 1:1 hhid using "$path/out/hhdnonconsumpexp.dta"
. // drop _merge
. // replace hhdnonconsumpexp=0 if hhdnonconsumpexp==.
. // sort hhid
. // save "$path/out/hhdeduc&medic&durab&nondurab&freqs&semi
> durab&nonconsmpex.dta", replace
. 
. gen hhnonfoodexp = educationd+medicalexpd+dassetvalue+dhhf
> requents
(113 missing values generated)

. la var hhnonfoodexp "household total non food expenditure"

. keep hhid hhnonfoodexp

. 
. 
. gen product = 0

. la var product "product code equal to 1 for food and 0 for
>  non food"

. gen food_cat = 0

. la var food_cat "food product or not equals 1 for foods an
> d 0 for non foods"

. gen prod_cat = 2

. la var prod_cat "COICOP product categories, 2 for all non 
> food"

. replace product = 2 if product==0
(2712 real changes made)

. replace food_cat = 2 if food_cat==0
(2712 real changes made)

. gen descript = 2

. la var descript "product description including product cod
> e but equals 2 for all non-foods"

. save "$path/out/hhtotalnonfoodexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> htotalnonfoodexp.dta saved

. label define descrip 2 " non food", add

. label values descript descrip

. label define descrip 1 " food", add

. replace descript = 1 in 6
(1 real change made)

. replace descript = 2 in 6
(1 real change made)

. sort hhid

. destring hhid, replace
hhid has all characters numeric; replaced as double

. save "$path/out/hhtotalnonfoodexp.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/h
> htotalnonfoodexp.dta saved

. 
. use "$path/out/hhtotalnonfoodexp.dta"

. append using  "$path/out/cons_cod_trans.dta"

. 
. 
. rename quantityz quantityd

. egen cod_hh_nom = rowtotal( hhnonfoodexp valuez)

. la var cod_hh_nom "total household daily expenditure"

. la var quantityd "housedhold daily quantity of food consum
> ed in Kgs"

. drop unit

. drop hhnonfoodexp

. sort hhid

. replace product = 999 if product==2
(2712 real changes made)

. la var product "product code is 999, if product is non foo
> d"

. replace prod_cat = 1 if prod_cat==.
(34404 real changes made)

. 
. replace descript=1 if descript==.
(34404 real changes made)

. label drop _all

. save "$path/out/cons_cod.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//out/c
> ons_cod.dta saved

. save "$path/work/cons_cod.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_cod.dta saved

. save "$path/in/cons_cod.dta", replace
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//in/co
> ns_cod.dta saved

. 
. 
. 
end of do-file

. do "$path/new/010_initial.do"

. cap log close

. log using "$path/rep/010_initial.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/010_initial.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:26

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ********************
> * 010_initial.do                (start)
> **********************************************************
> ********************;
. **********************************************************
> ********************
> * Purpose: Set some globals
> **********************************************************
> ********************;
. **********************************************************
> ********************
> * TPI basket
> **********************************************************
> ********************;
. * Number of items for Uganda i primarily set it to 30 on c
> onsidering a product for appearing over 1000 times on hous
> eholds menu min was 1085 and max was 6157 however the rele
> vant code in new is atvivated to take care of this automat
> ically;
. global product_tpi_n "30";

. * Code choose $product_tpi_n ;
. global product_tpi   "product_tpi==1";

. * Initial (arbitrary) quantile defining poor for price ind
> ex calculations.
> * Mozambique: bottom 60%. Vietnam: bottom 20%. Tanzania: b
> ottom 40% . Uganda: headcount 2009 24.5% ;
. global tpi_bottom "50";

.  * Set the number of regions in the TPI calc for Uganda ar
> e set to 4 as east central north and east;
. global n_tpi "4";

. * To reproduce the mozambique 10 numbers, the following gl
> obal should be commented out. It controls a line in 140_it
> erate.do 
> * where observations not measured in kg are dropped. For a
> ll other datasets, all observations should be converted to
>  kg's before
> * the toolkit is run. For all other datasets, this line sh
> ould therefore be included.
> global MZ "*";
. **********************************************************
> ********************
> * Initial (arbitrary) quantile defining the (relatively) p
> oor.
> **********************************************************
> ********************;
. global bottom "50";

. **********************************************************
> ********************
> * Number of iterations in 140_iterate.do
> **********************************************************
> ********************;
. global it_n "5";

. **********************************************************
> ********************
> * Set the number of regions in the spatial domain;
. **********************************************************
> ********************;
. global n_spdom "4";

. ******************* we deleted East urban (132 hhds), Nort
> h urban (172 hhds) and West urban (107 hhds) because too f
> ew observations were in those spatial domains;
.  *********************************************************
> *********************
> * Revealed preferences choices
> **********************************************************
> ********************;
. * Activate GAMS program according to number of regions in 
> spatial domain;
. *global revpref "190_revpref13_m1.bat";
. *global no_temp_rev " ";
. * k spatial regions and no intertemporal revealed preferen
> ce condition:
>   Activate the next two lines below;
. global no_temp_rev "*";

. global revpref "190_revpref13_r.bat";

.  *********************************************************
> *****************
> * 010_initial.do                (end)
> **********************************************************
> ****************;
. log close;
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/010_initial.log
  log type:  text
 closed on:  23 Oct 2013, 16:01:26
------------------------------------------------------------

. 
end of do-file

. 
. *do "C:\user\gapp\z_data_preb/new/100_collect_expen_moz.do
> "

. *s;

. 
. *do "C:\user\gapp\z_data_preb/new/000_boom.do"

. 
. *global path "C:\user\gapp"

. 
. 
. 
. **********************************************************
> ****************;

. **********************************************************
> ****************;

. * This is the block of do files to set up the data to get 
> nominal

. * consumption. These DO NOT need to be bootstrapped.

. **********************************************************
> ****************;

. **********************************************************
> ****************;

. 
. * This code produces some once for all data for the in-fol
> der. Don't

. * run it unless you know what you are doing!!!

. * Produces education expenditure

. *do "$path\new\Create/education_Create.do"

. * Imputation of missing recepts-in-kind. Run the code with
> out this first...

. *do "$path\new\Create/0_code_chain.do"

. * First poverty lines dependent on IAF

. *do "$path\new\Create/povlines_first_iof_Create.do"

. * Match product codes for different surveys

. *do "$path\new\Create/match96_02_Create.do"

. * Basket from previous survey

. *do "$path\new\Create/smallbasket_iof_Create.do"

. * Match product codes between surveys

. *do "$path\new\Create/rev_pref_matchcodes_02-96_iof_Create
> .do"

. * Update poverty lines

. *do "$path\new\Create/povlines-96-v1-vers7_iof_Create.do"

. * Food share

. *do "$path\new\Create/foodshr96_iof_Create.do"

. 
. *do "$path\new\Create/.do"

. *do "$path\new\Create/.do"

. 
. */

. * This set of files takes the raw data and creates more ha
> ndy data 

. * sets in the work-folder

. do "$path/new/020_in_2_work_folder.do"

. clear all

. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-
> HARUNA"
. set mem 999m

. 
. cap log close

. log using "$path/rep/020_hhdata.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/020_hhdata.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:28

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ****************
> * 020_hhdata.do         (start)
> *
> * Organize the hhid identifier in the HHData file the same
>  way, and keep
> * only the relevant variables.
> *
> * This file sets:
> * - interview month, quarter and year
> * - regions: make all needed regions. But in the end only 
> the one specified
> *            in initial.do are kept. These are
> *            - rural: 0=urban, 1=rural
> *            - news: speficifying North, East, West, South
> . But combinations
> *                    are also possible, eg. North-East, Ce
> nter,...
> *            - reg_tpi: regions with own TPI
> *            - strata: strata regions
> *            - spdomain: spatial domains (regions with own
>  poverty line)
> *            - news_ru_ur: combination of news and rural
> **********************************************************
> ****************;
. use "$path/in/hhdata.dta", clear;
(Household master record (1 record per household))

. *recode spdomain 10=1 11=2 20=3 30=4 40=5 these have been 
> set to five for Uganda to ensure hwe have at least 1000 ho
> useholds per domain;
. tab spdomain, missing;

    Spatial |
   domains: |
  each with |
own poverty |
 line (they |
     are 4) |      Freq.     Percent        Cum.
------------+-----------------------------------
    Central |        833       30.67       30.67
    Eastern |        647       23.82       54.49
   Northern |        693       25.52       80.01
    Western |        535       19.70       99.71
          . |          8        0.29      100.00
------------+-----------------------------------
      Total |      2,716      100.00

.         sort hhid;

.         save "$path/work/hhdata.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> hhdata.dta saved

.         sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |      2716    1.32e+11    4.07e+12   1.01e+09 
>   2.12e+14
      region |      2716     2.33947    1.112628          1 
>          4
       urban |      2716    .2249632     .417635          0 
>          1
      regurb |      2708    23.65694    11.05195         10 
>         41
      strata |      2716    3.830265    1.511984          1 
>          6
-------------+----------------------------------------------
> ----------
         psu |      2716     2435254     1116982    1010002 
>    4190035
       h1aq1 |         0
      h1aq2b |         0
      h1aq3b |         0
      h1aq4b |         0
-------------+----------------------------------------------
> ----------
         day |      2661     18.1879    8.160423          1 
>         31
       month |      2668    6.456147     3.54244          1 
>         12
        year |      2668    2010.741    .4379588       2010 
>       2011
interview_~t |      2716    1.021723    .1458049          1 
>          2
      reason |        49    46.42857    48.00477          1 
>         99
-------------+----------------------------------------------
> ----------
   hh_status |      2716    1.037555    .2688009          1 
>          3
spitoff09_10 |      2716    .0942563    .2922387          0 
>          1
spitoff10_11 |      2716    .0180412     .133125          0 
>          1
    hhweight |      2715    2207.802    1694.047   308.1181 
>   8736.727
    survquar |      2668    2.452024    1.105744          1 
>          4
-------------+----------------------------------------------
> ----------
     survmon |      2668    6.352699    3.368011          1 
>         12
       rural |      2716    .7750368     .417635          0 
>          1
     reg_tpi |      2716     2.33947    1.112628          1 
>          4
    spdomain |      2708    2.343427    1.111882          1 
>          4
        news |      2708    2.343427    1.111882          1 
>          4
-------------+----------------------------------------------
> ----------
        bswt |      2716           1           0          1 
>          1
      hhsize |      2714     7.06706    3.584677          1 
>         29

. use "$path/in/indata.dta", clear;
(One record per person per household (i.e. The roster inform
> ation) Sections 2 -5)

.         *sort hhid;
.         save "$path/work/indata.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> indata.dta saved

.         sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
       indid |     16725    1.03e+13    3.30e+14   1.24e+11 
>   4.23e+16
    motherhh |     15196    .4197157    .4935286          0 
>          1
        hhid |     16592    5.58e+10    1.66e+12   1.01e+09 
>   2.12e+14
         sex |     16592    .4836668    .4997482          0 
>          1
         age |     15924    20.66874    18.32459          0 
>        100

. use "$path/in/calperg.dta", clear;

.         *sort hhid;
.         save "$path/work/calperg.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> calperg.dta saved

.         sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     product |        62       130.5    18.04162        100 
>        161
    descript |         0
     calperg |        62    1.980935    2.136932          0 
>       8.84

. use "$path/in/cons_cod.dta", clear;

.                 save "$path/work/cons_cod.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_cod.dta saved

. use "$path/in/cons_cod_trans.dta", clear;
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

.                 save "$path/work/cons_cod_trans.dta", repl
> ace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_cod_trans.dta saved

. /*
> use "$path/in/cons_cod_trans.dta", clear;
>         *sort hhid;
>         sum;
> for var value quantityd cod_hh_nom cod_hh_nom2 cod_hh_nom3
> : replace X=0 if X==.;
> collapse food_cat prod_cat (sum) value quantityd cod_hh_no
> m cod_hh_nom2 cod_hh_nom3, by(hhid product descript);
>         save "$path/work/cons_cod.dta", replace;
>         sum;
> */
>  
> **********************************************************
> ****************
> * 020_hhdata.do         (end)
> **********************************************************
> ****************;
. cap log close;

. 
end of do-file

. 
. /*
unrecognized command:  / invalid command name
r(199);

. * All kind of raw expenditure is handled: daily, own and m
> onthly, rent and use value, education etc.

. do "$path/new/030_rawdata.do"
file
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//new/
    > 030_rawdata.do not found
r(601);

. 
. * Data set specific changes to each processed raw data set
>  takes place here

. do "$path/new/040_specifities.do"
file
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//new/
    > 040_specifities.do not found
r(601);

. 
. * These files summarizes and checks the data. But no tempo
> ral deflation done here yet

. do "$path/new/050_consump_nom.do"
file
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//new/
    > 050_consump_nom.do not found
r(601);

. 
. * Bring in data on food product's calories per gram

. do "$path/new/060_calperg.do"
file
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//new/
    > 060_calperg.do not found
r(601);

. */

. **********************************************************
> ************;

. **********************************************************
> ************;

. 
. do "$path/new/070_calpp.do"/* Calories per person in spati
> al domains*/

. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-
> HARUNA"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/070_calpp.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/070_calpp.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:29

. clear

. set more off

. 
. 
. 
. *global fert_rate "fert_rate" 
. 
. **********************************************************
> *************
. * 070_calpp.do          (start)
. *
. * Purpose: Determine calories required for each person per
>  domain per day.
. **********************************************************
> ************* 
. 
. /*
> This file uses:
>         work/indata.dta
>         work/hhdata.dta
> 
> This file creates:
>         work/calpp.dta
> */
. 
. *---------------------------------------------------------
> ----------------*
. * Include fertility rates from csv-file
. *---------------------------------------------------------
> ----------------* 
. clear 

. insheet sex rural age fert_rate using "$path/in/fert_rate_
> Uganda.csv" 
(4 vars, 96 obs)

. ***************************************** check for Uganda
> n fertility rates *************************************
. **********************************************************
> *************************************************** 
. sort sex rural age 

. tempfile fert_rate 

. save `fert_rate' 
file /tmp/St09373.000001 saved

. list 

     +------------------------------+
     | sex   rural   age   fert_r~e |
     |------------------------------|
  1. |   2       0    12       .008 |
  2. |   2       0    13       .008 |
  3. |   2       0    14       .008 |
  4. |   2       0    15       .134 |
  5. |   2       0    16       .134 |
     |------------------------------|
  6. |   2       0    17       .134 |
  7. |   2       0    18       .134 |
  8. |   2       0    19       .134 |
  9. |   2       0    20       .313 |
 10. |   2       0    21       .313 |
     |------------------------------|
 11. |   2       0    22       .313 |
 12. |   2       0    23       .313 |
 13. |   2       0    24       .313 |
 14. |   2       0    25       .291 |
 15. |   2       0    26       .291 |
     |------------------------------|
 16. |   2       0    27       .291 |
 17. |   2       0    28       .291 |
 18. |   2       0    29       .291 |
 19. |   2       0    30       .232 |
 20. |   2       0    31       .232 |
     |------------------------------|
 21. |   2       0    32       .232 |
 22. |   2       0    33       .232 |
 23. |   2       0    34       .232 |
 24. |   2       0    35       .172 |
 25. |   2       0    36       .172 |
     |------------------------------|
 26. |   2       0    37       .172 |
 27. |   2       0    38       .172 |
 28. |   2       0    39       .172 |
 29. |   2       0    40       .074 |
 30. |   2       0    41       .074 |
     |------------------------------|
 31. |   2       0    42       .074 |
 32. |   2       0    43       .074 |
 33. |   2       0    44       .074 |
 34. |   2       0    45       .023 |
 35. |   2       0    46       .023 |
     |------------------------------|
 36. |   2       0    47       .023 |
 37. |   2       0    48       .023 |
 38. |   2       0    49       .023 |
 39. |   2       0    50       .006 |
 40. |   2       0    51       .006 |
     |------------------------------|
 41. |   2       0    52       .006 |
 42. |   2       0    53       .006 |
 43. |   2       0    54       .006 |
 44. |   2       0    55       .006 |
 45. |   2       0    56       .006 |
     |------------------------------|
 46. |   2       0    57       .006 |
 47. |   2       0    58       .006 |
 48. |   2       0    59       .006 |
 49. |   2       1    12       .008 |
 50. |   2       1    13       .008 |
     |------------------------------|
 51. |   2       1    14       .008 |
 52. |   2       1    15       .134 |
 53. |   2       1    16       .134 |
 54. |   2       1    17       .134 |
 55. |   2       1    18       .134 |
     |------------------------------|
 56. |   2       1    19       .134 |
 57. |   2       1    20       .313 |
 58. |   2       1    21       .313 |
 59. |   2       1    22       .313 |
 60. |   2       1    23       .313 |
     |------------------------------|
 61. |   2       1    24       .313 |
 62. |   2       1    25       .291 |
 63. |   2       1    26       .291 |
 64. |   2       1    27       .291 |
 65. |   2       1    28       .291 |
     |------------------------------|
 66. |   2       1    29       .291 |
 67. |   2       1    30       .232 |
 68. |   2       1    31       .232 |
 69. |   2       1    32       .232 |
 70. |   2       1    33       .232 |
     |------------------------------|
 71. |   2       1    34       .232 |
 72. |   2       1    35       .172 |
 73. |   2       1    36       .172 |
 74. |   2       1    37       .172 |
 75. |   2       1    38       .172 |
     |------------------------------|
 76. |   2       1    39       .172 |
 77. |   2       1    40       .074 |
 78. |   2       1    41       .074 |
 79. |   2       1    42       .074 |
 80. |   2       1    43       .074 |
     |------------------------------|
 81. |   2       1    44       .074 |
 82. |   2       1    45       .023 |
 83. |   2       1    46       .023 |
 84. |   2       1    47       .023 |
 85. |   2       1    48       .023 |
     |------------------------------|
 86. |   2       1    49       .023 |
 87. |   2       1    50       .006 |
 88. |   2       1    51       .006 |
 89. |   2       1    52       .006 |
 90. |   2       1    53       .006 |
     |------------------------------|
 91. |   2       1    54       .006 |
 92. |   2       1    55       .006 |
 93. |   2       1    56       .006 |
 94. |   2       1    57       .006 |
 95. |   2       1    58       .006 |
     |------------------------------|
 96. |   2       1    59       .006 |
     +------------------------------+

. 
. *---------------------------------------------------------
> ----------------*
. * Now do the calorie needs for individuals
. *---------------------------------------------------------
> ----------------* 
. use "$path/work/indata.dta" 
(One record per person per household (i.e. The roster inform
> ation) Sections 2 -5)

. 
. * CA bootstrap modification 
. sort hhid 

. merge hhid using "$path/work/hhdata.dta" 
variable hhid does not uniquely identify observations in
    the master data

. tab _m  

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        133        0.80        0.80
          2 |          3        0.02        0.81
          3 |     16,592       99.19      100.00
------------+-----------------------------------
      Total |     16,728      100.00

. drop _m 

. 
. sum 

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
       indid |     16725    1.03e+13    3.30e+14   1.24e+11 
>   4.23e+16
    motherhh |     15196    .4197157    .4935286          0 
>          1
        hhid |     16595    5.58e+10    1.66e+12   1.01e+09 
>   2.12e+14
         sex |     16592    .4836668    .4997482          0 
>          1
         age |     15924    20.66874    18.32459          0 
>        100
-------------+----------------------------------------------
> ----------
      region |     16595    2.343537    1.097251          1 
>          4
       urban |     16595    .2208497    .4148318          0 
>          1
      regurb |     16561    23.68221      10.911         10 
>         41
      strata |     16595    3.835372    1.489108          1 
>          6
         psu |     16595     2438344     1101801    1010002 
>    4190035
-------------+----------------------------------------------
> ----------
       h1aq1 |         0
      h1aq2b |         0
      h1aq3b |         0
      h1aq4b |         0
         day |     16325    18.25893    8.105742          1 
>         31
-------------+----------------------------------------------
> ----------
       month |     16370    6.499695    3.520885          1 
>         12
        year |     16370     2010.74    .4387412       2010 
>       2011
interview_~t |     16595    1.017415    .1308153          1 
>          2
      reason |       232    48.70259    48.32307          1 
>         99
   hh_status |     16595    1.028924    .2370061          1 
>          3
-------------+----------------------------------------------
> ----------
spitoff09_10 |     16595    .0800844    .2714319          0 
>          1
spitoff10_11 |     16595    .0140404    .1176609          0 
>          1
    hhweight |     16594    1984.054    1511.524   308.1181 
>   8736.727
    survquar |     16370    2.461454    1.111593          1 
>          4
     survmon |     16370    6.377642    3.380194          1 
>         12
-------------+----------------------------------------------
> ----------
       rural |     16595    .7791503    .4148318          0 
>          1
     reg_tpi |     16595    2.343537    1.097251          1 
>          4
    spdomain |     16561    2.346296    1.096685          1 
>          4
        news |     16561    2.346296    1.096685          1 
>          4
        bswt |     16595           1           0          1 
>          1
-------------+----------------------------------------------
> ----------
      hhsize |     16593     8.69686    3.864144          1 
>         29

. replace sex=2 if sex==0
(8567 real changes made)

. * Include fertility rates 
. sort sex rural age 

. merge sex rural age using `fert_rate' 
variables sex rural age do not uniquely identify
    observations in the master data

. 
. sum 

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
       indid |     16725    1.03e+13    3.30e+14   1.24e+11 
>   4.23e+16
    motherhh |     15196    .4197157    .4935286          0 
>          1
        hhid |     16595    5.58e+10    1.66e+12   1.01e+09 
>   2.12e+14
         sex |     16592    1.516333    .4997482          1 
>          2
         age |     15924    20.66874    18.32459          0 
>        100
-------------+----------------------------------------------
> ----------
      region |     16595    2.343537    1.097251          1 
>          4
       urban |     16595    .2208497    .4148318          0 
>          1
      regurb |     16561    23.68221      10.911         10 
>         41
      strata |     16595    3.835372    1.489108          1 
>          6
         psu |     16595     2438344     1101801    1010002 
>    4190035
-------------+----------------------------------------------
> ----------
       h1aq1 |         0
      h1aq2b |         0
      h1aq3b |         0
      h1aq4b |         0
         day |     16325    18.25893    8.105742          1 
>         31
-------------+----------------------------------------------
> ----------
       month |     16370    6.499695    3.520885          1 
>         12
        year |     16370     2010.74    .4387412       2010 
>       2011
interview_~t |     16595    1.017415    .1308153          1 
>          2
      reason |       232    48.70259    48.32307          1 
>         99
   hh_status |     16595    1.028924    .2370061          1 
>          3
-------------+----------------------------------------------
> ----------
spitoff09_10 |     16595    .0800844    .2714319          0 
>          1
spitoff10_11 |     16595    .0140404    .1176609          0 
>          1
    hhweight |     16594    1984.054    1511.524   308.1181 
>   8736.727
    survquar |     16370    2.461454    1.111593          1 
>          4
     survmon |     16370    6.377642    3.380194          1 
>         12
-------------+----------------------------------------------
> ----------
       rural |     16595    .7791503    .4148318          0 
>          1
     reg_tpi |     16595    2.343537    1.097251          1 
>          4
    spdomain |     16561    2.346296    1.096685          1 
>          4
        news |     16561    2.346296    1.096685          1 
>          4
        bswt |     16595           1           0          1 
>          1
-------------+----------------------------------------------
> ----------
      hhsize |     16593     8.69686    3.864144          1 
>         29
   fert_rate |      4574    .1445059    .1126523       .006 
>       .313
      _merge |     16728    1.546868    .8914698          1 
>          3

. 
. * Do calorie calculations  
.     gen num=1 

.     gen cal = . 
(16728 missing values generated)

. 
. * Same assumptions about sex/age specific calories need in
>  IAF 1997, IAF 2003 and IOF 2009 
. 
. * Children (no difference between boys and girls)     
.     replace cal =  820 if age < 1 
(469 real changes made)

. 
. * Add 500 cal per day for mothers in first six months of b
> reast feeding
. * We assume that 60% of children under 1 are under six mon
> ths old
. * And that all of them breast feed
. * We add these mother requirements of 300 on average to ea
> ch child under 1 whose mother is alive 
.     replace cal = 1120 if age <  1 & motherhh==1 
(412 real changes made)

.     replace cal = 1150 if age >= 1 & age <2 
(455 real changes made)

.     replace cal = 1350 if age >= 2 & age <3 
(533 real changes made)

.     replace cal = 1550 if age >= 3 & age <5 
(1089 real changes made)

. 
. * Males  
.     replace cal = 1850 if age >=  5 & age <7  & sex==1 
(561 real changes made)

.     replace cal = 2100 if age >=  7 & age <10 & sex==1 
(761 real changes made)

.     replace cal = 2200 if age >= 10 & age <12 & sex==1 
(521 real changes made)

.     replace cal = 2400 if age >= 12 & age <14 & sex==1 
(527 real changes made)

.     replace cal = 2650 if age >= 14 & age <16 & sex==1 
(516 real changes made)

.     replace cal = 2850 if age >= 16 & age <18 & sex==1 
(407 real changes made)

.     replace cal = 3000 if age >= 18 & age <30 & sex==1 
(1301 real changes made)

.     replace cal = 2900 if age >= 30 & age <60 & sex==1 
(1517 real changes made)

.     replace cal = 2450 if age>=60 & age~=. & sex==1 
(379 real changes made)

. 
. * Girls 5-12 years (probability of pregnancy assumed = 0) 
>  
.     replace cal = 1750 if age >=  5 & age < 7 & sex==2 
(578 real changes made)

.     replace cal = 1800 if age >=  7 & age <10 & sex==2 
(785 real changes made)

.     replace cal = 1950 if age >= 10 & age <12 & sex==2 
(545 real changes made)

. 
. * Women with a correction for pregnancy. We add 285 calori
> es per for the final trimester.
. * To do this we find the probability that rural and urban 
> women are pregnant from
. * live births data in the 1997 census over the past 12 mon
> ths (no correction for still births).
. * 3/4*probability of birth gives probability of preganancy
> . Probability of final trimester is one
. * third of that of that or 1/4 of the probability of birth
. 
. * Women urban 
.     replace cal = 2100 + (fert_rate*285)/4 if age >= 12 & 
> age <14 & sex==2 & rural==0 
(97 real changes made)

.     replace cal = 2150 + (fert_rate*285)/4 if age >= 14 & 
> age <18 & sex==2 & rural==0 
(222 real changes made)

.     replace cal = 2100 + (fert_rate*285)/4 if age >= 18 & 
> age <30 & sex==2 & rural==0 
(441 real changes made)

.     replace cal = 2150 + (fert_rate*285)/4 if age >= 30 & 
> age <60 & sex==2 & rural==0 
(413 real changes made)

. 
. * Women rural 
.     replace cal = 2100 + (fert_rate*285)/4 if age >= 12 & 
> age <14 & sex==2 & rural==1 
(409 real changes made)

.     replace cal = 2150 + (fert_rate*285)/4 if age >= 14 & 
> age <18 & sex==2 & rural==1 
(662 real changes made)

.     replace cal = 2100 + (fert_rate*285)/4 if age >= 18 & 
> age <30 & sex==2 & rural==1 
(984 real changes made)

.     replace cal = 2150 + (fert_rate*285)/4 if age >= 30 & 
> age <60 & sex==2 & rural==1 
(1346 real changes made)

. 
. * Women 60+ are not pregnant  
.     replace cal = 1950 if age>=60 & age~=. & sex==2 
(406 real changes made)

. 
.     count if cal ==. 
  804

. 
.     *Fill in these two observations for IAF 2002/03: 
. 
.     * 1) this one is a child 
.     *replace cal = 1500 if cal ==. & age==. 
. 
.     * 2) this one is 21 years old 
.     *replace cal = 2500 if cal ==. & b2==. 
. 
.     collapse (sum) cal num (max) psu hhsize hhweight strat
> a rural spdomain, by (hhid) 

.     gen chk=hhsize - num 
(3 missing values generated)

.     sum chk 

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
         chk |      2714    .9532056    1.604116          0 
>         27

.     drop chk 

.     gen calpp = cal / hhsize 
(3 missing values generated)

.     sort spdomain 

. 
. sum 

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |      2716    1.32e+11    4.07e+12   1.01e+09 
>   2.12e+14
         cal |      2717    12627.04    6571.337          0 
>   52257.93
         num |      2717    6.156791    3.948919          1 
>        133
         psu |      2716     2435254     1116982    1010002 
>    4190035
      hhsize |      2714     7.06706    3.584677          1 
>         29
-------------+----------------------------------------------
> ----------
    hhweight |      2715    2207.802    1694.047   308.1181 
>   8736.727
      strata |      2716    3.830265    1.511984          1 
>          6
       rural |      2716    .7750368     .417635          0 
>          1
    spdomain |      2708    2.343427    1.111882          1 
>          4
       calpp |      2714    1853.853    449.1043          0 
>       3000

. 
. * MAH   sum  codebook hhid 
. 
. collapse (mean) calpp[aw=hhsize*hhweight], by (spdomain) 

. 
. drop if spdomain ==.
(1 observation deleted)

. 
. sort spdomain 

. 
. save "$path/work/calpp.dta",replace 
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> calpp.dta saved

. 
. 
. 
. **********************************************************
> *************
. * 070_calpp.do          (end)
. **********************************************************
> ************* 
. 
. log close 
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/070_calpp.log
  log type:  text
 closed on:  23 Oct 2013, 16:01:30
------------------------------------------------------------

. 
end of do-file

. do "$path/new/080_conpc.do"/* Nominal food/non-food expend
> iture */

. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-
> HARUNA"
. clear all

. set mem 100m

. 
. clear

. cap log close

. log using "$path/rep/080_conpc.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/080_conpc.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:30

. set more off

. 
. 
. **********************************************************
> *****************
. * 080_conpc.do          (start)
. *
. * Creates a file with per capita nominal consumption divid
> ed between food
. * and non-food categories based on the calorie definition 
> of food
. * rather than the COICOP (INE) definition of food. ready f
> or 
. * temporal deflation when necessary
. **********************************************************
> ****************** 
. 
. /*
> This file uses:
>         work/hhdata.dta
>         work/consump_nom.dta
>       
> This file creates:
>         work/conpc.dta
> */
. 
. 
. 
. **********************************************************
> *****************
. * Food expenditure
. **********************************************************
> ****************** 
. *use "$path/in/cons_cod.dta" 
. use "$path/work/cons_cod.dta" 

.             *sort product 
.             *merge product using "$path/work/food_cat.dta"
>  
.             *tab _m 
.             *drop _m 
.             keep if food_cat==1 
(2995 observations deleted)

.             collapse (sum) cod_hh_nom, by(hhid) 

.             rename cod_hh_nom food_hh_nom 

.                 sort hhid 

.             keep hhid food_hh_nom 

.             tempfile foodexp 

. save `foodexp' 
file /tmp/St09373.000001 saved

. 
. **********************************************************
> *****************
. * Food expenditure merged with all expenditure
. **********************************************************
> ****************** 
. use "$path/work/cons_cod.dta" 

. *use "$path/in/cons_cod.dta" 
. *use "$path/in/cons_cat.dta" 
. sum 

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     36833    1.34e+11    4.13e+12   1.01e+09 
>   2.12e+14
     product |     37094    197.1675    225.8068        100 
>        999
    food_cat |     36833     1.07363    .2611707          1 
>          2
    prod_cat |     37116    1.073068     .260252          1 
>          2
    descript |     37116    1.073068     .260252          1 
>          2
-------------+----------------------------------------------
> ----------
       untcd |     33603    55.59504    39.11441          1 
>        133
      h15bq2 |         0
     h15bq2b |         0
     h15bq2c |     33702    5.974364     3.23507          1 
>         12
     h15bq2d |         0
-------------+----------------------------------------------
> ----------
     h15bq3a |     34121           1           0          1 
>          1
     h15bq3b |     34111    4.109847    2.379586          1 
>          7
     h15bq3c |        22    48522.68    66379.85          1 
>     166089
     h15bq14 |     33682    6.794333    240.1296          0 
>      28000
     h15bq15 |     33680    3284.011    6913.258          0 
>     600000
-------------+----------------------------------------------
> ----------
   quantityd |     34121    .5441537    1.353663          0 
>   71.42857
      valuez |     34121    470.5371    985.3928   1.428571 
>   85714.29
    quantity |     18998    .7658831    2.589936          0 
>         60
  cod_hh_nom |     37116    951.7859    6405.568          0 
>   817166.7

. collapse (sum) cod_hh_nom, by(hhid) 

. *gen cons_pc_nom = cons_hh_nom/hhsize 
. rename cod_hh_nom cons_hh_nom 

. *keep  hhid cons_pc_nom cons_hh_nom  
. *keep hhid cod_hh_nom 
. *use "$path/in/cons_cod.dta" 
. *use "$path/in/consump_nom.dta" 
. *use "$path/work/consump_nom.dta" 
. *            keep  hhid cons_hh_nom  
.             display _N 
2713

.             keep  hhid cons_hh_nom  

.             sort hhid 

.             merge hhid using "$path/work/hhdata.dta" 

.             tab _m 

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          2 |          4        0.15        0.18
          3 |      2,712       99.82      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.             drop _m 

. gen cons_pc_nom = cons_hh_nom/hhsize 
(6 missing values generated)

.             sort hhid 

.             merge hhid using `foodexp' 

.             tab _m 

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         61        2.25        2.25
          3 |      2,656       97.75      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.                 drop if _merge==2 
(0 observations deleted)

.             replace food_hh_nom=0 if _merge==1 & food_hh_n
> om==. 
(61 real changes made)

.             drop _m 

.                 gen food_pc_nom=food_hh_nom/hhsize 
(3 missing values generated)

.                 gen nf_hh_nom=cons_hh_nom-food_hh_nom 
(4 missing values generated)

.             gen nf_pc_nom=nf_hh_nom/hhsize 
(6 missing values generated)

.  
.             keep hhid cons_hh_nom food_pc_nom nf_pc_nom co
> ns_pc_nom survquar spdomain news reg_tpi rural hhweight hh
> size 

.             lab var food_pc_nom "nominal food consumption 
> per capita" 

.             lab var nf_pc_nom "nominal non-food consumptio
> n per capita" 

. keep hhid cons_hh_nom cons_pc_nom food_pc_nom nf_pc_nom 

.             sort hhid 

. 
. * MAH   sum  codebook hhid 
. save "$path/work/conpc.dta", replace 
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> conpc.dta saved

. 
. 
. **********************************************************
> *****************
. * 080_conpc.do          (end)
. **********************************************************
> ****************** 
. 
. 
. log close 
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/080_conpc.log
  log type:  text
 closed on:  23 Oct 2013, 16:01:30
------------------------------------------------------------

. 
end of do-file

. do "$path/new/090_temp_index.do"/* Temporal price index */

. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-
> HARUNA"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/090_temp_index.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/090_temp_index.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:30

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ****************
> * 090_temp_index.do     (start)
> **********************************************************
> ****************;
. *do "$path/new/010_initial.do";
. **********************************************************
> ****************
> * Program to compute the temporal price index (intra-surve
> y)
> * 
> * The index is based on 6 regions (North/Center/South by r
> ural/urban) 
> * and four quarters. For IAF 2002/03 (t=t1) it is based on
>  the same 9
> * commodities used for the analysis of the 1996 IAF (t=t0)
> , 
> * except that we have to go to 8 commodities because the 2
> 002-03 survey 
> * does not distinguish between large and small groundnuts,
>  which were 
> * separate items in the old index. For IOF 2008/09 (t=t2) 
> we expand the
> * the food basket to include the 15 most important food pr
> oducts among
> * the poorest.
> *
> * The commodity weights for the items vary by the 6 region
> s, and are 
> * calculated from the observations in the IAF2002, using t
> he relatively 
> * poor households (below median nominal consumption per ca
> pita).
> *
> * The unit values (prices) calculated here are also based 
> on the prices 
> * paid by the relatively poor, using the same definition.
> *
> * K Simler, Sep 2003
> * CA
> * MAH, April 2010
> * URB, Feb 2013 (automatization to any number of n_tpi's)
> **********************************************************
> ****************;
. /*
> This file uses:
>         work/own.dta
>         work/receipts.dta
>         work/daily.dta
>         work/hhdata
>         work/cons_cat.dta
> 
> This file creates:
>         work/tpi_unit_val_quarterly.dta
>         work/tpi_unit_val_monthly.dta
>         work/tpi_news_share.dta
>         work/tpi_reg_tpi_share.dta
>         work/temp_index_news.dta
>         work/temp_index_reg_tpi.dta
> */      
> 
> 
> **********************************************************
> ****************
> * Either the products used for intertemporal price index i
> s specified
> * explicitly, or they are automatically found as the the n
> _tpi products
> * with the highest weighted expenditure shares among the $
> bottom % poorest
> * part of the population
> **********************************************************
> ****************;
. * Generating the n_tpi most important food items for the p
> oorest $bottom % ;
. **********************************************************
> ****************
> * Find the n_tpi most important food products among the lo
> west $bottom %
> * (start)
> **********************************************************
> ****************;
. *---------------------------------------------------------
> ---------------*
> * Population weights for each HH
> *---------------------------------------------------------
> ---------------*;
. use "$path/work/hhdata.dta", clear;
(Household master record (1 record per household))

. keep hhid hhweight hhsize;

. gen popwt = hhweight*hhsize;
(2 missing values generated)

. lab var popwt "Population weights = hhsize X hhweight";

. sort hhid;

. tempfile popwt;

. save `popwt', replace;
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |      2716    1.32e+11    4.07e+12   1.01e+09 
>   2.12e+14
    hhweight |      2715    2207.802    1694.047   308.1181 
>   8736.727
      hhsize |      2714     7.06706    3.584677          1 
>         29
       popwt |      2714       13754    11237.33   548.9749 
>   104660.2

. *---------------------------------------------------------
> ---------------*
> * Make list of all consumed products
> *---------------------------------------------------------
> ---------------*;
. *use "$path/in/cons_cod.dta", clear;
. *save "$path/work/cons_cod.dta", replace;
. use "$path/work/cons_cod.dta", clear;

. keep product descript;

. collapse product, by(descript);

. sort product;

. tempfile descript;

. save `descript', replace;
(note: file /tmp/St09373.000002 not found)
file /tmp/St09373.000002 saved

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
    descript |         2         1.5    .7071068          1 
>          2
     product |         2    566.4601    611.7038   133.9201 
>        999

. *---------------------------------------------------------
> ---------------*
> * Find the poorest part of the population
> *---------------------------------------------------------
> ---------------*;
. use
> "$path/work/cons_cod.dta", clear;

. *use
> *"$path/work/cons_cod.dta", clear;
. ********************************************check the COIC
> OP categories to create the variable prod_cat, for the mom
> ent it is equal to food_cat******;
. keep hhid prod_cat product cod_hh_nom;

. sort hhid;

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     36833    1.34e+11    4.13e+12   1.01e+09 
>   2.12e+14
     product |     37094    197.1675    225.8068        100 
>        999
    prod_cat |     37116    1.073068     .260252          1 
>          2
  cod_hh_nom |     37116    951.7859    6405.568          0 
>   817166.7

. merge hhid using `popwt';
variable hhid does not uniquely identify observations in
    the master data

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     36837    1.34e+11    4.13e+12   1.01e+09 
>   2.12e+14
     product |     37094    197.1675    225.8068        100 
>        999
    prod_cat |     37116    1.073068     .260252          1 
>          2
  cod_hh_nom |     37116    951.7859    6405.568          0 
>   817166.7
    hhweight |     36836    2108.699      1640.9   308.1181 
>   8736.727
-------------+----------------------------------------------
> ----------
      hhsize |     36835    7.420877    3.609826          1 
>         29
       popwt |     36835    13937.78    11273.38   548.9749 
>   104660.2
      _merge |     37120    2.984644    .1742655          1 
>          3

. drop _merge;

. preserve;

. collapse (sum) cod_hh_nom (mean) popwt hhweight hhsize, by
> (hhid);

. gen cod_pc_nom = cod_hh_nom/hhsize;
(3 missing values generated)

.         sum cod_pc_nom [aw=popwt] , detail;

                         cod_pc_nom
------------------------------------------------------------
> -
      Percentiles      Smallest
 1%            0              0
 5%     278.7577              0
10%     439.1918              0       Obs                271
> 4
25%     741.5734              0       Sum of Wgt.  37328356.
> 8

50%     1255.419                      Mean           1816.18
> 6
                        Largest       Std. Dev.      2980.62
> 9
75%      2031.27       31800.95
90%     3480.159       42829.77       Variance        888415
> 1
95%     4975.918       76265.16       Skewness       14.4661
> 4
99%     9769.631       85937.88       Kurtosis       316.314
> 7

.         global medcpc_= r(p$tpi_bottom);

.         gen bottom_ = cod_pc_nom <= $medcpc_;

. sum [aw=popwt];

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
        hhid |    2714  37328356.8    1.47e+11   2.95e+12   
> 1.01e+09   2.12e+14
  cod_hh_nom |    2714  37328356.8    14582.77   29340.47   
>        0   838916.7
       popwt |    2714  37328356.8    22931.77   17291.44   
> 548.9749   104660.2
    hhweight |    2714  37328356.8    3059.501   2065.404   
> 308.1181   8736.727
      hhsize |    2714  37328356.8    8.214561   4.009234   
>        1         29
-------------+----------------------------------------------
> -------------------
  cod_pc_nom |    2714  37328356.8    1816.186   2980.629   
>        0   85937.88
     bottom_ |    2714  37328356.8    .5007345   .5000916   
>        0          1

. sum [aw=hhweight];

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
        hhid |    2715  5994181.97    3.93e+11   7.30e+12   
> 1.01e+09   2.12e+14
  cod_hh_nom |    2715  5994181.97    11310.18    22818.6   
>        0   838916.7
       popwt |    2714  5985445.24    19080.64   14826.93   
> 548.9749   104660.2
    hhweight |    2715  5994181.97    3507.165   2259.003   
> 308.1181   8736.727
      hhsize |    2714  5985445.24    6.236521   3.512924   
>        1         29
-------------+----------------------------------------------
> -------------------
  cod_pc_nom |    2714  5985445.24    2071.488   3143.155   
>        0   85937.88
     bottom_ |    2715  5994181.97    .4649342   .4988608   
>        0          1

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |      2716    1.32e+11    4.07e+12   1.01e+09 
>   2.12e+14
  cod_hh_nom |      2717    13002.02    24922.52          0 
>   838916.7
       popwt |      2714       13754    11237.33   548.9749 
>   104660.2
    hhweight |      2715    2207.802    1694.047   308.1181 
>   8736.727
      hhsize |      2714     7.06706    3.584677          1 
>         29
-------------+----------------------------------------------
> ----------
  cod_pc_nom |      2714    1986.405    3262.889          0 
>   85937.88
     bottom_ |      2717    .4806772    .4997185          0 
>          1

. keep if bottom_==1;
(1411 observations deleted)

. keep hhid;

. sort hhid;

. tempfile hhid;

. save `hhid';
file /tmp/St09373.000004 saved

. restore;

. sort hhid;

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     36837    1.34e+11    4.13e+12   1.01e+09 
>   2.12e+14
     product |     37094    197.1675    225.8068        100 
>        999
    prod_cat |     37116    1.073068     .260252          1 
>          2
  cod_hh_nom |     37116    951.7859    6405.568          0 
>   817166.7
    hhweight |     36836    2108.699      1640.9   308.1181 
>   8736.727
-------------+----------------------------------------------
> ----------
      hhsize |     36835    7.420877    3.609826          1 
>         29
       popwt |     36835    13937.78    11273.38   548.9749 
>   104660.2

. merge hhid using `hhid';
variable hhid does not uniquely identify observations in
    the master data

. tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     22,831       61.51       61.51
          3 |     14,289       38.49      100.00
------------+-----------------------------------
      Total |     37,120      100.00

. keep if _m==3;
(22831 observations deleted)

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     14289    3.74e+10    2.12e+11   1.02e+09 
>   2.32e+12
     product |     14267    212.9422    249.7169        101 
>        999
    prod_cat |     14286    1.091208     .287915          1 
>          2
  cod_hh_nom |     14286    485.1504    848.3025          0 
>   11701.42
    hhweight |     14289    2019.773    1498.371   308.1181 
>   8736.727
-------------+----------------------------------------------
> ----------
      hhsize |     14289     7.74029    3.087326          1 
>         29
       popwt |     14289    14440.04    10334.85   821.0083 
>   104660.2
      _merge |     14289           3           0          3 
>          3

. *---------------------------------------------------------
> ---------------*
> * Keep only food product expenditure by the poor. Calculat
> e food product
> * share of total food expenditure by the poor
> *---------------------------------------------------------
> ---------------*;
. keep if prod_cat==1;
(1306 observations deleted)

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     12983    3.73e+10    2.12e+11   1.02e+09 
>   2.32e+12
     product |     12964    133.9362    16.61785        101 
>        171
    prod_cat |     12983           1           0          1 
>          1
  cod_hh_nom |     12983    337.3672    495.0164   1.428571 
>   7142.857
    hhweight |     12983     2008.29    1489.028   308.1181 
>   8736.727
-------------+----------------------------------------------
> ----------
      hhsize |     12983    7.778403    3.072952          1 
>         29
       popwt |     12983    14452.91    10288.01   821.0083 
>   104660.2
      _merge |     12983           3           0          3 
>          3

. sort product;

. *preserve;
. collapse (sum) cod_hh_nom [aw=hhweight], by(product);

. sort cod;

. egen total=sum(cod_hh_nom);

. gen sh=100*cod_hh_nom/total;

. *---------------------------------------------------------
> ---------------*
> * Include product labels
> *---------------------------------------------------------
> ---------------*;
. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     product |        65    135.0308     20.5015        101 
>        171
  cod_hh_nom |        66    64249.38    89260.31   428.5714 
>   401605.4
       total |        66     4240459           0    4240459 
>    4240459
          sh |        66    1.515151    2.104968   .0101067 
>   9.470799

. sort product;

. merge product using `descript';

. tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         66       97.06       97.06
          2 |          2        2.94      100.00
------------+-----------------------------------
      Total |         68      100.00

. keep if _merge==1 | _merge==3;
(2 observations deleted)

. drop _merge;

. sort sh;

. *list;
. list in -$product_tpi_n/-1;

     +----------------------------------------------------+
     | product   cod_hh~m     total         sh   descript |
     |----------------------------------------------------|
 37. |     150   42597.39   4240459   1.004547          . |
 38. |     135   43800.52   4240459   1.032919          . |
 39. |     143   44104.89   4240459   1.040097          . |
 40. |     146   44508.18   4240459   1.049608          . |
 41. |     118   50471.91   4240459   1.190246          . |
     |----------------------------------------------------|
 42. |     132    52548.6   4240459    1.23922          . |
 43. |     119   58545.69   4240459   1.380645          . |
 44. |     138   64900.77   4240459   1.530513          . |
 45. |     144   68251.58   4240459   1.609533          . |
 46. |     112   68802.59   4240459   1.622527          . |
     |----------------------------------------------------|
 47. |     110   73090.46   4240459   1.723645          . |
 48. |     136   75339.71   4240459   1.776688          . |
 49. |     139   75402.81   4240459   1.778176          . |
 50. |     115   75778.75   4240459   1.787041          . |
 51. |     122   92311.38   4240459   2.176919          . |
     |----------------------------------------------------|
 52. |     121   97030.22   4240459   2.288201          . |
 53. |     127    97845.7   4240459   2.307432          . |
 54. |     116   100604.4   4240459   2.372487          . |
 55. |     105   104104.7   4240459   2.455034          . |
 56. |     123   104418.5   4240459   2.462434          . |
     |----------------------------------------------------|
 57. |     140   108279.3   4240459   2.553481          . |
 58. |     107   114506.8   4240459   2.700339          . |
 59. |     125   136995.1   4240459   3.230667          . |
 60. |     157   166830.6   4240459   3.934258          . |
 61. |     117   182773.9   4240459   4.310238          . |
     |----------------------------------------------------|
 62. |     147   185242.7   4240459   4.368457          . |
 63. |     108   316564.5   4240459   7.465336          . |
 64. |     113   346247.2   4240459   8.165324          . |
 65. |     101   384959.9   4240459    9.07826          . |
 66. |     141   401605.4   4240459   9.470799          . |
     +----------------------------------------------------+

. list product descript in -$product_tpi_n/-1;

     +--------------------+
     | product   descript |
     |--------------------|
 37. |     150          . |
 38. |     135          . |
 39. |     143          . |
 40. |     146          . |
 41. |     118          . |
     |--------------------|
 42. |     132          . |
 43. |     119          . |
 44. |     138          . |
 45. |     144          . |
 46. |     112          . |
     |--------------------|
 47. |     110          . |
 48. |     136          . |
 49. |     139          . |
 50. |     115          . |
 51. |     122          . |
     |--------------------|
 52. |     121          . |
 53. |     127          . |
 54. |     116          . |
 55. |     105          . |
 56. |     123          . |
     |--------------------|
 57. |     140          . |
 58. |     107          . |
 59. |     125          . |
 60. |     157          . |
 61. |     117          . |
     |--------------------|
 62. |     147          . |
 63. |     108          . |
 64. |     113          . |
 65. |     101          . |
 66. |     141          . |
     +--------------------+

. *restore;
. *---------------------------------------------------------
> ---------------*
> * Keep the required number of most important food products
> *---------------------------------------------------------
> ---------------*;
. keep in -$product_tpi_n/-1;
(36 observations deleted)

. list;

     +----------------------------------------------------+
     | product   cod_hh~m     total         sh   descript |
     |----------------------------------------------------|
  1. |     150   42597.39   4240459   1.004547          . |
  2. |     135   43800.52   4240459   1.032919          . |
  3. |     143   44104.89   4240459   1.040097          . |
  4. |     146   44508.18   4240459   1.049608          . |
  5. |     118   50471.91   4240459   1.190246          . |
     |----------------------------------------------------|
  6. |     132    52548.6   4240459    1.23922          . |
  7. |     119   58545.69   4240459   1.380645          . |
  8. |     138   64900.77   4240459   1.530513          . |
  9. |     144   68251.58   4240459   1.609533          . |
 10. |     112   68802.59   4240459   1.622527          . |
     |----------------------------------------------------|
 11. |     110   73090.46   4240459   1.723645          . |
 12. |     136   75339.71   4240459   1.776688          . |
 13. |     139   75402.81   4240459   1.778176          . |
 14. |     115   75778.75   4240459   1.787041          . |
 15. |     122   92311.38   4240459   2.176919          . |
     |----------------------------------------------------|
 16. |     121   97030.22   4240459   2.288201          . |
 17. |     127    97845.7   4240459   2.307432          . |
 18. |     116   100604.4   4240459   2.372487          . |
 19. |     105   104104.7   4240459   2.455034          . |
 20. |     123   104418.5   4240459   2.462434          . |
     |----------------------------------------------------|
 21. |     140   108279.3   4240459   2.553481          . |
 22. |     107   114506.8   4240459   2.700339          . |
 23. |     125   136995.1   4240459   3.230667          . |
 24. |     157   166830.6   4240459   3.934258          . |
 25. |     117   182773.9   4240459   4.310238          . |
     |----------------------------------------------------|
 26. |     147   185242.7   4240459   4.368457          . |
 27. |     108   316564.5   4240459   7.465336          . |
 28. |     113   346247.2   4240459   8.165324          . |
 29. |     101   384959.9   4240459    9.07826          . |
 30. |     141   401605.4   4240459   9.470799          . |
     +----------------------------------------------------+

. gen product_tpi=1;

. keep product product_tpi;

. list;

     +--------------------+
     | product   produc~i |
     |--------------------|
  1. |     150          1 |
  2. |     135          1 |
  3. |     143          1 |
  4. |     146          1 |
  5. |     118          1 |
     |--------------------|
  6. |     132          1 |
  7. |     119          1 |
  8. |     138          1 |
  9. |     144          1 |
 10. |     112          1 |
     |--------------------|
 11. |     110          1 |
 12. |     136          1 |
 13. |     139          1 |
 14. |     115          1 |
 15. |     122          1 |
     |--------------------|
 16. |     121          1 |
 17. |     127          1 |
 18. |     116          1 |
 19. |     105          1 |
 20. |     123          1 |
     |--------------------|
 21. |     140          1 |
 22. |     107          1 |
 23. |     125          1 |
 24. |     157          1 |
 25. |     117          1 |
     |--------------------|
 26. |     147          1 |
 27. |     108          1 |
 28. |     113          1 |
 29. |     101          1 |
 30. |     141          1 |
     +--------------------+

. sort product;

. tempfile product_tpi;

. save `product_tpi', replace;
(note: file /tmp/St09373.000005 not found)
file /tmp/St09373.000005 saved

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     product |        30       126.9      15.264        101 
>        157
 product_tpi |        30           1           0          1 
>          1

. clear;

. **********************************************************
> ****************
> * Find the n_tpi most important food products among the lo
> west $bottom %
> * (end)
> **********************************************************
> ****************;
. **********************************************************
> ****************;
. * First, need to calculate the average prices for the food
>  items, by 
> * strata and quarter. For this, we are using the "unit val
> ues"
> * (value/quantity) for the observations in the consumption
>  questionnaires,
> * including daily, own and receipts-in-kind.
> *
> * The unit values are constructed as sum(value)/sum(quanti
> ty), which effectively
> * weights them by the quantity and value of the transactio
> n. Sampling
> * weights are also used.
> *
> * Get the own consumption file, and limit analysis to the 
> observations
> * in KGs where both value and quantity are available.
> **********************************************************
> ****************;
. use "$path/work/cons_cod.dta";

. *use "$path/work/cons_cod.dta";
. keep if prod_cat==1;
(2712 observations deleted)

. drop if quantityd==0 | quantityd==.;
(1062 observations deleted)

. *keep if quantityd!=. & cod_hh_nom2!=.;
. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     33342    1.37e+11    4.18e+12   1.01e+09 
>   2.12e+14
     product |     33320    133.3781    16.98235        101 
>        171
    food_cat |     33342           1           0          1 
>          1
    prod_cat |     33342           1           0          1 
>          1
    descript |     33342           1           0          1 
>          1
-------------+----------------------------------------------
> ----------
       untcd |     33320    55.74619     39.1895          1 
>        133
      h15bq2 |         0
     h15bq2b |         0
     h15bq2c |     32923    5.831789    3.135899          1 
>         12
     h15bq2d |         0
-------------+----------------------------------------------
> ----------
     h15bq3a |     33342           1           0          1 
>          1
     h15bq3b |     33337     4.09425    2.381471          1 
>          7
     h15bq3c |        22    48522.68    66379.85          1 
>     166089
     h15bq14 |     32913    4.368152    54.27286          0 
>       7000
     h15bq15 |     32911    3057.808    6173.454          0 
>     600000
-------------+----------------------------------------------
> ----------
   quantityd |     33342    .5568673    1.366798   .0071429 
>   71.42857
      valuez |     33342    438.0954     880.029   1.428571 
>   85714.29
    quantity |     18219    .7986303     2.63978   .0004286 
>         60
  cod_hh_nom |     33342    438.0954     880.029   1.428571 
>   85714.29

. sort product;

. merge product using `product_tpi';
variable product does not uniquely identify observations
    in the master data

. tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      8,382       25.14       25.14
          2 |          1        0.00       25.14
          3 |     24,960       74.86      100.00
------------+-----------------------------------
      Total |     33,343      100.00

. drop _merge;

. keep if $product_tpi;
(8382 observations deleted)

. *        replace valued_ac=0 if valued_ac==.;
. *        replace quantityd_ac=0 if quantityd_ac==.;
.         gen valued_tot=cod_hh_nom;
(1 missing value generated)

.         gen quantityd_tot=quantityd;
(1 missing value generated)

. *               replace quantityd_tot=0 if (valued_tot>0 &
>  valued_tot<.) & quantityd_tot==.;
.         keep if quantityd_tot!=. & valued_tot!=.;
(1 observation deleted)

.                 collapse (sum) valued_tot quantityd_tot, b
> y(hhid product);

.                 sort hhid;

. tempfile acredd;

. save `acredd' , replace;
(note: file /tmp/St09373.000006 not found)
file /tmp/St09373.000006 saved

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     24960    1.49e+11    4.45e+12   1.01e+09 
>   2.12e+14
     product |     24960    129.9594    14.49125        101 
>        150
  valued_tot |     24960    498.2278     975.377   2.857143 
>   85714.29
quantityd_~t |     24960    .5521706    1.109211   .0071429 
>         60

. /*
> **********************************************************
> ****************;
> * Create a data set with an empty 1 observation. Used to a
> void empty data
> * sets when the survey do not have the Mozambican set up
> **********************************************************
> ****************;
> use "$path/work/own.dta";
> 
> preserve;
> keep in 1;
> drop unit valued quantityd;
> gen unit=2;
> gen valued=0;
> gen quantityd=0;
> tempfile 1obs;
> save `1obs';
> restore;
> 
> **********************************************************
> ****************;
> * Own consumption
> **********************************************************
> ****************;
> sum;
> sort product;
> merge product using `product_tpi';
> tab _merge;
> drop _merge;
> 
> keep if $product_tpi;
> 
> 
> 
> * Comment out below if IAF 2002/03 ( START ) ;
> 
> rename quantityd quantity;
> do "$path/new/110a_conversions.do";
> rename quantity quantityd;
> 
> * Comment out below if IAF 2002/03 ( END ) ;
> 
> 
> 
>         keep if unit==2 & quantityd!=. & valued!=.;
>         collapse (sum) valued quantityd , by(hhid product)
> ;
>         rename valued valued_ac;
>         rename quantityd quantityd_ac;
>         compress;
>         sort hhid product;
>         tempfile ac;
> save `ac', replace;
> 
> **********************************************************
> ****************;
> * Now do a similar thing with receipts-in-kind file.
> **********************************************************
> ****************;
> use "$path/work/receipts.dta";
> 
> sum;
> sort product;
> merge product using `product_tpi';
> tab _merge;
> drop _merge;
> 
> 
> 
> keep if $product_tpi;
> append using `1obs';
> 
> 
> 
> * Comment out below if IAF 2002/03 ( START ) ;
> 
> rename quantityd quantity;
> do "$path/new/110a_conversions.do";
> rename quantity quantityd;
> 
> * Comment out below if IAF 2002/03 ( END ) ;
> 
> 
> 
>         keep if unit==2 & quantityd!=. & valued!=.;
>         collapse (sum) valued quantityd , by(hhid product)
> ;
>         rename valued valued_re;
>         rename quantityd quantityd_re;
>         compress;
>         sort hhid product;
>         tempfile re;
> save `re', replace;
> 
> **********************************************************
> ****************;
> * And also with the daily expenditure file.
> **********************************************************
> ****************;
> use "$path/work/daily.dta";
> 
> sum;
> sort product;
> merge product using `product_tpi';
> tab _merge;
> drop _merge;
> 
> keep if $product_tpi;
> 
> 
> 
> * Comment out below if IAF 2002/03 ( START ) ;
> 
> *rename quantityd quantity;
> do "$path/new/110a_conversions.do";
> *rename quantity quantityd;
> 
> * Comment out below if IAF 2002/03 ( END ) ;
> 
> 
> 
>         collapse (sum) value quantity days , 
>                 by(hhid product unit);
> 
>         gen valued=value/7 if days<=7;
>         replace valued=value/days if days>7 & days<.;
>         gen quantityd=quantity/7 if days<=7;
>         replace quantityd=quantity/days if days>7 & days<.
> ;
> 
>         keep if unit==2 & quantityd!=. & valued!=.;
>         collapse (sum) valued quantityd , by(hhid product)
> ;
> 
>         rename valued valued_dd;
>         rename quantityd quantityd_dd;
>         compress;
>         sort hhid product;
>         tempfile dd;
> save `dd', replace;
> 
> 
> 
> 
> **********************************************************
> ****************;
> * Merge the three components (own, daily, receipts) togeth
> er at the HH/product level, 
> * then aggregate to the regional level, using the sample w
> eights (hhweight).
> * We DON'T want to weight by "hhsize" because the quantity
>  and value are
> * already for the household (i.e., other things equal, lar
> ger households
> * are buying larger quantities, and therefore already gett
> ing more weight).
> * Then calculate sum(val)/sum(quantity) to get the quantit
> y weighted mean
> * unit value in each strata in each quarter.
> **********************************************************
> ****************;
> use `ac';
>         sort hhid product;
>         merge hhid product using `re';
>         tab _m;
>         drop _m;
>         
>         sort hhid product;
>         merge hhid product using `dd';
>         tab _m;
>         drop _m;
>         
>         replace valued_ac=0 if valued_ac==.;
>         replace valued_re=0 if valued_re==.;
>         replace valued_dd=0 if valued_dd==.;
>         replace quantityd_ac=0 if quantityd_ac==.;
>         replace quantityd_re=0 if quantityd_re==.;
>         replace quantityd_dd=0 if quantityd_dd==.;
> 
>         gen valued_tot=valued_ac+valued_re+valued_dd;
>         gen quantityd_tot=quantityd_ac+quantityd_re+quanti
> tyd_dd;
> 
>         sort hhid;
> 
>         tempfile acredd;
> save `acredd' , replace;
> */
> 
> 
> 
> use "$path/work/hhdata.dta";
(Household master record (1 record per household))

.         keep strata hhid hhweight hhsize rural survmon sur
> vquar news spdomain reg_tpi;

.         sort hhid;

.         tempfile hhd;

. save `hhd' , replace;
(note: file /tmp/St09373.000007 not found)
file /tmp/St09373.000007 saved

. use `acredd', clear;

.         merge hhid using `hhd';
variable hhid does not uniquely identify observations in
    the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        158        0.63        0.63
          3 |     24,960       99.37      100.00
------------+-----------------------------------
      Total |     25,118      100.00

.         drop _merge;

.                 tab survquar , miss;

    Sequential |
Survey Quarter |
 (Oct-Dec 10 = |
            1) |      Freq.     Percent        Cum.
---------------+-----------------------------------
    Oct-Dec 10 |      6,608       26.31       26.31
   Jan-Marc 11 |      6,225       24.78       51.09
   Apr-June 11 |      6,491       25.84       76.93
July-Sept 2011 |      5,746       22.88       99.81
             . |         48        0.19      100.00
---------------+-----------------------------------
         Total |     25,118      100.00

.                 tab survmon survquar, miss;

Sequential |
    Survey |    Sequential Survey Quarter
Month (Oct |         (Oct-Dec 10 = 1)
 2010 = 1) | Oct-Dec 1  Jan-Marc   Apr-June  |     Total
-----------+---------------------------------+----------
    Oct 10 |     2,070          0          0 |     2,070 
    Nov 10 |     1,810          0          0 |     1,810 
    Dec 10 |     2,728          0          0 |     2,728 
    Jan 11 |         0      2,195          0 |     2,195 
    Feb 11 |         0      1,993          0 |     1,993 
    Mac 11 |         0      2,037          0 |     2,037 
    Apr 11 |         0          0      2,406 |     2,406 
    May 11 |         0          0      2,465 |     2,465 
    Jun 11 |         0          0      1,620 |     1,620 
    Jul 11 |         0          0          0 |     1,977 
    Aug 11 |         0          0          0 |     2,033 
    Sep 11 |         0          0          0 |     1,736 
         . |         0          0          0 |        48 
-----------+---------------------------------+----------
     Total |     6,608      6,225      6,491 |    25,118 


Sequential |   Sequential Survey
    Survey | Quarter (Oct-Dec 10 =
Month (Oct |          1)
 2010 = 1) | July-Sept          . |     Total
-----------+----------------------+----------
    Oct 10 |         0          0 |     2,070 
    Nov 10 |         0          0 |     1,810 
    Dec 10 |         0          0 |     2,728 
    Jan 11 |         0          0 |     2,195 
    Feb 11 |         0          0 |     1,993 
    Mac 11 |         0          0 |     2,037 
    Apr 11 |         0          0 |     2,406 
    May 11 |         0          0 |     2,465 
    Jun 11 |         0          0 |     1,620 
    Jul 11 |     1,977          0 |     1,977 
    Aug 11 |     2,033          0 |     2,033 
    Sep 11 |     1,736          0 |     1,736 
         . |         0         48 |        48 
-----------+----------------------+----------
     Total |     5,746         48 |    25,118 


.         compress;
product was float now int
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
hhsize was long now byte

.         sort hhid;

. save `acredd', replace;
file /tmp/St09373.000006 saved

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     25118    1.48e+11    4.43e+12   1.01e+09 
>   2.12e+14
     product |     24960    129.9594    14.49125        101 
>        150
  valued_tot |     24960    498.2278     975.377   2.857143 
>   85714.29
quantityd_~t |     24960    .5521706    1.109211   .0071429 
>         60
      strata |     25118    3.726809    1.490816          1 
>          6
-------------+----------------------------------------------
> ----------
    hhweight |     25117    2113.125    1644.387   308.1181 
>   8736.727
    survquar |     25070     2.45373    1.110616          1 
>          4
     survmon |     25070    6.340168    3.371343          1 
>         12
       rural |     25118    .7538021    .4308038          0 
>          1
     reg_tpi |     25118    2.282507    1.077913          1 
>          4
-------------+----------------------------------------------
> ----------
    spdomain |     25110    2.282915    1.077841          1 
>          4
        news |     25110    2.282915    1.077841          1 
>          4
      hhsize |     25116    7.457517    3.568781          1 
>         29

. **********************************************************
> ****************;
. * Need to merge with the file that has nominal consumption
>  per household,
> * and compute nominal consumption per capita from that, so
>  that we can
> * choose the relatively poor (i.e., below median nominal c
> onsumption per
> * capita).
> **********************************************************
> ****************;
. use "$path/work/conpc.dta", clear;

. keep hhid cons_hh_nom;

. *use "$path/in/cons_cat.dta" ;
. *save "$path/work/cons_cat.dta", replace ;
. *use "$path/work/cons_cat.dta" ;
. *CA modified to merge in hhdata for bootstrap;
.        sort hhid;

.         merge hhid using "$path/work/hhdata.dta";

.           tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.  drop _m;

.         collapse (mean) cons_hh_nom hhsize hhweight , by(h
> hid);

.         gen cpc=cons_hh_nom/hhsize;
(6 missing values generated)

.         sum cpc [aw=hhsize*hhweight] , detail;

                             cpc
------------------------------------------------------------
> -
      Percentiles      Smallest
 1%            0              0
 5%      282.121              0
10%     442.7513              0       Obs                271
> 1
25%     742.3367              0       Sum of Wgt.  37293839.
> 4

50%     1255.419                      Mean           1817.86
> 7
                        Largest       Std. Dev.      2981.49
> 6
75%     2037.781       31800.95
90%     3480.159       42829.77       Variance        888932
> 0
95%     4975.918       76265.16       Skewness       14.4654
> 3
99%     9769.631       85937.88       Kurtosis       316.206
> 9

.         global medcpc=r(p$tpi_bottom);

.         gen bottom_tpi=cpc<=$medcpc;

.         keep hhid bottom_tpi;

.         sort hhid;

.         tempfile bottom_tpi;

. save `bottom_tpi', replace;
(note: file /tmp/St09373.000008 not found)
file /tmp/St09373.000008 saved

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |      2716    1.32e+11    4.07e+12   1.01e+09 
>   2.12e+14
  bottom_tpi |      2717    .4795731    .4996745          0 
>          1

. use `acredd' ;

.         merge hhid using `bottom_tpi';
variable hhid does not uniquely identify observations in
    the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          1        0.00        0.00
          3 |     25,118      100.00      100.00
------------+-----------------------------------
      Total |     25,119      100.00

.         drop _merge;

.         keep if bottom_tpi;
(14824 observations deleted)

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     10295    3.78e+10    2.14e+11   1.02e+09 
>   2.32e+12
     product |     10203     130.632    14.49675        101 
>        150
  valued_tot |     10203    366.2404    518.1724   2.857143 
>   7142.857
quantityd_~t |     10203    .5590053     1.04242   .0142857 
>   34.28571
      strata |     10295    4.257018    1.194099          1 
>          6
-------------+----------------------------------------------
> ----------
    hhweight |     10295    2019.918    1496.353   308.1181 
>   8736.727
    survquar |     10252      2.3611    1.078664          1 
>          4
     survmon |     10252    6.078716    3.293314          1 
>         12
       rural |     10295    .8960661    .3051897          0 
>          1
     reg_tpi |     10295    2.519767    .9366845          1 
>          4
-------------+----------------------------------------------
> ----------
    spdomain |     10288    2.520801    .9361635          1 
>          4
        news |     10288    2.520801    .9361635          1 
>          4
      hhsize |     10295    7.744828    3.066181          1 
>         29
  bottom_tpi |     10295           1           0          1 
>          1

. * Drop one HH with extremely high quantity and low value i
> n IAF 2002/03 (t=t1) ;
. *        drop if hhid==263001;
.         preserve;

.                 collapse (sum) valued_tot quantityd_tot [a
> w=hhweight] , 
>                                 by(reg_tpi news product su
> rvmon);

.                         drop if product==.;
(25 observations deleted)

.                         gen ppkg=valued_tot/quantityd_tot;

.                         lab var ppkg "Unit value per kg";

.                         sort reg_tpi product ;

.                         compress;

.                         tempfile uvm;

.                 save `uvm', replace;
(note: file /tmp/St09373.00000a not found)
file /tmp/St09373.00000a saved

.                 save "$path/work/tpi_unit_val_monthly.dta"
> , replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> tpi_unit_val_monthly.dta saved

.         restore;

.         preserve;

.                 collapse (sum) valued_tot quantityd_tot [a
> w=hhweight] , 
>                                 by(reg_tpi news product su
> rvquar);

.                         drop if product==.;
(17 observations deleted)

.                         gen ppkg=valued_tot/quantityd_tot;

.                         sort reg_tpi product survquar;

.                         list in  1/3;

     +-------------------------------------------+
  1. | product |    survquar | reg_tpi |    news |
     |     101 |  Oct-Dec 10 | Central | Central |
     |-------------------------------------------|
     |  valued~t   |   quanti~t   |       ppkg   |
     |  32489.39   |   9.090378   |   3574.041   |
     +-------------------------------------------+

     +-------------------------------------------+
  2. | product |    survquar | reg_tpi |    news |
     |     101 | Jan-Marc 11 | Central | Central |
     |-------------------------------------------|
     |  valued~t   |   quanti~t   |       ppkg   |
     |  26747.85   |   7.668651   |   3487.947   |
     +-------------------------------------------+

     +-------------------------------------------+
  3. | product |    survquar | reg_tpi |    news |
     |     101 | Apr-June 11 | Central | Central |
     |-------------------------------------------|
     |  valued~t   |   quanti~t   |       ppkg   |
     |   22607.1   |   5.109016   |   4424.943   |
     +-------------------------------------------+

.                         list in -3/-1;

     +----------------------------------------------+
442. | product |       survquar | reg_tpi |    news |
     |     150 |    Jan-Marc 11 | Western | Western |
     |----------------------------------------------|
     |   valued~t   |   quanti~t    |       ppkg    |
     |   3881.845   |   11.98976    |   323.7632    |
     +----------------------------------------------+

     +----------------------------------------------+
443. | product |       survquar | reg_tpi |    news |
     |     150 |    Apr-June 11 | Western | Western |
     |----------------------------------------------|
     |   valued~t   |   quanti~t    |       ppkg    |
     |   2283.002   |    5.49506    |   415.4644    |
     +----------------------------------------------+

     +----------------------------------------------+
444. | product |       survquar | reg_tpi |    news |
     |     150 | July-Sept 2011 | Western | Western |
     |----------------------------------------------|
     |   valued~t   |   quanti~t    |       ppkg    |
     |    1779.01   |   8.060019    |   220.7204    |
     +----------------------------------------------+

.                         tempfile uvq;

.                 save "$path/work/tpi_unit_val_quarterly.dt
> a", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> tpi_unit_val_quarterly.dta saved

.                 save `uvq', replace;
(note: file /tmp/St09373.00000c not found)
file /tmp/St09373.00000c saved

.         restore;

.         **************************************************
> ************************;
. * Toss out the bottom 5% and top 5% of the HH-LEVEL prices
>  per kg in
> * each reg_tpi & product combination. This should eliminat
> e outliers that
> * may have an undue influence on the price calculation. Th
> en use sample
> * weighting PLUS quantity weighting on those HH-level obse
> rvations.
> **********************************************************
> ****************;
.         preserve;

.                 gen hhppkg=valued_tot/quantityd_tot;
(92 missing values generated)

.                 egen lower5=pctile(hhppkg), p(5) by(reg_tp
> i product);
(92 missing values generated)

.                 egen upper5=pctile(hhppkg), p(95) by(reg_t
> pi product);
(92 missing values generated)

.                 keep if hhppkg>=lower5 & hhppkg<=upper5;
(655 observations deleted)

.                                 gen hhqtywt=hhweight*quant
> ityd_tot;
(92 missing values generated)

.                                 collapse (sum) valued_tot 
> quantityd_tot [aw=hhqtywt] , 
>                                 by(reg_tpi news product su
> rvquar);

.                         drop if product==.;
(0 observations deleted)

.                         gen ppkg_trim=valued_tot/quantityd
> _tot;

.                         lab var ppkg_trim "90% trimmed uni
> t value per kg";

.                         sort reg_tpi product survquar;

.                         list , nol;

     +------------------------------------------------+
  1. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        1 |       1 |    1 | 57437.59 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       13.20283        |          4350.4        |
     +------------------------------------------------+

     +------------------------------------------------+
  2. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        2 |       1 |    1 | 47372.37 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       15.73028        |        3011.539        |
     +------------------------------------------------+

     +------------------------------------------------+
  3. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        3 |       1 |    1 | 29595.09 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.921304        |        6013.668        |
     +------------------------------------------------+

     +------------------------------------------------+
  4. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        4 |       1 |    1 | 16443.26 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.143313        |        3197.017        |
     +------------------------------------------------+

     +------------------------------------------------+
  5. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        1 |       1 |    1 | 3096.492 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.96168        |         1578.49        |
     +------------------------------------------------+

     +------------------------------------------------+
  6. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        2 |       1 |    1 |  7326.93 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.86774        |        3922.886        |
     +------------------------------------------------+

     +------------------------------------------------+
  7. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        3 |       1 |    1 | 3083.075 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        5.12687        |        601.3561        |
     +------------------------------------------------+

     +------------------------------------------------+
  8. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        4 |       1 |    1 | 3032.885 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .9450139        |        3209.355        |
     +------------------------------------------------+

     +------------------------------------------------+
  9. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        1 |       1 |    1 | 22460.63 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       22.70206        |        989.3655        |
     +------------------------------------------------+

     +------------------------------------------------+
 10. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        2 |       1 |    1 | 14543.59 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.515906        |        1707.814        |
     +------------------------------------------------+

     +------------------------------------------------+
 11. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        3 |       1 |    1 |  10159.7 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.782445        |        1497.941        |
     +------------------------------------------------+

     +------------------------------------------------+
 12. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        4 |       1 |    1 |  10009.3 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.516844        |        1814.317        |
     +------------------------------------------------+

     +------------------------------------------------+
 13. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        1 |       1 |    1 | 5159.026 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.586006        |        680.0715        |
     +------------------------------------------------+

     +------------------------------------------------+
 14. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        2 |       1 |    1 | 23203.86 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       27.19081        |        853.3713        |
     +------------------------------------------------+

     +------------------------------------------------+
 15. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        3 |       1 |    1 | 14242.07 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        18.0817        |        787.6511        |
     +------------------------------------------------+

     +------------------------------------------------+
 16. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        4 |       1 |    1 | 2117.246 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.015287        |        1050.593        |
     +------------------------------------------------+

     +------------------------------------------------+
 17. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        1 |       1 |    1 | 11622.73 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |         6.3585        |        1827.904        |
     +------------------------------------------------+

     +------------------------------------------------+
 18. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        2 |       1 |    1 |     9014 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.480495        |        2011.831        |
     +------------------------------------------------+

     +------------------------------------------------+
 19. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        3 |       1 |    1 | 4146.546 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.729706        |        2397.254        |
     +------------------------------------------------+

     +------------------------------------------------+
 20. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        4 |       1 |    1 | 943.1462 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5491004        |        1717.621        |
     +------------------------------------------------+

     +------------------------------------------------+
 21. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        1 |       1 |    1 | 1911.648 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.038295        |        211.5054        |
     +------------------------------------------------+

     +------------------------------------------------+
 22. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        2 |       1 |    1 | 1241.393 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.112843        |        153.0157        |
     +------------------------------------------------+

     +------------------------------------------------+
 23. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        4 |       1 |    1 | 2830.457 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       28.30457        |             100        |
     +------------------------------------------------+

     +------------------------------------------------+
 24. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        1 |       1 |    1 | 55904.71 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       61.60274        |        907.5035        |
     +------------------------------------------------+

     +------------------------------------------------+
 25. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        2 |       1 |    1 | 46225.42 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       38.87849        |        1188.972        |
     +------------------------------------------------+

     +------------------------------------------------+
 26. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        3 |       1 |    1 | 30488.22 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       19.47458        |        1565.539        |
     +------------------------------------------------+

     +------------------------------------------------+
 27. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        4 |       1 |    1 | 14955.94 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.051464        |        1857.543        |
     +------------------------------------------------+

     +------------------------------------------------+
 28. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        1 |       1 |    1 | 3269.306 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.170702        |        632.2752        |
     +------------------------------------------------+

     +------------------------------------------------+
 29. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        2 |       1 |    1 | 2397.687 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.208619        |        1983.823        |
     +------------------------------------------------+

     +------------------------------------------------+
 30. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        3 |       1 |    1 | 1081.815 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.43311        |        754.8727        |
     +------------------------------------------------+

     +------------------------------------------------+
 31. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        1 |       1 |    1 | 342.8571 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2857143        |            1200        |
     +------------------------------------------------+

     +------------------------------------------------+
 32. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        1 |       1 |    1 | 14848.79 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.768032        |        3940.729        |
     +------------------------------------------------+

     +------------------------------------------------+
 33. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        2 |       1 |    1 | 4429.099 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .8586505        |        5158.209        |
     +------------------------------------------------+

     +------------------------------------------------+
 34. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        3 |       1 |    1 | 7781.213 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.571554        |        4951.287        |
     +------------------------------------------------+

     +------------------------------------------------+
 35. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        4 |       1 |    1 | 1798.912 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .3903554        |        4608.397        |
     +------------------------------------------------+

     +------------------------------------------------+
 36. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        1 |       1 |    1 | 2614.276 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        .681674        |        3835.082        |
     +------------------------------------------------+

     +------------------------------------------------+
 37. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        2 |       1 |    1 | 7354.505 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.705084        |         4313.28        |
     +------------------------------------------------+

     +------------------------------------------------+
 38. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        3 |       1 |    1 | 7706.461 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.110944        |        3650.719        |
     +------------------------------------------------+

     +------------------------------------------------+
 39. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        4 |       1 |    1 | 867.8613 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1875015        |        4628.557        |
     +------------------------------------------------+

     +------------------------------------------------+
 40. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        1 |       1 |    1 | 2273.695 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5083914        |        4472.332        |
     +------------------------------------------------+

     +------------------------------------------------+
 41. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        2 |       1 |    1 |  1123.65 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2013378        |         5580.92        |
     +------------------------------------------------+

     +------------------------------------------------+
 42. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        3 |       1 |    1 | 857.1429 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |            6000        |
     +------------------------------------------------+

     +------------------------------------------------+
 43. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        4 |       1 |    1 |     1000 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |            7000        |
     +------------------------------------------------+

     +------------------------------------------------+
 44. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        1 |       1 |    1 | 2572.537 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5714286        |        4501.939        |
     +------------------------------------------------+

     +------------------------------------------------+
 45. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        2 |       1 |    1 | 4675.481 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4285714        |        10909.46        |
     +------------------------------------------------+

     +------------------------------------------------+
 46. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        3 |       1 |    1 | 2142.857 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |           15000        |
     +------------------------------------------------+

     +------------------------------------------------+
 47. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        1 |       1 |    1 |  6649.08 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.725502        |        1784.747        |
     +------------------------------------------------+

     +------------------------------------------------+
 48. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        2 |       1 |    1 | 2635.878 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.414103        |        1863.993        |
     +------------------------------------------------+

     +------------------------------------------------+
 49. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        3 |       1 |    1 | 6031.641 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.175878        |        737.7363        |
     +------------------------------------------------+

     +------------------------------------------------+
 50. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        4 |       1 |    1 | 1086.937 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.400611        |        776.0446        |
     +------------------------------------------------+

     +------------------------------------------------+
 51. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        1 |       1 |    1 | 3119.581 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        3.42611        |        910.5315        |
     +------------------------------------------------+

     +------------------------------------------------+
 52. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        2 |       1 |    1 | 5313.776 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.511941        |        707.3772        |
     +------------------------------------------------+

     +------------------------------------------------+
 53. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        3 |       1 |    1 | 1766.611 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.947817        |        599.2947        |
     +------------------------------------------------+

     +------------------------------------------------+
 54. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        4 |       1 |    1 | 1080.359 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.115664        |        510.6476        |
     +------------------------------------------------+

     +------------------------------------------------+
 55. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        1 |       1 |    1 | 7686.653 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       17.42526        |        441.1213        |
     +------------------------------------------------+

     +------------------------------------------------+
 56. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        2 |       1 |    1 | 20869.65 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       34.91679        |        597.6967        |
     +------------------------------------------------+

     +------------------------------------------------+
 57. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        3 |       1 |    1 |  10598.2 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       27.91056        |        379.7199        |
     +------------------------------------------------+

     +------------------------------------------------+
 58. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        4 |       1 |    1 | 3707.861 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.12278        |        333.3574        |
     +------------------------------------------------+

     +------------------------------------------------+
 59. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        1 |       1 |    1 | 6824.398 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       59.31282        |        115.0577        |
     +------------------------------------------------+

     +------------------------------------------------+
 60. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        2 |       1 |    1 | 6297.364 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       40.39234        |        155.9049        |
     +------------------------------------------------+

     +------------------------------------------------+
 61. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        3 |       1 |    1 | 2188.635 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       16.26604        |        134.5524        |
     +------------------------------------------------+

     +------------------------------------------------+
 62. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        4 |       1 |    1 | 1437.624 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.95978        |        131.1727        |
     +------------------------------------------------+

     +------------------------------------------------+
 63. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        1 |       1 |    1 | 1891.177 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       18.57759        |        101.7988        |
     +------------------------------------------------+

     +------------------------------------------------+
 64. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        2 |       1 |    1 | 2716.133 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       22.48006        |        120.8241        |
     +------------------------------------------------+

     +------------------------------------------------+
 65. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        3 |       1 |    1 | 780.2601 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.655854        |        213.4276        |
     +------------------------------------------------+

     +------------------------------------------------+
 66. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        4 |       1 |    1 | 5803.601 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       53.49823        |        108.4821        |
     +------------------------------------------------+

     +------------------------------------------------+
 67. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        1 |       1 |    1 | 3954.751 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       24.86561        |         159.045        |
     +------------------------------------------------+

     +------------------------------------------------+
 68. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        2 |       1 |    1 | 3281.322 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       22.02204        |        149.0017        |
     +------------------------------------------------+

     +------------------------------------------------+
 69. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        3 |       1 |    1 | 3027.535 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        16.5083        |        183.3947        |
     +------------------------------------------------+

     +------------------------------------------------+
 70. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        4 |       1 |    1 | 787.0079 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.235242        |        352.0907        |
     +------------------------------------------------+

     +------------------------------------------------+
 71. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        1 |       1 |    1 | 5569.063 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       33.05913        |        168.4576        |
     +------------------------------------------------+

     +------------------------------------------------+
 72. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        2 |       1 |    1 | 4890.257 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       34.37237        |        142.2729        |
     +------------------------------------------------+

     +------------------------------------------------+
 73. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        3 |       1 |    1 | 3760.855 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       21.98375        |        171.0743        |
     +------------------------------------------------+

     +------------------------------------------------+
 74. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        4 |       1 |    1 | 1284.787 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.13897        |        126.7177        |
     +------------------------------------------------+

     +------------------------------------------------+
 75. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        1 |       1 |    1 | 2558.836 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.55608        |        221.4276        |
     +------------------------------------------------+

     +------------------------------------------------+
 76. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        2 |       1 |    1 | 2798.901 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        14.7935        |        189.1981        |
     +------------------------------------------------+

     +------------------------------------------------+
 77. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        3 |       1 |    1 | 3777.925 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       19.42369        |        194.5009        |
     +------------------------------------------------+

     +------------------------------------------------+
 78. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        4 |       1 |    1 | 996.0446 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.369731        |        185.4925        |
     +------------------------------------------------+

     +------------------------------------------------+
 79. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        1 |       1 |    1 | 686.2408 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.533675        |        124.0118        |
     +------------------------------------------------+

     +------------------------------------------------+
 80. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        2 |       1 |    1 | 672.1129 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.210073        |        108.2295        |
     +------------------------------------------------+

     +------------------------------------------------+
 81. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        3 |       1 |    1 |  4571.78 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.67725        |        428.1796        |
     +------------------------------------------------+

     +------------------------------------------------+
 82. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        4 |       1 |    1 | 1142.541 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.970713        |        384.6016        |
     +------------------------------------------------+

     +------------------------------------------------+
 83. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        1 |       1 |    1 |  35455.8 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       64.11021        |        553.0445        |
     +------------------------------------------------+

     +------------------------------------------------+
 84. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        2 |       1 |    1 | 2889.947 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.103635        |        1373.787        |
     +------------------------------------------------+

     +------------------------------------------------+
 85. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        3 |       1 |    1 | 4093.697 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.911985        |         1405.81        |
     +------------------------------------------------+

     +------------------------------------------------+
 86. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        4 |       1 |    1 | 1796.124 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .9168923        |        1958.926        |
     +------------------------------------------------+

     +------------------------------------------------+
 87. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        1 |       1 |    1 | 14880.81 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.15792        |        1333.655        |
     +------------------------------------------------+

     +------------------------------------------------+
 88. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        2 |       1 |    1 | 47662.19 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       39.97542        |        1192.287        |
     +------------------------------------------------+

     +------------------------------------------------+
 89. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        3 |       1 |    1 | 8192.462 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.300771        |        1300.232        |
     +------------------------------------------------+

     +------------------------------------------------+
 90. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        4 |       1 |    1 |  11326.4 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.792655        |        1156.622        |
     +------------------------------------------------+

     +------------------------------------------------+
 91. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        1 |       1 |    1 |  1053.63 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .8461956        |        1245.138        |
     +------------------------------------------------+

     +------------------------------------------------+
 92. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        2 |       1 |    1 |  2369.28 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.845238        |        1283.997        |
     +------------------------------------------------+

     +------------------------------------------------+
 93. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        4 |       1 |    1 | 142.8571 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .0714286        |            2000        |
     +------------------------------------------------+

     +------------------------------------------------+
 94. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        1 |       1 |    1 | 7192.035 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.825283        |        1053.734        |
     +------------------------------------------------+

     +------------------------------------------------+
 95. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        2 |       1 |    1 | 12767.59 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.09449        |        1055.654        |
     +------------------------------------------------+

     +------------------------------------------------+
 96. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        3 |       1 |    1 | 13884.03 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.334504        |        2602.685        |
     +------------------------------------------------+

     +------------------------------------------------+
 97. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        4 |       1 |    1 | 1663.013 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        .835554        |        1990.312        |
     +------------------------------------------------+

     +------------------------------------------------+
 98. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        1 |       1 |    1 | 142.8571 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .0714286        |            2000        |
     +------------------------------------------------+

     +------------------------------------------------+
 99. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        2 |       1 |    1 | 142.8571 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .0714286        |            2000        |
     +------------------------------------------------+

     +------------------------------------------------+
100. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        1 |       1 |    1 | 20065.78 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        8.08877        |        2480.696        |
     +------------------------------------------------+

     +------------------------------------------------+
101. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        2 |       1 |    1 | 29892.62 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        10.5046        |         2845.67        |
     +------------------------------------------------+

     +------------------------------------------------+
102. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        3 |       1 |    1 | 12825.83 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        4.90842        |        2613.025        |
     +------------------------------------------------+

     +------------------------------------------------+
103. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        4 |       1 |    1 | 1458.272 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4442825        |        3282.308        |
     +------------------------------------------------+

     +------------------------------------------------+
104. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        1 |       1 |    1 | 2157.393 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.053516        |        356.3867        |
     +------------------------------------------------+

     +------------------------------------------------+
105. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        2 |       1 |    1 | 7026.391 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       17.86482        |        393.3087        |
     +------------------------------------------------+

     +------------------------------------------------+
106. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        3 |       1 |    1 | 1672.504 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.923066        |        426.3258        |
     +------------------------------------------------+

     +------------------------------------------------+
107. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        4 |       1 |    1 | 706.8258 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.825066        |        387.2878        |
     +------------------------------------------------+

     +------------------------------------------------+
108. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        1 |       2 |    2 | 30917.75 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.717041        |        3181.807        |
     +------------------------------------------------+

     +------------------------------------------------+
109. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        2 |       2 |    2 | 20643.89 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.604708        |        2399.138        |
     +------------------------------------------------+

     +------------------------------------------------+
110. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        3 |       2 |    2 | 61807.68 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       15.21774        |        4061.553        |
     +------------------------------------------------+

     +------------------------------------------------+
111. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        4 |       2 |    2 | 19771.42 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        7.80793        |        2532.223        |
     +------------------------------------------------+

     +------------------------------------------------+
112. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        1 |       2 |    2 | 20281.21 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.977516        |        2032.692        |
     +------------------------------------------------+

     +------------------------------------------------+
113. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        2 |       2 |    2 | 5959.242 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.040996        |        2919.771        |
     +------------------------------------------------+

     +------------------------------------------------+
114. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        3 |       2 |    2 | 4660.469 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.444165        |        3227.102        |
     +------------------------------------------------+

     +------------------------------------------------+
115. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        4 |       2 |    2 | 8100.008 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.521023        |        5325.369        |
     +------------------------------------------------+

     +------------------------------------------------+
116. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        1 |       2 |    2 | 5407.415 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.982277        |        903.9059        |
     +------------------------------------------------+

     +------------------------------------------------+
117. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        2 |       2 |    2 | 7082.089 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.837265        |        801.3892        |
     +------------------------------------------------+

     +------------------------------------------------+
118. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        3 |       2 |    2 | 22018.15 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       33.04293        |          666.35        |
     +------------------------------------------------+

     +------------------------------------------------+
119. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        4 |       2 |    2 | 3872.837 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.288449        |        1177.709        |
     +------------------------------------------------+

     +------------------------------------------------+
120. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        1 |       2 |    2 | 43257.25 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       82.06037        |        527.1393        |
     +------------------------------------------------+

     +------------------------------------------------+
121. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        2 |       2 |    2 |  54035.9 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       105.3065        |        513.1299        |
     +------------------------------------------------+

     +------------------------------------------------+
122. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        3 |       2 |    2 | 90440.73 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        137.163        |        659.3668        |
     +------------------------------------------------+

     +------------------------------------------------+
123. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        4 |       2 |    2 | 46355.68 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       49.05183        |        945.0346        |
     +------------------------------------------------+

     +------------------------------------------------+
124. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        1 |       2 |    2 | 8898.298 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.786174        |        1311.239        |
     +------------------------------------------------+

     +------------------------------------------------+
125. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        2 |       2 |    2 | 7417.211 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.936081        |        1884.415        |
     +------------------------------------------------+

     +------------------------------------------------+
126. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        3 |       2 |    2 | 16244.52 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        6.91428        |        2349.417        |
     +------------------------------------------------+

     +------------------------------------------------+
127. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        4 |       2 |    2 | 7790.305 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.736455        |        2084.946        |
     +------------------------------------------------+

     +------------------------------------------------+
128. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        1 |       2 |    2 | 7562.565 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       74.23523        |         101.873        |
     +------------------------------------------------+

     +------------------------------------------------+
129. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        2 |       2 |    2 | 1303.809 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.035436        |        429.5292        |
     +------------------------------------------------+

     +------------------------------------------------+
130. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        3 |       2 |    2 | 19334.88 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       190.7692        |        101.3522        |
     +------------------------------------------------+

     +------------------------------------------------+
131. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        4 |       2 |    2 | 30780.78 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       176.1678        |        174.7242        |
     +------------------------------------------------+

     +------------------------------------------------+
132. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        1 |       2 |    2 | 34300.83 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        55.4006        |        619.1418        |
     +------------------------------------------------+

     +------------------------------------------------+
133. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        2 |       2 |    2 | 56740.77 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       57.44872        |        987.6768        |
     +------------------------------------------------+

     +------------------------------------------------+
134. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        3 |       2 |    2 | 35456.57 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       27.81991        |        1274.503        |
     +------------------------------------------------+

     +------------------------------------------------+
135. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        4 |       2 |    2 | 125049.3 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       123.1687        |        1015.268        |
     +------------------------------------------------+

     +------------------------------------------------+
136. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        1 |       2 |    2 | 2821.523 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.183771        |        886.2206        |
     +------------------------------------------------+

     +------------------------------------------------+
137. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        2 |       2 |    2 | 15270.31 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       17.89433        |        853.3605        |
     +------------------------------------------------+

     +------------------------------------------------+
138. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        3 |       2 |    2 | 7401.881 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.07073        |        734.9899        |
     +------------------------------------------------+

     +------------------------------------------------+
139. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        4 |       2 |    2 | 4273.172 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.306858        |         514.415        |
     +------------------------------------------------+

     +------------------------------------------------+
140. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        1 |       2 |    2 | 24539.91 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       35.26673        |        695.8375        |
     +------------------------------------------------+

     +------------------------------------------------+
141. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        2 |       2 |    2 | 22940.14 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       99.14336        |        231.3835        |
     +------------------------------------------------+

     +------------------------------------------------+
142. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        3 |       2 |    2 | 9097.234 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       15.16707        |        599.8017        |
     +------------------------------------------------+

     +------------------------------------------------+
143. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        4 |       2 |    2 | 3267.832 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.741683        |        569.1419        |
     +------------------------------------------------+

     +------------------------------------------------+
144. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        1 |       2 |    2 | 25548.83 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.980374        |        4272.112        |
     +------------------------------------------------+

     +------------------------------------------------+
145. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        2 |       2 |    2 | 27889.84 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.460457        |        4317.008        |
     +------------------------------------------------+

     +------------------------------------------------+
146. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        3 |       2 |    2 | 20807.46 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.051707        |        5135.481        |
     +------------------------------------------------+

     +------------------------------------------------+
147. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        4 |       2 |    2 | 14254.51 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.485363        |        5735.383        |
     +------------------------------------------------+

     +------------------------------------------------+
148. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        1 |       2 |    2 | 5329.023 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.528054        |        3487.458        |
     +------------------------------------------------+

     +------------------------------------------------+
149. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        2 |       2 |    2 | 2908.327 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .7941739        |        3662.078        |
     +------------------------------------------------+

     +------------------------------------------------+
150. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        3 |       2 |    2 | 7566.575 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.879047        |        4026.816        |
     +------------------------------------------------+

     +------------------------------------------------+
151. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        4 |       2 |    2 | 1366.234 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2857143        |        4781.818        |
     +------------------------------------------------+

     +------------------------------------------------+
152. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        1 |       2 |    2 | 11042.76 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        2.66961        |        4136.471        |
     +------------------------------------------------+

     +------------------------------------------------+
153. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        2 |       2 |    2 | 8739.325 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.934546        |        4517.507        |
     +------------------------------------------------+

     +------------------------------------------------+
154. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        3 |       2 |    2 | 8681.765 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.97979        |        4385.195        |
     +------------------------------------------------+

     +------------------------------------------------+
155. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        4 |       2 |    2 | 6463.121 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.096876        |        5892.299        |
     +------------------------------------------------+

     +------------------------------------------------+
156. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        1 |       2 |    2 | 7379.641 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.142857        |        6457.186        |
     +------------------------------------------------+

     +------------------------------------------------+
157. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        2 |       2 |    2 | 9103.506 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.47835        |        6157.884        |
     +------------------------------------------------+

     +------------------------------------------------+
158. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        3 |       2 |    2 | 7689.818 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |              1        |        7689.817        |
     +------------------------------------------------+

     +------------------------------------------------+
159. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        4 |       2 |    2 |     1000 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |            7000        |
     +------------------------------------------------+

     +------------------------------------------------+
160. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        1 |       2 |    2 | 4526.135 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.078802        |        891.1816        |
     +------------------------------------------------+

     +------------------------------------------------+
161. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        2 |       2 |    2 | 20605.64 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       35.90212        |        573.9393        |
     +------------------------------------------------+

     +------------------------------------------------+
162. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        3 |       2 |    2 | 15491.42 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |         18.075        |        857.0634        |
     +------------------------------------------------+

     +------------------------------------------------+
163. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        4 |       2 |    2 | 8573.027 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.19223        |        841.1335        |
     +------------------------------------------------+

     +------------------------------------------------+
164. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        1 |       2 |    2 | 7963.766 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.33406        |         645.673        |
     +------------------------------------------------+

     +------------------------------------------------+
165. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        2 |       2 |    2 | 5540.414 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.471103        |        654.0369        |
     +------------------------------------------------+

     +------------------------------------------------+
166. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        3 |       2 |    2 | 8521.401 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.14227        |        840.1863        |
     +------------------------------------------------+

     +------------------------------------------------+
167. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        4 |       2 |    2 | 4746.663 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.992334        |        678.8382        |
     +------------------------------------------------+

     +------------------------------------------------+
168. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        1 |       2 |    2 | 35180.56 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        113.713        |        309.3804        |
     +------------------------------------------------+

     +------------------------------------------------+
169. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        2 |       2 |    2 |    27044 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       89.08467        |        303.5763        |
     +------------------------------------------------+

     +------------------------------------------------+
170. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        3 |       2 |    2 | 24926.27 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       54.54134        |        457.0162        |
     +------------------------------------------------+

     +------------------------------------------------+
171. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        4 |       2 |    2 | 14330.31 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       30.75032        |        466.0214        |
     +------------------------------------------------+

     +------------------------------------------------+
172. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        1 |       2 |    2 | 8928.952 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       86.55354        |         103.161        |
     +------------------------------------------------+

     +------------------------------------------------+
173. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        2 |       2 |    2 | 10563.64 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       115.9922        |        91.07195        |
     +------------------------------------------------+

     +------------------------------------------------+
174. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        3 |       2 |    2 | 14345.94 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       104.0765        |        137.8404        |
     +------------------------------------------------+

     +------------------------------------------------+
175. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        4 |       2 |    2 | 11227.85 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       96.01176        |        116.9424        |
     +------------------------------------------------+

     +------------------------------------------------+
176. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        1 |       2 |    2 |  4198.84 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        80.0224        |        52.47081        |
     +------------------------------------------------+

     +------------------------------------------------+
177. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        2 |       2 |    2 | 4367.154 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       36.78229        |        118.7298        |
     +------------------------------------------------+

     +------------------------------------------------+
178. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        3 |       2 |    2 | 32180.34 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       317.9416        |        101.2146        |
     +------------------------------------------------+

     +------------------------------------------------+
179. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        4 |       2 |    2 | 883.7887 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.767577        |             500        |
     +------------------------------------------------+

     +------------------------------------------------+
180. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        1 |       2 |    2 | 3040.788 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       35.38102        |        85.94403        |
     +------------------------------------------------+

     +------------------------------------------------+
181. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        2 |       2 |    2 | 4177.416 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       39.41179        |        105.9941        |
     +------------------------------------------------+

     +------------------------------------------------+
182. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        3 |       2 |    2 | 3296.588 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       24.23394        |        136.0318        |
     +------------------------------------------------+

     +------------------------------------------------+
183. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        4 |       2 |    2 | 2773.514 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       19.17013        |         144.679        |
     +------------------------------------------------+

     +------------------------------------------------+
184. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        1 |       2 |    2 | 10354.23 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       62.43311        |        165.8451        |
     +------------------------------------------------+

     +------------------------------------------------+
185. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        2 |       2 |    2 | 9783.981 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       52.34124        |        186.9268        |
     +------------------------------------------------+

     +------------------------------------------------+
186. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        3 |       2 |    2 | 7634.942 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       43.39058        |        175.9585        |
     +------------------------------------------------+

     +------------------------------------------------+
187. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        4 |       2 |    2 | 7176.791 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       38.02027        |        188.7622        |
     +------------------------------------------------+

     +------------------------------------------------+
188. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        1 |       2 |    2 | 7882.937 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       33.72482        |        233.7429        |
     +------------------------------------------------+

     +------------------------------------------------+
189. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        2 |       2 |    2 | 6758.606 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       23.60381        |        286.3354        |
     +------------------------------------------------+

     +------------------------------------------------+
190. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        3 |       2 |    2 | 21340.11 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       74.59715        |        286.0714        |
     +------------------------------------------------+

     +------------------------------------------------+
191. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        4 |       2 |    2 | 9269.579 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        37.0763        |        250.0136        |
     +------------------------------------------------+

     +------------------------------------------------+
192. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        1 |       2 |    2 | 8352.019 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       32.54639        |        256.6189        |
     +------------------------------------------------+

     +------------------------------------------------+
193. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        2 |       2 |    2 | 11713.57 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       55.17506        |        212.2982        |
     +------------------------------------------------+

     +------------------------------------------------+
194. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        3 |       2 |    2 | 15024.65 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       49.92088        |        300.9692        |
     +------------------------------------------------+

     +------------------------------------------------+
195. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        4 |       2 |    2 | 5673.721 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       26.13314        |        217.1082        |
     +------------------------------------------------+

     +------------------------------------------------+
196. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        1 |       2 |    2 | 12002.73 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       19.15019        |        626.7683        |
     +------------------------------------------------+

     +------------------------------------------------+
197. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        2 |       2 |    2 | 887.1206 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.786241        |        496.6409        |
     +------------------------------------------------+

     +------------------------------------------------+
198. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        3 |       2 |    2 | 15133.07 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       44.12085        |        342.9912        |
     +------------------------------------------------+

     +------------------------------------------------+
199. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        4 |       2 |    2 | 15674.88 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       48.66425        |        322.1025        |
     +------------------------------------------------+

     +------------------------------------------------+
200. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        1 |       2 |    2 |  14837.3 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       17.36218        |        854.5761        |
     +------------------------------------------------+

     +------------------------------------------------+
201. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        2 |       2 |    2 | 12601.62 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        11.4215        |        1103.324        |
     +------------------------------------------------+

     +------------------------------------------------+
202. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        3 |       2 |    2 | 13479.43 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       13.17103        |        1023.415        |
     +------------------------------------------------+

     +------------------------------------------------+
203. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        4 |       2 |    2 |  20362.4 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       21.81466        |        933.4276        |
     +------------------------------------------------+

     +------------------------------------------------+
204. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        1 |       2 |    2 | 2248.794 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.108533        |        723.4259        |
     +------------------------------------------------+

     +------------------------------------------------+
205. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        2 |       2 |    2 | 18025.34 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.847675        |        1830.416        |
     +------------------------------------------------+

     +------------------------------------------------+
206. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        3 |       2 |    2 | 4700.289 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.257614        |        507.7214        |
     +------------------------------------------------+

     +------------------------------------------------+
207. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        4 |       2 |    2 |  10250.2 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.704212        |        1056.263        |
     +------------------------------------------------+

     +------------------------------------------------+
208. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        1 |       2 |    2 | 4048.043 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.510612        |        538.9764        |
     +------------------------------------------------+

     +------------------------------------------------+
209. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        2 |       2 |    2 | 7574.279 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       22.33645        |        339.0994        |
     +------------------------------------------------+

     +------------------------------------------------+
210. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        3 |       2 |    2 | 1370.098 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.708887        |         505.779        |
     +------------------------------------------------+

     +------------------------------------------------+
211. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        4 |       2 |    2 | 8939.245 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        17.0062        |        525.6461        |
     +------------------------------------------------+

     +------------------------------------------------+
212. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        1 |       2 |    2 |  288.604 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4285714        |        673.4094        |
     +------------------------------------------------+

     +------------------------------------------------+
213. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        2 |       2 |    2 |  211.044 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4723901        |        446.7578        |
     +------------------------------------------------+

     +------------------------------------------------+
214. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        3 |       2 |    2 | 642.8571 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4285714        |            1500        |
     +------------------------------------------------+

     +------------------------------------------------+
215. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        4 |       2 |    2 | 2542.667 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.882372        |        1350.778        |
     +------------------------------------------------+

     +------------------------------------------------+
216. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        1 |       2 |    2 | 34714.96 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       14.64415        |         2370.57        |
     +------------------------------------------------+

     +------------------------------------------------+
217. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        2 |       2 |    2 | 25909.27 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       16.93002        |        1530.375        |
     +------------------------------------------------+

     +------------------------------------------------+
218. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        3 |       2 |    2 | 21908.47 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.75421        |        2037.199        |
     +------------------------------------------------+

     +------------------------------------------------+
219. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        4 |       2 |    2 | 14867.16 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.886016        |        1503.857        |
     +------------------------------------------------+

     +------------------------------------------------+
220. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        1 |       2 |    2 | 2416.695 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.641703        |        250.6502        |
     +------------------------------------------------+

     +------------------------------------------------+
221. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        2 |       2 |    2 | 2539.177 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.38782        |        244.4379        |
     +------------------------------------------------+

     +------------------------------------------------+
222. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        3 |       2 |    2 | 3201.746 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.78372        |        296.9056        |
     +------------------------------------------------+

     +------------------------------------------------+
223. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        4 |       2 |    2 | 3493.449 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.12845        |        288.0376        |
     +------------------------------------------------+

     +------------------------------------------------+
224. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        1 |       3 |    3 | 6693.087 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.571429        |        4259.237        |
     +------------------------------------------------+

     +------------------------------------------------+
225. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        2 |       3 |    3 | 6744.184 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.267428        |        5321.157        |
     +------------------------------------------------+

     +------------------------------------------------+
226. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        3 |       3 |    3 | 6748.517 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.824382        |         3699.07        |
     +------------------------------------------------+

     +------------------------------------------------+
227. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        4 |       3 |    3 | 826.8876 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4661054        |        1774.036        |
     +------------------------------------------------+

     +------------------------------------------------+
228. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        1 |       3 |    3 | 2706.331 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .7743224        |        3495.096        |
     +------------------------------------------------+

     +------------------------------------------------+
229. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        2 |       3 |    3 | 4663.914 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.833247        |        2544.073        |
     +------------------------------------------------+

     +------------------------------------------------+
230. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        3 |       3 |    3 | 112.8174 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2857143        |        394.8608        |
     +------------------------------------------------+

     +------------------------------------------------+
231. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        4 |       3 |    3 | 259.5653 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5191305        |             500        |
     +------------------------------------------------+

     +------------------------------------------------+
232. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        1 |       3 |    3 | 8733.572 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.61719        |        822.5876        |
     +------------------------------------------------+

     +------------------------------------------------+
233. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        2 |       3 |    3 |  7839.93 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       13.99399        |        560.2355        |
     +------------------------------------------------+

     +------------------------------------------------+
234. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        3 |       3 |    3 |  45565.2 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       85.99776        |        529.8417        |
     +------------------------------------------------+

     +------------------------------------------------+
235. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        4 |       3 |    3 | 18600.23 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        35.6814        |        521.2866        |
     +------------------------------------------------+

     +------------------------------------------------+
236. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        1 |       3 |    3 | 23702.18 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.381835        |         2526.39        |
     +------------------------------------------------+

     +------------------------------------------------+
237. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        2 |       3 |    3 | 28962.39 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       35.65995        |        812.1826        |
     +------------------------------------------------+

     +------------------------------------------------+
238. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        3 |       3 |    3 | 37212.01 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        70.5031        |        527.8067        |
     +------------------------------------------------+

     +------------------------------------------------+
239. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        4 |       3 |    3 | 25201.22 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       23.84569        |        1056.846        |
     +------------------------------------------------+

     +------------------------------------------------+
240. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        1 |       3 |    3 |  5235.82 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        5.85678        |         893.976        |
     +------------------------------------------------+

     +------------------------------------------------+
241. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        2 |       3 |    3 | 3139.814 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.562282        |        881.4052        |
     +------------------------------------------------+

     +------------------------------------------------+
242. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        3 |       3 |    3 | 7321.516 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.481671        |        978.5937        |
     +------------------------------------------------+

     +------------------------------------------------+
243. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        4 |       3 |    3 | 571.4286 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5714286        |            1000        |
     +------------------------------------------------+

     +------------------------------------------------+
244. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        1 |       3 |    3 | 13049.02 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        153.918        |        84.77903        |
     +------------------------------------------------+

     +------------------------------------------------+
245. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        3 |       3 |    3 |  1706.26 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.213063        |        404.9927        |
     +------------------------------------------------+

     +------------------------------------------------+
246. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        4 |       3 |    3 | 15777.44 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       134.6283        |        117.1926        |
     +------------------------------------------------+

     +------------------------------------------------+
247. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        1 |       3 |    3 |  16458.1 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       34.72477        |        473.9584        |
     +------------------------------------------------+

     +------------------------------------------------+
248. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        2 |       3 |    3 | 37903.46 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       50.46889        |        751.0263        |
     +------------------------------------------------+

     +------------------------------------------------+
249. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        3 |       3 |    3 | 13394.77 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       27.69614        |        483.6328        |
     +------------------------------------------------+

     +------------------------------------------------+
250. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        4 |       3 |    3 | 13339.08 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        40.8194        |        326.7828        |
     +------------------------------------------------+

     +------------------------------------------------+
251. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        1 |       3 |    3 | 1101.454 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.332984        |        254.2022        |
     +------------------------------------------------+

     +------------------------------------------------+
252. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        2 |       3 |    3 | 4551.298 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       15.09288        |        301.5526        |
     +------------------------------------------------+

     +------------------------------------------------+
253. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        3 |       3 |    3 | 2277.361 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.532002        |        266.9199        |
     +------------------------------------------------+

     +------------------------------------------------+
254. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        4 |       3 |    3 | 27495.84 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       90.94854        |        302.3231        |
     +------------------------------------------------+

     +------------------------------------------------+
255. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        1 |       3 |    3 | 23921.89 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       36.00626        |        664.3815        |
     +------------------------------------------------+

     +------------------------------------------------+
256. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        2 |       3 |    3 | 26380.51 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       80.67308        |        327.0051        |
     +------------------------------------------------+

     +------------------------------------------------+
257. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        3 |       3 |    3 | 30361.86 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        82.8774        |        366.3466        |
     +------------------------------------------------+

     +------------------------------------------------+
258. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        4 |       3 |    3 | 20539.35 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        73.8637        |         278.071        |
     +------------------------------------------------+

     +------------------------------------------------+
259. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        1 |       3 |    3 | 20793.65 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.968845        |        3483.697        |
     +------------------------------------------------+

     +------------------------------------------------+
260. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        2 |       3 |    3 |  21681.7 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.754853        |        4559.909        |
     +------------------------------------------------+

     +------------------------------------------------+
261. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        3 |       3 |    3 | 25303.14 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.165558        |        4898.433        |
     +------------------------------------------------+

     +------------------------------------------------+
262. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        4 |       3 |    3 | 9198.486 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.631877        |        5636.751        |
     +------------------------------------------------+

     +------------------------------------------------+
263. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        1 |       3 |    3 | 2907.122 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .6466722        |        4495.511        |
     +------------------------------------------------+

     +------------------------------------------------+
264. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        2 |       3 |    3 | 10196.97 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.386557        |        4272.669        |
     +------------------------------------------------+

     +------------------------------------------------+
265. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        3 |       3 |    3 | 6915.432 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.539821        |        4491.063        |
     +------------------------------------------------+

     +------------------------------------------------+
266. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        4 |       3 |    3 | 5282.972 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.395173        |        3786.605        |
     +------------------------------------------------+

     +------------------------------------------------+
267. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        1 |       3 |    3 | 10171.84 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.300395        |         4421.78        |
     +------------------------------------------------+

     +------------------------------------------------+
268. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        2 |       3 |    3 | 2654.662 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        .558817        |        4750.503        |
     +------------------------------------------------+

     +------------------------------------------------+
269. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        3 |       3 |    3 | 7652.524 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.48963        |        5137.198        |
     +------------------------------------------------+

     +------------------------------------------------+
270. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        4 |       3 |    3 | 9877.456 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.895393        |        5211.297        |
     +------------------------------------------------+

     +------------------------------------------------+
271. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        1 |       3 |    3 | 30717.81 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        4.78941        |        6413.695        |
     +------------------------------------------------+

     +------------------------------------------------+
272. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        2 |       3 |    3 | 8800.493 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.428571        |        6160.345        |
     +------------------------------------------------+

     +------------------------------------------------+
273. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        3 |       3 |    3 | 12983.26 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.714286        |        7573.567        |
     +------------------------------------------------+

     +------------------------------------------------+
274. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        4 |       3 |    3 |  13280.8 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.573274        |        8441.506        |
     +------------------------------------------------+

     +------------------------------------------------+
275. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        1 |       3 |    3 | 5703.447 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.076863        |          628.35        |
     +------------------------------------------------+

     +------------------------------------------------+
276. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        2 |       3 |    3 | 14476.75 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.61533        |        1363.759        |
     +------------------------------------------------+

     +------------------------------------------------+
277. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        3 |       3 |    3 | 4126.432 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.910475        |        1055.225        |
     +------------------------------------------------+

     +------------------------------------------------+
278. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        4 |       3 |    3 | 11018.22 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        5.47283        |        2013.258        |
     +------------------------------------------------+

     +------------------------------------------------+
279. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        1 |       3 |    3 |    14699 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.68424        |        1258.019        |
     +------------------------------------------------+

     +------------------------------------------------+
280. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        2 |       3 |    3 | 19541.21 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       18.67705        |        1046.269        |
     +------------------------------------------------+

     +------------------------------------------------+
281. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        3 |       3 |    3 | 21528.37 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        29.5912        |        727.5261        |
     +------------------------------------------------+

     +------------------------------------------------+
282. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        4 |       3 |    3 | 13715.71 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       13.55837        |        1011.604        |
     +------------------------------------------------+

     +------------------------------------------------+
283. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        1 |       3 |    3 | 5340.968 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       18.51476        |        288.4709        |
     +------------------------------------------------+

     +------------------------------------------------+
284. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        2 |       3 |    3 | 13087.64 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       44.82575        |         291.967        |
     +------------------------------------------------+

     +------------------------------------------------+
285. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        3 |       3 |    3 | 14947.87 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       54.28977        |        275.3349        |
     +------------------------------------------------+

     +------------------------------------------------+
286. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        4 |       3 |    3 |  5142.94 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       17.23019        |        298.4843        |
     +------------------------------------------------+

     +------------------------------------------------+
287. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        1 |       3 |    3 | 20086.94 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |          152.9        |        131.3731        |
     +------------------------------------------------+

     +------------------------------------------------+
288. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        2 |       3 |    3 | 9470.743 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       43.57069        |         217.365        |
     +------------------------------------------------+

     +------------------------------------------------+
289. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        3 |       3 |    3 | 15640.42 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       44.35918        |        352.5859        |
     +------------------------------------------------+

     +------------------------------------------------+
290. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        4 |       3 |    3 | 12096.29 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       33.96336        |         356.157        |
     +------------------------------------------------+

     +------------------------------------------------+
291. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        1 |       3 |    3 |  1592.64 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        9.98709        |        159.4698        |
     +------------------------------------------------+

     +------------------------------------------------+
292. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        2 |       3 |    3 | 1818.749 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       17.74215        |        102.5101        |
     +------------------------------------------------+

     +------------------------------------------------+
293. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        3 |       3 |    3 | 10795.25 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       250.0516        |         43.1721        |
     +------------------------------------------------+

     +------------------------------------------------+
294. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        4 |       3 |    3 | 171.4286 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5714286        |             300        |
     +------------------------------------------------+

     +------------------------------------------------+
295. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        1 |       3 |    3 | 5142.925 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       42.36136        |        121.4061        |
     +------------------------------------------------+

     +------------------------------------------------+
296. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        2 |       3 |    3 | 4006.562 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       29.23029        |        137.0689        |
     +------------------------------------------------+

     +------------------------------------------------+
297. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        3 |       3 |    3 | 4564.301 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       28.77551        |        158.6176        |
     +------------------------------------------------+

     +------------------------------------------------+
298. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        4 |       3 |    3 | 4374.106 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       37.54668        |        116.4978        |
     +------------------------------------------------+

     +------------------------------------------------+
299. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        1 |       3 |    3 | 6801.358 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       31.30634        |        217.2518        |
     +------------------------------------------------+

     +------------------------------------------------+
300. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        2 |       3 |    3 | 5705.542 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       33.92505        |        168.1808        |
     +------------------------------------------------+

     +------------------------------------------------+
301. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        3 |       3 |    3 | 6442.883 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       25.46354        |        253.0238        |
     +------------------------------------------------+

     +------------------------------------------------+
302. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        4 |       3 |    3 | 6656.842 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       26.20046        |        254.0735        |
     +------------------------------------------------+

     +------------------------------------------------+
303. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        1 |       3 |    3 | 2789.633 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       19.03816        |        146.5285        |
     +------------------------------------------------+

     +------------------------------------------------+
304. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        2 |       3 |    3 | 2098.432 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.09001        |        207.9713        |
     +------------------------------------------------+

     +------------------------------------------------+
305. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        3 |       3 |    3 | 5381.186 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       47.02765        |         114.426        |
     +------------------------------------------------+

     +------------------------------------------------+
306. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        4 |       3 |    3 | 7572.134 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       53.03334        |        142.7806        |
     +------------------------------------------------+

     +------------------------------------------------+
307. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        1 |       3 |    3 | 12182.49 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       60.91607        |        199.9881        |
     +------------------------------------------------+

     +------------------------------------------------+
308. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        2 |       3 |    3 | 15699.66 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       105.2158        |        149.2139        |
     +------------------------------------------------+

     +------------------------------------------------+
309. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        3 |       3 |    3 | 15721.71 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       82.12822        |        191.4289        |
     +------------------------------------------------+

     +------------------------------------------------+
310. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        4 |       3 |    3 | 8562.939 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       56.27006        |        152.1758        |
     +------------------------------------------------+

     +------------------------------------------------+
311. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        1 |       3 |    3 | 6123.507 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        24.1863        |        253.1808        |
     +------------------------------------------------+

     +------------------------------------------------+
312. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        2 |       3 |    3 | 142.8571 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2857143        |             500        |
     +------------------------------------------------+

     +------------------------------------------------+
313. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        3 |       3 |    3 | 1922.871 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.575411        |         420.262        |
     +------------------------------------------------+

     +------------------------------------------------+
314. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        4 |       3 |    3 | 10761.22 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       20.24615        |        531.5196        |
     +------------------------------------------------+

     +------------------------------------------------+
315. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        1 |       3 |    3 | 52518.52 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |         111.45        |        471.2293        |
     +------------------------------------------------+

     +------------------------------------------------+
316. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        2 |       3 |    3 | 63253.55 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       93.92202        |        673.4688        |
     +------------------------------------------------+

     +------------------------------------------------+
317. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        3 |       3 |    3 | 64781.09 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       85.82384        |        754.8146        |
     +------------------------------------------------+

     +------------------------------------------------+
318. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        4 |       3 |    3 | 74524.27 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       128.8979        |        578.1651        |
     +------------------------------------------------+

     +------------------------------------------------+
319. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        1 |       3 |    3 | 3113.044 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        4.00343        |        777.5941        |
     +------------------------------------------------+

     +------------------------------------------------+
320. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        2 |       3 |    3 | 3863.918 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |          8.752        |        441.4897        |
     +------------------------------------------------+

     +------------------------------------------------+
321. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        3 |       3 |    3 | 2958.032 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.188151        |        321.9398        |
     +------------------------------------------------+

     +------------------------------------------------+
322. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        4 |       3 |    3 | 1800.949 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.394933        |        751.9832        |
     +------------------------------------------------+

     +------------------------------------------------+
323. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        1 |       3 |    3 |  366.955 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.473307        |        249.0689        |
     +------------------------------------------------+

     +------------------------------------------------+
324. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        2 |       3 |    3 | 641.1347 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.723314        |        372.0359        |
     +------------------------------------------------+

     +------------------------------------------------+
325. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        3 |       3 |    3 | 213.2845 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4285714        |        497.6637        |
     +------------------------------------------------+

     +------------------------------------------------+
326. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        4 |       3 |    3 | 71.42857 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |             500        |
     +------------------------------------------------+

     +------------------------------------------------+
327. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        1 |       3 |    3 | 11125.49 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       16.80904        |        661.8755        |
     +------------------------------------------------+

     +------------------------------------------------+
328. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        2 |       3 |    3 |  11621.2 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        17.9825        |        646.2503        |
     +------------------------------------------------+

     +------------------------------------------------+
329. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        3 |       3 |    3 | 15882.23 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       20.21427        |         785.694        |
     +------------------------------------------------+

     +------------------------------------------------+
330. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        4 |       3 |    3 | 11102.82 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.41306        |        972.8165        |
     +------------------------------------------------+

     +------------------------------------------------+
331. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        1 |       3 |    3 |  17475.6 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       20.97888        |        833.0092        |
     +------------------------------------------------+

     +------------------------------------------------+
332. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        2 |       3 |    3 | 29168.58 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       65.56867        |        444.8555        |
     +------------------------------------------------+

     +------------------------------------------------+
333. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        3 |       3 |    3 | 12740.07 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.08927        |        1053.833        |
     +------------------------------------------------+

     +------------------------------------------------+
334. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        4 |       3 |    3 | 4063.164 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.865879        |        1051.032        |
     +------------------------------------------------+

     +------------------------------------------------+
335. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        1 |       3 |    3 | 3381.183 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.03894        |        336.8067        |
     +------------------------------------------------+

     +------------------------------------------------+
336. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        2 |       3 |    3 | 3306.872 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.944101        |        332.5461        |
     +------------------------------------------------+

     +------------------------------------------------+
337. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        3 |       3 |    3 | 4058.737 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.06998        |        366.6435        |
     +------------------------------------------------+

     +------------------------------------------------+
338. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        4 |       3 |    3 | 4025.984 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.82339        |        340.5101        |
     +------------------------------------------------+

     +------------------------------------------------+
339. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        1 |       4 |    4 | 77976.86 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       24.67211        |        3160.527        |
     +------------------------------------------------+

     +------------------------------------------------+
340. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        2 |       4 |    4 | 63598.17 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       22.32814        |        2848.341        |
     +------------------------------------------------+

     +------------------------------------------------+
341. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        3 |       4 |    4 | 52859.21 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       22.50952        |        2348.305        |
     +------------------------------------------------+

     +------------------------------------------------+
342. | product | survquar | reg_tpi | news | valued~t |
     |     101 |        4 |       4 |    4 | 42049.28 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.46775        |        3372.643        |
     +------------------------------------------------+

     +------------------------------------------------+
343. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        1 |       4 |    4 | 11944.25 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.399168        |        1614.269        |
     +------------------------------------------------+

     +------------------------------------------------+
344. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        2 |       4 |    4 | 27133.72 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.14108        |        2675.624        |
     +------------------------------------------------+

     +------------------------------------------------+
345. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        3 |       4 |    4 | 20228.96 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.477164        |        3123.119        |
     +------------------------------------------------+

     +------------------------------------------------+
346. | product | survquar | reg_tpi | news | valued~t |
     |     105 |        4 |       4 |    4 | 21130.48 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.587944        |        2203.859        |
     +------------------------------------------------+

     +------------------------------------------------+
347. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        1 |       4 |    4 | 2894.775 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.894775        |            1000        |
     +------------------------------------------------+

     +------------------------------------------------+
348. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        2 |       4 |    4 | 3978.135 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.728468        |        694.4502        |
     +------------------------------------------------+

     +------------------------------------------------+
349. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        3 |       4 |    4 | 3872.877 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.872877        |        999.9999        |
     +------------------------------------------------+

     +------------------------------------------------+
350. | product | survquar | reg_tpi | news | valued~t |
     |     107 |        4 |       4 |    4 | 3876.577 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.420148        |        1133.453        |
     +------------------------------------------------+

     +------------------------------------------------+
351. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        1 |       4 |    4 | 13911.06 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       88.82827        |        156.6062        |
     +------------------------------------------------+

     +------------------------------------------------+
352. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        2 |       4 |    4 | 19860.74 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       93.47954        |        212.4608        |
     +------------------------------------------------+

     +------------------------------------------------+
353. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        3 |       4 |    4 | 17334.27 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       60.92399        |        284.5228        |
     +------------------------------------------------+

     +------------------------------------------------+
354. | product | survquar | reg_tpi | news | valued~t |
     |     108 |        4 |       4 |    4 | 3275.773 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       13.98419        |        234.2482        |
     +------------------------------------------------+

     +------------------------------------------------+
355. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        1 |       4 |    4 | 912.9967 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4564984        |            2000        |
     +------------------------------------------------+

     +------------------------------------------------+
356. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        2 |       4 |    4 | 10187.09 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       9.558207        |        1065.795        |
     +------------------------------------------------+

     +------------------------------------------------+
357. | product | survquar | reg_tpi | news | valued~t |
     |     110 |        4 |       4 |    4 | 428.5714 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |            3000        |
     +------------------------------------------------+

     +------------------------------------------------+
358. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        1 |       4 |    4 | 2443.062 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.325107        |        293.4571        |
     +------------------------------------------------+

     +------------------------------------------------+
359. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        2 |       4 |    4 | 841.6063 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.098531        |        118.5606        |
     +------------------------------------------------+

     +------------------------------------------------+
360. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        3 |       4 |    4 | 399.7506 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.947166        |         135.639        |
     +------------------------------------------------+

     +------------------------------------------------+
361. | product | survquar | reg_tpi | news | valued~t |
     |     112 |        4 |       4 |    4 | 392.7363 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.043411        |        376.3967        |
     +------------------------------------------------+

     +------------------------------------------------+
362. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        1 |       4 |    4 | 13660.46 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       15.45704        |        883.7695        |
     +------------------------------------------------+

     +------------------------------------------------+
363. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        2 |       4 |    4 | 26148.04 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       25.76538        |        1014.852        |
     +------------------------------------------------+

     +------------------------------------------------+
364. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        3 |       4 |    4 | 27065.78 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       20.82117        |        1299.916        |
     +------------------------------------------------+

     +------------------------------------------------+
365. | product | survquar | reg_tpi | news | valued~t |
     |     113 |        4 |       4 |    4 | 7220.461 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.586842        |        951.7084        |
     +------------------------------------------------+

     +------------------------------------------------+
366. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        1 |       4 |    4 | 1507.344 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.406062        |        626.4775        |
     +------------------------------------------------+

     +------------------------------------------------+
367. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        2 |       4 |    4 | 22274.02 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       39.42229        |         565.011        |
     +------------------------------------------------+

     +------------------------------------------------+
368. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        3 |       4 |    4 | 11047.72 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.35337        |        894.3082        |
     +------------------------------------------------+

     +------------------------------------------------+
369. | product | survquar | reg_tpi | news | valued~t |
     |     115 |        4 |       4 |    4 | 10856.11 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        12.4964        |        868.7389        |
     +------------------------------------------------+

     +------------------------------------------------+
370. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        1 |       4 |    4 | 1928.387 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.200268        |        370.8245        |
     +------------------------------------------------+

     +------------------------------------------------+
371. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        2 |       4 |    4 | 16673.01 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       41.33203        |         403.392        |
     +------------------------------------------------+

     +------------------------------------------------+
372. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        3 |       4 |    4 | 1363.626 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.115075        |        437.7505        |
     +------------------------------------------------+

     +------------------------------------------------+
373. | product | survquar | reg_tpi | news | valued~t |
     |     116 |        4 |       4 |    4 | 1178.152 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.207613        |        975.6038        |
     +------------------------------------------------+

     +------------------------------------------------+
374. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        1 |       4 |    4 | 4822.179 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.066443        |         4521.74        |
     +------------------------------------------------+

     +------------------------------------------------+
375. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        2 |       4 |    4 |  12913.9 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.591247        |        4983.661        |
     +------------------------------------------------+

     +------------------------------------------------+
376. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        3 |       4 |    4 | 9498.631 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.95365        |        4861.993        |
     +------------------------------------------------+

     +------------------------------------------------+
377. | product | survquar | reg_tpi | news | valued~t |
     |     117 |        4 |       4 |    4 | 5968.928 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .9948213        |            6000        |
     +------------------------------------------------+

     +------------------------------------------------+
378. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        2 |       4 |    4 | 1964.889 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4285714        |        4584.741        |
     +------------------------------------------------+

     +------------------------------------------------+
379. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        3 |       4 |    4 | 1285.714 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2142857        |            6000        |
     +------------------------------------------------+

     +------------------------------------------------+
380. | product | survquar | reg_tpi | news | valued~t |
     |     118 |        4 |       4 |    4 | 428.5714 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .0714286        |            6000        |
     +------------------------------------------------+

     +------------------------------------------------+
381. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        1 |       4 |    4 |   2343.2 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4857714        |        4823.667        |
     +------------------------------------------------+

     +------------------------------------------------+
382. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        2 |       4 |    4 | 714.2857 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |            5000        |
     +------------------------------------------------+

     +------------------------------------------------+
383. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        3 |       4 |    4 | 1547.885 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2579809        |            6000        |
     +------------------------------------------------+

     +------------------------------------------------+
384. | product | survquar | reg_tpi | news | valued~t |
     |     119 |        4 |       4 |    4 |     2500 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .3571429        |            7000        |
     +------------------------------------------------+

     +------------------------------------------------+
385. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        2 |       4 |    4 | 2142.857 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |           15000        |
     +------------------------------------------------+

     +------------------------------------------------+
386. | product | survquar | reg_tpi | news | valued~t |
     |     121 |        3 |       4 |    4 | 714.2857 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |            5000        |
     +------------------------------------------------+

     +------------------------------------------------+
387. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        1 |       4 |    4 | 571.4286 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4805104        |        1189.212        |
     +------------------------------------------------+

     +------------------------------------------------+
388. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        2 |       4 |    4 | 2125.521 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        1.06276        |            2000        |
     +------------------------------------------------+

     +------------------------------------------------+
389. | product | survquar | reg_tpi | news | valued~t |
     |     122 |        3 |       4 |    4 | 4312.383 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.121704        |        2032.509        |
     +------------------------------------------------+

     +------------------------------------------------+
390. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        1 |       4 |    4 | 709.3217 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .4285714        |        1655.084        |
     +------------------------------------------------+

     +------------------------------------------------+
391. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        2 |       4 |    4 | 2975.609 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.630344        |        1131.262        |
     +------------------------------------------------+

     +------------------------------------------------+
392. | product | survquar | reg_tpi | news | valued~t |
     |     123 |        3 |       4 |    4 |  1869.01 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        4.23368        |        441.4622        |
     +------------------------------------------------+

     +------------------------------------------------+
393. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        1 |       4 |    4 | 26120.85 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        83.9003        |         311.332        |
     +------------------------------------------------+

     +------------------------------------------------+
394. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        2 |       4 |    4 | 18034.46 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       32.62766        |        552.7354        |
     +------------------------------------------------+

     +------------------------------------------------+
395. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        3 |       4 |    4 | 10262.87 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       26.54571        |        386.6111        |
     +------------------------------------------------+

     +------------------------------------------------+
396. | product | survquar | reg_tpi | news | valued~t |
     |     125 |        4 |       4 |    4 | 4244.055 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.97636        |        327.0605        |
     +------------------------------------------------+

     +------------------------------------------------+
397. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        1 |       4 |    4 |  639.074 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.178144        |         201.084        |
     +------------------------------------------------+

     +------------------------------------------------+
398. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        2 |       4 |    4 | 1094.488 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       10.74731        |        101.8383        |
     +------------------------------------------------+

     +------------------------------------------------+
399. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        3 |       4 |    4 | 2347.573 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.714616        |        349.6213        |
     +------------------------------------------------+

     +------------------------------------------------+
400. | product | survquar | reg_tpi | news | valued~t |
     |     127 |        4 |       4 |    4 | 57.14286 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |             400        |
     +------------------------------------------------+

     +------------------------------------------------+
401. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        1 |       4 |    4 | 5152.579 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       97.33838        |        52.93471        |
     +------------------------------------------------+

     +------------------------------------------------+
402. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        2 |       4 |    4 | 542.4931 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       8.312217        |        65.26455        |
     +------------------------------------------------+

     +------------------------------------------------+
403. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        3 |       4 |    4 | 5891.731 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       60.95041        |        96.66434        |
     +------------------------------------------------+

     +------------------------------------------------+
404. | product | survquar | reg_tpi | news | valued~t |
     |     132 |        4 |       4 |    4 | 395.7559 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.575753        |        153.6467        |
     +------------------------------------------------+

     +------------------------------------------------+
405. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        1 |       4 |    4 |  1443.04 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       7.302395        |        197.6119        |
     +------------------------------------------------+

     +------------------------------------------------+
406. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        2 |       4 |    4 | 2713.996 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       11.36293        |        238.8464        |
     +------------------------------------------------+

     +------------------------------------------------+
407. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        3 |       4 |    4 | 1407.027 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.640696        |         249.442        |
     +------------------------------------------------+

     +------------------------------------------------+
408. | product | survquar | reg_tpi | news | valued~t |
     |     135 |        4 |       4 |    4 | 834.1417 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.035891        |        274.7601        |
     +------------------------------------------------+

     +------------------------------------------------+
409. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        1 |       4 |    4 | 4115.263 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       12.58098        |        327.1019        |
     +------------------------------------------------+

     +------------------------------------------------+
410. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        2 |       4 |    4 | 4128.942 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        14.4573        |        285.5956        |
     +------------------------------------------------+

     +------------------------------------------------+
411. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        3 |       4 |    4 | 4309.292 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       17.08393        |        252.2424        |
     +------------------------------------------------+

     +------------------------------------------------+
412. | product | survquar | reg_tpi | news | valued~t |
     |     136 |        4 |       4 |    4 | 1441.006 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.428707        |        325.3785        |
     +------------------------------------------------+

     +------------------------------------------------+
413. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        1 |       4 |    4 | 3431.687 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       23.29078        |         147.341        |
     +------------------------------------------------+

     +------------------------------------------------+
414. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        2 |       4 |    4 |  3493.46 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       23.06096        |        151.4881        |
     +------------------------------------------------+

     +------------------------------------------------+
415. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        3 |       4 |    4 |   4716.6 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       20.41814        |        231.0005        |
     +------------------------------------------------+

     +------------------------------------------------+
416. | product | survquar | reg_tpi | news | valued~t |
     |     138 |        4 |       4 |    4 | 1352.146 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.759604        |        200.0333        |
     +------------------------------------------------+

     +------------------------------------------------+
417. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        1 |       4 |    4 | 1011.461 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        6.45961        |        156.5824        |
     +------------------------------------------------+

     +------------------------------------------------+
418. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        2 |       4 |    4 | 1392.123 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       3.212658        |        433.3245        |
     +------------------------------------------------+

     +------------------------------------------------+
419. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        3 |       4 |    4 | 1048.108 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.337052        |        448.4743        |
     +------------------------------------------------+

     +------------------------------------------------+
420. | product | survquar | reg_tpi | news | valued~t |
     |     139 |        4 |       4 |    4 | 289.9218 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.153756        |        134.6122        |
     +------------------------------------------------+

     +------------------------------------------------+
421. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        1 |       4 |    4 | 25738.31 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       57.77862        |        445.4643        |
     +------------------------------------------------+

     +------------------------------------------------+
422. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        2 |       4 |    4 | 3681.862 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       5.899815        |         624.064        |
     +------------------------------------------------+

     +------------------------------------------------+
423. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        3 |       4 |    4 | 20261.97 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       48.72957        |        415.8045        |
     +------------------------------------------------+

     +------------------------------------------------+
424. | product | survquar | reg_tpi | news | valued~t |
     |     140 |        4 |       4 |    4 | 571.4286 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5714286        |            1000        |
     +------------------------------------------------+

     +------------------------------------------------+
425. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        1 |       4 |    4 | 12776.11 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       18.45608        |        692.2438        |
     +------------------------------------------------+

     +------------------------------------------------+
426. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        2 |       4 |    4 | 66606.09 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       83.19444        |        800.6075        |
     +------------------------------------------------+

     +------------------------------------------------+
427. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        3 |       4 |    4 | 35539.55 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       36.82692        |        965.0425        |
     +------------------------------------------------+

     +------------------------------------------------+
428. | product | survquar | reg_tpi | news | valued~t |
     |     141 |        4 |       4 |    4 |  31537.1 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       37.22974        |        847.0942        |
     +------------------------------------------------+

     +------------------------------------------------+
429. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        1 |       4 |    4 | 428.5714 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .1428571        |            3000        |
     +------------------------------------------------+

     +------------------------------------------------+
430. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        2 |       4 |    4 | 571.4286 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .5714286        |            1000        |
     +------------------------------------------------+

     +------------------------------------------------+
431. | product | survquar | reg_tpi | news | valued~t |
     |     143 |        4 |       4 |    4 | 1868.555 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .9473138        |        1972.477        |
     +------------------------------------------------+

     +------------------------------------------------+
432. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        1 |       4 |    4 | 2474.456 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.838267        |        871.8192        |
     +------------------------------------------------+

     +------------------------------------------------+
433. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        2 |       4 |    4 | 17807.09 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       18.09983        |        983.8261        |
     +------------------------------------------------+

     +------------------------------------------------+
434. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        3 |       4 |    4 | 2501.495 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.073572        |         1206.37        |
     +------------------------------------------------+

     +------------------------------------------------+
435. | product | survquar | reg_tpi | news | valued~t |
     |     144 |        4 |       4 |    4 | 8855.939 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |        6.15747        |        1438.243        |
     +------------------------------------------------+

     +------------------------------------------------+
436. | product | survquar | reg_tpi | news | valued~t |
     |     146 |        3 |       4 |    4 | 28.57143 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2857143        |        99.99999        |
     +------------------------------------------------+

     +------------------------------------------------+
437. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        1 |       4 |    4 | 4666.466 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.914979        |        2436.824        |
     +------------------------------------------------+

     +------------------------------------------------+
438. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        2 |       4 |    4 | 7345.384 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       2.685859        |        2734.836        |
     +------------------------------------------------+

     +------------------------------------------------+
439. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        3 |       4 |    4 |  3742.31 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       1.567503        |        2387.434        |
     +------------------------------------------------+

     +------------------------------------------------+
440. | product | survquar | reg_tpi | news | valued~t |
     |     147 |        4 |       4 |    4 | 799.5235 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       .2665078        |            3000        |
     +------------------------------------------------+

     +------------------------------------------------+
441. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        1 |       4 |    4 | 2316.135 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.545722        |        353.8395        |
     +------------------------------------------------+

     +------------------------------------------------+
442. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        2 |       4 |    4 | 8979.104 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       23.73425        |        378.3184        |
     +------------------------------------------------+

     +------------------------------------------------+
443. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        3 |       4 |    4 | 2632.817 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       6.546304        |        402.1837        |
     +------------------------------------------------+

     +------------------------------------------------+
444. | product | survquar | reg_tpi | news | valued~t |
     |     150 |        4 |       4 |    4 | 2049.994 |
     |------------------------------------------------|
     |       quanti~t        |        ppkg_t~m        |
     |       4.778547        |        428.9995        |
     +------------------------------------------------+

.                         tempfile uvq2;

.                         keep reg_tpi product survquar ppkg
> _trim;

.                 save `uvq2', replace;
(note: file /tmp/St09373.00000e not found)
file /tmp/St09373.00000e saved

.                                 use `uvq' ;

.                         merge reg_tpi product survquar usi
> ng `uvq2';
(label lbreg already defined)
(label lsurvquar already defined)

.                         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |        444      100.00      100.00
------------+-----------------------------------
      Total |        444      100.00

.                         drop _merge;

.                 save `uvq', replace;
file /tmp/St09373.00000c saved

.                 save "$path/work/tpi_unit_val_quarterly.dt
> a", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> tpi_unit_val_quarterly.dta saved

.         restore;

. **********************************************************
> ****************;
. * Now calculate the weights for the temporal price index. 
> The weights
> * will be based on the bottom 50% of the national nominal 
> consumption
> * per capita (see below). We let the weights vary by strat
> a (3 regions X rural/urban).
> *
> * First, make a small file that has the total nominal HH d
> aily consumption,
> * to use as our denominator. We cannot simply use the `bot
> tom_tpi' file that
> * was created earlier because we will need some other vari
> ables from
> * the cons_cat.dta file.
> **********************************************************
> ****************;
. use "$path/work/conpc.dta", clear;

. keep hhid cons_hh_nom;

. *use "$path/in/cons_cat.dta", clear ;
. *CA modified to merge in hhdata for bootstrap;
.        sort hhid;

.         merge hhid using "$path/work/hhdata.dta";

.           tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         collapse (mean) cons_hh_nom hhsize strata hhweight
>  rural news survquar reg_tpi,
>                 by(hhid);

.         lab var cons_hh_nom "Nominal daily HH consumption"
> ;

.         rename hhsize   cc_hhs;

.         rename strata   cc_reg;

.         rename hhweight cc_hhw;

.         rename rural    cc_rur;

.         rename news     cc_news;

.         rename survquar cc_qua;

.         rename reg_tpi  cc_reg_tpi;

.         sort hhid;

.         tempfile thhcons;

. save `thhcons', replace;
(note: file /tmp/St09373.00000f not found)
file /tmp/St09373.00000f saved

. **********************************************************
> ****************;
. * Merge the file with consumption on the food products wit
> h HH consumption file,
> * then use "fillin" to take care of cases where a househol
> d did not
> * consume all n_tpi commodities. Note that we need to do t
> he merge
> * first because there are some households that are not in 
> `acredd' at
> * all, because they did not consume *any* of the n_tpi ite
> ms. Then replace
> * missing values in the "filled in" observations with the 
> relevant values 
> * for that household.
> **********************************************************
> ****************;
. use `acredd';

.         cap drop _merge;

.         drop if product==.;
(158 observations deleted)

.         merge hhid using `thhcons';
variable hhid does not uniquely identify observations in
    the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        159        0.63        0.63
          3 |     24,960       99.37      100.00
------------+-----------------------------------
      Total |     25,119      100.00

.         for var valued_tot quantityd_tot : replace X=0 if 
> _merge==2;

->  replace valued_tot=0 if _merge==2
(159 real changes made)

->  replace quantityd_tot=0 if _merge==2
(159 real changes made)

.                 /*
>         for var valued_ac quantityd_ac valued_re quantityd
> _re valued_dd quantityd_dd 
>                 valued_tot quantityd_tot : replace X=0 if 
> _merge==2;
>                                 */
> 
>         replace hhsize  =cc_hhs     if _merge==2;
(156 real changes made)

.         replace strata  =cc_reg     if _merge==2;
(158 real changes made)

.         replace hhweight=cc_hhw     if _merge==2;
(157 real changes made)

.         replace rural   =cc_rur     if _merge==2;
(158 real changes made)

.         replace news    =cc_news        if _merge==2;
(150 real changes made)

.         replace survquar=cc_qua     if _merge==2;
(110 real changes made)

.         replace reg_tpi =cc_reg_tpi     if _merge==2;
(158 real changes made)

.         drop _merge cc_* ;

.                 fillin hhid product;

.         replace valued_tot=0 if _fillin;
(56391 real changes made)

.                 for var quantityd_tot 
>                 strata rural hhweight hhsize survquar surv
> mon news reg_tpi cons_hh_nom :
>                 egen tmp=mean(X), by(hhid) \
>                 replace X=tmp if _fillin \
>                 drop tmp;

->  egen tmp=mean(quantityd_tot), by(hhid)

->  replace quantityd_tot=tmp if _fillin
(56391 real changes made)

->  drop tmp

->  egen tmp=mean(strata), by(hhid)
(30 missing values generated)

->  replace strata=tmp if _fillin
(56362 real changes made)

->  drop tmp

->  egen tmp=mean(rural), by(hhid)
(30 missing values generated)

->  replace rural=tmp if _fillin
(56362 real changes made)

->  drop tmp

->  egen tmp=mean(hhweight), by(hhid)
(60 missing values generated)

->  replace hhweight=tmp if _fillin
(56333 real changes made)

->  drop tmp

->  egen tmp=mean(hhsize), by(hhid)
(90 missing values generated)

->  replace hhsize=tmp if _fillin
(56304 real changes made)

->  drop tmp

->  egen tmp=mean(survquar), by(hhid)
(1470 missing values generated)

->  replace survquar=tmp if _fillin
(54970 real changes made)

->  drop tmp

->  egen tmp=mean(survmon), by(hhid)
(4770 missing values generated)

->  replace survmon=tmp if _fillin
(51780 real changes made)

->  drop tmp

->  egen tmp=mean(news), by(hhid)
(270 missing values generated)

->  replace news=tmp if _fillin
(56130 real changes made)

->  drop tmp

->  egen tmp=mean(reg_tpi), by(hhid)
(30 missing values generated)

->  replace reg_tpi=tmp if _fillin
(56362 real changes made)

->  drop tmp

->  egen tmp=mean(cons_hh_nom), by(hhid)
(120 missing values generated)

->  replace cons_hh_nom=tmp if _fillin
(56275 real changes made)

->  drop tmp

.                                 /*
>         for var valued_ac quantityd_ac valued_re quantityd
> _re valued_dd quantityd_dd 
>                 quantityd_tot 
>                 strata rural hhweight hhsize survquar surv
> mon news reg_tpi cons_hh_nom :
>                 egen tmp=mean(X), by(hhid) \
>                 replace X=tmp if _fillin \
>                 drop tmp;
>                                 */
> 
> **********************************************************
> ****************;
. * Now calculate the shares, and then the mean shares in ea
> ch strata, 
> * using hhweight*hhsize weighting. 
> * Note that we are not doing quantity weighting now for th
> e shares.
> **********************************************************
> ****************;
.         gen share = valued_tot/cons_hh_nom ;
(1770 missing values generated)

.         gen popwt = hhsize*hhweight;
(90 missing values generated)

.         lab var share "HH share in total consumption";

.         lab var popwt "Population weight: hhsize*hhweight"
> ;

. **********************************************************
> ****************;
. * Select the bottom 50% (weighted) of the distribution of 
> nominal per 
> * capita consumption.
> **********************************************************
> ****************;
.         gen cpc=cons_hh_nom/hhsize;
(180 missing values generated)

.         sum cpc [aw=hhweight] , detail;

                             cpc
------------------------------------------------------------
> -
      Percentiles      Smallest
 1%            0              0
 5%     297.9974              0
10%     475.4251              0       Obs               8133
> 0
25%     784.2912              0       Sum of Wgt.   17911148
> 9

50%     1339.269                      Mean           2076.71
> 4
                        Largest       Std. Dev.      3144.83
> 2
75%     2318.095       85937.88
90%      4232.54       85937.88       Variance        988996
> 9
95%      6070.32       85937.88       Skewness       10.5818
> 7
99%     11919.64       85937.88       Kurtosis       197.061
> 3

.         global medcpc=r(p$tpi_bottom);

. * MAH ;
.  sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     81480    1.32e+11    4.07e+12   1.01e+09 
>   2.12e+14
     product |     78793    125.8621    14.16592        101 
>        150
  valued_tot |     81510    152.5674    586.5618          0 
>   85714.29
quantityd_~t |     81510     .525583    .7130046          0 
>         60
      strata |     81480    3.830265    1.511715          1 
>          6
-------------+----------------------------------------------
> ----------
    hhweight |     81450    2207.802    1693.745   308.1181 
>   8736.727
    survquar |     80040    2.452024    1.105543          1 
>          4
     survmon |     76740    6.381939    3.384659          1 
>         12
       rural |     81480    .7750368    .4175606          0 
>          1
     reg_tpi |     81480     2.33947     1.11243          1 
>          4
-------------+----------------------------------------------
> ----------
    spdomain |     24960    2.283293    1.076947          1 
>          4
        news |     81240    2.343427    1.111683          1 
>          4
      hhsize |     81420     7.06706    3.584038          1 
>         29
 cons_hh_nom |     81390    13021.19    24931.44          0 
>   838916.7
     _fillin |     81510    .6918292    .4617404          0 
>          1
-------------+----------------------------------------------
> ----------
       share |     79740    .0153441    .0451381          0 
>    .830227
       popwt |     81420       13754    11235.33   548.9749 
>   104660.2
         cpc |     81330    1988.603    3263.443          0 
>   85937.88

.  codebook hhid;

------------------------------------------------------------
hhid                 Unique HH Identifier Across Panel Waves
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,2.115e+14]        units:
>   1
         unique values:  2716                     missing .:
>   30/81510

                  mean:   1.3e+11
              std. dev:   4.1e+12

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           1.1e+09   1.1e+09   3.0e+09   4.0
> e+09                                                      
>        1.1e+11

.         keep if cpc<=$medcpc;
(39420 observations deleted)

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     42090    3.80e+10    2.06e+11   1.01e+09 
>   2.32e+12
     product |     40687    125.8621      14.166        101 
>        150
  valued_tot |     42090    101.1089    326.3176          0 
>   7428.571
quantityd_~t |     42090    .5334378     .668108          0 
>   34.28571
      strata |     42090    4.274412    1.265645          1 
>          6
-------------+----------------------------------------------
> ----------
    hhweight |     42090    2130.764    1591.182   308.1181 
>   8736.727
    survquar |     40800    2.388971    1.084406          1 
>          4
     survmon |     39240    6.243884    3.345495          1 
>         12
       rural |     42090     .890948    .3117082          0 
>          1
     reg_tpi |     42090    2.549537    1.007223          1 
>          4
-------------+----------------------------------------------
> ----------
    spdomain |     11197    2.501831    .9486274          1 
>          4
        news |     41880    2.557307    1.003736          1 
>          4
      hhsize |     42090      7.4134    3.262411          1 
>         29
 cons_hh_nom |     42090    5677.468    3764.774          0 
>   30491.16
     _fillin |     42090    .7317177    .4430706          0 
>          1
-------------+----------------------------------------------
> ----------
       share |     40500     .017837    .0526434          0 
>    .765022
       popwt |     42090    14379.78    10953.56   821.0083 
>   104660.2
         cpc |     42090    764.5323    341.9746          0 
>   1339.269

.                 collapse (mean) share (median) medshare=sh
> are [aw=popwt] , 
>                         by(reg_tpi product);

.                 egen sumsh=sum(share) , by(reg_tpi);

.                 replace share=share/sumsh;
(116 real changes made)

.                 drop sumsh;

.                 egen sumsh=sum(medshare) , by(reg_tpi);

.                 replace medshare=medshare/sumsh;
(22 real changes made)

.                 drop sumsh;

.                 lab var share "Reg 6: Mean HH share of tot
> al consumption";

.                 lab var medshare "Reg 6: Median HH share o
> f total consumption";

.                 sort reg_tpi product;

.                 save "$path/work/tpi_reg_tpi_share.dta", r
> eplace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> tpi_reg_tpi_share.dta saved

.                 tempfile tempwt6;

.                 save `tempwt6', replace;
(note: file /tmp/St09373.00000g not found)
file /tmp/St09373.00000g saved

. use `uvq', clear;

.         sort reg_tpi product;

. save , replace;
file /tmp/St09373.00000c saved

. use `tempwt6';

.         merge reg_tpi product using `uvq';
variables reg_tpi product do not uniquely identify
    observations in /tmp/St09373.00000c
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          4        0.89        0.89
          3 |        444       99.11      100.00
------------+-----------------------------------
      Total |        448      100.00

.         gen tpi1     =ppkg     *share;
(4 missing values generated)

.         gen tpi1_trim=ppkg_trim*share;
(4 missing values generated)

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     product |       444    125.8131    14.19737        101 
>        150
     reg_tpi |       448    2.495536    1.101139          1 
>          4
       share |       448    .0355103    .0395025          0 
>   .2094782
    medshare |       448    .0357143    .1057025          0 
>   .6344869
    survquar |       444     2.47973    1.117092          1 
>          4
-------------+----------------------------------------------
> ----------
        news |       444    2.495495    1.100986          1 
>          4
  valued_tot |       444    8153.248    9676.112   28.57143 
>   69515.08
quantityd_~t |       444    12.46269    16.31162   .0714286 
>   99.39294
        ppkg |       444     1628.56    2065.862    47.2836 
>   15090.58
   ppkg_trim |       444    1533.082    1994.471    43.1721 
>      15000
-------------+----------------------------------------------
> ----------
      _merge |       448    2.982143     .188347          1 
>          3
        tpi1 |       444    61.12065     104.337   .0036175 
>   809.8702
   tpi1_trim |       444     56.8291    99.50523   .0036175 
>   728.8422

. keep if survquar!=.;
(4 observations deleted)

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     product |       444    125.8131    14.19737        101 
>        150
     reg_tpi |       444    2.495495    1.100986          1 
>          4
       share |       444    .0358302    .0395354   .0000362 
>   .2094782
    medshare |       444     .036036    .1061239          0 
>   .6344869
    survquar |       444     2.47973    1.117092          1 
>          4
-------------+----------------------------------------------
> ----------
        news |       444    2.495495    1.100986          1 
>          4
  valued_tot |       444    8153.248    9676.112   28.57143 
>   69515.08
quantityd_~t |       444    12.46269    16.31162   .0714286 
>   99.39294
        ppkg |       444     1628.56    2065.862    47.2836 
>   15090.58
   ppkg_trim |       444    1533.082    1994.471    43.1721 
>      15000
-------------+----------------------------------------------
> ----------
      _merge |       444           3           0          3 
>          3
        tpi1 |       444    61.12065     104.337   .0036175 
>   809.8702
   tpi1_trim |       444     56.8291    99.50523   .0036175 
>   728.8422

. list in  1/3;

     +----------------------------------------------------+
  1. |  product  |  reg_tpi   |     share   |  medshare   |
     |      101  |  Central   |  .1211976   |         0   |
     |----------------------------------------------------|
     |    survquar  |     news  |  valued~t  |  quanti~t  |
     |  Oct-Dec 10  |  Central  |  32489.39  |  9.090378  |
     |----------------------------------------------------|
     |     ppkg | ppkg_t~m | _merge |     tpi1 | tpi1_t~m |
     | 3574.041 |   4350.4 |      3 | 433.1652 | 527.2581 |
     +----------------------------------------------------+

     +----------------------------------------------------+
  2. |  product  |  reg_tpi   |     share   |  medshare   |
     |      105  |  Central   |  .0255272   |         0   |
     |----------------------------------------------------|
     |    survquar  |     news  |  valued~t  |  quanti~t  |
     |  Oct-Dec 10  |  Central  |  3817.906  |   1.46191  |
     |----------------------------------------------------|
     |     ppkg | ppkg_t~m | _merge |     tpi1 | tpi1_t~m |
     | 2611.587 |  1578.49 |      3 | 66.66661 | 40.29449 |
     +----------------------------------------------------+

     +----------------------------------------------------+
  3. |  product  |  reg_tpi   |     share   |  medshare   |
     |      107  |  Central   |  .0568199   |         0   |
     |----------------------------------------------------|
     |    survquar  |     news  |  valued~t  |  quanti~t  |
     |  Oct-Dec 10  |  Central  |  11947.76  |   11.0764  |
     |----------------------------------------------------|
     |     ppkg | ppkg_t~m | _merge |     tpi1 | tpi1_t~m |
     | 1078.668 | 989.3655 |      3 | 61.28975 |  56.2156 |
     +----------------------------------------------------+

. list in -3/-1;

     +----------------------------------------------------+
442. |  product  |  reg_tpi   |     share   |  medshare   |
     |      150  |  Western   |  .0155686   |  .0414923   |
     |----------------------------------------------------|
     |       survquar  |    news  | valued~t  | quanti~t  |
     |    Jan-Marc 11  | Western  | 3881.845  | 11.98976  |
     |----------------------------------------------------|
     |     ppkg | ppkg_t~m | _merge |     tpi1 | tpi1_t~m |
     | 323.7632 | 378.3184 |      3 | 5.040539 | 5.889887 |
     +----------------------------------------------------+

     +----------------------------------------------------+
443. |  product  |  reg_tpi   |     share   |  medshare   |
     |      150  |  Western   |  .0155686   |  .0414923   |
     |----------------------------------------------------|
     |       survquar  |    news  | valued~t  | quanti~t  |
     |    Apr-June 11  | Western  | 2283.002  |  5.49506  |
     |----------------------------------------------------|
     |     ppkg | ppkg_t~m | _merge |     tpi1 | tpi1_t~m |
     | 415.4644 | 402.1837 |      3 | 6.468198 | 6.261437 |
     +----------------------------------------------------+

     +----------------------------------------------------+
444. |  product  |  reg_tpi   |     share   |  medshare   |
     |      150  |  Western   |  .0155686   |  .0414923   |
     |----------------------------------------------------|
     |       survquar  |    news  | valued~t  | quanti~t  |
     | July-Sept 2011  | Western  |  1779.01  | 8.060019  |
     |----------------------------------------------------|
     |     ppkg | ppkg_t~m | _merge |     tpi1 | tpi1_t~m |
     | 220.7204 | 428.9995 |      3 | 3.436307 | 6.678921 |
     +----------------------------------------------------+

.         **************************************************
> ************************;
. * Find TPI level and indexes for non-trimmed and trimmed p
> rices
> **********************************************************
> ****************;
. * Not trimmed ;
.         collapse (sum) tpi1 tpi1_trim  , by(reg_tpi survqu
> ar);

.                 for num 1/$n_tpi :
>                         sum tpi1 if reg_tpi==X & survquar=
> =2 , meanonly \
>                         sum tpi1 if reg_tpi==X & survquar=
> =4 , meanonly \
>                         global baseX=r(mean);

->  sum tpi1 if reg_tpi==1 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==1 & survquar==4 , meanonly

->  global base1=r(mean)

->  sum tpi1 if reg_tpi==2 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==2 & survquar==4 , meanonly

->  global base2=r(mean)

->  sum tpi1 if reg_tpi==3 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==3 & survquar==4 , meanonly

->  global base3=r(mean)

->  sum tpi1 if reg_tpi==4 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==4 & survquar==4 , meanonly

->  global base4=r(mean)

.                 lab var tpi1 "Temporal price index before 
> normalization";

.                                 foreach v of numlist 1/$n_
> tpi { ;
  2.                                         if `v'==1 { ;
  3.                                                 gen tpi
> =tpi1/${base`v'} if reg_tpi==`v' ;
  4.                                         } ;
  5.                                         if `v'>1 { ;
  6.                                                 replace
>  tpi=tpi1/${base`v'} if reg_tpi==`v' ;
  7.                                         } ;
  8.                                 } ;
(12 missing values generated)
(4 real changes made)
(4 real changes made)
(4 real changes made)

.                                                           
>                                       *gen     tpi=tpi1/$b
> ase1 if reg_tpi==1;
.                 *replace tpi=tpi1/$base2 if reg_tpi==2;
.                 *replace tpi=tpi1/$base3 if reg_tpi==3;
.                 *replace tpi=tpi1/$base4 if reg_tpi==4;
.                 *replace tpi=tpi1/$base5 if reg_tpi==5;
.                 *replace tpi=tpi1/$base6 if reg_tpi==6;
.                                                           
>                       lab var tpi "Temporal price index (Q
> 4=1)";

. * Trimmed ;
.                 for num 1/$n_tpi :
>                         sum tpi1_trim if reg_tpi==X & surv
> quar==2 , meanonly \
>                         sum tpi1_trim if reg_tpi==X & surv
> quar==4 , meanonly \
>                         global baseX=r(mean);

->  sum tpi1_trim if reg_tpi==1 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==1 & survquar==4 , meanonly

->  global base1=r(mean)

->  sum tpi1_trim if reg_tpi==2 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==2 & survquar==4 , meanonly

->  global base2=r(mean)

->  sum tpi1_trim if reg_tpi==3 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==3 & survquar==4 , meanonly

->  global base3=r(mean)

->  sum tpi1_trim if reg_tpi==4 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==4 & survquar==4 , meanonly

->  global base4=r(mean)

.                 lab var tpi1_trim "Six regions: TRIMMED Te
> mporal price index before normalization";

.                                 foreach v of numlist 1/$n_
> tpi { ;
  2.                                         if `v'==1 { ;
  3.                                                 gen tpi
> _trim=tpi1_trim/${base`v'} if reg_tpi==`v' ;
  4.                                         } ;
  5.                                         if `v'>1 { ;
  6.                                                 replace
>  tpi_trim=tpi1_trim/${base`v'} if reg_tpi==`v' ;
  7.                                         } ;
  8.                                 } ;
(12 missing values generated)
(4 real changes made)
(4 real changes made)
(4 real changes made)

.                                                 lab var tp
> i_trim "TRIMMED Temporal price index (Q4=1)";

.                 sort reg_tpi survquar;

.             drop if reg_tpi<1 | reg_tpi>$n_tpi;
(0 observations deleted)

. gen tpi_diff = tpi - tpi_trim;

. lab var tpi_diff "TPI difference btw trimmed/untrimmed";

. twoway (connected tpi_trim survquar),yline(1) by(, title("
> TPI: Trimmed"))
> by(reg_tpi) sav("$path/work/reg_tpi-tpi_trim", replace);
(file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
> /reg_tpi-tpi_trim.gph saved)

. graph export "$path/work/reg_tpi-tpi_trim.tif", replace;
(file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
> /reg_tpi-tpi_trim.tif written in TIFF format)

. list reg_tpi survquar tpi tpi_trim tpi_diff;

     +-------------------------------------------------+
  1. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Central |     Oct-Dec 10 | .7891766 | .8524719 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.0632954                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  2. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Central |    Jan-Marc 11 | .9386311 | .9643729 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.0257418                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  3. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Central |    Apr-June 11 |  1.02372 | 1.169799 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.1460783                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  4. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Central | July-Sept 2011 |        1 |        1 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                            0                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  5. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Eastern |     Oct-Dec 10 | .6622866 | .8463236 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                     -.184037                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  6. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Eastern |    Jan-Marc 11 | .7166862 | .8391094 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.1224231                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  7. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Eastern |    Apr-June 11 | .8506218 | 1.039694 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.1890727                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  8. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Eastern | July-Sept 2011 |        1 |        1 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                            0                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
  9. |  reg_tpi |       survquar |      tpi | tpi_trim |
     | Northern |     Oct-Dec 10 | .8356474 | .9681882 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.1325408                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
 10. |  reg_tpi |       survquar |      tpi | tpi_trim |
     | Northern |    Jan-Marc 11 | .7596721 | .9116799 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.1520078                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
 11. |  reg_tpi |       survquar |      tpi | tpi_trim |
     | Northern |    Apr-June 11 | .8404347 | .9435343 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.1030996                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
 12. |  reg_tpi |       survquar |      tpi | tpi_trim |
     | Northern | July-Sept 2011 |        1 |        1 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                            0                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
 13. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Western |     Oct-Dec 10 | .7123509 | .8253922 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.1130413                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
 14. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Western |    Jan-Marc 11 | .8800917 | .9131287 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                    -.0330371                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
 15. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Western |    Apr-June 11 |  .956185 | .8899134 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                     .0662715                    |
     +-------------------------------------------------+

     +-------------------------------------------------+
 16. |  reg_tpi |       survquar |      tpi | tpi_trim |
     |  Western | July-Sept 2011 |        1 |        1 |
     |-------------------------------------------------|
     |                     tpi_diff                    |
     |                            0                    |
     +-------------------------------------------------+

.                 sort reg_tpi survquar;

. keep reg_tpi survquar tpi_trim;

. save "$path/work/temp_index_reg_tpi.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> temp_index_reg_tpi.dta saved

.                        ***********************************
> ***************************************
> * 090_temp_index.do     (end)
> **********************************************************
> ****************;
. cap log close;

. 
end of do-file

. do "$path/new/100_food_basket_flex.do"/* Flexible food bas
> ket */

. *global path "C:/user/gapp"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/100_food_basket_flex.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/100_food_basket_flex.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:35

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ****************
> * 100_food_basket_flex.do     (start)
> *
> * This file is to get the data from the cons_cod.dta in wo
> rk and then 
> * to create the do file with the 90% of the consumption ex
> penditures 
> * using a flexible basket of goods.
> *
> * NOTE: we actually keep goods representing 95% of expendi
> ture
> * in order to facilitate dropping of some goods (such as r
> ats) where
> * quantity and nutrition information is unknown.
> *
> * We base our basket on the bottom 60 percent of consumpti
> on per capita
> * (weighted by hhweight*hhsize). We use the TEMPORALLY-ADJ
> USTED
> * NOMINAL consumption because we don't have a spatial adju
> stment yet.
> *
> * (Then we iterate this process to arrive at a final food 
> bundle in later code)
> **********************************************************
> ****************;
. *CA modified to bring in hhdata into bootstrap;
. /*
> This file uses:
>                 work/cons_cod.dta
>                 work/hhdata.dta
>                 work/products.dta
>                 work/consump_nom.dta
>                 work/temp_index_reg_tpi.dta
>                 work/food_cat.dta
> 
> This file creates:
>                 work/food_basket_flex.dta
>                 work/codes_food_basket_flex.dta
> */
> 
> 
> 
> *do "$path/new/010_initial.do";
. **********************************************************
> ****************;
. * First, make a small temp file that has the temporally ad
> justed 
> * nominal consumption per capita, using work/consump_nom a
> nd 
> * work/temp_index_reg_tpi.dta. Make a dummy variable indic
> ating
> * whether they are in the bottom 60%.
> **********************************************************
> ****************;
. use "$path/work/conpc.dta", clear;

. *use "$path/work/consump_nom.dta", clear;
. *CA modified to merge in work/hhdata.dta for bootstrap;
.         sort hhid;

.         merge hhid using "$path/work/hhdata.dta";

.         tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _m;

.         keep hhid hhweight hhsize cons_pc_nom reg_tpi rura
> l survquar;

.         sort reg_tpi survquar;

.         cap drop _merge;

.         merge reg_tpi survquar using "$path/work/temp_inde
> x_reg_tpi.dta";
variables reg_tpi survquar do not uniquely identify
    observations in the master data
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         49        1.80        1.80
          3 |      2,668       98.20      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         sort hhid;

.         merge hhid using "$path/work/conpc.dta";

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.                 gen food_pc_tpi  = food_pc_nom /tpi_trim;
(49 missing values generated)

.         lab var food_pc_tpi "Temp-adjusted per capita food
>  consumption/day";

.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
(49 missing values generated)

.         lab var cons_pc_tpi "Temp adjusted total consumpti
> on/day";

.         gen one=1;

.         tempfile contpi;

.         save `contpi', replace;
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved

.         collapse (p$bottom) one cons_pc_tpi [aw=hhsize*hhw
> eight] ;

.         rename cons_pc_tpi pctile_60;

.         tempfile 60pct;

.         sort one;

.         save `60pct', replace;
(note: file /tmp/St09373.000002 not found)
file /tmp/St09373.000002 saved

.                 use `contpi';

.                 sort one;

.                 merge one using `60pct';
variable one does not uniquely identify observations in
    the master data

.                 tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.                 drop _merge;

.                 drop one;

.                         gen bottom_basket=cons_pc_tpi< pct
> ile_60;

.                 tab bottom_basket [aw=hhsize*hhweight];

bottom_bask |
         et |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |1,383.54757       50.98       50.98
          1 |1,330.45243       49.02      100.00
------------+-----------------------------------
      Total |      2,714      100.00

.                 lab var bottom_basket "=1 if in bottom 60%
>  of PCE";

.                                 sort hhid;

. save `contpi' , replace;
file /tmp/St09373.000001 saved

. **********************************************************
> ****************;
. * Next, need to keep only the food products in order to ca
> lculate the 
> * food poverty line, and then calculate the food expenses 
> by code.
> **********************************************************
> ****************;
. use "$path/work/cons_cod.dta";

. /*
>         sort product;
>         merge product using "$path/work/food_cat.dta";
>         tab _merge;
>         keep if _merge==3;
>         drop _merge;
> */
>         
>         keep if food_cat;
(0 observations deleted)

.         codebook hhid;

------------------------------------------------------------
hhid                 Unique HH Identifier Across Panel Waves
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,2.115e+14]        units:
>   1
         unique values:  2712                     missing .:
>   283/37116

                  mean:   1.3e+11
              std. dev:   4.1e+12

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           1.1e+09   1.1e+09   2.2e+09   4.0
> e+09                                                      
>        1.1e+11

.         sort hhid;

. **********************************************************
> ****************;
. * Next, merge in the consumption information, and select t
> hose in bottom
> * 60% of nominal distribution, after making temporal adjus
> tment. 
> **********************************************************
> ****************;
.         merge hhid using `contpi';
variable hhid does not uniquely identify observations in
    the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          4        0.01        0.01
          3 |     37,116       99.99      100.00
------------+-----------------------------------
      Total |     37,120      100.00

.         keep if _merge==3;
(4 observations deleted)

.         drop _merge;

.         keep if bottom_basket==1;
(22699 observations deleted)

.      *****************************************************
> *********************;
. * Calculate food shares. Since we're only doing shares her
> e, we can
> * work with the expenditures without doing temporal adjust
> ment.
> **********************************************************
> ****************;
.           gen  food_expenditure= cod_hh_nom;

.                             *gen  food_expenditure= own_va
> lued + daily_valued + monthly_valued + educ_valued;
.           egen tot_food_expen= sum (food_expen), by (hhid)
>  ;

.           count if food_expenditure==.;
    0

.           count if tot_food_expen==.;
    0

.                     gen food_share= food_expenditure/tot_f
> ood_expen;
(10 missing values generated)

.           count if food_share==.;
   10

.           drop if food_share==.;
(10 observations deleted)

.           sort hhid product;

.                         tempfile food_basket_flex;

. save `food_basket_flex', replace;
(note: file /tmp/St09373.000003 not found)
file /tmp/St09373.000003 saved

. **********************************************************
> **********************;
. * Now prepare to get the variable spdomain to the using da
> taset, and then find the 
> * total shares by each product in order to select the most
>  important goods in the 
> * basket.
> **********************************************************
> **********************;
.                 preserve;

.                 use "$path/work/hhdata.dta", clear;
(Household master record (1 record per household))

.                         keep hhid spdomain;

.                         sort hhid;

.                         tempfile spdomain;

.                 save `spdomain' , replace;
(note: file /tmp/St09373.000005 not found)
file /tmp/St09373.000005 saved

.                 restore;

.                            collapse (mean) hhweight, by (h
> hid);

.            sort hhid ;

.             merge hhid using `spdomain';

.            tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |      1,451       53.42       53.42
          3 |      1,265       46.58      100.00
------------+-----------------------------------
      Total |      2,716      100.00

.            drop if _m==2;
(1451 observations deleted)

.            drop _merge;

.             collapse (sum) hhweight , by(spdomain);

.            rename hhweight tothhweight;

.            tempfile tothhweight;

. save `tothhweight';
file /tmp/St09373.000006 saved

. use `food_basket_flex';

.           sort hhid;

.           merge hhid using `spdomain';
variable hhid does not uniquely identify observations in
    the master data

.           tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |      1,451        9.15        9.15
          3 |     14,407       90.85      100.00
------------+-----------------------------------
      Total |     15,858      100.00

.           sort _m;

.           drop if _m==2;
(1451 observations deleted)

.           drop _m;

.           sort spdomain;

.             merge spdomain using `tothhweight';
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.           tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     14,407      100.00      100.00
------------+-----------------------------------
      Total |     14,407      100.00

.           drop _merge;

.             sort spdomain product;

.             gen f_share_w=(food_share*hhweight)/tothhweigh
> t;

.                                                 *drop desc
> ript;
.                         *gen descript = 0;
.             collapse (sum) f_share_w, by(spdomain product 
> descript);

.                      sort spdomain f_share_w;

.           by spdomain: gen cumshr= sum(f_share_w);

.                     count if cumshr<=.075;
  149

.           drop if cumshr<=.075;
(149 observations deleted)

.             lab var f_share_w "average food share for the 
> 13 regions";

. save "$path/work/food_basket_flex.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> food_basket_flex.dta saved

. * List first spatial region to get an idea about contents;
. list product spdomain f_share_w cumshr if spdomain==1;

     +------------------------------------------+
     | product   spdomain   f_shar~w     cumshr |
     |------------------------------------------|
  1. |     150    Central   .0072882   .0819964 |
  2. |     138    Central   .0073462   .0893425 |
  3. |     114    Central   .0076678   .0970103 |
  4. |     134    Central   .0079754   .1049857 |
  5. |     122    Central   .0079987   .1129844 |
     |------------------------------------------|
  6. |     135    Central   .0085053   .1214897 |
  7. |     139    Central   .0105225   .1320122 |
  8. |     105    Central   .0108133   .1428255 |
  9. |     125    Central   .0110401   .1538657 |
 10. |     127    Central   .0113729   .1652385 |
     |------------------------------------------|
 11. |     110    Central    .012941   .1781795 |
 12. |     136    Central   .0133429   .1915224 |
 13. |     117    Central   .0134696    .204992 |
 14. |     108    Central   .0158653   .2208573 |
 15. |     144    Central   .0208415   .2416988 |
     |------------------------------------------|
 16. |     140    Central   .0244673    .266166 |
 17. |     107    Central   .0248364   .2910024 |
 18. |     147    Central   .0316927   .3226951 |
 19. |     141    Central   .0399678   .3626629 |
 20. |     101    Central   .0541264   .4167894 |
     |------------------------------------------|
 21. |     157    Central   .0594484   .4762377 |
 22. |       .    Central   .0878934   .5641311 |
 23. |     113    Central   .0904238   .6545549 |
 24. |     999    Central   .3454451          1 |
     +------------------------------------------+

.                     gen numreg=1;

.           collapse (sum) numreg cumshr, by (product descri
> pt);

.                           keep product descript numreg;

.           display _N;
38

.                     lab var numreg "number of goods in the
>  basket";

. /*
>           merge product using "$path/work/products.dta";
>             tab _merge;
>           keep if _merge==3;
> */
>           keep product descript numreg;

.             sort product;

.                display _N;
38

.   save "$path/work/codes_food_basket_flex.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> codes_food_basket_flex.dta saved

. **********************************************************
> ****************
> * 100_food_basket_flex.do     (end)
> **********************************************************
> ****************;
. cap log close;

. 
end of do-file

. do "$path/new/110_price_unit_flex.do"/* Flexible basket: P
> rices */

. *global path "C:/user/gapp"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/110_price_unit_flex.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/110_price_unit_flex.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:35

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ******************************
> * 110_price_unit_flex.do                (start)
> *
> * Purpose: This do file creates a price_unit_flex database
>  with the unit prices of the
> * goods of the flexible food basket in order to determine 
> the poverty lines per spatial
> * domain. It uses the files work/daily.dta and work/own.dt
> a file and draw unit prices
> * by: sum of values and quantity
> **********************************************************
> ******************************;
. *CA modified to bring in work/hhdata.dta for bootstrap
> *CA check for price calcs conditional on number of observa
> tions;
. /*
> This file uses:
>         work/daily.dta
>         work/own.dta
>         work/hhdata.dta
>         work/consump_nom.dta
>         work/codes_food_basket_flex.dta
>         work/temp_index_reg_tpi.dta
>           new/conversions.do
> 
> This file creates:
>         work/price_unit_flex.dta
>         work/bottom_basket.dta
> */
> 
> 
> 
> 
> *do "$path/new/010_initial.do";
. **********************************************************
> ****************************
> * Create sorted data set with daily and own and the matche
> d codes
> **********************************************************
> ****************************;
. use "$path/work/cons_cod_trans.dta", clear;
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

. *use "$path/in/cons_cod_trans.dta", clear;
. *save "$path/work/cons_cod_trans.dta", replace;
. *drop if quantityd==0 ;
. keep hhid product food_cat valuez quantityz unit;

. rename valuez    value;

. rename quantityz quantity;

. drop if quantity==0 ;
(779 observations deleted)

. *drop count;
.         sort product;

.         gen count=1;

.                 tempfile dd_acsort;

. save `dd_acsort', replace;
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved

. /*
> use "$path/work/daily.dta";
> tempfile dd_acsort;
>         drop days;
>         sort product;
>         tempfile dd_acsort;
> save `dd_acsort', replace;
> 
> use "$path/work/own.dta";
>         keep hhid product valued quantityd unit;
>         rename valued value;
>         rename quantityd quantity;
> 
>         *CHECK THE ZEROS IN quantity FOR NOW DELETE;
>         drop if quantity==0;
> 
>         append using `dd_acsort';
> 
> *CA modified to merge in work/hhdata.dta for bootstrap;
>         sort hhid;
>       merge hhid using "$path/work/hhdata.dta";
>       tab _m;
> 
> * Drop observations if non existent in HH data set;
> drop if _m!=3;
> drop _m;
> 
> 
>         sort product;
>         gen count=1;
> 
> 
> save `dd_acsort', replace;
> */
> 
> 
> **********************************************************
> ****************************;
. * Merge the flexible food basket codes with the daily and 
> own data sets
> * Drop all codes not a part of the flexible food basket
> **********************************************************
> ****************************;
.         merge product using "$path/work/codes_food_basket_
> flex.dta";
variable product does not uniquely identify observations
    in the master data
product was int now float

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      6,091       18.11       18.11
          2 |          2        0.01       18.12
          3 |     27,534       81.88      100.00
------------+-----------------------------------
      Total |     33,627      100.00

.         drop if _merge~=3;
(6093 observations deleted)

.         drop _merge;

. **********************************************************
> ****************************;
. * Drop observations where product code or quantity or valu
> e information is unavailable
> **********************************************************
> ****************************;
.                                 codebook hhid;

------------------------------------------------------------
hhid                                            household id
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,2.115e+14]        units:
>   1
         unique values:  2581                     missing .:
>   148/27534

                  mean:   1.5e+11
              std. dev:   4.4e+12

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           1.1e+09   1.1e+09   2.2e+09   4.0
> e+09                                                      
>        1.1e+11

. *        drop if product==. | value==. | quantity==.  ;
.                                 codebook hhid;

------------------------------------------------------------
hhid                                            household id
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,2.115e+14]        units:
>   1
         unique values:  2581                     missing .:
>   148/27534

                  mean:   1.5e+11
              std. dev:   4.4e+12

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           1.1e+09   1.1e+09   2.2e+09   4.0
> e+09                                                      
>        1.1e+11

. **********************************************************
> ****************************;
. * Convert non-KG quantities (units and liters) to kilogram
> s;
. **********************************************************
> ****************************;
. *do "$path/new/110a_conversions.do"
> 
> **********************************************************
> **********
> * There remain a few difficult to interpret observations s
> uch as liters
> * of fish and liters of pasta. These are dropped
> **********************************************************
> **********;
. *        drop if unit~=2;
. **********************************************************
> **********
> * Merge in labels for the 13 spatial domains
> **********************************************************
> **********;
.         preserve;

.                 use "$path/work/hhdata.dta", clear;
(Household master record (1 record per household))

.                                                           
>               keep hhid spdomain reg_tpi survquar;

.                         sort hhid;

.                         tempfile spdomainreg_tpi;

.                 save `spdomainreg_tpi', replace;
(note: file /tmp/St09373.000003 not found)
file /tmp/St09373.000003 saved

.                                 codebook hhid;

------------------------------------------------------------
hhid                                            Household ID
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,2.115e+14]        units:
>   1
         unique values:  2716                     missing .:
>   0/2716

                  mean:   1.3e+11
              std. dev:   4.1e+12

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           1.1e+09   1.1e+09   3.0e+09   4.0
> e+09                                                      
>        1.1e+11

.         restore;

.                 sort hhid;

.         merge hhid using `spdomainreg_tpi';
variable hhid does not uniquely identify observations in
    the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        148        0.53        0.53
          2 |        135        0.49        1.02
          3 |     27,386       98.98      100.00
------------+-----------------------------------
      Total |     27,669      100.00

.         drop _merge;

.         drop if product==.;
(157 observations deleted)

. codebook hhid;

------------------------------------------------------------
hhid                                            household id
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,2.115e+14]        units:
>   1
         unique values:  2559                     missing .:
>   148/27512

                  mean:   1.5e+11
              std. dev:   4.4e+12

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           1.1e+09   1.1e+09   2.2e+09   4.0
> e+09                                                      
>        1.1e+11

. tab spd;

    Spatial |
   domains: |
  each with |
own poverty |
 line (they |
     are 4) |      Freq.     Percent        Cum.
------------+-----------------------------------
    Central |      8,786       32.11       32.11
    Eastern |      6,958       25.43       57.54
   Northern |      7,102       25.95       83.49
    Western |      4,518       16.51      100.00
------------+-----------------------------------
      Total |     27,364      100.00

. sum if spd>=3;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     11620    6.16e+10    2.67e+11   1.07e+09 
>   2.32e+12
     product |     11768    130.8119    15.27799        101 
>        166
    quantity |     11620    .5797112    .9695324   .0142857 
>         30
       value |     11620    443.9768    676.2261   3.571429 
>      15000
        unit |     11620           1           0          1 
>          1
-------------+----------------------------------------------
> ----------
    food_cat |     11620           1           0          1 
>          1
       count |     11768           1           0          1 
>          1
    descript |     11768           1           0          1 
>          1
      numreg |     11768    3.198844    1.020097          1 
>          4
    survquar |     11620    2.543718    1.106701          1 
>          4
-------------+----------------------------------------------
> ----------
     reg_tpi |     11620    3.388812    .4875016          3 
>          4
    spdomain |     11620    3.388812    .4875016          3 
>          4

. table spdomain, content(mean quantity count quantity count
>  hhid) row missing;

----------------------------------------------------------
Spatial   |
domains:  |
each with |
own       |
poverty   |
line      |
(they are |
4)        | mean(quantity)     N(quantity)         N(hhid)
----------+-----------------------------------------------
  Central |       .4984302           8,786           8,786
  Eastern |       .6435321           6,958           6,958
 Northern |       .5598714           7,102           7,102
  Western |       .6108981           4,518           4,518
          | 
    Total |       .5698417          27,364          27,364
----------------------------------------------------------

.         drop if product==. | value==. | quantity==.  ;
(148 observations deleted)

. codebook hhid;

------------------------------------------------------------
hhid                                            household id
------------------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,2.115e+14]        units:
>   1
         unique values:  2559                     missing .:
>   0/27364

                  mean:   1.5e+11
              std. dev:   4.4e+12

           percentiles:        10%       25%       50%      
>  75%                                                      
>            90%
                           1.1e+09   1.1e+09   2.2e+09   4.0
> e+09                                                      
>        1.1e+11

. tab spd;

    Spatial |
   domains: |
  each with |
own poverty |
 line (they |
     are 4) |      Freq.     Percent        Cum.
------------+-----------------------------------
    Central |      8,786       32.11       32.11
    Eastern |      6,958       25.43       57.54
   Northern |      7,102       25.95       83.49
    Western |      4,518       16.51      100.00
------------+-----------------------------------
      Total |     27,364      100.00

. **********************************************************
> **********
> * Merge in temporal price index to convert nominal value t
> o real
> **********************************************************
> **********;
.         sort reg_tpi survquar;

.         merge reg_tpi survquar using "$path/work/temp_inde
> x_reg_tpi.dta";
variables reg_tpi survquar do not uniquely identify
    observations in the master data
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     27,364      100.00      100.00
------------+-----------------------------------
      Total |     27,364      100.00

.         drop if _merge ~= 3;
(0 observations deleted)

.         drop _merge;

.         gen value_r=value/tpi_trim;

. **********************************************************
> ****************;
. * Identify relatively poor households, based on nominal te
> mporally adjusted
> * consumption per capita. Only work with these households 
> for the price
> * calculations.
> **********************************************************
> ****************;
.                 preserve;

.                         use "$path/work/conpc.dta", clear;

. *                       use "$path/work/consump_nom.dta", 
> clear;
. *CA modified to merge in work/hhdata.dta for bootstrap;
.         sort hhid;

.       merge hhid using "$path/work/hhdata.dta";

.       tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.       drop _m;

. *CA modified to keep bswt;
.                                 keep hhid hhweight hhsize 
> cons_pc_nom bswt ;

.                                 sort hhid;

.                                 merge hhid using `spdomain
> reg_tpi';
(label lbreg already defined)
(label lsurvquar already defined)
(label lspdomain already defined)

.                                 tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.                                 drop _merge;

.                                 sort reg_tpi survquar;

.                                 cap drop _merge;

.                                 merge reg_tpi survquar usi
> ng "$path/work/temp_index_reg_tpi.dta";
variables reg_tpi survquar do not uniquely identify
    observations in the master data
(label lsurvquar already defined)
(label lbreg already defined)

.                                 tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         49        1.80        1.80
          3 |      2,668       98.20      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.                                 drop _merge;

.                                 sort hhid;

.                                 merge hhid using "$path/wo
> rk/conpc.dta";

.                                 tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.                                 drop _merge;

.                                 gen food_pc_tpi  = food_pc
> _nom /tpi_trim;
(49 missing values generated)

.                                 lab var food_pc_tpi "Temp-
> adjusted per capita food consumption/day";

.                                                           
>       * Non-food not TPI adjusted ;
.                                 gen cons_pc_tpi = food_pc_
> tpi + nf_pc_nom;
(49 missing values generated)

.                                 lab var cons_pc_tpi "Temp 
> adjusted total consumption/day";

.                                 gen one=1;

.                                 tempfile contpi;

.                                 save `contpi', replace;
(note: file /tmp/St09373.000005 not found)
file /tmp/St09373.000005 saved

.                                 collapse (p$bottom) one co
> ns_pc_tpi [aw=hhsize*hhweight], by(spdomain) ;

.                                 rename cons_pc_tpi pctile_
> 60;

.                                 tempfile 60pct;

.                                 sort spdomain;

.                                 save `60pct', replace;
(note: file /tmp/St09373.000006 not found)
file /tmp/St09373.000006 saved

.                                 use `contpi';

.                                         sort spdomain;

.                                         merge spdomain usi
> ng `60pct';
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.                                         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.                                         drop _merge;

.                                         drop one;

.                                         sort spdomain;

.                                         gen bottom_basket=
> cons_pc_tpi< pctile_60;

.                                         by spdomain: tab b
> ottom_basket [aw=hhsize*hhweight];

------------------------------------------------------------
-> spdomain = Central

bottom_bask |
         et |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 419.564632       50.37       50.37
          1 | 413.435368       49.63      100.00
------------+-----------------------------------
      Total |        833      100.00

------------------------------------------------------------
-> spdomain = Eastern

bottom_bask |
         et |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 326.267964       50.51       50.51
          1 | 319.732036       49.49      100.00
------------+-----------------------------------
      Total |        646      100.00

------------------------------------------------------------
-> spdomain = Northern

bottom_bask |
         et |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 352.603665       50.88       50.88
          1 | 340.396335       49.12      100.00
------------+-----------------------------------
      Total |        693      100.00

------------------------------------------------------------
-> spdomain = Western

bottom_bask |
         et |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 279.528852       52.25       52.25
          1 | 255.471148       47.75      100.00
------------+-----------------------------------
      Total |        535      100.00

------------------------------------------------------------
-> spdomain = .

bottom_bask |
         et |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |          7      100.00      100.00
------------+-----------------------------------
      Total |          7      100.00


.                                         lab var bottom_bas
> ket "=1 if in bottom (60%) of PCE";

.                                         sort hhid;

.                                                           
>       save "$path/work/bottom_basket.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> bottom_basket.dta saved

.         restore;

.         sort hhid;

.         merge hhid using "$path/work/bottom_basket.dta";
variable hhid does not uniquely identify observations in
    the master data
(label lspdomain already defined)
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        158        0.57        0.57
          3 |     27,364       99.43      100.00
------------+-----------------------------------
      Total |     27,522      100.00

.         drop _merge;

.                         * Only keep price observations for
>  the poor ;
.         keep if bottom_basket==1;
(16183 observations deleted)

.         **************************************************
> ************************;
. * Toss out the bottom 5% and top 5% of the HH-LEVEL prices
>  per kg in
> * for each spdomain & product combination. This should eli
> minate outliers
> * that may have an undue influence on the price calculatio
> n. 
> **********************************************************
> ****************;
.                 gen hhppkg=value_r/quantity;
(53 missing values generated)

.                 egen lower5=pctile(hhppkg), p(5) by(spdoma
> in product);
(53 missing values generated)

.                 egen upper5=pctile(hhppkg), p(95) by(spdom
> ain product);
(53 missing values generated)

. sum;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        hhid |     11339    4.06e+10    2.24e+11   1.01e+09 
>   2.31e+12
     product |     11286     130.827    15.02754        101 
>        166
    quantity |     11286    .5601898     1.04634   .0142857 
>   34.28571
       value |     11286    387.5792    581.1725   2.857143 
>   10285.71
        unit |     11286           1           0          1 
>          1
-------------+----------------------------------------------
> ----------
    food_cat |     11286           1           0          1 
>          1
       count |     11286           1           0          1 
>          1
    descript |     11286           1           0          1 
>          1
      numreg |     11286    3.256601    .9765928          1 
>          4
    survquar |     11339    2.424111    1.085165          1 
>          4
-------------+----------------------------------------------
> ----------
     reg_tpi |     11339    2.206456    1.064082          1 
>          4
    spdomain |     11339    2.206456    1.064082          1 
>          4
    tpi_trim |     11339    .9554574    .0931922   .8253922 
>   1.169799
     value_r |     11286    404.0295    595.0896   3.351598 
>    10665.7
 cons_pc_nom |     11339    901.0073    410.5481          0 
>   2191.746
-------------+----------------------------------------------
> ----------
    hhweight |     11339    1977.479    1464.357   308.1181 
>   8736.727
        bswt |     11339           1           0          1 
>          1
      hhsize |     11339    7.811447    3.184635          1 
>         29
 cons_hh_nom |     11339    7012.918    4573.879          0 
>   30491.16
 food_pc_nom |     11339    573.3774    293.6895          0 
>   2048.572
-------------+----------------------------------------------
> ----------
   nf_pc_nom |     11339    327.6299    240.6677          0 
>   1927.743
 food_pc_tpi |     11339    597.6076    288.4402          0 
>   1876.895
 cons_pc_tpi |     11339    925.2375    401.9649          0 
>   2008.056
   pctile_60 |     11339    1412.929     435.109   979.4053 
>   2011.312
bottom_bas~t |     11339           1           0          1 
>          1
-------------+----------------------------------------------
> ----------
      hhppkg |     11286    1296.305    1788.427   3.179535 
>   51290.88
      lower5 |     11286    465.8754    716.6225   20.81838 
>   5618.524
      upper5 |     11286    2715.726     2566.56   112.3705 
>   16427.04

. describe;

Contains data from /tmp/St09373.000001
  obs:        11,339                          HH food
                                                cons. (1 rec
                                                per item
                                                cons. cat A&
                                                B per HH;
                                                Cat B: only
                                                T6SQ1 +
                                                T6AEQ3)
 vars:            28                          23 Oct 2013 16
> :01
 size:     1,372,019                          (_dta has note
> s)
------------------------------------------------------------
              storage  display     value
variable name   type   format      label      variable label
------------------------------------------------------------
hhid            double %10.0g                 household id
product         float  %39.0g      itmds      Food product
                                        code: numerical
quantity        float  %9.0g                  daily
                                        household food
                                        consumption
value           float  %9.0g                  daily value of
                                        consumption in UGX
                                        per per household
unit            float  %9.0g                  set equal to
                                        one since all
                                        observations are
                                        converted into kg
food_cat        float  %9.0g                  food category
                                        equals 1, if product
                                        is food and 0 if non
                                        food
count           float  %9.0g                  
descript        float  %9.0g       descrip    product
                                        description
                                        including product
                                        code but equals 2
                                        for all non-foods
numreg          double %9.0g                  number of
                                        goods in the basket
survquar        float  %14.0g      lsurvquar
                                              Sequential
                                        Survey Quarter
                                        (Oct-Dec 10 = 1)
reg_tpi         byte   %24.0g      lbreg      Regions used
                                        for temporal price
                                        index calculations
spdomain        float  %9.0g       lspdomain
                                              Spatial
                                        domains: each with
                                        own poverty line
                                        (they are 4)
tpi_trim        float  %9.0g                  TRIMMED
                                        Temporal price index
                                        (Q4=1)
value_r         float  %9.0g                  
cons_pc_nom     float  %9.0g                  
hhweight        float  %9.0g                  Household
                                        sample weight
bswt            float  %9.0g                  bootstrap
                                        weights; and all
                                        equal to 1 for all
                                        households, as a
                                        toolkit requireme
hhsize          long   %9.0g                  number of
                                        household menbers
cons_hh_nom     double %9.0g                  (sum)
                                        cod_hh_nom
food_pc_nom     float  %9.0g                  nominal food
                                        consumption per
                                        capita
nf_pc_nom       float  %9.0g                  nominal
                                        non-food consumption
                                        per capita
food_pc_tpi     float  %9.0g                  Temp-adjusted
                                        per capita food
                                        consumption/day
cons_pc_tpi     float  %9.0g                  Temp adjusted
                                        total
                                        consumption/day
pctile_60       float  %9.0g                  (p 50)
                                        cons_pc_tpi
bottom_basket   float  %9.0g                  =1 if in
                                        bottom (60%) of PCE
hhppkg          float  %9.0g                  
lower5          float  %9.0g                  
upper5          float  %9.0g                  
------------------------------------------------------------
Sorted by:  
     Note:  dataset has changed since last saved

. keep if hhppkg-lower5>=0 & hhppkg-upper5<=0;
(920 observations deleted)

. **********************************************************
> ***********
> * Note that we do prices in three ways. First, by summing 
> quantity and value 
> * This average price price_unitw is thus quantity/value we
> ighted. Second, we
> * calculate the price and take simple means for a transact
> ion weighted
> * price, price_unitt. Last we take the median, price_unitm
> . But in the end
> * we only use price_unitw
> **********************************************************
> ***********;
.         gen price_unitt=value_r/(quantity*1000);

.         gen price_unitm=price_unitt;

.                 *CA modified to count the boot sample weig
> ht bswt;
.         collapse (sum) quantity value_r count bswt 
>                  (mean) price_unitt 
>                  (median) price_unitm [aw=hhweight], by(sp
> domain product);

.         *Generate weighted price per gram ;
.         gen price_unitw=value_r/(quantity*1000);

.         drop value_r quantity;

.         sort spdomain product;

.         lab var price_unitt "simple average of calculated 
> prices - transaction weighted";

.         lab var price_unitm "median of prices";

.         lab var price_unitw "value share weighted mean pri
> ces";

. * Get an idea of the difference between the price measures
> ;
.         gen ratiotw=price_unitt/price_unitw;

.         gen ratiomw=price_unitm/price_unitw;

.         sum ratiotw ratiomw;

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     ratiotw |       140    1.257942    .4200054    .611376 
>   3.380153
     ratiomw |       140    1.065038    .4184307   .2974508 
>   3.838698

.         sort product;

.         merge product using "$path/work/codes_food_basket_
> flex.dta";
variable product does not uniquely identify observations
    in the master data

.         tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          3        2.10        2.10
          3 |        140       97.90      100.00
------------+-----------------------------------
      Total |        143      100.00

.         count if _merge~=3;
    3

.         drop if _merge~=3;
(3 observations deleted)

.         drop _merge;

.         sort product spdomain;

. save "$path/work/price_unit_flex.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> price_unit_flex.dta saved

. **********************************************************
> ******************************
> * 110_price_unit_flex.do                (end)
> **********************************************************
> ******************************;
. cap log close;

. 
end of do-file

. do "$path/new/120_povline_food_flex_original.do"/* Flexibl
> e basket: Poverty line */

. *global path "C:/user/gapp"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/120_povline_food_flex.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/120_povline_food_flex.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:36

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ****************
> * 120_povline_food_flex.do      (start)
> *
> * Use the file with the food basket (food_basket_flex), wh
> ich is in shares. 
> * Then merge it with the prices file, and then with the ca
> lories file.
> * Along the way, drop those observations where we have no 
> price information
> * or no calorie information.
> **********************************************************
> ****************;
. /*
> This file uses:
>         work/food_basket_flex.dta
>         work/price_unit_flex.dta
>         work/calperg.dta
>         work/calpp.dta
> 
> This file creates:
>         work/povline_flex.dta
> */
> 
> 
> * start with the quantity information;
. use "$path/work/food_basket_flex.dta";

.         sort product spdomain;

.         * merge in price information;
.         merge product spdomain using "$path/work/price_uni
> t_flex.dta";
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        6.04        6.04
          2 |         48       32.21       38.26
          3 |         92       61.74      100.00
------------+-----------------------------------
      Total |        149      100.00

.         list product spdomain descript if _merge==1;

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
 92. |     157    Central          1 |
 93. |     157    Eastern          1 |
 94. |     157   Northern          1 |
 95. |     157    Western          1 |
 97. |     999    Central          2 |
     |-------------------------------|
 98. |     999    Eastern          2 |
 99. |     999   Northern          2 |
100. |     999    Western          2 |
101. |       .    Central          1 |
     +-------------------------------+

.         drop if _merge ~=3;
(57 observations deleted)

.         drop _merge;

.         sort product;

.         * merge in information on calories per gram;
.         merge product using "$path/work/calperg.dta";
variable product does not uniquely identify observations
    in the master data
(note: descript is str26 in using data but will be float now
> )

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.83        0.83
          2 |         28       23.33       24.17
          3 |         91       75.83      100.00
------------+-----------------------------------
      Total |        120      100.00

.         * This tells where we are lacking calorie info or 
> are lacking quantity info due to 
>         * missing price info above;
.         list product spdomain descript if _merge==1;

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
 92. |     166    Western          1 |
     +-------------------------------+

.         drop if _merge~=3;
(29 observations deleted)

.         drop _merge;

.         sort spdomain f_share_w;

.                 * CA modified to handle bootstrap counting
> ;
.         * determine if any quantity has fewer than 10 pric
> e observations;
.         by spdomain: count if round(bswt)<10;

------------------------------------------------------------
-> spdomain = Central
    0
------------------------------------------------------------
-> spdomain = Eastern
    0
------------------------------------------------------------
-> spdomain = Northern
    0
------------------------------------------------------------
-> spdomain = Western
    0

.         drop if round(bswt) < 10;
(0 observations deleted)

.         by spdomain: egen baskshr=sum(f_share_w);

.         by spdomain: gen cumshr1=sum(f_share_w);

.         * bundle was cut at 92.5 percent- cut back to 90 p
> ercent if necessary;
.         drop if cumshr1<=baskshr-.9;
(0 observations deleted)

.         * reobtain the share represented from the average 
> basket- should be slightly more than 90;
.         drop baskshr;

.         by spdomain: egen baskshr=sum(f_share_w);

.         by spdomain: sum baskshr;

------------------------------------------------------------
-> spdomain = Central

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     baskshr |        21     .432505           0    .432505 
>    .432505

------------------------------------------------------------
-> spdomain = Eastern

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     baskshr |        26    .5797779           0   .5797779 
>   .5797779

------------------------------------------------------------
-> spdomain = Northern

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     baskshr |        26    .5067519           0   .5067519 
>   .5067519

------------------------------------------------------------
-> spdomain = Western

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
     baskshr |        18     .566602           0    .566602 
>    .566602


.         * obtain quantities and calories provided by these
>  quantities;
.         gen quan=f_share_w/price_unitw;

.                         /* how many g in 1 MT exp on food 
> item */
>         gen cal_ir=quan*calperg;

.                                 /* how many cal in 1 MT ex
> p on food item */
>         by spdomain: egen calreg=sum(cal_ir);

.         /* how many cal in 1 MT exp in food basket*/
> 
>         * merge in calorie requirements;
.         sort spdomain;

.         merge spdomain using "$path/work/calpp.dta";
variable spdomain does not uniquely identify observations
    in the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |         91      100.00      100.00
------------+-----------------------------------
      Total |         91      100.00

.         drop _merge;

.         * get the expansion factor to hit 95% of calorie r
> equirements;
.         gen ratio=.95*calpp/calreg;

.                         replace quan=quan*ratio;
(91 real changes made)

.         replace cal_ir=quan*calperg;
(87 real changes made)

.         * do a consistency check;
.         sort spdomain;

.         by spdomain: egen chkcal=sum(cal_ir);

.         replace chkcal=chkcal/.95-calpp ;
(91 real changes made)

.                         * these values should be about zer
> o;
.         by spdomain: sum chkcal;

------------------------------------------------------------
-> spdomain = Central

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
      chkcal |        21    .0000385           0   .0000385 
>   .0000385

------------------------------------------------------------
-> spdomain = Eastern

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
      chkcal |        26   -.0000899           0  -.0000899 
>  -.0000899

------------------------------------------------------------
-> spdomain = Northern

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
      chkcal |        26    .0000707           0   .0000707 
>   .0000707

------------------------------------------------------------
-> spdomain = Western

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
      chkcal |        18   -.0001221           0  -.0001221 
>  -.0001221


.         * obtain the value of each good in the bundle;
.         gen val_ir=quan*price_unitw;

.         * the sum of the value of the goods in the bundle 
> is assumed to represent 90% of expenditure;
.         by spdomain: egen povline_f_flex90=sum(val_ir);

.         replace povline_f_flex=povline_f_flex90/.9;
(91 real changes made)

.         collapse (mean) povline_f_flex, by (spdomain);

.                 lab var povline_f_flex "Food poverty line.
>  Flexible basket";

.         sort spdomain;

.         keep spdomain povline_f_flex;

. save "$path/work/povline_food_flex.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povline_food_flex.dta saved

. /*
> * To be used in 140_iterate.do;
> gen cutoff = 1.5 * povline_f_flex;
> keep spdomain cutoff;
> save "$path/work/povlines_first_iterate.dta", replace;
> */
> 
> **********************************************************
> ****************
> * 120_povline_food_flex.do      (end)
> **********************************************************
> ****************;
. log close;
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/120_povline_food_flex.log
  log type:  text
 closed on:  23 Oct 2013, 16:01:36
------------------------------------------------------------

. 
end of do-file

. do "$path/new/130_povmeas_flex.do"

. *global path "C:/user/gapp"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/130_povmeas_flex.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/130_povmeas_flex.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:36

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ****************
> * 130_povmeas_flex.do           (start)
> *
> * Purpose:
> * Initial poverty measures calculation for flexible basket
> . (Before any iteration)
> **********************************************************
> ****************;
. *CA modified to add work/hhdata.dta for bootstrap;
. /*
> This file uses:
>         in/foodshr96.dta
>         work/povline_f_flex.dta
>         work/consump_nom.dta
>         work/hhdata.dta
>         work/temp_index_reg_tpi.dta
> 
> This file creates:
>         work/foodshr96.dta
>         work/povmeas.dta
>         work/povlines.dta
>         work/cons_real.dta
> */
> 
> 
> 
> **********************************************************
> ****************;
. * Bring in data file with nominal consumption per capita, 
> and deflate it
> * by temporal price index.
> **********************************************************
> ****************;
. use "$path/work/hhdata.dta", clear;
(Household master record (1 record per household))

.         keep hhid strata reg_tpi spdomain news rural survm
> on survquar;

.         tab reg_tpi, miss;

    Regions |
   used for |
   temporal |
price index |
calculation |
          s |      Freq.     Percent        Cum.
------------+-----------------------------------
    Central |        841       30.96       30.96
    Eastern |        647       23.82       54.79
   Northern |        693       25.52       80.30
    Western |        535       19.70      100.00
------------+-----------------------------------
      Total |      2,716      100.00

.         tab survquar, miss;

    Sequential |
Survey Quarter |
 (Oct-Dec 10 = |
            1) |      Freq.     Percent        Cum.
---------------+-----------------------------------
    Oct-Dec 10 |        690       25.41       25.41
   Jan-Marc 11 |        692       25.48       50.88
   Apr-June 11 |        676       24.89       75.77
July-Sept 2011 |        610       22.46       98.23
             . |         48        1.77      100.00
---------------+-----------------------------------
         Total |      2,716      100.00

.         keep hhid spdomain reg_tpi survquar;

.         sort hhid;

.         tempfile spdomainreg_tpi;

. save `spdomainreg_tpi', replace;
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved

. use "$path/work/conpc.dta", clear;

. *use "$path/work/consump_nom.dta", clear;
. *CA modified to merge in work/hhdata.dta for bootstrap;
.     sort hhid;

.     merge hhid using "$path/work/hhdata.dta";

.     tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.     drop _m;

.         keep hhid hhweight hhsize cons_pc_nom ;

.         sort hhid;

.         merge hhid using `spdomainreg_tpi';
(label lbreg already defined)
(label lsurvquar already defined)
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         sort reg_tpi survquar;

.         merge reg_tpi survquar using "$path/work/temp_inde
> x_reg_tpi.dta";
variables reg_tpi survquar do not uniquely identify
    observations in the master data
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         49        1.80        1.80
          3 |      2,668       98.20      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         sort hhid;

.         merge hhid using "$path/work/conpc.dta";

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         gen food_pc_tpi  = food_pc_nom /tpi_trim;
(49 missing values generated)

.         lab var food_pc_tpi "Temp-adjusted per capita food
>  consumption/day";

.                 gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
(49 missing values generated)

.         lab var cons_pc_tpi "Temp adjusted total consumpti
> on/day";

.         gen one=1;

. * TPI deflated per capita consumption ;
.         tempfile contpi;

. save `contpi', replace;
(note: file /tmp/St09373.000002 not found)
file /tmp/St09373.000002 saved

. **********************************************************
> ****************
> * Calculate non-food expenditure for HH around the food po
> verty line
> *
> * Develop a discrete triangular weighted distribution. Thi
> s gives a
> * weight of  1 to HH at +/- 18-20% from food poverty line,
>  and
> * weight of  2 to HH at +/- 16-18% from food poverty line,
>  and ...
> * weight of 10 to HH at +/-  0- 2% from food poverty line.
> * This weight is called triwt below.
> **********************************************************
> ****************;
. use `contpi';

.         sort spdomain;

.         merge spdomain using "$path/work/povline_food_flex
> .dta";
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. gen     triwt = 0 ;

. replace triwt = 11 - round(50*abs(cons_pc_tpi/povline_f_fl
> ex-1)+0.5)
>                 if abs(cons_pc_tpi/povline_f_flex-1)<=0.2;
(279 real changes made)

.                                         * Nearness to pove
> rty line and population weights ;
.         gen tripopwt=triwt*hhweight*hhsize;
(3 missing values generated)

.         preserve;

.                 collapse (mean) nf_pc_nom [aw=tripopwt] ,
>                         by(spdomain);

.                                         rename nf_pc_nom p
> ovline_na_flex;

.                 lab var povline_na_flex "Nonfood poverty l
> ine. Flexible bundle";

.                                 tempfile znf;

.                 sort spdomain;

.                 save `znf', replace;
(note: file /tmp/St09373.000004 not found)
file /tmp/St09373.000004 saved

.                 tab spdomain;

    Spatial |
   domains: |
  each with |
own poverty |
 line (they |
     are 4) |      Freq.     Percent        Cum.
------------+-----------------------------------
    Central |          1       25.00       25.00
    Eastern |          1       25.00       50.00
   Northern |          1       25.00       75.00
    Western |          1       25.00      100.00
------------+-----------------------------------
      Total |          4      100.00

.         restore;

.         sort spdomain;

.         merge spdomain using `znf';
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. **********************************************************
> ****************;
. * Poverty line is the sum of the food and non-food poverty
>  lines
> **********************************************************
> ****************;
.         gen povline_flex=povline_f_flex + povline_na_flex;
(9 missing values generated)

.         lab var povline_flex "Poverty line. Flexible bundl
> e";

.         sort spdomain;

. save "$path/work/povlines.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines.dta saved

. **********************************************************
> ****************;
. * Create spatial price index, based on the total poverty l
> ine, with
> * adjustment so that mean (and total) nominal consumption 
> equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first: we just
>  use the first stratum.
> **********************************************************
> ****************;
. use `contpi';

.         sort spdomain;

.         merge spdomain using "$path/work/povlines.dta";
variable spdomain does not uniquely identify observations
    in the master data
variable spdomain does not uniquely identify observations
    in
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
    > /povlines.dta
(label lbreg already defined)
(label lsurvquar already defined)
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         * Real consumption pc, temporally deflated ;
.         gen cr= cons_pc_tpi ;
(49 missing values generated)

.         * Poverty line;
.         gen linpob=povline_flex;
(9 missing values generated)

.         *qui sum linpob if spdomain==1, meanonly;
.         sum linpob if spdomain==3, meanonly;

.         global spi_base=r(mean);

.         * Spatial price index ;
.         gen spi=linpob/$spi_base;
(9 missing values generated)

.         * Real consumption pc, temporally and spatially de
> flated ;
.         gen cr2=cr/spi;
(49 missing values generated)

.         qui sum cr [aw=hhweight*hhsize];

.         global sumcr=r(sum);

.         qui sum cr2 [aw=hhweight*hhsize];

.         global sumcr2=r(sum);

.         replace spi=spi*$sumcr2/$sumcr;
(2708 real changes made)

.         gen linpobr=linpob/spi;
(9 missing values generated)

.         replace cr2=cr/spi;
(2658 real changes made)

.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
         cr2 |    2668  36669748.9    1891.772   2775.075   
>        0   78224.86
      linpob |    2707    37257099    831.0039   262.3186   
>  577.541   1245.596
     linpobr |    2707    37257099    792.6632   .0000494   
> 792.6631   792.6632

.         lab var cr      "Temporally-adjusted cons pc";

.         lab var cr2     "Spatially & temporally adjusted c
> ons pc";

.         lab var linpob  "Poverty line";

.         lab var linpobr "Real poverty line";

.         lab var spi     "Spatial price index";

. **********************************************************
> ****************
> * calculate poverty measures with the flexible food bundle
> **********************************************************
> ****************;
.         gen h = 100     if cr <=(linpob);
(2122 missing values generated)

.         replace  h = 0 if cr > (linpob);
(2122 real changes made)

.                         gen             pg      = ((linpob
>  - cr )/linpob) *100;
(49 missing values generated)

.         replace         pg      = 0             if h==0;
(2122 real changes made)

.         gen             spg     = ((( linpob - cr )/ linpo
> b )^2)*100;
(49 missing values generated)

.         replace         spg     = 0             if h==0;
(2122 real changes made)

.         gen h_flex=h;

.         gen pg_flex=pg;
(9 missing values generated)

.         gen spg_flex=spg;
(9 missing values generated)

.         lab var h_flex   "Poverty headcount. Flex bundle";

.         lab var pg_flex  "Poverty gap. Flex bundle";

.         lab var spg_flex "Squared poverty gap. Flex bundle
> ";

.         sort hhid;

.         merge hhid using "$path/work/hhdata.dta";
(label lspdomain already defined)
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop if _merge~=3;
(1 observation deleted)

.         drop _merge;

.         gen popwt=hhsize*hhweight;
(2 missing values generated)

.                 * Stata 10.1 syntax ;
.         svyset , clear;

.         svyset [pweight=popwt] , str(strata) psu(psu);

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>

.         svy: mean h_flex pg_flex spg_flex;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
      h_flex |   23.78035   1.474744      20.88021    26.680
> 49
     pg_flex |   8.640618   .7062988      7.251654    10.029
> 58
    spg_flex |   4.738182   .5317062      3.692561    5.7838
> 03
------------------------------------------------------------
> --

.         svy: mean h_flex pg_flex spg_flex , over(rural);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex       |
           0 |   6.032549   1.326789      3.423367    8.6417
> 32
           1 |   26.95495   1.709691      23.59277    30.317
> 12
-------------+----------------------------------------------
> --
pg_flex      |
           0 |   2.433973   .6844338      1.088008    3.7799
> 39
           1 |   9.750818    .819836      8.138579    11.363
> 06
-------------+----------------------------------------------
> --
spg_flex     |
           0 |   1.462514   .5584336      .3643328    2.5606
> 95
           1 |    5.32411   .6168346      4.111081    6.5371
> 39
------------------------------------------------------------
> --

.         svy: mean h_flex pg_flex spg_flex , over(news);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: news = Central
      Eastern: news = Eastern
     Northern: news = Northern
      Western: news = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex       |
     Central |   14.42243   2.025856       10.4385    18.406
> 35
     Eastern |   15.01479   1.889616      11.29878    18.730
> 79
    Northern |   22.19032   3.048504      16.19532    28.185
> 32
     Western |   44.99748   3.907248      37.31372    52.681
> 23
-------------+----------------------------------------------
> --
pg_flex      |
     Central |   7.622984   1.672593      4.333765     10.91
> 22
     Eastern |   3.724468    .634223      2.477244    4.9716
> 92
    Northern |   6.018522   1.169118      3.719407    8.3176
> 37
     Western |    17.4237   1.683975       14.1121     20.73
> 53
-------------+----------------------------------------------
> --
spg_flex     |
     Central |   5.711281   1.579115      2.605889    8.8166
> 73
     Eastern |   1.596288   .3494187      .9091429    2.2834
> 34
    Northern |   2.419153   .5634548      1.311097    3.5272
> 09
     Western |   9.136437   1.055508       7.06074    11.212
> 13
------------------------------------------------------------
> --

.         svy: mean h_flex pg_flex spg_flex , over(reg_tpi);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: reg_tpi = Central
      Eastern: reg_tpi = Eastern
     Northern: reg_tpi = Northern
      Western: reg_tpi = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex       |
     Central |   14.42243   2.025856       10.4385    18.406
> 35
     Eastern |   15.01479   1.889616      11.29878    18.730
> 79
    Northern |   22.19032   3.048504      16.19532    28.185
> 32
     Western |   44.99748   3.907248      37.31372    52.681
> 23
-------------+----------------------------------------------
> --
pg_flex      |
     Central |   7.622984   1.672593      4.333765     10.91
> 22
     Eastern |   3.724468    .634223      2.477244    4.9716
> 92
    Northern |   6.018522   1.169118      3.719407    8.3176
> 37
     Western |    17.4237   1.683975       14.1121     20.73
> 53
-------------+----------------------------------------------
> --
spg_flex     |
     Central |   5.711281   1.579115      2.605889    8.8166
> 73
     Eastern |   1.596288   .3494187      .9091429    2.2834
> 34
    Northern |   2.419153   .5634548      1.311097    3.5272
> 09
     Western |   9.136437   1.055508       7.06074    11.212
> 13
------------------------------------------------------------
> --

.         svy: mean h_flex pg_flex spg_flex , over(strata);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex       |
     Kampala |   3.383183    1.79719     -.1510616    6.9174
> 27
   _subpop_2 |   7.427843   1.784915      3.917738    10.937
> 95
   _subpop_3 |   19.91683   2.898469      14.21687    25.616
> 78
   _subpop_4 |   15.86898   2.031866      11.87324    19.864
> 72
   _subpop_5 |   23.74083   3.361665      17.12998    30.351
> 67
   _subpop_6 |   47.18332   4.119882      39.08142    55.285
> 23
-------------+----------------------------------------------
> --
pg_flex      |
     Kampala |   .9953435   .7090994     -.3991281    2.3898
> 15
   _subpop_2 |   3.199488   .9782933      1.275636    5.1233
> 39
   _subpop_3 |   10.46981   2.427794      5.695459    15.244
> 16
   _subpop_4 |   3.912261   .6841744      2.566805    5.2577
> 17
   _subpop_5 |   6.433043   1.296555      3.883318    8.9827
> 68
   _subpop_6 |   18.33858   1.787421      14.82354    21.853
> 61
-------------+----------------------------------------------
> --
spg_flex     |
     Kampala |   .4041599    .320569     -.2262515    1.0345
> 71
   _subpop_2 |   2.028741   .8409646      .3749518    3.6825
> 31
   _subpop_3 |   7.838418   2.309953      3.295806    12.381
> 03
   _subpop_4 |   1.672913   .3775056      .9305335    2.4152
> 92
   _subpop_5 |   2.606302   .6265514      1.374164    3.8384
> 39
   _subpop_6 |   9.633776   1.126522      7.418427    11.849
> 13
------------------------------------------------------------
> --

.         svy: mean h_flex pg_flex spg_flex , over(spdomain)
> ;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex       |
     Central |   14.42243   2.025856       10.4385    18.406
> 35
     Eastern |   15.01479   1.889616      11.29878    18.730
> 79
    Northern |   22.19032   3.048504      16.19532    28.185
> 32
     Western |   44.99748   3.907248      37.31372    52.681
> 23
-------------+----------------------------------------------
> --
pg_flex      |
     Central |   7.622984   1.672593      4.333765     10.91
> 22
     Eastern |   3.724468    .634223      2.477244    4.9716
> 92
    Northern |   6.018522   1.169118      3.719407    8.3176
> 37
     Western |    17.4237   1.683975       14.1121     20.73
> 53
-------------+----------------------------------------------
> --
spg_flex     |
     Central |   5.711281   1.579115      2.605889    8.8166
> 73
     Eastern |   1.596288   .3494187      .9091429    2.2834
> 34
    Northern |   2.419153   .5634548      1.311097    3.5272
> 09
     Western |   9.136437   1.055508       7.06074    11.212
> 13
------------------------------------------------------------
> --

.         compress;
hhsize was long now byte
survquar was float now byte
spdomain was float now byte
one was float now byte
triwt was float now byte
h was float now byte
h_flex was float now byte
survmon was float now byte
rural was float now byte
news was float now byte
bswt was float now byte

.         sort hhid;

. save "$path/work/cons_real.dta" , replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_real.dta saved

.         collapse  (mean) h_flex pg_flex spg_flex [aw=hhwei
> ght*hhsize];

. save "$path/work/povmeas.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povmeas.dta saved

. *** HARUNA, the file Povmeas.dta gives the headcount pover
> ty rates using flexible food bundle without inflicting rev
> eales preferences
> *** therefore specifications in line 226 of this do file h
> ave been changed repeatedly to generate these counts for p
> articular
> *** classifications of interest including strata spdomain 
> region urban/rural (urban) and national (done by removing 
> the by command 
> **********************************************************
> ****************
> * 130_povmeas_flex.do           (end)
> **********************************************************
> ****************;
. log close;
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/130_povmeas_flex.log
  log type:  text
 closed on:  23 Oct 2013, 16:01:37
------------------------------------------------------------

. 
end of do-file

. do "$path/new/140_iterate_bjorn.do" $it_n $bottom

. *global path "C:/user/gapp"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/140_iterate.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/140_iterate.log
  log type:  text
 opened on:  23 Oct 2013, 16:01:55

. clear

. set more off

. #delimit ;
delimiter now ;
. *global povline_initial "$path/in/povlines_first_iof.dta";
. **********************************************************
> ****************
> * 140_iterate.do        (start)
> *
> * Purpose: Create flexible food basket and poverty line wi
> th iterative procedure
> *
> * This program will take the results from the first pass a
> t the
> * poverty lines and applies the corresponding spatial defl
> ator to
> * re-select the relatively poor, their consumption bundles
> , and
> * their prices.
> *
> * Welfare indicator is here always temporally and spatiall
> y adjusted per capita
> * expenditure. Here called cr_it< >.
> *
> * We will iterate this process 5 times which here assures 
> convergence.
> *
> * CA, Mar 2010: Relatively poor are those below last itera
> ted poverty line
> * MAH, Apr 2010: Cleaning
> * URB, feb 2012: Commented out "drop if unit~=2"
> **********************************************************
> ****************;
. /*
> This file uses:
>             in/povlines_first_new.dta
>         work/hhdata.dta
>         work/consump_nom.dta
>         work/own.dta
>         work/daily.dta
>         work/temp_index_reg_tpi.dta
>         work/cons_cod.dta
>         work/food_cat.dta
>         work/cons_real.dta
>         work/products.dta
>         work/match96_02.dta
>         new/conversions.do
>         
> This file creates (where `pass' is the number of the itera
> tion):
>         work/codes_food_basket_flex_it`pass'.dta
>         work/price_unit_flex_it`pass'.dta
>         work/quan_flex_it`pass'.dta
>         work/match_cod_flex_it`pass'.csv
>         work/relpoor_it`pass'.dta
>         work/povlines_it`pass'.dta
>         work/foodshares_it`pass'.dta
>         work/nat_pov_flex.csv
>         work/rur_pov_flex.csv
>         work/strata_pov_flex.csv
>         work/spdomain_pov_flex.csv
>         work/reg_tpi_pov_flex.csv
> */
> 
> **********************************************************
> ****************;
. * Make a key file that will be used over and over, without
>  change
> * in every iteration. This will include the TEMPORALLY def
> lated consumption
> * and various HH data such as hhweight, spdomain, etc.
> **********************************************************
> ****************;
. use "$path/work/conpc.dta";

.         sort hhid;

.         merg hhid using "$path/work/hhdata.dta";

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         sort reg_tpi survquar;

.         merge reg_tpi survquar using "$path/work/temp_inde
> x_reg_tpi.dta";
variables reg_tpi survquar do not uniquely identify
    observations in the master data
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         49        1.80        1.80
          3 |      2,668       98.20      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.                 gen food_pc_tpi = food_pc_nom /tpi_trim;
(49 missing values generated)

.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
(49 missing values generated)

.         lab var food_pc_tpi "Temp-adjusted per capita food
>  consumption/day";

.         lab var cons_pc_tpi "Temp adjusted total consumpti
> on/day";

.         tempfile contpi;

.         sort hhid;

. save `contpi', replace;
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved

. save contpi_, replace;
file contpi_.dta saved

. *use "$path/in/povlines_first_iterate.dta", clear;
. *save "$path/work/povlines_first.dta", replace;
. **********************************************************
> ****************;
. * Now set some information pertaining to the iterations. F
> or now we'll
> * manually set the number of iterations. Also specify the 
> percentile
> * cutpoint that we will use for defining the relatively po
> or.
> **********************************************************
> ****************;
. local lastpass=0;

. local pass=1;

. * Use these two lines to manually specify the number of it
> erations
> * and the cutpoint here in the do file.;
.   *local maxit=5;
.   *local cutpt=50;
. * Use these few lines if you want to specify the number of
>  iterations
> * and percentile cutpoint by passing them as parameters on
>  the command
> * line, e.g.:   wstata do new/iterate1.do 5 50;
. if "`1'"=="" | "`2'"=="" {      ;
.         di in red "Error: you need to specify number of it
> erations as first parameter";
.         di in red "       and percentile cutpoint as secon
> d parameter on command line.";
. };

. local maxit `1';

. local cutpt `2';

. tempfile cutoff;

. di "******************************************************
> ****************";
************************************************************
> **********

. while `pass' <= `maxit' {;
  2.         ***********************************************
> ***************************;
. **********************************************************
> ****************;
. * Pick out the bottom X percent in real consumption per ca
> pita 
> * (temporally & spatially adjusted), as ranked by the prev
> ious iteration.
> * The percentile to use is defined by "cutpt". This produc
> es a file that
> * has the hhid, and a dummy variable indicating if they we
> re below the
> * cutpoint on the last iteration.
> **********************************************************
> ****************;
. **********************************************************
> ****************;
. /*
> * Comment out if IOF 2008/09. (This code included instead 
> of below code in order to replicate published figures 2002
> /03). ( START ) ;
> 
>         if "`pass'"=="1" {      ;
>               use `contpi', clear;
>               sort spdomain;
>               merge spdomain using "$path/work/povlines_fi
> rst.dta";
>               tab _m;
>               drop _m;
> *              gen relpoor`pass'= cons_pc_tpi<=cutoff;
>                gen relpoor`pass'= cons_pc_tpi if cons_pc_t
> pi<=cutoff;
>               rename cons_pc_tpi cr_it0;
>               sort hhid;
>          save "$path/work/relpoor_it`pass'.dta", replace;
> *        use "$path/work/cons_real.dta", clear;
> *              gen cr_it0=cr2;
>         };
>         
> 
> * Comment out if IOF 2008/09. (This code included instead 
> of below code in order to replicate published figures 2002
> /03). ( END ) ;
> */
> 
> 
> 
> * Comment out if IAF 2002/03. (This code below excluded in
>  order to replicate published figures 2002/03). ( START ) 
> ;
.         if "`pass'"=="1" { ;
  3. * Find real income at cut point initially;
.                 use "$path/work/cons_real.dta", clear;
  4.                                     gen cr_it0=cr2;
  5.                         cap drop one;
  6.             gen one=1;
  7.                                     collapse (p`cutpt')
>  one cr_it`lastpass' [aw=popwt] ;
  8.                                     rename cr_it`lastpa
> ss' cutoff;
  9.                                     sort one;
 10.             save `cutoff', replace;
 11.             save cutoff, replace;
 12.  * Find relatively poor initially;
.             use "$path/work/cons_real.dta", clear;
 13.                                                 gen cr_
> it`lastpass'=cr2;
 14.             cap drop one;
 15.             cap drop cutoff;
 16.             gen one=1;
 17.                                     sort one;
 18.             merge one using `cutoff';
 19.             tab _merge;
 20.             drop _merge;
 21.                                     drop one;
 22.                            gen relpoor`pass'=cr_it`last
> pass'<=cutoff;
 23.             *lab var relpoor`pass' "=1 if in bottom of 
> PCE";
.                                     tab relpoor`pass' [aw=
> popwt];
 24.                                     keep hhid cr_it`las
> tpass' relpoor`pass' popwt;
 25.             sort hhid;
 26.         save "$path/work/relpoor_it`pass'.dta", replace
> ;
 27.         };
 28. * Comment out if IAF 2002/03. (This code below excluded
>  in order to replicate published figures 2002/03). ( END )
>  ;
.                 if `pass'>1 {   ;
 29. * Find real income at cut point in iteration number `pa
> ss' ;
.                 use "$path/work/cons_real_it`lastpass'.dta
> " , clear;
 30.                                                 cap dro
> p one;
 31.                 gen one=1;
 32.                                                        
>          *CA modified from hhweight*hhsize to popwt;
.                 collapse (p`cutpt') one cr_it`lastpass' [a
> w=popwt] ;
 33.                         rename cr_it`lastpass' cutoff;
 34.                                                        
>                  sort one;
 35.         save `cutoff', replace;
 36.         * Find relatively poor in iteration number `pas
> s' ;
.                 use "$path/work/cons_real_it`lastpass'.dta
> ", clear;
 37.                                                 cap dro
> p one;
 38.                 gen one=1;
 39.                                                 sort on
> e;
 40.                 merge one using `cutoff';
 41.                 tab _merge;
 42.                 drop _merge;
 43.                                                 drop on
> e;
 44.                 gen relpoor`pass'=cr_it`lastpass'<=cuto
> ff;
 45.                 *lab var relpoor`pass' "=1 if in bottom
>  of PCE";
.                                                 tab relpoo
> r`pass' [aw=popwt];
 46. *CA modified to popwt above and to keep popwt below;
.                 keep hhid cr_it`lastpass' relpoor`pass' po
> pwt;
 47.                 sort hhid;
 48.         save "$path/work/relpoor_it`pass'.dta", replace
> ;
 49.         };
 50.         ***********************************************
> ***************************;
. * Get the consumption file, and select only those codes th
> at are food,
> * using our definition of "food", which includes alcoholic
>  beverages.
> **********************************************************
> ****************;
.         use "$path/work/cons_cod.dta", clear;
 51. *CA modified to merge in work/hhdata.dta for bootstrap;
.     sort hhid;
 52.     merge hhid using "$path/work/hhdata.dta";
 53.     tab _m;
 54.     drop _m;
 55.         /*
>                 sort product;
>                 merge product using "$path/work/food_cat.d
> ta";
>                 tab _merge;
>                 keep if _merge==3;
>                 drop _merge;
> */
> 
>                                 * Only food transactions ;
.                 keep if food_cat==1;
 56.                 sort hhid;
 57. *******************************************************
> *******************;
. * Merge with file that has temporally AND spatially adjust
> ed consumption
> * per capita from the previous iteration, and also identif
> ies those below 
> * the cutoff. Then select only those who are below the cut
> off.
> **********************************************************
> ****************;
.                 merge hhid using "$path/work/relpoor_it`pa
> ss'.dta";
 58.                 tab _merge;
 59.                 drop _merge;
 60.                                 * Keep only transaction
> s by the poor ;
.                 keep if relpoor`pass';
 61. *******************************************************
> *******************;
. * Calculate HH level food shares. Since we're only doing s
> hares here, we can
> * work with the expenditures without doing temporal adjust
> ment.
> **********************************************************
> ****************;
.                 gen  food_expenditure = cod_hh_nom;
 62.                 *gen  food_expenditure= own_valued + da
> ily_valued + monthly_valued + educ_valued;
.                 egen tot_food_expen= sum (food_expen), by 
> (hhid) ;
 63.                 count if food_expenditure==.;
 64.                 count if tot_food_expen==.;
 65.                 gen food_share= food_expenditure/tot_fo
> od_expen;
 66.                 count if food_share==.;
 67.                 drop if food_share==.;
 68.                 sort hhid product;
 69.                 tempfile foodshares;
 70.         save `foodshares', replace;
 71. *******************************************************
> *************************;
. * Now find the total (economy wise, e.g. not by HH) shares
>  by each product in
> * order to select the most important goods in each domain'
> s basket.
> **********************************************************
> **********************;
.                 collapse (mean) hhweight spdomain, by (hhi
> d);
 72.                 sort hhid ;
 73.                  collapse (sum) hhweight , by(spdomain)
> ;
 74.                 rename hhweight tothhweight;
 75.                 tempfile tothhweight;
 76.                 sort spdomain;
 77.         save `tothhweight', replace;
 78.         use `foodshares', clear;
 79.                 sort spdomain;
 80.                 merge spdomain using `tothhweight';
 81.                 tab _merge;
 82.                 drop _merge;
 83.                 sort spdomain product;
 84.                 gen f_share_w`pass'=(food_share*hhweigh
> t)/tothhweight;
 85.                 collapse (sum) f_share_w`pass', by(spdo
> main product descript);
 86.                                sort spdomain f_share_w`
> pass';
 87.                 by spdomain: gen cumshr`pass'= sum(f_sh
> are_w`pass');
 88.                 count if cumshr`pass'<=.075;
 89.                 drop if cumshr`pass'<=.075;
 90.                 lab var f_share_w`pass' "average food s
> hare for the 13 spatial domains";
 91.         save `foodshares', replace;
 92.                                                 * Numbe
> r of spatials domains a food product appears ;
.                 gen numreg=1;
 93.                 collapse (sum) numreg cumshr`pass', by 
> (product descript);
 94.                 keep product numreg descript;
 95.                 display _N;
 96.                 sort product;
 97.                                 * Include food product 
> labels ;
. *                merge product using "$path/work/products.
> dta";
. *                tab _merge;
. *                keep if _merge==3;
.                 keep product descript numreg;
 98.                   sort product;
 99.                      display _N;
100.           save "$path/work/codes_food_basket_flex_it`pa
> ss'.dta", replace;
101. *******************************************************
> *******************;
. **********************************************************
> ****************;
. * That is pretty much the part equivalent to "100_food_bas
> ket_flex.do",
> * which figures out the food shares for the relevant refer
> ence group. Now
> * we figure out the prices with a code stream that is adap
> ted from
> * "110_price_unit_flex.do".
> **********************************************************
> ****************;
. **********************************************************
> ****************;
. **********************************************************
> ****************************
> * Create sorted data set with daily + own expenditure and 
> the matched codes
> **********************************************************
> ****************************;
. use "$path/in/cons_cod_trans.dta", clear;
102. *save "$path/work/cons_cod_trans.dta", replace;
. *drop value   ;
. *drop quantity;
. keep hhid product food_cat valuez quantityz unit;
103. rename valuez    value;
104. rename quantityz quantity;
105. *drop count;
. drop if quantity==0 ;
106.         tempfile dd_acsort;
107.         save    `dd_acsort', replace;
108. /*
>         use "$path/work/daily.dta", clear;
>                 drop days;
>                 sort product;
>                 tempfile dd_acsort;
>         save `dd_acsort', replace;
>         
>         use "$path/work/own.dta", clear;
>                 keep hhid product valued quantityd unit;
>                 rename valued value;
>                 rename quantityd quantity;
>         
>                 *CHECK THE ZEROS IN quantity FOR NOW DELET
> E;
>                 drop if quantity==0;
>         
>                 append using `dd_acsort';
> */
> 
>                 *CA modified to insert work/hhdata.dta for
>  bootstrap;
.                 sort hhid;
109.                 merge hhid using "$path/work/hhdata.dta
> ";
110.                 tab _m;
111.                  drop if _m==2;
112.                 drop _m;
113.                                 sort product;
114.                 gen count=1;
115.         save `dd_acsort', replace;
116.         ***********************************************
> ***************************;
. * Merge the basket codes with the dd  and own data sets.
> * Drop all codes not a part of the flexible food basket
> **********************************************************
> ****************;
.                 merge product using "$path/work/codes_food
> _basket_flex_it`pass'.dta";
117.                         tab _merge;
118.                 drop if _merge~=3;
119.                 drop _merge;
120. *******************************************************
> *******************************
> * Drop observations where product code, quantity or value 
> information is unavailable
> **********************************************************
> ****************************;
.                 drop if product==. | value==. | quantity==
> .  ;
121.         ***********************************************
> ***************************************
> * Convert non-KG quantities (units, liters) into kilograms
> **********************************************************
> ****************************;
. *do "$path/new/110a_conversions.do"
> 
> **********************************************************
> **********
> * There remain a few difficult to interpret observations s
> uch as liters
> * of fish and liters of pasta. These are dropped.
> **********************************************************
> **********;
. *                $MZ drop if unit~=2;
.         **************************************************
> ************************;
. * Bring in the spdomain and reg_tpi variables, and also th
> e information on
> * relatively poor households.
> **********************************************************
> ****************;
.                 preserve;
122.                                                 * Tempo
> rally adjusted expenditure ;
.                         use `contpi', clear;
123.                                 keep hhid hhweight spdo
> main reg_tpi survquar tpi_trim cons_pc_tpi ;
124.                                 sort hhid;
125.                                 tempfile hhd2;
126.                         save `hhd2', replace;
127.                 restore;
128.                                 compress;
129.                 sort hhid;
130.                 merge hhid using `hhd2';
131.                 tab _merge;
132.                 drop _merge;
133.                 sort hhid;
134.                 merge hhid using "$path/work/relpoor_it
> `pass'.dta";
135.                 tab _merge;
136.                 drop _merge;
137.                                                 * Keep 
> nominal food transactions by poor people ;
.                 keep if relpoor`pass';
138.                 drop if product==.;
139.                                                        
>          * Temporally deflate transaction values ;
.                 gen value_r=value/tpi_trim;
140. *******************************************************
> *******************;
. * Toss out the bottom 5% and top 5% of the HH-LEVEL prices
>  per kg in
> * each spdomain & product combination. This should elimina
> te outliers
> * that may have an undue influence on the price calculatio
> n. 
> **********************************************************
> ****************;
.                 gen hhppkg=value_r/quantity;
141.                 egen lower5=pctile(hhppkg), p(5)  by(sp
> domain product);
142.                 egen upper5=pctile(hhppkg), p(95) by(sp
> domain product);
143.                 keep if hhppkg>=lower5 & hhppkg<=upper5
> ;
144. *******************************************************
> **************
> * Note that we do prices in three ways. First, by summing 
> quantity and value 
> * This average price price_uw is thus quantity/value weigh
> ted. Second, we
> * calculate the price and take simple means for a transact
> ion weighted
> * price, price_ut. Last we take the median, price_um. But 
> in the end
> * we only use price_unitw
> **********************************************************
> ***********;
.                 gen price_ut`pass'=value_r/(quantity*1000)
> ;
145.                 gen price_um`pass'=price_ut;
146.                 collapse (sum) 
>                         quantity value_r count bswt (mean)
>  price_ut (median) price_um [aw=hhweight], 
>                         by(spdomain product);
147.                 *Generate weighted price per gram ;
.                 gen price_uw`pass'=value_r/(quantity*1000)
> ;
148.                 drop value_r quantity;
149.                 sort spdomain product;
150.                 lab var price_ut`pass' "Average of calc
> ulated prices - transaction weighted";
151.                 lab var price_um`pass' "Median of price
> s";
152.                 lab var price_uw`pass' "Value share wei
> ghted mean prices";
153. * Get an idea of the difference between the price measu
> res;
.                 gen ratiotw`pass'=price_ut`pass'/price_uw`
> pass';
154.                 gen ratiomw`pass'=price_um`pass'/price_
> uw`pass';
155.                 sum ratiotw`pass' ratiomw`pass';
156.                 sort product;
157.                 merge product using "$path/work/codes_f
> ood_basket_flex_it`pass'.dta";
158.                 tab _m;
159.                 count if _merge~=3;
160.                 drop if _merge~=3;
161.                 drop _merge;
162.                 sort product spdomain;
163.         save "$path/work/price_unit_flex_it`pass'.dta",
>  replace;
164. *******************************************************
> *******************;
. **********************************************************
> ****************;
. * That concludes the prices part. Now we move to calculati
> ng the food
> * poverty lines, which draws code from "120_povline_flex.d
> o" with very few
> * changes:
> * - The changes facilitate accumulating vectors
> *   of intermediate results across iterations, rather than
>  generating a
> *   bunch of new files.
> **********************************************************
> ****************;
. **********************************************************
> ****************;
. **********************************************************
> ****************;
. * Use the file with the food basket (`foodshares'), which 
> is in shares. 
> * Then merge it with the prices file, and then with the ca
> lories file.
> * Along the way, drop those observations where we have no 
> price information
> * or no calorie information, but list them out.
> **********************************************************
> ****************;
.         use `foodshares', clear;
165.                 sort product spdomain;
166.                 merge product spdomain using "$path/wor
> k/price_unit_flex_it`pass'.dta";
167.                         tab _merge;
168.                 list product spdomain descript if _merg
> e==1;
169.                         drop if _merge ~=3;
170.                 drop _merge;
171.                 sort product;
172.                         merge product using "$path/work
> /calperg.dta";
173.                 tab _merge;
174.                                                 * This 
> tells where we are lacking calorie info or are lacking qua
> ntity info due to 
>                 * missing price info above;
.                 list product spdomain descript if _merge==
> 1;
175.                         drop if _merge~=3;
176.                 drop _merge;
177.                 sort spdomain f_share_w`pass';
178.                                 *CA modified to change 
> count bswt;
.                 by spdomain: count if round(bswt)<10;
179.                                 sum bswt;
180.                                                 drop if
>  round(bswt) < 10;
181.                                                        
>          * Total food share in spatial domain ;
.                 by spdomain: egen baskshr=sum(f_share_w`pa
> ss');
182.                                 * Cumulated food share 
> in spatial domain ;
.                 by spdomain: gen  cumshr =sum(f_share_w`pa
> ss');
183.                 drop if cumshr<=baskshr-.9;
184.                         drop baskshr;
185.                 by spdomain: egen baskshr=sum(f_share_w
> `pass');
186.                 tabstat baskshr , by(spdomain) st(n mea
> n sd min max);
187.                                                        
>          * How many grams in 1 MT exp on food item ;
.                                 gen quan`pass'=f_share_w`p
> ass'/price_uw`pass';
188.                                 * How many calories in 
> 1 MT exp on food item ;
.                 gen cal_ir`pass'=quan`pass'*calperg;
189.                                 * how many calories in 
> 1 MT exp in food basket ;
.                 by spdomain: egen calreg=sum(cal_ir);
190.                         sort spdomain;
191.                 merge spdomain using "$path/work/calpp.
> dta";
192.                 tab _merge;
193.                 drop _merge;
194.                                                        
>  * get the expansion factor to hit 95% of calorie requirem
> ents ;
.                 gen ratio=.95*calpp/calreg;
195.                         replace quan`pass'=quan`pass'*r
> atio;
196.                 replace cal_ir`pass'=quan`pass'*calperg
> ;
197.                         sort spdomain product;
198.                 by spdomain: egen chkcal=sum(cal_ir`pas
> s');
199.                 replace chkcal=chkcal/.95-calpp ;
200.                                                 tabstat
>  chkcal , by(spdomain) st(n mean sd min max);
201.                         gen val_ir`pass'=quan`pass'*pri
> ce_uw`pass';
202.                         by spdomain: egen povline_f_fle
> x90_`pass'=sum(val_ir`pass');
203.                 replace povline_f=povline_f_flex90_`pas
> s'/.9;
204.                 *drop product96;
. keep product spdomain quan`pass'  price_uw`pass' val_ir`pa
> ss' povline_f_flex90_`pass' calpp calperg;
205.                     save "$path/work/quan_flex_it`pass'
> .dta", replace;
206.                         collapse (mean) povline_f_flex9
> 0_`pass', by (spdomain);
207.                                                 keep sp
> domain povline_f_flex90_`pass';
208.                 sort spdomain;
209.                 save "$path/work/povline_food_flex_it`p
> ass'.dta", replace;
210.         ***********************************************
> ***************************;
. **********************************************************
> ****************;
. * Now comes the part that draws the non-food and total pov
> erty lines,
> * and generates estimates of poverty measures. This is dra
> wn from 
> * "130_povmeas_flex.do" with a few changes.
> **********************************************************
> ****************;
. **********************************************************
> ****************;
. **********************************************************
> ****************
> * Calculate non-food expenditure for HH around the food po
> verty line
> *
> * Develop a discrete triangular weighted distribution. Thi
> s gives a
> * weight of  1 to HH at +/- 18-20% from food poverty line,
>  and
> * weight of  2 to HH at +/- 16-18% from food poverty line,
>  and ...
> * weight of 10 to HH at +/-  0- 2% from food poverty line.
> * This weight is called triwt below.
> **********************************************************
> ****************;
.         use `contpi', clear;
211.                 sort spdomain;
212.                 merge spdomain using "$path/work/povlin
> e_food_flex_it`pass'.dta";
213.                 tab _merge;
214.                 drop _merge;
215.                 gen triwt=0;
216.                 replace triwt = 11 - round(50*abs(cons_
> pc_tpi/povline_f_flex90_`pass'-1)+0.5) if abs(cons_pc_tpi/
> povline_f_flex90_`pass'-1) <= 0.2;
217.                                 ***since the poor were 
> very few in Kampala and Central urban for Uganda we added 
> 1 to weights****;
.                                 * Nearness to poverty line
>  and population weights ;
.                 gen tripopwt=(0.001+triwt)*hhweight*hhsize
> ;
218.                                                 preserv
> e;
219.                         collapse (mean) nf_pc_nom [aw=t
> ripopwt] , by(spdomain);
220.                         rename nf_pc_nom povline_nf_fle
> x`pass';
221.                         lab var povline_nf_flex`pass' "
> Nonfood poverty line. Flexible bundle";
222.                         tempfile znf;
223.                         sort spdomain;
224.                         save `znf', replace;
225.                                                        
>          restore;
226.                                 sort spdomain;
227.                 merge spdomain using `znf';
228.                 tab _merge;
229.                 drop _merge;
230. *******************************************************
> *******************
> * Poverty line is the sum of the food and non-food poverty
>  lines
> **********************************************************
> ****************;
.                 gen povline_flex`pass'=povline_f_flex90_`p
> ass' + povline_nf_flex`pass';
231. keep spdomain povline_flex`pass';
232.                 sort spdomain;
233.         save "$path/work/povlines_it`pass'.dta", replac
> e;
234. *******************************************************
> *******************;
. * Create spatial price index, based on the total poverty l
> ine, with
> * adjustment so that mean (and total) nominal consumption 
> equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first: we just
>  use the first stratum.
> **********************************************************
> ****************;
.         use `contpi', clear;
235.                 sort spdomain;
236.                 merge spdomain using "$path/work/povlin
> es_it`pass'.dta";
237.                 tab _merge;
238.                 drop _merge;
239.                 gen cr= cons_pc_tpi ;
240.                 gen linpob`pass'=povline_flex`pass';
241.                 qui sum linpob`pass' if spdomain==1, me
> anonly;
242.                 global spi_base=r(mean);
243.                 gen spi`pass'=linpob`pass'/$spi_base;
244.                 gen cr_it`pass'=cr/spi`pass';
245.                 qui sum cr [aw=hhweight*hhsize];
246.                 global sumcr=r(sum);
247.                 qui sum cr_it`pass' [aw=hhweight*hhsize
> ];
248.                 global sumcr2=r(sum);
249.                 replace spi`pass'=spi`pass'*$sumcr2/$su
> mcr;
250.                 gen linpobr`pass'=linpob`pass'/spi`pass
> ';
251.                 replace cr_it`pass'=cr/spi`pass';
252.                 su cr cr_it`pass' linpob`pass' linpobr`
> pass' [aw=hhweight*hhsize];
253.                 lab var cr "Temporally-adjusted cons pc
> ";
254.                 lab var cr_it`pass' "Spatially & tempor
> ally adjusted cons pc";
255.                 lab var linpob`pass' "Poverty line";
256.                 lab var linpobr`pass' "Real poverty lin
> e";
257.                 lab var spi`pass' "Spatial price index"
> ;
258.                 gen linpob=linpob`pass';
259. *******************************************************
> *******************
> * calculate poverty measures with the flexible food bundle
> **********************************************************
> ****************;
.                 gen h=100 if cr_it`pass'<=linpobr`pass' & 
> linpobr`pass'~=. & cr_it`pass'~=.;
260.                 replace  h   = 0 if cr_it`pass' > linpo
> br`pass' & linpobr`pass'~=. & cr_it`pass'~=.;
261.                 gen      pg  = ((linpobr`pass' - cr_it`
> pass' )/linpobr`pass') *100;
262.                 replace  pg  = 0             if h==0;
263.                 gen      spg = ((( linpobr`pass' - cr_i
> t`pass' )/ linpobr`pass' )^2)*100;
264.                 replace  spg = 0             if h==0;
265.                 gen h_flex`pass'  =h;
266.                 gen pg_flex`pass' =pg;
267.                 gen spg_flex`pass'=spg;
268.                                 lab var h_flex`pass'   
> "Poverty headcount. Flexible bundle";
269.                 lab var pg_flex`pass'  "Poverty gap. Fl
> exible bundle";
270.                 lab var spg_flex`pass' "Squared poverty
>  gap. Flexible bundle";
271.                 gen popwt=hhsize*hhweight;
272.                         * Stata 10.1 syntax ;
.                         svyset , clear;
273.                         svyset [pweight=popwt] , str(st
> rata) psu(psu);
274.                 svy: mean h_flex`pass' pg_flex`pass' sp
> g_flex`pass';
275.                 svy: mean h_flex`pass' pg_flex`pass' sp
> g_flex`pass' , over(rural);
276.                 svy: mean h_flex`pass' pg_flex`pass' sp
> g_flex`pass' , over(strata);
277.                 svy: mean h_flex`pass' pg_flex`pass' sp
> g_flex`pass' , over(strata rural);
278.                 svy: mean h_flex`pass' pg_flex`pass' sp
> g_flex`pass' , over(spdomain);
279. *preserve;
. keep hhid popwt cr_it`pass' h_flex`pass' pg_flex`pass' spg
> _flex`pass' rural news reg_tpi strata spdomain;
280.                 compress;
281.                 sort hhid;
282.         save "$path/work/cons_real_it`pass'.dta" , repl
> ace;
283. *restore;
.                                 * New cutoff point (percen
> tile) to use in next iteration is equal to the poverty ;
.                 * rate in this iteration ;
.                                                 sum h_flex
> `pass' [aw=popwt] ;
284.                                 * Comment out next line
>  for IAF 2002/03 in order to replicate official figures ( 
> START );
.                 * URB: In this case, we just use the poore
> st 50% as there are too few actually poor to calculate the
>  bundle and prices..;
.                 local cutpt= $tpi_bottom;
285. *               local cutpt= round(r(mean));
.                 * Comment out next line for IAF 2002/03 in
>  order to replicate official figures ( END );
. *       save foodshares tempfile to disk;
.         use `foodshares', clear;
286.         save "$path/work/foodshares_it`pass'.dta", repl
> ace;
287.         local lastpass = `pass';
288.         local pass = `pass' + 1;
289.         };
(48 missing values generated)
(note: file /tmp/St09373.000002 not found)
file /tmp/St09373.000002 saved
file cutoff.dta saved
(48 missing values generated)
variable one does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,716      100.00      100.00
------------+-----------------------------------
      Total |      2,716      100.00

   relpoor1 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |   1,380.22       50.86       50.86
          1 |   1,333.78       49.14      100.00
------------+-----------------------------------
      Total |      2,714      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> relpoor_it1.dta saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.76        0.76
          2 |          4        0.01        0.77
          3 |     36,833       99.23      100.00
------------+-----------------------------------
      Total |     37,120      100.00
(2999 observations deleted)
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |         60        0.18        0.18
          3 |     34,121       99.82      100.00
------------+-----------------------------------
      Total |     34,181      100.00
(21901 observations deleted)
(11 missing values generated)
   11
    0
(11 missing values generated)
   11
(11 observations deleted)
(note: file /tmp/St09373.000003 not found)
file /tmp/St09373.000003 saved
(note: file /tmp/St09373.000004 not found)
file /tmp/St09373.000004 saved
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     12,269      100.00      100.00
------------+-----------------------------------
      Total |     12,269      100.00
  139
(139 observations deleted)
file /tmp/St09373.000003 saved
41
41
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> codes_food_basket_flex_it1.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(779 observations deleted)
(note: file /tmp/St09373.000005 not found)
file /tmp/St09373.000005 saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.84        0.84
          2 |        110        0.33        1.16
          3 |     33,342       98.84      100.00
------------+-----------------------------------
      Total |     33,735      100.00
(110 observations deleted)
file /tmp/St09373.000005 saved
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,590       10.68       10.68
          2 |          1        0.00       10.68
          3 |     30,035       89.32      100.00
------------+-----------------------------------
      Total |     33,626      100.00
(3591 observations deleted)
(176 observations deleted)
(note: file /tmp/St09373.000007 not found)
file /tmp/St09373.000007 saved
product was float now int
unit was float now byte
food_cat was float now byte
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
bswt was float now byte
hhsize was long now byte
count was float now byte
descript was float now byte
numreg was double now byte
variable hhid does not uniquely identify observations in
    the master data
survquar was byte now float
spdomain was byte now float
(label lspdomain already defined)
(label lsurvquar already defined)
(label lbreg already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        156        0.52        0.52
          3 |     29,859       99.48      100.00
------------+-----------------------------------
      Total |     30,015      100.00
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.00        0.00
          3 |     30,014      100.00      100.00
------------+-----------------------------------
      Total |     30,015      100.00
(18665 observations deleted)
(49 observations deleted)
(854 observations deleted)

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
    ratiotw1 |       156    1.245399    .3783339    .907093 
>   3.414566
    ratiomw1 |       156    1.046059     .325231    .354801 
>   3.136625
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          2        1.27        1.27
          3 |        156       98.73      100.00
------------+-----------------------------------
      Total |        158      100.00
    2
(2 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> price_unit_flex_it1.dta saved
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          5        3.11        3.11
          2 |         49       30.43       33.54
          3 |        107       66.46      100.00
------------+-----------------------------------
      Total |        161      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
104. |     157    Central          1 |
105. |     157    Eastern          1 |
106. |     157   Northern          1 |
107. |     157    Western          1 |
112. |       .    Central          1 |
     +-------------------------------+
(54 observations deleted)
variable product does not uniquely identify observations
    in the master data
(note: descript is str26 in using data but will be float now
> )

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          4        3.01        3.01
          2 |         26       19.55       22.56
          3 |        103       77.44      100.00
------------+-----------------------------------
      Total |        133      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
104. |     162   Northern          1 |
105. |     166    Western          1 |
106. |     171    Central          1 |
107. |     171    Eastern          1 |
     +-------------------------------+
(30 observations deleted)

------------------------------------------------------------
-> spdomain = Central
    0
------------------------------------------------------------
-> spdomain = Eastern
    0
------------------------------------------------------------
-> spdomain = Northern
    0
------------------------------------------------------------
-> spdomain = Western
    0

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        bswt |       103    89.13592    67.16384         13 
>        332
(0 observations deleted)
(0 observations deleted)

Summary for variables: baskshr
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        26  .7473591         0  .7473591  .7473591
 Eastern |        28  .8894368         0  .8894368  .8894368
Northern |        27  .8630612         0  .8630612  .8630612
 Western |        22  .8803068         0  .8803068  .8803068
---------+--------------------------------------------------
   Total |       103  .8447085  .0576833  .7473591  .8894368
------------------------------------------------------------
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |        103      100.00      100.00
------------+-----------------------------------
      Total |        103      100.00
(103 real changes made)
(98 real changes made)
(103 real changes made)

Summary for variables: chkcal
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        26 -.0002184         0 -.0002184 -.0002184
 Eastern |        28  .0000385         0  .0000385  .0000385
Northern |        27 -.0000578         0 -.0000578 -.0000578
 Western |        22  .0001349         0  .0001349  .0001349
---------+--------------------------------------------------
   Total |       103  -.000031  .0001281 -.0002184  .0001349
------------------------------------------------------------
(103 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> quan_flex_it1.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povline_food_flex_it1.dta saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(270 real changes made)
(3 missing values generated)
(note: file /tmp/St09373.000009 not found)
file /tmp/St09373.000009 saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(9 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines_it1.dta saved
variable spdomain does not uniquely identify observations
    in the master data
variable spdomain does not uniquely identify observations
    in
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
    > /povlines_it1.dta
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(49 missing values generated)
(9 missing values generated)
(9 missing values generated)
(49 missing values generated)
(2708 real changes made)
(9 missing values generated)
(2658 real changes made)

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
      cr_it1 |    2668  36669748.9    1891.772   2689.844   
>        0   74621.59
     linpob1 |    2707    37257099    835.7049   293.6757   
> 531.2397   1285.485
    linpobr1 |    2707    37257099    787.8209          0   
> 787.8209   787.8209
(9 missing values generated)
(2149 missing values generated)
(2100 real changes made)
(49 missing values generated)
(2100 real changes made)
(49 missing values generated)
(2100 real changes made)
(49 missing values generated)
(49 missing values generated)
(49 missing values generated)
(3 missing values generated)

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
     h_flex1 |   23.64991   1.503001       20.6942    26.605
> 62
    pg_flex1 |   8.726179   .7166281      7.316902    10.135
> 46
   spg_flex1 |   4.836122   .5414702        3.7713    5.9009
> 44
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex1      |
           0 |   6.326062   1.339848      3.691199    8.9609
> 26
           1 |   26.72901   1.744476      23.29843    30.159
> 59
-------------+----------------------------------------------
> --
pg_flex1     |
           0 |   2.489213    .698299      1.115981    3.8624
> 45
           1 |   9.834726    .830848      8.200831    11.468
> 62
-------------+----------------------------------------------
> --
spg_flex1    |
           0 |   1.497357   .5740725      .3684216    2.6262
> 93
           1 |   5.429548   .6274352      4.195672    6.6634
> 23
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex1      |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   7.773105   1.803049       4.22734    11.318
> 87
   _subpop_3 |    20.8093    2.92784      15.05158    26.567
> 01
   _subpop_4 |   14.29078   1.969347      10.41798    18.163
> 58
   _subpop_5 |    19.2359   3.393755      12.56195    25.909
> 85
   _subpop_6 |   52.11975   4.167259      43.92468    60.314
> 83
-------------+----------------------------------------------
> --
pg_flex1     |
     Kampala |   1.096276   .7448751       -.36855    2.5611
> 01
   _subpop_2 |   3.253963   1.000166      1.287097     5.220
> 83
   _subpop_3 |   10.93114   2.448061      6.116933    15.745
> 35
   _subpop_4 |     3.5977    .654173      2.311244    4.8841
> 57
   _subpop_5 |    5.19351   1.147808      2.936301     7.450
> 72
   _subpop_6 |   20.04664   1.883765      16.34214    23.751
> 13
-------------+----------------------------------------------
> --
spg_flex1    |
     Kampala |   .4546812   .3523358     -.2382007    1.1475
> 63
   _subpop_2 |   2.073338   .8704021      .3616581    3.7850
> 17
   _subpop_3 |   8.108861   2.331398      3.524077    12.693
> 65
   _subpop_4 |   1.557001   .3631809      .8427912     2.271
> 21
   _subpop_5 |     2.0472   .5257622      1.013268    3.0811
> 32
   _subpop_6 |   10.59611   1.202493      8.231358    12.960
> 86
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

         Over: strata rural
    _subpop_1: Kampala 0
    _subpop_2: Kampala 1
    _subpop_3: Other Urban 0
    _subpop_4: Central rural 1
    _subpop_5: East rural 1
    _subpop_6: North rural 1
    _subpop_7: West rural 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex1      |
   _subpop_1 |    3.72633   1.839651       .108586    7.3440
> 74
   _subpop_2 |          0  (omitted)
   _subpop_3 |   7.773105   1.803049       4.22734    11.318
> 87
   _subpop_4 |    20.8093    2.92784      15.05158    26.567
> 01
   _subpop_5 |   14.29078   1.969347      10.41798    18.163
> 58
   _subpop_6 |    19.2359   3.393755      12.56195    25.909
> 85
   _subpop_7 |   52.11975   4.167259      43.92468    60.314
> 83
-------------+----------------------------------------------
> --
pg_flex1     |
   _subpop_1 |   1.115276   .7577214     -.3748126    2.6053
> 65
   _subpop_2 |          0  (omitted)
   _subpop_3 |   3.253963   1.000166      1.287097     5.220
> 83
   _subpop_4 |   10.93114   2.448061      6.116933    15.745
> 35
   _subpop_5 |     3.5977    .654173      2.311244    4.8841
> 57
   _subpop_6 |    5.19351   1.147808      2.936301     7.450
> 72
   _subpop_7 |   20.04664   1.883765      16.34214    23.751
> 13
-------------+----------------------------------------------
> --
spg_flex1    |
   _subpop_1 |   .4625616   .3584127     -.2422709    1.1673
> 94
   _subpop_2 |          0  (omitted)
   _subpop_3 |   2.073338   .8704021      .3616581    3.7850
> 17
   _subpop_4 |   8.108861   2.331398      3.524077    12.693
> 65
   _subpop_5 |   1.557001   .3631809      .8427912     2.271
> 21
   _subpop_6 |     2.0472   .5257622      1.013268    3.0811
> 32
   _subpop_7 |   10.59611   1.202493      8.231358    12.960
> 86
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex1      |
     Central |   15.27065   2.053504      11.23235    19.308
> 94
     Eastern |   13.54232   1.833618       9.93644     17.14
> 82
    Northern |   18.11416   3.074332      12.06837    24.159
> 96
     Western |   49.56343   3.964573      41.76694    57.359
> 91
-------------+----------------------------------------------
> --
pg_flex1     |
     Central |   7.966702   1.689763      4.643717    11.289
> 69
     Eastern |   3.446091   .6087891      2.248884    4.6432
> 99
    Northern |    4.86859   1.036418      2.830434    6.9067
> 46
     Western |   19.02428   1.776225      15.53126    22.517
> 29
-------------+----------------------------------------------
> --
spg_flex1    |
     Central |   5.913721   1.596213      2.774705    9.0527
> 36
     Eastern |   1.493224   .3375891      .8293424    2.1571
> 06
    Northern |   1.896842   .4735611      .9655655    2.8281
> 18
     Western |   10.03728   1.126238      7.822491    12.252
> 07
------------------------------------------------------------
> --
rural was float now byte
spdomain was float now byte
news was float now byte
h_flex1 was float now byte
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_real_it1.dta saved

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
     h_flex1 |    2668  36669748.9    23.64991   42.50117   
>        0        100
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> foodshares_it1.dta saved
file /tmp/St09373.000002 saved
variable one does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

   relpoor2 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 1,380.1466       50.85       50.85
          1 | 1,333.8534       49.15      100.00
------------+-----------------------------------
      Total |      2,714      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> relpoor_it2.dta saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.76        0.76
          2 |          4        0.01        0.77
          3 |     36,833       99.23      100.00
------------+-----------------------------------
      Total |     37,120      100.00
(2999 observations deleted)
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |         61        0.18        0.18
          3 |     34,121       99.82      100.00
------------+-----------------------------------
      Total |     34,182      100.00
(21874 observations deleted)
(12 missing values generated)
   12
    0
(12 missing values generated)
   12
(12 observations deleted)
(note: file /tmp/St09373.00000a not found)
file /tmp/St09373.00000a saved
(note: file /tmp/St09373.00000b not found)
file /tmp/St09373.00000b saved
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     12,296      100.00      100.00
------------+-----------------------------------
      Total |     12,296      100.00
  139
(139 observations deleted)
file /tmp/St09373.00000a saved
42
42
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> codes_food_basket_flex_it2.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(779 observations deleted)
(note: file /tmp/St09373.00000c not found)
file /tmp/St09373.00000c saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.84        0.84
          2 |        110        0.33        1.16
          3 |     33,342       98.84      100.00
------------+-----------------------------------
      Total |     33,735      100.00
(110 observations deleted)
file /tmp/St09373.00000c saved
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,563       10.60       10.60
          2 |          1        0.00       10.60
          3 |     30,062       89.40      100.00
------------+-----------------------------------
      Total |     33,626      100.00
(3564 observations deleted)
(176 observations deleted)
(note: file /tmp/St09373.00000e not found)
file /tmp/St09373.00000e saved
product was float now int
unit was float now byte
food_cat was float now byte
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
bswt was float now byte
hhsize was long now byte
count was float now byte
descript was float now byte
numreg was double now byte
variable hhid does not uniquely identify observations in
    the master data
survquar was byte now float
spdomain was byte now float
(label lspdomain already defined)
(label lsurvquar already defined)
(label lbreg already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        156        0.52        0.52
          3 |     29,886       99.48      100.00
------------+-----------------------------------
      Total |     30,042      100.00
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     30,042      100.00      100.00
------------+-----------------------------------
      Total |     30,042      100.00
(18668 observations deleted)
(49 observations deleted)
(864 observations deleted)

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
    ratiotw2 |       159    1.273933    .4769103   .9606478 
>   4.342579
    ratiomw2 |       159    1.063712    .3428812    .354801 
>   3.280165
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          2        1.24        1.24
          3 |        159       98.76      100.00
------------+-----------------------------------
      Total |        161      100.00
    2
(2 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> price_unit_flex_it2.dta saved
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          5        3.05        3.05
          2 |         52       31.71       34.76
          3 |        107       65.24      100.00
------------+-----------------------------------
      Total |        164      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
104. |     157    Central          1 |
105. |     157    Eastern          1 |
106. |     157   Northern          1 |
107. |     157    Western          1 |
112. |       .    Central          1 |
     +-------------------------------+
(57 observations deleted)
variable product does not uniquely identify observations
    in the master data
(note: descript is str26 in using data but will be float now
> )

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          4        3.03        3.03
          2 |         25       18.94       21.97
          3 |        103       78.03      100.00
------------+-----------------------------------
      Total |        132      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
104. |     162   Northern          1 |
105. |     166    Western          1 |
106. |     171    Central          1 |
107. |     171    Eastern          1 |
     +-------------------------------+
(29 observations deleted)

------------------------------------------------------------
-> spdomain = Central
    0
------------------------------------------------------------
-> spdomain = Eastern
    0
------------------------------------------------------------
-> spdomain = Northern
    1
------------------------------------------------------------
-> spdomain = Western
    0

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        bswt |       103    88.76699    68.02064          8 
>        347
(1 observation deleted)
(0 observations deleted)

Summary for variables: baskshr
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        26  .7543513         0  .7543513  .7543513
 Eastern |        28  .8891392         0  .8891392  .8891392
Northern |        26  .8495657         0  .8495657  .8495657
 Western |        22  .8796476         0  .8796476  .8796476
---------+--------------------------------------------------
   Total |       102  .8426469  .0540064  .7543513  .8891392
------------------------------------------------------------
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |        102      100.00      100.00
------------+-----------------------------------
      Total |        102      100.00
(102 real changes made)
(97 real changes made)
(102 real changes made)

Summary for variables: chkcal
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        26  .0000385         0  .0000385  .0000385
 Eastern |        28 -.0000899         0 -.0000899 -.0000899
Northern |        26 -.0000578         0 -.0000578 -.0000578
 Western |        22  6.42e-06         0  6.42e-06  6.42e-06
---------+--------------------------------------------------
   Total |       102 -.0000282  .0000519 -.0000899  .0000385
------------------------------------------------------------
(102 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> quan_flex_it2.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povline_food_flex_it2.dta saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(268 real changes made)
(3 missing values generated)
(note: file /tmp/St09373.00000g not found)
file /tmp/St09373.00000g saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(9 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines_it2.dta saved
variable spdomain does not uniquely identify observations
    in the master data
variable spdomain does not uniquely identify observations
    in
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
    > /povlines_it2.dta
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(49 missing values generated)
(9 missing values generated)
(9 missing values generated)
(49 missing values generated)
(2708 real changes made)
(9 missing values generated)
(2658 real changes made)

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
      cr_it2 |    2668  36669748.9    1891.771   2703.455   
>        0   75077.99
     linpob2 |    2707    37257099    830.8208   300.3522   
> 519.7867   1297.331
    linpobr2 |    2707    37257099    778.2963          0   
> 778.2963   778.2963
(9 missing values generated)
(2156 missing values generated)
(2107 real changes made)
(49 missing values generated)
(2107 real changes made)
(49 missing values generated)
(2107 real changes made)
(49 missing values generated)
(49 missing values generated)
(49 missing values generated)
(3 missing values generated)

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
     h_flex2 |   23.46473   1.484528      20.54535    26.384
> 12
    pg_flex2 |   8.682104   .7163892      7.273297    10.090
> 91
   spg_flex2 |   4.822269   .5411934      3.757992    5.8865
> 47
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex2      |
           0 |   5.895466   1.328455      3.283008    8.5079
> 23
           1 |   26.58746    1.72154      23.20199    29.972
> 94
-------------+----------------------------------------------
> --
pg_flex2     |
           0 |   2.452433   .6948534      1.085976    3.8188
> 89
           1 |   9.789354    .830575      8.155996    11.422
> 71
-------------+----------------------------------------------
> --
spg_flex2    |
           0 |   1.481267   .5720976      .3562151    2.6063
> 19
           1 |   5.416093   .6271326      4.182812    6.6493
> 73
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex2      |
     Kampala |   3.383183    1.79719     -.1510616    6.9174
> 27
   _subpop_2 |   7.261196   1.795119      3.731025    10.791
> 37
   _subpop_3 |   20.35901   2.910631      14.63514    26.082
> 87
   _subpop_4 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_5 |   18.52163   3.373151       11.8882    25.155
> 07
   _subpop_6 |   53.04413   4.081565      45.01757    61.070
> 68
-------------+----------------------------------------------
> --
pg_flex2     |
     Kampala |   1.049098   .7290153     -.3845392    2.4827
> 34
   _subpop_2 |   3.223425   .9982337       1.26036    5.1864
> 91
   _subpop_3 |   10.75149   2.445889       5.94156    15.561
> 43
   _subpop_4 |    3.54864   .6493338        2.2717     4.825
> 58
   _subpop_5 |    4.89614   1.102333      2.728359    7.0639
> 21
   _subpop_6 |   20.34539   1.898347      16.61222    24.078
> 56
-------------+----------------------------------------------
> --
spg_flex2    |
     Kampala |   .4316874   .3381693     -.2333358     1.096
> 71
   _subpop_2 |   2.061312   .8690742      .3522437     3.770
> 38
   _subpop_3 |   8.007222   2.328134      3.428856    12.585
> 59
   _subpop_4 |   1.537945   .3607547      .8285073    2.2473
> 83
   _subpop_5 |    1.91363   .4997576      .9308378    2.8964
> 23
   _subpop_6 |   10.77063   1.212722      8.385764    13.155
> 49
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

         Over: strata rural
    _subpop_1: Kampala 0
    _subpop_2: Kampala 1
    _subpop_3: Other Urban 0
    _subpop_4: Central rural 1
    _subpop_5: East rural 1
    _subpop_6: North rural 1
    _subpop_7: West rural 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex2      |
   _subpop_1 |   3.441819    1.82805     -.1531124     7.036
> 75
   _subpop_2 |          0  (omitted)
   _subpop_3 |   7.261196   1.795119      3.731025    10.791
> 37
   _subpop_4 |   20.35901   2.910631      14.63514    26.082
> 87
   _subpop_5 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_6 |   18.52163   3.373151       11.8882    25.155
> 07
   _subpop_7 |   53.04413   4.081565      45.01757    61.070
> 68
-------------+----------------------------------------------
> --
pg_flex2     |
   _subpop_1 |    1.06728   .7415906     -.3910864    2.5256
> 47
   _subpop_2 |          0  (omitted)
   _subpop_3 |   3.223425   .9982337       1.26036    5.1864
> 91
   _subpop_4 |   10.75149   2.445889       5.94156    15.561
> 43
   _subpop_5 |    3.54864   .6493338        2.2717     4.825
> 58
   _subpop_6 |    4.89614   1.102333      2.728359    7.0639
> 21
   _subpop_7 |   20.34539   1.898347      16.61222    24.078
> 56
-------------+----------------------------------------------
> --
spg_flex2    |
   _subpop_1 |   .4391692    .344002      -.237324    1.1156
> 63
   _subpop_2 |          0  (omitted)
   _subpop_3 |   2.061312   .8690742      .3522437     3.770
> 38
   _subpop_4 |   8.007222   2.328134      3.428856    12.585
> 59
   _subpop_5 |   1.537945   .3607547      .8285073    2.2473
> 83
   _subpop_6 |    1.91363   .4997576      .9308378    2.8964
> 23
   _subpop_7 |   10.77063   1.212722      8.385764    13.155
> 49
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex2      |
     Central |   14.73632   2.043359      10.71798    18.754
> 67
     Eastern |   13.16495   1.773616      9.677062    16.652
> 83
    Northern |   17.47113   3.056913       11.4596    23.482
> 67
     Western |     50.422   3.887479      42.77712    58.066
> 87
-------------+----------------------------------------------
> --
pg_flex2     |
     Central |   7.833711    1.68755      4.515078    11.152
> 34
     Eastern |   3.399745   .6042793      2.211407    4.5880
> 84
    Northern |   4.587576   .9951747      2.630526    6.5446
> 26
     Western |   19.30861   1.790407       15.7877    22.829
> 51
-------------+----------------------------------------------
> --
spg_flex2    |
     Central |   5.839828   1.593516      2.706117    8.9735
> 39
     Eastern |   1.474986    .335329      .8155489    2.1344
> 24
    Northern |   1.770684   .4500651      .8856131    2.6557
> 54
     Western |   10.20325    1.13604       7.96918    12.437
> 31
------------------------------------------------------------
> --
rural was float now byte
spdomain was float now byte
news was float now byte
h_flex2 was float now byte
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_real_it2.dta saved

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
     h_flex2 |    2668  36669748.9    23.46473   42.38576   
>        0        100
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> foodshares_it2.dta saved
file /tmp/St09373.000002 saved
variable one does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

   relpoor3 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 1,380.6454       50.87       50.87
          1 | 1,333.3546       49.13      100.00
------------+-----------------------------------
      Total |      2,714      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> relpoor_it3.dta saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.76        0.76
          2 |          4        0.01        0.77
          3 |     36,833       99.23      100.00
------------+-----------------------------------
      Total |     37,120      100.00
(2999 observations deleted)
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |         61        0.18        0.18
          3 |     34,121       99.82      100.00
------------+-----------------------------------
      Total |     34,182      100.00
(21914 observations deleted)
(12 missing values generated)
   12
    0
(12 missing values generated)
   12
(12 observations deleted)
(note: file /tmp/St09373.00000h not found)
file /tmp/St09373.00000h saved
(note: file /tmp/St09373.00000i not found)
file /tmp/St09373.00000i saved
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     12,256      100.00      100.00
------------+-----------------------------------
      Total |     12,256      100.00
  138
(138 observations deleted)
file /tmp/St09373.00000h saved
42
42
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> codes_food_basket_flex_it3.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(779 observations deleted)
(note: file /tmp/St09373.00000j not found)
file /tmp/St09373.00000j saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.84        0.84
          2 |        110        0.33        1.16
          3 |     33,342       98.84      100.00
------------+-----------------------------------
      Total |     33,735      100.00
(110 observations deleted)
file /tmp/St09373.00000j saved
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,563       10.60       10.60
          2 |          1        0.00       10.60
          3 |     30,062       89.40      100.00
------------+-----------------------------------
      Total |     33,626      100.00
(3564 observations deleted)
(176 observations deleted)
(note: file /tmp/St09373.00000l not found)
file /tmp/St09373.00000l saved
product was float now int
unit was float now byte
food_cat was float now byte
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
bswt was float now byte
hhsize was long now byte
count was float now byte
descript was float now byte
numreg was double now byte
variable hhid does not uniquely identify observations in
    the master data
survquar was byte now float
spdomain was byte now float
(label lspdomain already defined)
(label lsurvquar already defined)
(label lbreg already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        156        0.52        0.52
          3 |     29,886       99.48      100.00
------------+-----------------------------------
      Total |     30,042      100.00
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     30,042      100.00      100.00
------------+-----------------------------------
      Total |     30,042      100.00
(18708 observations deleted)
(49 observations deleted)
(852 observations deleted)

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
    ratiotw3 |       159    1.272657     .473197   .9606478 
>   4.342579
    ratiomw3 |       159    1.063585    .3362606    .354801 
>   3.071779
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          2        1.24        1.24
          3 |        159       98.76      100.00
------------+-----------------------------------
      Total |        161      100.00
    2
(2 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> price_unit_flex_it3.dta saved
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          5        3.05        3.05
          2 |         51       31.10       34.15
          3 |        108       65.85      100.00
------------+-----------------------------------
      Total |        164      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
105. |     157    Central          1 |
106. |     157    Eastern          1 |
107. |     157   Northern          1 |
108. |     157    Western          1 |
113. |       .    Central          1 |
     +-------------------------------+
(56 observations deleted)
variable product does not uniquely identify observations
    in the master data
(note: descript is str26 in using data but will be float now
> )

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          4        3.01        3.01
          2 |         25       18.80       21.80
          3 |        104       78.20      100.00
------------+-----------------------------------
      Total |        133      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
105. |     162   Northern          1 |
106. |     166    Western          1 |
107. |     171    Central          1 |
108. |     171    Eastern          1 |
     +-------------------------------+
(29 observations deleted)

------------------------------------------------------------
-> spdomain = Central
    0
------------------------------------------------------------
-> spdomain = Eastern
    0
------------------------------------------------------------
-> spdomain = Northern
    1
------------------------------------------------------------
-> spdomain = Western
    0

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        bswt |       104    88.30769    67.94402          8 
>        353
(1 observation deleted)
(0 observations deleted)

Summary for variables: baskshr
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        26  .7522156         0  .7522156  .7522156
 Eastern |        28  .8891392         0  .8891392  .8891392
Northern |        26  .8488881         0  .8488881  .8488881
 Western |        23  .8856661         0  .8856661  .8856661
---------+--------------------------------------------------
   Total |       103  .8436399  .0557148  .7522156  .8891392
------------------------------------------------------------
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |        103      100.00      100.00
------------+-----------------------------------
      Total |        103      100.00
(103 real changes made)
(98 real changes made)
(103 real changes made)

Summary for variables: chkcal
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        26  .0000385         0  .0000385  .0000385
 Eastern |        28 -.0000899         0 -.0000899 -.0000899
Northern |        26 -.0000578         0 -.0000578 -.0000578
 Western |        23  6.42e-06         0  6.42e-06  6.42e-06
---------+--------------------------------------------------
   Total |       103 -.0000279  .0000517 -.0000899  .0000385
------------------------------------------------------------
(103 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> quan_flex_it3.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povline_food_flex_it3.dta saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(256 real changes made)
(3 missing values generated)
(note: file /tmp/St09373.00000n not found)
file /tmp/St09373.00000n saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(9 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines_it3.dta saved
variable spdomain does not uniquely identify observations
    in the master data
variable spdomain does not uniquely identify observations
    in
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
    > /povlines_it3.dta
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(49 missing values generated)
(9 missing values generated)
(9 missing values generated)
(49 missing values generated)
(2708 real changes made)
(9 missing values generated)
(2658 real changes made)

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
      cr_it3 |    2668  36669748.9    1891.771   2672.085   
>        0   73915.55
     linpob3 |    2707    37257099    813.7582   276.3598   
> 512.0205   1226.501
    linpobr3 |    2707    37257099    772.4415   .0000255   
> 772.4415   772.4415
(9 missing values generated)
(2176 missing values generated)
(2127 real changes made)
(49 missing values generated)
(2127 real changes made)
(49 missing values generated)
(2127 real changes made)
(49 missing values generated)
(49 missing values generated)
(49 missing values generated)
(3 missing values generated)

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
     h_flex3 |   22.56164   1.483364      19.64455    25.478
> 74
    pg_flex3 |   8.256578   .6956653      6.888525    9.6246
> 31
   spg_flex3 |   4.577568   .5326478      3.530096    5.6250
> 41
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex3      |
           0 |   6.148591   1.317131      3.558402    8.7387
> 81
           1 |   25.47887   1.720729      22.09499    28.862
> 75
-------------+----------------------------------------------
> --
pg_flex3     |
           0 |   2.384391   .6881624      1.031093    3.7376
> 89
           1 |   9.300289   .8065614      7.714155    10.886
> 42
-------------+----------------------------------------------
> --
spg_flex3    |
           0 |   1.444826   .5709177      .3220942    2.5675
> 58
           1 |   5.134376   .6171825      3.920662    6.3480
> 89
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex3      |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   7.496852   1.764243        4.0274     10.96
> 63
   _subpop_3 |    20.8093    2.92784      15.05158    26.567
> 01
   _subpop_4 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_5 |   18.34788   3.374896      11.71101    24.984
> 74
   _subpop_6 |   48.59244   4.152588      40.42622    56.758
> 67
-------------+----------------------------------------------
> --
pg_flex3     |
     Kampala |   1.069942   .7360083     -.3774464    2.5173
> 31
   _subpop_2 |   3.105708   .9855654      1.167556    5.0438
> 61
   _subpop_3 |   10.82979   2.446927      6.017812    15.641
> 77
   _subpop_4 |   3.548639   .6493337      2.271699    4.8255
> 79
   _subpop_5 |   4.690741   1.070535      2.585493    6.7959
> 89
   _subpop_6 |   18.59755   1.806079      15.04582    22.149
> 27
-------------+----------------------------------------------
> --
spg_flex3    |
     Kampala |   .4417182   .3444119     -.2355812    1.1190
> 18
   _subpop_2 |   1.998907   .8664981      .2949046    3.7029
> 09
   _subpop_3 |    8.05169   2.329584      3.470473    12.632
> 91
   _subpop_4 |   1.537945   .3607546      .8285071    2.2473
> 83
   _subpop_5 |   1.825594   .4823005      .8771312    2.7740
> 56
   _subpop_6 |   9.736598   1.151714      7.471708    12.001
> 49
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

         Over: strata rural
    _subpop_1: Kampala 0
    _subpop_2: Kampala 1
    _subpop_3: Other Urban 0
    _subpop_4: Central rural 1
    _subpop_5: East rural 1
    _subpop_6: North rural 1
    _subpop_7: West rural 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex3      |
   _subpop_1 |    3.72633   1.839651       .108586    7.3440
> 74
   _subpop_2 |          0  (omitted)
   _subpop_3 |   7.496852   1.764243        4.0274     10.96
> 63
   _subpop_4 |    20.8093    2.92784      15.05158    26.567
> 01
   _subpop_5 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_6 |   18.34788   3.374896      11.71101    24.984
> 74
   _subpop_7 |   48.59244   4.152588      40.42622    56.758
> 67
-------------+----------------------------------------------
> --
pg_flex3     |
   _subpop_1 |   1.088486   .7487031     -.3838674     2.560
> 84
   _subpop_2 |          0  (omitted)
   _subpop_3 |   3.105708   .9855654      1.167556    5.0438
> 61
   _subpop_4 |   10.82979   2.446927      6.017812    15.641
> 77
   _subpop_5 |   3.548639   .6493337      2.271699    4.8255
> 79
   _subpop_6 |   4.690741   1.070535      2.585493    6.7959
> 89
   _subpop_7 |   18.59755   1.806079      15.04582    22.149
> 27
-------------+----------------------------------------------
> --
spg_flex3    |
   _subpop_1 |    .449374   .3503522     -.2396073    1.1383
> 55
   _subpop_2 |          0  (omitted)
   _subpop_3 |   1.998907   .8664981      .2949046    3.7029
> 09
   _subpop_4 |    8.05169   2.329584      3.470473    12.632
> 91
   _subpop_5 |   1.537945   .3607546      .8285071    2.2473
> 83
   _subpop_6 |   1.825594   .4823005      .8771312    2.7740
> 56
   _subpop_7 |   9.736598   1.151714      7.471708    12.001
> 49
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex3      |
     Central |   15.27065   2.053504      11.23235    19.308
> 94
     Eastern |   13.16495   1.773616      9.677062    16.652
> 83
    Northern |   17.27434   3.057664      11.26132    23.287
> 35
     Western |   46.21323   3.947633      38.45005     53.97
> 64
-------------+----------------------------------------------
> --
pg_flex3     |
     Central |   7.891762   1.688567      4.571131    11.212
> 39
     Eastern |   3.399745   .6042792      2.211406    4.5880
> 83
    Northern |   4.393701   .9663375      2.493361    6.2940
> 41
     Western |   17.64334   1.700857      14.29854    20.988
> 14
-------------+----------------------------------------------
> --
spg_flex3    |
     Central |   5.872146   1.594711      2.736085    9.0082
> 07
     Eastern |   1.474986    .335329      .8155487    2.1344
> 24
    Northern |   1.687535   .4342967      .8334742    2.5415
> 97
     Western |    9.22007   1.077631      7.100867    11.339
> 27
------------------------------------------------------------
> --
rural was float now byte
spdomain was float now byte
news was float now byte
h_flex3 was float now byte
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_real_it3.dta saved

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
     h_flex3 |    2668  36669748.9    22.56164    41.8066   
>        0        100
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> foodshares_it3.dta saved
file /tmp/St09373.000002 saved
variable one does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

   relpoor4 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 1,380.6587       50.87       50.87
          1 | 1,333.3413       49.13      100.00
------------+-----------------------------------
      Total |      2,714      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> relpoor_it4.dta saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.76        0.76
          2 |          4        0.01        0.77
          3 |     36,833       99.23      100.00
------------+-----------------------------------
      Total |     37,120      100.00
(2999 observations deleted)
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |         61        0.18        0.18
          3 |     34,121       99.82      100.00
------------+-----------------------------------
      Total |     34,182      100.00
(21793 observations deleted)
(11 missing values generated)
   11
    0
(11 missing values generated)
   11
(11 observations deleted)
(note: file /tmp/St09373.00000o not found)
file /tmp/St09373.00000o saved
(note: file /tmp/St09373.00000p not found)
file /tmp/St09373.00000p saved
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     12,378      100.00      100.00
------------+-----------------------------------
      Total |     12,378      100.00
  137
(137 observations deleted)
file /tmp/St09373.00000o saved
42
42
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> codes_food_basket_flex_it4.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(779 observations deleted)
(note: file /tmp/St09373.00000q not found)
file /tmp/St09373.00000q saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.84        0.84
          2 |        110        0.33        1.16
          3 |     33,342       98.84      100.00
------------+-----------------------------------
      Total |     33,735      100.00
(110 observations deleted)
file /tmp/St09373.00000q saved
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,563       10.60       10.60
          2 |          1        0.00       10.60
          3 |     30,062       89.40      100.00
------------+-----------------------------------
      Total |     33,626      100.00
(3564 observations deleted)
(176 observations deleted)
(note: file /tmp/St09373.00000s not found)
file /tmp/St09373.00000s saved
product was float now int
unit was float now byte
food_cat was float now byte
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
bswt was float now byte
hhsize was long now byte
count was float now byte
descript was float now byte
numreg was double now byte
variable hhid does not uniquely identify observations in
    the master data
survquar was byte now float
spdomain was byte now float
(label lspdomain already defined)
(label lsurvquar already defined)
(label lbreg already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        156        0.52        0.52
          3 |     29,886       99.48      100.00
------------+-----------------------------------
      Total |     30,042      100.00
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     30,042      100.00      100.00
------------+-----------------------------------
      Total |     30,042      100.00
(18599 observations deleted)
(49 observations deleted)
(868 observations deleted)

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
    ratiotw4 |       159     1.27082     .469792   .9606478 
>   4.342579
    ratiomw4 |       159    1.059297    .3381764    .354801 
>   3.145106
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          2        1.24        1.24
          3 |        159       98.76      100.00
------------+-----------------------------------
      Total |        161      100.00
    2
(2 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> price_unit_flex_it4.dta saved
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          5        3.05        3.05
          2 |         50       30.49       33.54
          3 |        109       66.46      100.00
------------+-----------------------------------
      Total |        164      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
106. |     157    Central          1 |
107. |     157    Eastern          1 |
108. |     157   Northern          1 |
109. |     157    Western          1 |
114. |       .    Central          1 |
     +-------------------------------+
(55 observations deleted)
variable product does not uniquely identify observations
    in the master data
(note: descript is str26 in using data but will be float now
> )

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          4        2.99        2.99
          2 |         25       18.66       21.64
          3 |        105       78.36      100.00
------------+-----------------------------------
      Total |        134      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
106. |     162   Northern          1 |
107. |     166    Western          1 |
108. |     171    Central          1 |
109. |     171    Eastern          1 |
     +-------------------------------+
(29 observations deleted)

------------------------------------------------------------
-> spdomain = Central
    0
------------------------------------------------------------
-> spdomain = Eastern
    0
------------------------------------------------------------
-> spdomain = Northern
    1
------------------------------------------------------------
-> spdomain = Western
    0

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        bswt |       105     88.7619     67.9715          8 
>        338
(1 observation deleted)
(0 observations deleted)

Summary for variables: baskshr
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        27  .7580781         0  .7580781  .7580781
 Eastern |        28  .8892832         0  .8892832  .8892832
Northern |        26   .849073         0   .849073   .849073
 Western |        23  .8855474         0  .8855474  .8855474
---------+--------------------------------------------------
   Total |       104  .8443416  .0537076  .7580781  .8892832
------------------------------------------------------------
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |        104      100.00      100.00
------------+-----------------------------------
      Total |        104      100.00
(104 real changes made)
(99 real changes made)
(104 real changes made)

Summary for variables: chkcal
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        27  .0000385         0  .0000385  .0000385
 Eastern |        28  .0000385         0  .0000385  .0000385
Northern |        26 -.0000578         0 -.0000578 -.0000578
 Western |        23  6.42e-06         0  6.42e-06  6.42e-06
---------+--------------------------------------------------
   Total |       104  7.35e-06  .0000399 -.0000578  .0000385
------------------------------------------------------------
(104 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> quan_flex_it4.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povline_food_flex_it4.dta saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(258 real changes made)
(3 missing values generated)
(note: file /tmp/St09373.00000u not found)
file /tmp/St09373.00000u saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(9 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines_it4.dta saved
variable spdomain does not uniquely identify observations
    in the master data
variable spdomain does not uniquely identify observations
    in
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
    > /povlines_it4.dta
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(49 missing values generated)
(9 missing values generated)
(9 missing values generated)
(49 missing values generated)
(2708 real changes made)
(9 missing values generated)
(2658 real changes made)

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
      cr_it4 |    2668  36669748.9    1891.771   2674.033   
>        0   74028.79
     linpob4 |    2707    37257099    809.8062   270.9035   
> 512.8976   1213.094
    linpobr4 |    2707    37257099    770.6135   .0000268   
> 770.6135   770.6135
(9 missing values generated)
(2180 missing values generated)
(2131 real changes made)
(49 missing values generated)
(2131 real changes made)
(49 missing values generated)
(2131 real changes made)
(49 missing values generated)
(49 missing values generated)
(49 missing values generated)
(3 missing values generated)

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
     h_flex4 |   22.40565   1.484358       19.4866     25.32
> 47
    pg_flex4 |    8.18005   .6921756      6.818859     9.541
> 24
   spg_flex4 |   4.531959   .5310763      3.487577    5.5763
> 42
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex4      |
           0 |   6.148591   1.317131      3.558402    8.7387
> 81
           1 |   25.29515   1.722277      21.90822    28.682
> 07
-------------+----------------------------------------------
> --
pg_flex4     |
           0 |   2.367998   .6866221      1.017729    3.7182
> 67
           1 |   9.213072   .8025368      7.634853    10.791
> 29
-------------+----------------------------------------------
> --
spg_flex4    |
           0 |   1.436298   .5701191      .3151367     2.557
> 46
           1 |   5.082176   .6153694      3.872028    6.2923
> 24
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex4      |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   7.496852   1.764243        4.0274     10.96
> 63
   _subpop_3 |   20.35901   2.910631      14.63514    26.082
> 87
   _subpop_4 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_5 |   18.34788   3.374896      11.71101    24.984
> 74
   _subpop_6 |   48.25633   4.179903      40.03639    56.476
> 27
-------------+----------------------------------------------
> --
pg_flex4     |
     Kampala |    1.05981   .7326224     -.3809203    2.5005
> 41
   _subpop_2 |   3.085927   .9838232      1.151201    5.0206
> 54
   _subpop_3 |   10.79131   2.446472       5.98023     15.60
> 24
   _subpop_4 |   3.553576   .6498072      2.275705    4.8314
> 47
   _subpop_5 |   4.714096   1.074165      2.601708    6.8264
> 83
   _subpop_6 |   18.26828   1.788058      14.75199    21.784
> 56
-------------+----------------------------------------------
> --
spg_flex4    |
     Kampala |   .4368384   .3413877     -.2345138    1.1081
> 91
   _subpop_2 |   1.988396   .8656141      .2861319    3.6906
> 59
   _subpop_3 |   8.030087   2.328884      3.450247    12.609
> 93
   _subpop_4 |   1.539868       .361      .8299474    2.2497
> 88
   _subpop_5 |   1.835425   .4842637      .8831014    2.7877
> 48
   _subpop_6 |   9.543291   1.140185      7.301073    11.785
> 51
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

         Over: strata rural
    _subpop_1: Kampala 0
    _subpop_2: Kampala 1
    _subpop_3: Other Urban 0
    _subpop_4: Central rural 1
    _subpop_5: East rural 1
    _subpop_6: North rural 1
    _subpop_7: West rural 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex4      |
   _subpop_1 |    3.72633   1.839651       .108586    7.3440
> 74
   _subpop_2 |          0  (omitted)
   _subpop_3 |   7.496852   1.764243        4.0274     10.96
> 63
   _subpop_4 |   20.35901   2.910631      14.63514    26.082
> 87
   _subpop_5 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_6 |   18.34788   3.374896      11.71101    24.984
> 74
   _subpop_7 |   48.25633   4.179903      40.03639    56.476
> 27
-------------+----------------------------------------------
> --
pg_flex4     |
   _subpop_1 |   1.078178   .7452594     -.3874031     2.543
> 76
   _subpop_2 |          0  (omitted)
   _subpop_3 |   3.085927   .9838232      1.151201    5.0206
> 54
   _subpop_4 |   10.79131   2.446472       5.98023     15.60
> 24
   _subpop_5 |   3.553576   .6498072      2.275705    4.8314
> 47
   _subpop_6 |   4.714096   1.074165      2.601708    6.8264
> 83
   _subpop_7 |   18.26828   1.788058      14.75199    21.784
> 56
-------------+----------------------------------------------
> --
spg_flex4    |
   _subpop_1 |   .4444095   .3472758     -.2385219    1.1273
> 41
   _subpop_2 |          0  (omitted)
   _subpop_3 |   1.988396   .8656141      .2861319    3.6906
> 59
   _subpop_4 |   8.030087   2.328884      3.450247    12.609
> 93
   _subpop_5 |   1.539868       .361      .8299474    2.2497
> 88
   _subpop_6 |   1.835425   .4842637      .8831014    2.7877
> 48
   _subpop_7 |   9.543291   1.140185      7.301073    11.785
> 51
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex4      |
     Central |   14.97346   2.038533       10.9646    18.982
> 31
     Eastern |   13.16495   1.773616      9.677062    16.652
> 83
    Northern |   17.27434   3.057664      11.26132    23.287
> 35
     Western |   45.90104   3.971065      38.09179     53.71
> 03
-------------+----------------------------------------------
> --
pg_flex4     |
     Central |   7.863271     1.6881      4.543558    11.182
> 98
     Eastern |   3.404409   .6047208      2.215203    4.5936
> 16
    Northern |   4.415728     .96963      2.508913    6.3225
> 43
     Western |   17.32966   1.683372      14.01925    20.640
> 08
-------------+----------------------------------------------
> --
spg_flex4    |
     Central |   5.856443   1.594133      2.721518    8.9913
> 68
     Eastern |   1.476827   .3355575      .8169399    2.1367
> 14
    Northern |   1.696821   .4360698      .8392726    2.5543
> 69
     Western |   9.036318   1.066609      6.938789    11.133
> 85
------------------------------------------------------------
> --
rural was float now byte
spdomain was float now byte
news was float now byte
h_flex4 was float now byte
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_real_it4.dta saved

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
     h_flex4 |    2668  36669748.9    22.40565   41.70376   
>        0        100
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> foodshares_it4.dta saved
file /tmp/St09373.000002 saved
variable one does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00

   relpoor5 |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 | 1,380.6074       50.87       50.87
          1 | 1,333.3926       49.13      100.00
------------+-----------------------------------
      Total |      2,714      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> relpoor_it5.dta saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.76        0.76
          2 |          4        0.01        0.77
          3 |     36,833       99.23      100.00
------------+-----------------------------------
      Total |     37,120      100.00
(2999 observations deleted)
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |         61        0.18        0.18
          3 |     34,121       99.82      100.00
------------+-----------------------------------
      Total |     34,182      100.00
(21756 observations deleted)
(11 missing values generated)
   11
    0
(11 missing values generated)
   11
(11 observations deleted)
(note: file /tmp/St09373.00000v not found)
file /tmp/St09373.00000v saved
(note: file /tmp/St09373.00000w not found)
file /tmp/St09373.00000w saved
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     12,415      100.00      100.00
------------+-----------------------------------
      Total |     12,415      100.00
  138
(138 observations deleted)
file /tmp/St09373.00000v saved
42
42
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> codes_food_basket_flex_it5.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(779 observations deleted)
(note: file /tmp/St09373.00000x not found)
file /tmp/St09373.00000x saved
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        283        0.84        0.84
          2 |        110        0.33        1.16
          3 |     33,342       98.84      100.00
------------+-----------------------------------
      Total |     33,735      100.00
(110 observations deleted)
file /tmp/St09373.00000x saved
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      3,563       10.60       10.60
          2 |          1        0.00       10.60
          3 |     30,062       89.40      100.00
------------+-----------------------------------
      Total |     33,626      100.00
(3564 observations deleted)
(176 observations deleted)
(note: file /tmp/St09373.000011 not found)
file /tmp/St09373.000011 saved
product was float now int
unit was float now byte
food_cat was float now byte
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
bswt was float now byte
hhsize was long now byte
count was float now byte
descript was float now byte
numreg was double now byte
variable hhid does not uniquely identify observations in
    the master data
survquar was byte now float
spdomain was byte now float
(label lspdomain already defined)
(label lsurvquar already defined)
(label lbreg already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |        156        0.52        0.52
          3 |     29,886       99.48      100.00
------------+-----------------------------------
      Total |     30,042      100.00
variable hhid does not uniquely identify observations in
    the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |     30,042      100.00      100.00
------------+-----------------------------------
      Total |     30,042      100.00
(18564 observations deleted)
(49 observations deleted)
(868 observations deleted)

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
    ratiotw5 |       159    1.267821    .4655784   .9606478 
>   4.342579
    ratiomw5 |       159    1.055872    .3424559    .354801 
>   3.145106
variable product does not uniquely identify observations
    in the master data
product was int now float

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          2        1.24        1.24
          3 |        159       98.76      100.00
------------+-----------------------------------
      Total |        161      100.00
    2
(2 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> price_unit_flex_it5.dta saved
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          5        3.05        3.05
          2 |         51       31.10       34.15
          3 |        108       65.85      100.00
------------+-----------------------------------
      Total |        164      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
105. |     157    Central          1 |
106. |     157    Eastern          1 |
107. |     157   Northern          1 |
108. |     157    Western          1 |
113. |       .    Central          1 |
     +-------------------------------+
(56 observations deleted)
variable product does not uniquely identify observations
    in the master data
(note: descript is str26 in using data but will be float now
> )

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          4        3.01        3.01
          2 |         25       18.80       21.80
          3 |        104       78.20      100.00
------------+-----------------------------------
      Total |        133      100.00

     +-------------------------------+
     | product   spdomain   descript |
     |-------------------------------|
105. |     162   Northern          1 |
106. |     166    Western          1 |
107. |     171    Central          1 |
108. |     171    Eastern          1 |
     +-------------------------------+
(29 observations deleted)

------------------------------------------------------------
-> spdomain = Central
    0
------------------------------------------------------------
-> spdomain = Eastern
    0
------------------------------------------------------------
-> spdomain = Northern
    1
------------------------------------------------------------
-> spdomain = Western
    0

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
        bswt |       104    89.31731    68.25854          8 
>        336
(1 observation deleted)
(0 observations deleted)

Summary for variables: baskshr
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        27  .7580781         0  .7580781  .7580781
 Eastern |        28  .8899734         0  .8899734  .8899734
Northern |        26    .84907         0    .84907    .84907
 Western |        22  .8798823         0  .8798823  .8798823
---------+--------------------------------------------------
   Total |       103  .8429184  .0530799  .7580781  .8899734
------------------------------------------------------------
variable spdomain does not uniquely identify observations
    in the master data

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |        103      100.00      100.00
------------+-----------------------------------
      Total |        103      100.00
(103 real changes made)
(98 real changes made)
(103 real changes made)

Summary for variables: chkcal
     by categories of: spdomain (Spatial domains: each with 
> own poverty line (they are 4))

spdomain |         N      mean        sd       min       max
---------+--------------------------------------------------
 Central |        27  .0000385         0  .0000385  .0000385
 Eastern |        28  .0000385         0  .0000385  .0000385
Northern |        26 -.0000578         0 -.0000578 -.0000578
 Western |        22  6.42e-06         0  6.42e-06  6.42e-06
---------+--------------------------------------------------
   Total |       103  7.36e-06  .0000401 -.0000578  .0000385
------------------------------------------------------------
(103 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> quan_flex_it5.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povline_food_flex_it5.dta saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(265 real changes made)
(3 missing values generated)
(note: file /tmp/St09373.000013 not found)
file /tmp/St09373.000013 saved
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(9 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines_it5.dta saved
variable spdomain does not uniquely identify observations
    in the master data
variable spdomain does not uniquely identify observations
    in
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
    > /povlines_it5.dta
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      2,717      100.00      100.00
------------+-----------------------------------
      Total |      2,717      100.00
(49 missing values generated)
(9 missing values generated)
(9 missing values generated)
(49 missing values generated)
(2708 real changes made)
(9 missing values generated)
(2658 real changes made)

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
      cr_it5 |    2668  36669748.9    1891.771   2691.701   
>        0   74589.24
     linpob5 |    2707    37257099    827.7227   297.9553   
> 513.5631   1286.419
    linpobr5 |    2707    37257099    776.4476          0   
> 776.4476   776.4476
(9 missing values generated)
(2161 missing values generated)
(2112 real changes made)
(49 missing values generated)
(2112 real changes made)
(49 missing values generated)
(2112 real changes made)
(49 missing values generated)
(49 missing values generated)
(49 missing values generated)
(3 missing values generated)

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
     h_flex5 |   23.28027   1.495636      20.33904     26.22
> 15
    pg_flex5 |   8.591794   .7122129      7.191199    9.9923
> 88
   spg_flex5 |   4.774924    .539564      3.713851    5.8359
> 98
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex5      |
           0 |   6.265698   1.332923      3.644453    8.8869
> 42
           1 |   26.30441   1.735521      22.89144    29.717
> 38
-------------+----------------------------------------------
> --
pg_flex5     |
           0 |   2.437553   .6933775      1.073999    3.8011
> 07
           1 |   9.685636   .8257181       8.06183    11.309
> 44
-------------+----------------------------------------------
> --
spg_flex5    |
           0 |   1.473658    .572173      .3484578    2.5988
> 59
           1 |   5.361685   .6252209      4.132164    6.5912
> 06
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex5      |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   7.679141   1.790693      4.157673    11.200
> 61
   _subpop_3 |   20.35901   2.910631      14.63514    26.082
> 87
   _subpop_4 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_5 |   18.34788   3.374896      11.71101    24.984
> 74
   _subpop_6 |   52.11975   4.167259      43.92468    60.314
> 83
-------------+----------------------------------------------
> --
pg_flex5     |
     Kampala |    1.05981   .7326224     -.3809204     2.500
> 54
   _subpop_2 |   3.194198   .9949696      1.237552    5.1508
> 44
   _subpop_3 |   10.79131   2.446472      5.980229     15.60
> 24
   _subpop_4 |   3.545444   .6490274      2.269106    4.8217
> 81
   _subpop_5 |   4.731763   1.076914       2.61397    6.8495
> 56
   _subpop_6 |   20.06994   1.884981      16.36305    23.776
> 82
-------------+----------------------------------------------
> --
spg_flex5    |
     Kampala |   .4368384   .3413877     -.2345138     1.108
> 19
   _subpop_2 |   2.046551   .8688264      .3379699    3.7551
> 31
   _subpop_3 |   8.030087   2.328884      3.450247    12.609
> 93
   _subpop_4 |   1.536703    .360596      .8275766    2.2458
> 29
   _subpop_5 |   1.842903   .4857547      .8876478    2.7981
> 59
   _subpop_6 |   10.60985     1.2033      8.243514    12.976
> 19
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

         Over: strata rural
    _subpop_1: Kampala 0
    _subpop_2: Kampala 1
    _subpop_3: Other Urban 0
    _subpop_4: Central rural 1
    _subpop_5: East rural 1
    _subpop_6: North rural 1
    _subpop_7: West rural 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex5      |
   _subpop_1 |    3.72633   1.839651       .108586    7.3440
> 74
   _subpop_2 |          0  (omitted)
   _subpop_3 |   7.679141   1.790693      4.157673    11.200
> 61
   _subpop_4 |   20.35901   2.910631      14.63514    26.082
> 87
   _subpop_5 |   13.88355   1.903657      10.13994    17.627
> 17
   _subpop_6 |   18.34788   3.374896      11.71101    24.984
> 74
   _subpop_7 |   52.11975   4.167259      43.92468    60.314
> 83
-------------+----------------------------------------------
> --
pg_flex5     |
   _subpop_1 |   1.078178   .7452594     -.3874032     2.543
> 76
   _subpop_2 |          0  (omitted)
   _subpop_3 |   3.194198   .9949696      1.237552    5.1508
> 44
   _subpop_4 |   10.79131   2.446472      5.980229     15.60
> 24
   _subpop_5 |   3.545444   .6490274      2.269106    4.8217
> 81
   _subpop_6 |   4.731763   1.076914       2.61397    6.8495
> 56
   _subpop_7 |   20.06994   1.884981      16.36305    23.776
> 82
-------------+----------------------------------------------
> --
spg_flex5    |
   _subpop_1 |   .4444095   .3472758     -.2385219    1.1273
> 41
   _subpop_2 |          0  (omitted)
   _subpop_3 |   2.046551   .8688264      .3379699    3.7551
> 31
   _subpop_4 |   8.030087   2.328884      3.450247    12.609
> 93
   _subpop_5 |   1.536703    .360596      .8275766    2.2458
> 29
   _subpop_6 |   1.842903   .4857547      .8876478    2.7981
> 59
   _subpop_7 |   10.60985     1.2033      8.243514    12.976
> 19
------------------------------------------------------------
> --
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      26
> 68
Number of PSUs   =     368        Population size  =  366697
> 49
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_flex5      |
     Central |   14.97346   2.038533       10.9646    18.982
> 31
     Eastern |   13.16495   1.773616      9.677062    16.652
> 83
    Northern |   17.27434   3.057664      11.26132    23.287
> 35
     Western |   49.56343   3.964573      41.76694    57.359
> 91
-------------+----------------------------------------------
> --
pg_flex5     |
     Central |   7.863271     1.6881      4.543558    11.182
> 98
     Eastern |   3.396726   .6039936      2.208949    4.5845
> 02
    Northern |    4.43239   .9721226      2.520673    6.3441
> 07
     Western |   19.04646   1.777404      15.55113     22.54
> 18
-------------+----------------------------------------------
> --
spg_flex5    |
     Central |   5.856443   1.594133      2.721518    8.9913
> 68
     Eastern |   1.473797   .3351812      .8146499    2.1329
> 44
    Northern |   1.703884   .4374165      .8436878    2.5640
> 81
     Western |   10.05035   1.127011      7.834039    12.266
> 66
------------------------------------------------------------
> --
rural was float now byte
spdomain was float now byte
news was float now byte
h_flex5 was float now byte
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> cons_real_it5.dta saved

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
     h_flex5 |    2668  36669748.9    23.28027   42.26968   
>        0        100
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> foodshares_it5.dta saved

. **********************************************************
> ****************
> * Send results to one big csv-file
> **********************************************************
> ****************;
. use "$path/work/cons_real_it`lastpass'.dta", clear ;

.         gen dum=1;

.         collapse (mean) dum h_flex`lastpass' pg_flex`lastp
> ass' spg_flex`lastpass' [aw=popwt];

. gen geo="National";

. gen geono=dum;

. tempfile nat;

. save `nat';
file /tmp/St09373.000014 saved

.         use "$path/work/cons_real_it`lastpass'.dta", clear
>  ;

.         collapse (mean) h_flex`lastpass' pg_flex`lastpass'
>  spg_flex`lastpass' [aw=popwt], by(rural);

. gen geo="Rural/Urban";

. gen geono=rural;

. tempfile rur;

. save `rur';
file /tmp/St09373.000015 saved

. use "$path/work/cons_real_it`lastpass'.dta", clear ;

.         collapse (mean) h_flex`lastpass' pg_flex`lastpass'
>  spg_flex`lastpass' [aw=popwt], by(news);

. gen geo="North/Center/South";

. gen geono=news;
(1 missing value generated)

. tempfile new;

. save `new';
file /tmp/St09373.000016 saved

. use "$path/work/cons_real_it`lastpass'.dta", clear ;

.         collapse (mean) h_flex`lastpass' pg_flex`lastpass'
>  spg_flex`lastpass' [aw=popwt], by(reg_tpi);

. gen geo="TPI - 6 regions";

. gen geono=reg_tpi;

. tempfile rtp;

. save `rtp';
file /tmp/St09373.000017 saved

. use "$path/work/cons_real_it`lastpass'.dta", clear ;

.         collapse (mean) h_flex`lastpass' pg_flex`lastpass'
>  spg_flex`lastpass' [aw=popwt], by(strata);

. gen geo="Provinces";

. gen geono=strata;

. tempfile str;

. save `str';
file /tmp/St09373.000018 saved

. use "$path/work/cons_real_it`lastpass'.dta", clear ;

.         collapse (mean) h_flex`lastpass' pg_flex`lastpass'
>  spg_flex`lastpass' [aw=popwt], by(spdomain);

. gen geo="Spatial domains";

. gen geono=spdomain;
(1 missing value generated)

. tempfile r13;

. save `r13';
file /tmp/St09373.000019 saved

. clear;

. set obs 1;
obs was 0, now 1

. gen geo=" ";

. tempfile one;

. save `one';
file /tmp/St09373.00001a saved

. use          `nat';

. append using `one';

. append using `rur';
geo was str8 now str11

. append using `one';

. append using `new';
geo was str11 now str18

. append using `one';

. append using `rtp';

. append using `one';

. append using `str';

. append using `one';

. append using `r13';

. outsheet geo geono h_flex`lastpass' pg_flex`lastpass' spg_
> flex`lastpass' dum rural news reg_tpi strata spdomain usin
> g "$path/work/poverty_flexBask.csv", replace c;

. **********************************************************
> ****************
> * Convergence graph (based on 5 iterations)
> **********************************************************
> ****************;
. #delimit cr
delimiter now cr
. 
. clear

. set obs 1
obs was 0, now 1

. gen iteration=.
(1 missing value generated)

. tempfile converg

. save `converg'
file /tmp/St09373.00001b saved

. 
. forvalues X = 1/`maxit' {
  2.         use "$path/work/cons_real_it`X'.dta", clear
  3.         collapse (mean) h_flex`X' pg_flex`X' spg_flex`X
> ' [aw=popwt], by(strata)
  4.         rename h_flex`X' h_flex
  5.         rename pg_flex`X' pg_flex
  6.         rename spg_flex`X' spg_flex
  7.         gen iteration=`X'
  8.         order iteration
  9.         *sum
.         if `X' != 1     {
 10.                 append using `converg'
 11.                         }
 12.         save `converg', replace
 13.         }
file /tmp/St09373.00001b saved
(label strat already defined)
file /tmp/St09373.00001b saved
(label strat already defined)
file /tmp/St09373.00001b saved
(label strat already defined)
file /tmp/St09373.00001b saved
(label strat already defined)
file /tmp/St09373.00001b saved

. 
. use `converg', clear

. sum

    Variable |       Obs        Mean    Std. Dev.       Min 
>        Max
-------------+----------------------------------------------
> ----------
   iteration |        30           3     1.43839          1 
>          5
      strata |        30         3.5    1.737021          1 
>          6
      h_flex |        30     19.1732    15.60898   3.383183 
>   53.04413
     pg_flex |        30    7.154708     6.39157   1.049098 
>   20.34539
    spg_flex |        30    4.034297    3.776603   .4316874 
>   10.77063

. 
. twoway (connected h_flex iteration), by(, title(Convergenc
> e graph: Poverty rate. %) subtitle(After iterative procedu
> re)) by(strata)

. graph export "$path/work/converge_pov_rate.tif", replace
(file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
> /converge_pov_rate.tif written in TIFF format)

. 
. sort strata iteration

. 
. for var h_flex pg_flex spg_flex: replace X = round(X,0.01)

->  replace h_flex = round(h_flex,0.01)
(30 real changes made)

->  replace pg_flex = round(pg_flex,0.01)
(30 real changes made)

->  replace spg_flex = round(spg_flex,0.01)
(30 real changes made)

. 
. list strata iteration h_flex pg_flex spg_flex

     +---------------------------------------------+
  1. |        strata | iterat~n | h_flex | pg_flex |
     |       Kampala |        1 |   3.66 |     1.1 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                       .45                   |
     +---------------------------------------------+

     +---------------------------------------------+
  2. |        strata | iterat~n | h_flex | pg_flex |
     |       Kampala |        2 |   3.38 |    1.05 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                       .43                   |
     +---------------------------------------------+

     +---------------------------------------------+
  3. |        strata | iterat~n | h_flex | pg_flex |
     |       Kampala |        3 |   3.66 |    1.07 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                       .44                   |
     +---------------------------------------------+

     +---------------------------------------------+
  4. |        strata | iterat~n | h_flex | pg_flex |
     |       Kampala |        4 |   3.66 |    1.06 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                       .44                   |
     +---------------------------------------------+

     +---------------------------------------------+
  5. |        strata | iterat~n | h_flex | pg_flex |
     |       Kampala |        5 |   3.66 |    1.06 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                       .44                   |
     +---------------------------------------------+

     +---------------------------------------------+
  6. |        strata | iterat~n | h_flex | pg_flex |
     |   Other Urban |        1 |   7.77 |    3.25 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      2.07                   |
     +---------------------------------------------+

     +---------------------------------------------+
  7. |        strata | iterat~n | h_flex | pg_flex |
     |   Other Urban |        2 |   7.26 |    3.22 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      2.06                   |
     +---------------------------------------------+

     +---------------------------------------------+
  8. |        strata | iterat~n | h_flex | pg_flex |
     |   Other Urban |        3 |    7.5 |    3.11 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                         2                   |
     +---------------------------------------------+

     +---------------------------------------------+
  9. |        strata | iterat~n | h_flex | pg_flex |
     |   Other Urban |        4 |    7.5 |    3.09 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.99                   |
     +---------------------------------------------+

     +---------------------------------------------+
 10. |        strata | iterat~n | h_flex | pg_flex |
     |   Other Urban |        5 |   7.68 |    3.19 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      2.05                   |
     +---------------------------------------------+

     +---------------------------------------------+
 11. |        strata | iterat~n | h_flex | pg_flex |
     | Central rural |        1 |  20.81 |   10.93 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      8.11                   |
     +---------------------------------------------+

     +---------------------------------------------+
 12. |        strata | iterat~n | h_flex | pg_flex |
     | Central rural |        2 |  20.36 |   10.75 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      8.01                   |
     +---------------------------------------------+

     +---------------------------------------------+
 13. |        strata | iterat~n | h_flex | pg_flex |
     | Central rural |        3 |  20.81 |   10.83 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      8.05                   |
     +---------------------------------------------+

     +---------------------------------------------+
 14. |        strata | iterat~n | h_flex | pg_flex |
     | Central rural |        4 |  20.36 |   10.79 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      8.03                   |
     +---------------------------------------------+

     +---------------------------------------------+
 15. |        strata | iterat~n | h_flex | pg_flex |
     | Central rural |        5 |  20.36 |   10.79 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      8.03                   |
     +---------------------------------------------+

     +---------------------------------------------+
 16. |        strata | iterat~n | h_flex | pg_flex |
     |    East rural |        1 |  14.29 |     3.6 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.56                   |
     +---------------------------------------------+

     +---------------------------------------------+
 17. |        strata | iterat~n | h_flex | pg_flex |
     |    East rural |        2 |  13.88 |    3.55 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.54                   |
     +---------------------------------------------+

     +---------------------------------------------+
 18. |        strata | iterat~n | h_flex | pg_flex |
     |    East rural |        3 |  13.88 |    3.55 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.54                   |
     +---------------------------------------------+

     +---------------------------------------------+
 19. |        strata | iterat~n | h_flex | pg_flex |
     |    East rural |        4 |  13.88 |    3.55 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.54                   |
     +---------------------------------------------+

     +---------------------------------------------+
 20. |        strata | iterat~n | h_flex | pg_flex |
     |    East rural |        5 |  13.88 |    3.55 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.54                   |
     +---------------------------------------------+

     +---------------------------------------------+
 21. |        strata | iterat~n | h_flex | pg_flex |
     |   North rural |        1 |  19.24 |    5.19 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      2.05                   |
     +---------------------------------------------+

     +---------------------------------------------+
 22. |        strata | iterat~n | h_flex | pg_flex |
     |   North rural |        2 |  18.52 |     4.9 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.91                   |
     +---------------------------------------------+

     +---------------------------------------------+
 23. |        strata | iterat~n | h_flex | pg_flex |
     |   North rural |        3 |  18.35 |    4.69 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.83                   |
     +---------------------------------------------+

     +---------------------------------------------+
 24. |        strata | iterat~n | h_flex | pg_flex |
     |   North rural |        4 |  18.35 |    4.71 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.84                   |
     +---------------------------------------------+

     +---------------------------------------------+
 25. |        strata | iterat~n | h_flex | pg_flex |
     |   North rural |        5 |  18.35 |    4.73 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      1.84                   |
     +---------------------------------------------+

     +---------------------------------------------+
 26. |        strata | iterat~n | h_flex | pg_flex |
     |    West rural |        1 |  52.12 |   20.05 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      10.6                   |
     +---------------------------------------------+

     +---------------------------------------------+
 27. |        strata | iterat~n | h_flex | pg_flex |
     |    West rural |        2 |  53.04 |   20.35 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                     10.77                   |
     +---------------------------------------------+

     +---------------------------------------------+
 28. |        strata | iterat~n | h_flex | pg_flex |
     |    West rural |        3 |  48.59 |    18.6 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      9.74                   |
     +---------------------------------------------+

     +---------------------------------------------+
 29. |        strata | iterat~n | h_flex | pg_flex |
     |    West rural |        4 |  48.26 |   18.27 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                      9.54                   |
     +---------------------------------------------+

     +---------------------------------------------+
 30. |        strata | iterat~n | h_flex | pg_flex |
     |    West rural |        5 |  52.12 |   20.07 |
     |---------------------------------------------|
     |                  spg_flex                   |
     |                     10.61                   |
     +---------------------------------------------+

.         
. #delimit ;
delimiter now ;
. **********************************************************
> ****************
> * 140_iterate.do        (end)
> **********************************************************
> ****************;
. cap log close;

. 
end of do-file

. do "$path/new/170_pref_r_price_bjorn.do"

. *global path "C:/user/gapp"
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/170_pref_r_price.log", replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/170_pref_r_price.log
  log type:  text
 opened on:  23 Oct 2013, 16:02:07

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ****************
> * 170_pref_r_price.do           (start)
> *
> * This file conducts revealed preference comparisons so th
> at
> * we can check the quality of the regional baskets.
> * It also exports the price and quantity data for work in 
> GAMS
> * Rather than make up for missing prices with shares, we e
> stimate
> * a missing price in this case
> **********************************************************
> ****************;
. *global n_spdom "13";
. *global it_n "5";
. /*
> This file uses:
>         work/quan_flex_it$it_n.dta
>         work/povline_food_flex_it$it_n.dta
>         work/price_unit_flex_it$it_n.dta
>                 
> This file creates:
>         work/pref_r_price.dta
>         work/revpref_price_`i'.dta
>         work/product_flex.inc
>         work/price_unit_flex.inc
>         work/quan_flex.inc
> */
> 
> 
> 
> **********************************************************
> *****************;
. * Export price, codes and quantity data to text
> **********************************************************
> *****************;
. use "$path/work/price_unit_flex_it$it_n.dta";
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

. gen reg=spdomain ;

. gen crap=1;

.  lab def crap
>          1  ".";

.  lab val crap crap;

. outsheet product crap reg bswt price_uw$it_n using "$path/
> work/price_unit_flex.inc",  noquote noname replace ;

. collapse (min) spdomain, by(product);

. outsheet product  using "$path/work/product_flex.inc", non
> ame replace;

. use "$path/work/quan_flex_it$it_n.dta", clear;

. gen reg=spdomain;

. gen crap=1;

.  lab def crap
>          1  ".";

.  lab val crap crap;

. format calperg quan$it_n calpp %14.9e;

. outsheet  product crap reg calperg quan$it_n  calpp povlin
> e_f_flex90_$it_n using "$path/work/quan_flex.inc", noname 
> noquote replace;

. clear;

. **********************************************************
> ****************;
. * Revealed preference calculations
> * get the basket for the region we want to test
> **********************************************************
> ****************;
. tempfile quanreg;

. tempfile getmiss;

. tempfile codmiss;

. gen crap=0;

. save "$path/work/pref_r_price.dta", replace;
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> pref_r_price.dta saved

. forvalues i=1/$n_spdom {                ;
  2.         clear;
  3.         gen crap=0;
  4.         save "$path/work/revpref_price_`i'.dta", replac
> e;
  5.         clear;
  6.                 use "$path/work/quan_flex_it$it_n.dta",
>  clear;
  7.                 keep product spdomain quan$it_n price_u
> w$it_n val_ir$it_n povline_f_flex90_$it_n calpp;
  8.         gen share=val_ir$it_n/povline_f_flex90_$it_n;
  9.         rename price_uw$it_n pquanreg;
 10.         rename spdomain spdomainq;
 11.         drop if spdomainq~= `i';
 12.         sort product;
 13.                                 *rescale quantities to 
> hit constant calorie target;
.                 gen ratquan=2150/calpp;
 14.             gen quan_s=quan$it_n*ratquan;
 15.             lab var quan_s "quantities rescaled to hit 
> 2150 calories pp";
 16.         save `quanreg', replace;
 17. *******************************************************
> *******************;
. * Now get the prices in other regions so that you can use 
> them 
> * to build  a new poverty line
> **********************************************************
> ****************;
.         forvalues j= 1/$n_spdom {               ;
 18.                 use "$path/work/price_unit_flex_it$it_n
> .dta";
 19.                                 keep product spdomain p
> rice_uw$it_n descript count bswt;
 20.                         sort product;
 21.                 keep if spdomain==`j';
 22.                 sort product;
 23.                 merge product using `quanreg';
 24.                     *here we have to deal with the fact
>  that not all commodities are consumed in every region;
.                 *so we might have a quantity from region i
>  but no price in region j;
.                 *these will have _merge value=2;
.                 *alternatively the number of observations 
> might be too small;
.                 *deal with these problems by TAKING THE MA
> X PRICE OBSERVED ELSEWHERE (excluding Maputo)
>                         
>                 tab _m;
.                 drop if _m==1;
 25.                                 *CA modified to handle 
> the counting of bswt instead of count
>                   replace price_uw$it_n=. if round(bswt)<5
> ;
.                         gen pricemiss=0;
 26.                   replace spdomain=`j' if _m==2 ;
 27.                   replace pricemiss=1 if _m==2 | round(
> bswt)<5;
 28.                         lab var pricemiss "identify tho
> se items with no price observation";
 29.                   drop _m;
 30.                         sort product;
 31. *browse;
.                *this is the tempfile containing observed q
> uans and prices;
.              save `getmiss', replace;
 32.                         keep if pricemiss==1;
 33.                         if _N>0 {
>                             keep product;
 34.                                             sort produc
> t;
 35.                                             *this file 
> contains the price codes that are missing for the region i
> n question;
.                             save `codmiss', replace;
 36. *browse;
.                                   use "$path/work/price_un
> it_flex_it$it_n.dta", clear;
 37.                         sort product;
 38. *browse;
.                         merge product using `codmiss';
 39.                                                 tab _m;
 40.                         keep if _m==3 ;
 41.                                 *exclude Maputo provinc
> e and city from other price calculation;
.                                 drop if spdomain>10;
 42.                         collapse (max) price_uw$it_n, b
> y(product);
 43.                   *this file contains the code and the 
> max price;
.                   save `codmiss', replace;
 44. *browse;
.                         use `getmiss';
 45.                               merge product using `codm
> iss';
 46. *browse;
.                         tab _m;
 47.                         drop _m;
 48.                         *end if;
.                  };
 49.                                                        
>      else use `getmiss', clear;
 50.                         gen val_q=quan_s*price_uw$it_n;
 51.                                                 collaps
> e (sum) val_q pricemiss (mean) spdomainq ratquan, by(spdom
> ain);
 52.                   gen linf_q=val_q/.9;
 53.                   drop val_q;
 54.                         append using "$path/work/revpre
> f_price_`i'.dta";
 55.                         sort spdomain;
 56.                 save "$path/work/revpref_price_`i'.dta"
> , replace;
 57.    *browse;
.         *close j loop;
.         };
 58.         *aggregate into a big data set;
.         append using "$path/work/pref_r_price.dta";
 59.       sort spdomain spdomainq;
 60.       save "$path/work/pref_r_price.dta", replace;
 61.  *close i loop;
. };
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_1.dta saved
(76 observations deleted)
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(0 real changes made)
(0 real changes made)
(note: file /tmp/St09373.000002 not found)
file /tmp/St09373.000002 saved
(27 observations deleted)
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_1.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(120 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St09373.000002 saved
(26 observations deleted)
(note: file /tmp/St09373.000003 not found)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        155       97.48       97.48
          3 |          4        2.52      100.00
------------+-----------------------------------
      Total |        159      100.00
(155 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         26       96.30       96.30
          3 |          1        3.70      100.00
------------+-----------------------------------
      Total |         27      100.00
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_1.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(0 real changes made)
(2 real changes made)
file /tmp/St09373.000002 saved
(25 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        151       94.97       94.97
          3 |          8        5.03      100.00
------------+-----------------------------------
      Total |        159      100.00
(151 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         25       92.59       92.59
          3 |          2        7.41      100.00
------------+-----------------------------------
      Total |         27      100.00
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_1.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St09373.000002 saved
(26 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        155       97.48       97.48
          3 |          4        2.52      100.00
------------+-----------------------------------
      Total |        159      100.00
(155 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         26       96.30       96.30
          3 |          1        3.70      100.00
------------+-----------------------------------
      Total |         27      100.00
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_1.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> pref_r_price.dta saved
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_2.dta saved
(75 observations deleted)
file /tmp/St09373.000001 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St09373.000002 saved
(27 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        155       97.48       97.48
          3 |          4        2.52      100.00
------------+-----------------------------------
      Total |        159      100.00
(155 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         27       96.43       96.43
          3 |          1        3.57      100.00
------------+-----------------------------------
      Total |         28      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_2.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(120 observations deleted)
(label lspdomain already defined)
(11 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St09373.000002 saved
(28 observations deleted)
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_2.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St09373.000002 saved
(27 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        155       97.48       97.48
          3 |          4        2.52      100.00
------------+-----------------------------------
      Total |        159      100.00
(155 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         27       96.43       96.43
          3 |          1        3.57      100.00
------------+-----------------------------------
      Total |         28      100.00
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_2.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St09373.000002 saved
(28 observations deleted)
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_2.dta saved
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> pref_r_price.dta saved
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_3.dta saved
(77 observations deleted)
file /tmp/St09373.000001 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(14 observations deleted)
(0 real changes made)
(2 real changes made)
file /tmp/St09373.000002 saved
(24 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        151       94.97       94.97
          3 |          8        5.03      100.00
------------+-----------------------------------
      Total |        159      100.00
(151 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         24       92.31       92.31
          3 |          2        7.69      100.00
------------+-----------------------------------
      Total |         26      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_3.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(120 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St09373.000002 saved
(26 observations deleted)
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_3.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(14 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St09373.000002 saved
(26 observations deleted)
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_3.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(14 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St09373.000002 saved
(25 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        155       97.48       97.48
          3 |          4        2.52      100.00
------------+-----------------------------------
      Total |        159      100.00
(155 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         25       96.15       96.15
          3 |          1        3.85      100.00
------------+-----------------------------------
      Total |         26      100.00
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_3.dta saved
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> pref_r_price.dta saved
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_4.dta saved
(81 observations deleted)
file /tmp/St09373.000001 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(18 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St09373.000002 saved
(21 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        155       97.48       97.48
          3 |          4        2.52      100.00
------------+-----------------------------------
      Total |        159      100.00
(155 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         21       95.45       95.45
          3 |          1        4.55      100.00
------------+-----------------------------------
      Total |         22      100.00
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_4.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(120 observations deleted)
(label lspdomain already defined)
(17 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St09373.000002 saved
(22 observations deleted)
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_4.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(18 observations deleted)
(0 real changes made)
(2 real changes made)
file /tmp/St09373.000002 saved
(20 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
variable product does not uniquely identify observations
    in the master data
(label lspdomain already defined)

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        151       94.97       94.97
          3 |          8        5.03      100.00
------------+-----------------------------------
      Total |        159      100.00
(151 observations deleted)
(0 observations deleted)
file /tmp/St09373.000003 saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         20       90.91       90.91
          3 |          2        9.09      100.00
------------+-----------------------------------
      Total |         22      100.00
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_4.dta saved
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(119 observations deleted)
(label lspdomain already defined)
(18 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St09373.000002 saved
(22 observations deleted)
(HH food cons. (1 rec per item cons. cat A& B per HH; Cat B:
>  only T6SQ1 + T6AEQ3))
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> revpref_price_4.dta saved
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> pref_r_price.dta saved

. *bring in actual flexible bundle numbers;
. use "$path/work/povline_food_flex_it$it_n.dta", clear;

.         merge spdomain using "$path/work/pref_r_price.dta"
> ;
variable spdomain does not uniquely identify observations
    in
    /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work
    > /pref_r_price.dta
(label lspdomain already defined)

.         tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |         16      100.00      100.00
------------+-----------------------------------
      Total |         16      100.00

.          drop crap;

.         drop _m;

.         order spdomainq spdomain;

.       sort spdomainq spdomain;

.         *rescale expenditures to hit a constant calorie ta
> rget;
.         gen povline_f5_s=ratquan*povline_f_flex90_$it_n;

.       compress;
spdomainq was float now byte
spdomain was float now byte
pricemiss was double now byte

. *browse;
.         *categorize revealed preference performance;
.       gen pref_r=0;

.       replace pref_r=1 if float(linf_q)>float(povline_f5_s
> );
(10 real changes made)

.       replace pref_r=2 if float(linf_q)<float(povline_f5_s
> );
(5 real changes made)

.       lab var pref_r "Fails or passes revealed preference 
> test";

.       lab def pref_r
>                         0 "comparison of the same region w
> ith itself"
>                         1 "passes revealed preference test
> "
>                         2 "fails revealed preference test"
>  ;

.         lab val pref_r pref_r;

.       drop if spdomainq==spdomain;
(4 observations deleted)

.         tab pref_r;

    Fails or passes revealed preference |
                                   test |      Freq.     Per
> cent        Cum.
----------------------------------------+-------------------
> ----------------
        passes revealed preference test |          8       6
> 6.67       66.67
         fails revealed preference test |          4       3
> 3.33      100.00
----------------------------------------+-------------------
> ----------------
                                  Total |         12      10
> 0.00

.              sort spdomainq ;

.       by spdomainq: tab pref_r;

------------------------------------------------------------
-> spdomainq = 1

    Fails or passes revealed preference |
                                   test |      Freq.     Per
> cent        Cum.
----------------------------------------+-------------------
> ----------------
        passes revealed preference test |          2       6
> 6.67       66.67
         fails revealed preference test |          1       3
> 3.33      100.00
----------------------------------------+-------------------
> ----------------
                                  Total |          3      10
> 0.00

------------------------------------------------------------
-> spdomainq = 2

    Fails or passes revealed preference |
                                   test |      Freq.     Per
> cent        Cum.
----------------------------------------+-------------------
> ----------------
        passes revealed preference test |          1       3
> 3.33       33.33
         fails revealed preference test |          2       6
> 6.67      100.00
----------------------------------------+-------------------
> ----------------
                                  Total |          3      10
> 0.00

------------------------------------------------------------
-> spdomainq = 3

    Fails or passes revealed preference |
                                   test |      Freq.     Per
> cent        Cum.
----------------------------------------+-------------------
> ----------------
        passes revealed preference test |          2       6
> 6.67       66.67
         fails revealed preference test |          1       3
> 3.33      100.00
----------------------------------------+-------------------
> ----------------
                                  Total |          3      10
> 0.00

------------------------------------------------------------
-> spdomainq = 4

    Fails or passes revealed preference |
                                   test |      Freq.     Per
> cent        Cum.
----------------------------------------+-------------------
> ----------------
        passes revealed preference test |          3      10
> 0.00      100.00
----------------------------------------+-------------------
> ----------------
                                  Total |          3      10
> 0.00


. save "$path/work/pref_r_price.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> pref_r_price.dta saved

. *drop comparisons with Maputo ;
. drop if spdomain>=11;
(0 observations deleted)

. drop if spdomainq>=11;
(0 observations deleted)

. display "this is with maputo dropped";
this is with maputo dropped

. tab pref_r;

    Fails or passes revealed preference |
                                   test |      Freq.     Per
> cent        Cum.
----------------------------------------+-------------------
> ----------------
        passes revealed preference test |          8       6
> 6.67       66.67
         fails revealed preference test |          4       3
> 3.33      100.00
----------------------------------------+-------------------
> ----------------
                                  Total |         12      10
> 0.00

. *further drop Nampula rural and urban;
. drop if spdomain==3 | spdomain==4;
(6 observations deleted)

. display "this is with maputo and nampula dropped (MAH: Act
> ually not - experimenting with 6 spatial domains)";
this is with maputo and nampula dropped (MAH: Actually not -
>  experimenting with 6 spatial domains)

. tab pref_r;

    Fails or passes revealed preference |
                                   test |      Freq.     Per
> cent        Cum.
----------------------------------------+-------------------
> ----------------
        passes revealed preference test |          5       8
> 3.33       83.33
         fails revealed preference test |          1       1
> 6.67      100.00
----------------------------------------+-------------------
> ----------------
                                  Total |          6      10
> 0.00

. **********************************************************
> ****************
> * 170_pref_r_price.do           (end)
> **********************************************************
> ****************;
. log close;
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/170_pref_r_price.log
  log type:  text
 closed on:  23 Oct 2013, 16:02:07
------------------------------------------------------------

. 
end of do-file

. shell /usr/GAMS/gams24.1_linux_x64_64_sfx/gams "/home/bjvc
> a/data/data/GAP/Haruna/UNPS_2011/GAPP3/new/190a_revpref13_
> r_bjorn.gms" o="/home/bjvca/data/data/GAP/Haruna/UNPS_2011
> /GAPP3/new/list.lst"

*** Could not write to console: /dev/tty
*** Logging to standard output
--- Job 190a_revpref13_r_bjorn.gms Start 10/23/13 16:02:15 2
> 4.1.2 r40979 LEX-LEG x86_64/Linux
GAMS 24.1.2   Copyright (C) 1987-2013 GAMS Development. All 
> rights reserved
Licensee: Computer Services                              G13
> 0401:1333CP-GEN
          International Food Policy Research Institute      
>          DC2119
--- Starting compilation
--- 190a_revpref13_r_bjorn.gms(19) 2 Mb
--- .product_flex.inc(40) 3 Mb
--- 190a_revpref13_r_bjorn.gms(64) 3 Mb
--- .price_unit_flex.inc(159) 3 Mb
--- 190a_revpref13_r_bjorn.gms(69) 3 Mb
--- .quan_flex.inc(103) 3 Mb
--- 190a_revpref13_r_bjorn.gms(269) 3 Mb
--- Starting execution: elapsed 0:00:00.006
--- 190a_revpref13_r_bjorn.gms(495) 4 Mb
--- Generating NLP model revpref
--- 190a_revpref13_r_bjorn.gms(497) 7 Mb
---   136 rows  223 columns  963 non-zeroes
---   929 nl-code  309 nl-non-zeroes
--- 190a_revpref13_r_bjorn.gms(497) 4 Mb
--- Executing CONOPT: elapsed 0:00:00.033
*** Could not write to console: /dev/tty
*** Logging to standard output
CONOPT 3         24.1.2 r40979 Released Jun 16, 2013 LEG x86
> _64/Linux         
 
 
    C O N O P T 3   version 3.15K
    Copyright (C)   ARKI Consulting and Development A/S
                    Bagsvaerdvej 246 A
                    DK-2880 Bagsvaerd, Denmark
 
 
   Iter Phase Ninf   Infeasibility   RGmax    NSB   Step InI
> tr MX OK
      0   0        2.2620550020E+03 (Input point)
                                Pre-triangular equations:   
>      0
                                Post-triangular equations:  
>      1
      1   0        2.2620550020E+03 (After pre-processing)
      2   0        3.2699532872E+00 (After scaling)
     10   0     0  4.5028568897E-02               1.0E+00   
>    F  T
 
 ** Feasible solution. Value of objective =   0.504721069729
 
   Iter Phase Ninf     Objective     RGmax    NSB   Step InI
> tr MX OK
     16   3        3.1198266859E-01 8.5E+00    94 1.0E+00   
>  1 F  T
     21   4        5.6747234208E-02 5.6E-01    93 1.0E+00   
>  4 F  T
     26   4        5.3588434995E-02 4.2E-04    96 1.0E+00   
>  9 F  T
     28   4        5.3588434994E-02 8.5E-08    96
 
 ** Optimal solution. Reduced gradient less than tolerance.
 
*** Could not write to console: /dev/tty
*** Logging to standard output
--- Restarting execution
--- 190a_revpref13_r_bjorn.gms(497) 2 Mb
--- Reading solution for model revpref
--- 190a_revpref13_r_bjorn.gms(566) 3 Mb
--- Putfile povline_rp /home/bjvca/data/data/GAP/Haruna/UNPS
> _2011/GAPP3/work/povline_rp_inout.csv
--- Putfile res /home/bjvca/data/data/GAP/Haruna/UNPS_2011/G
> APP3/work/qent.csv
--- Putfile lin /home/bjvca/data/data/GAP/Haruna/UNPS_2011/G
> APP3/work/povline_food_ent.csv
*** Status: Normal completion
--- Job 190a_revpref13_r_bjorn.gms Stop 10/23/13 16:02:15 el
> apsed 0:00:00.075

. do "$path/new/210_povmeas_ent_flex.do"

. 
. 
. if c(os)=="Unix" {
. global path "/home/bjvca/data/data/GAP/Haruna/UNPS_2011/GA
> PP3/"
. }

. else{
. global path "C:\Users\Templeton\Desktop\GAPP\GAPP-UGANDA-H
> ARUNA\UNPS_2011\GAPP3"
. }

. 
. 
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/210_povmeas_ent_flex.log" , replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/210_povmeas_ent_flex.log
  log type:  text
 opened on:  23 Oct 2013, 16:02:24

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ***********************
> * 210_povmeas_ent_flex.do               (start)
> *
> * This file produces poverty measures taking the entropy a
> djusted poverty 
> * lines as a base. It produces two sets of poverty measure
> s. In one, 
> * Maputo is treated with the logic of the fixed bundle. In
>  the second, the revealed preference logic
> * is maintained. Here, the flexible bundle is viewed as be
> ing determined by the 
> * lower constraint on the value of the food bundle dictate
> d by P_t2*Q_t1. In this case,
> * the year t2 food shares are calculated and applied.
> *
> * Fixed poverty lines/etc. are mentioned here and there. B
> ut there are NO fixed
> * calculations for Maputo (or other provinces) anymore
> *
> **********************************************************
> ***********************;
. /*
> This file uses:
>         work\povline_food_ent.csv
>         work\conpc.dta
>         work\hhdata.dta
>         work/temp_index_reg_tpi.dta
> 
> This file creates:
>         work\povlines_ent.dta
>         work\povmeas_ent_flex.dta
>         work\povlines_ent.dta
>       work\nat_pov_ent_m.csv
>       work\rur_pov_ent_m.csv
>       work\news_pov_ent_m.csv
>       work\reg_tpi_pov_ent_m.csv
>       work\strata_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>         work\povlines_ent.csv
> */
> 
> 
> 
> **********************************************************
> ****************;
. * Bring in data file with nominal consumption per capita, 
> and deflate it
> * by temporal price index.
> **********************************************************
> ****************;
. use "$path/work/hhdata.dta", clear;
(Household master record (1 record per household))

.         sort reg_tpi survquar;

.         merge reg_tpi survquar using "$path/work/temp_inde
> x_reg_tpi.dta";
variables reg_tpi survquar do not uniquely identify
    observations in the master data
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         48        1.77        1.77
          3 |      2,668       98.23      100.00
------------+-----------------------------------
      Total |      2,716      100.00

.         drop _merge;

.         sort hhid;

.         merge hhid using "$path/work/conpc.dta";

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         gen food_pc_tpi  = food_pc_nom /tpi_trim;
(49 missing values generated)

.         lab var food_pc_tpi "Temp-adjusted per capita food
>  consumption/day";

.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
(49 missing values generated)

.         lab var cons_pc_tpi "Temp adjusted total consumpti
> on/day";

.         gen one=1;

.         tempfile contpi;

. save `contpi', replace;
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved

. **********************************************************
> ****************;
. * Calculate the food shares for people near the food pover
> ty line
> **********************************************************
> ****************;
. *Bring in entropy estimated flexible lines;
. clear;

. insheet using "$path/work/povline_food_ent.csv";
(3 vars, 4 obs)

.         rename ent food_povline_ent;

.      keep spdomain food_povline_ent;

.      sort spdomain;

. *Bring in fixed bundle poverty lines for Maputo ;
. *This is the same level for both entropy and fixed bundle 
> analysis;
. *since the Q02*P02<=Q96*P02 constraint is binding;
. *$no_temp_rev   merge spdomain using "$path/work/povline_f
> ood_fix.dta";
. *$no_temp_rev    replace food_povline_ent=food_povline_w i
> f spdomain>10;
.       keep spdomain food_povline_ent;

.       sort spdomain;

.       tempfile food_povline_ent;

. save `food_povline_ent';
file /tmp/St09373.000002 saved

. clear;

. use `contpi';
(Household master record (1 record per household))

.         sort spdomain;

.         merge spdomain using `food_povline_ent';
variable spdomain does not uniquely identify observations
    in the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. gen     triwt = 0 ;

. replace triwt = 11 - round(50*abs(cons_pc_tpi/food_povline
> _ent-1)+0.5)
>                 if abs(cons_pc_tpi/food_povline_ent-1)<=0.
> 2;
(322 real changes made)

.         gen tripopwt=triwt*hhweight*hhsize;
(3 missing values generated)

.         collapse (mean) nf_pc_nom food_povline_ent [aw=tri
> popwt] ,
>         by(spdomain);

.         rename nf_pc_nom povline_nf;

.         lab var povline_nf "Nonfood poverty line";

.         sort spdomain;

. *       merge spdomain using "$foodshr_pastSurvey", keep(s
> pdomain $fdshr_t1);
. *       tab _m;
. *       drop _m;
. *       gen fdshr_t1 = $fdshr_t1;
. *       drop $fdshr_t1;
. *       lab var fdshr_t1 "year t1 (e.g. 1996) poverty line
>  food share";
.      *calculate line for all provinces with flexible food 
> shares;
.                         gen povline_ent_m=food_povline_ent
>  + povline_nf;

.         gen fdshr=food_povline_ent/povline_ent;

.         lab var fdshr "year t2 (e.g. 2002) poverty line fo
> od share";

.       *redo for maputo inserting the fixed food share;
.  *     gen povline_ent=povline_ent_m;
. *MAH;
. *$no_temp_rev   replace povline_ent=food_povline_ent/fdshr
> _t1 if spdomain >=11;
. *       lab var povline_ent   "poverty lines with Maputo r
> egions calculated using fixed bundle non-food shares";
.     lab var povline_ent   "poverty lines with all regions 
> calculated using flexible bundle non-food shares";

. *    lab var povline_ent_m "poverty lines with Maputo regi
> ons calculated using flexible bundle non-food shares";
.         sort spdomain;

. tempfile povlines_ent;

. save `povlines_ent', replace;
(note: file /tmp/St09373.000003 not found)
file /tmp/St09373.000003 saved

. clear;

. **********************************************************
> ****************;
. * Calculate poverty measures with all regions using flexib
> le year t2 food shares
> **********************************************************
> ****************;
. use `contpi';
(Household master record (1 record per household))

.         sort spdomain;

.         merge spdomain using `povlines_ent';
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. **********************************************************
> ****************;
. * Create spatial price index, based on the total poverty l
> ine, with
> * adjustment so that mean (and total) nominal consumption 
> equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first. The mid
> dle of the 13
> * codes is code 7 -- that's arbirtary enough.
> **********************************************************
> ****************;
.         gen cr= cons_pc_tpi ;
(49 missing values generated)

.         gen linpob=povline_ent;
(9 missing values generated)

. *MAH;
.  *Now only 6 regions, so base is chosen as the 1;
.         *qui sum linpob if spdomain==7, meanonly;
.         qui sum linpob if spdomain==1, meanonly;

.         global spi_base=r(mean);

.         gen spi=linpob/$spi_base;
(9 missing values generated)

.         gen cr2=cr/spi;
(49 missing values generated)

.         qui sum cr [aw=hhweight*hhsize];

.         global sumcr=r(sum);

.         qui sum cr2 [aw=hhweight*hhsize];

.         global sumcr2=r(sum);

.         replace spi=spi*$sumcr2/$sumcr;
(2708 real changes made)

.         gen linpobr=linpob/spi;
(9 missing values generated)

.         replace cr2=cr/spi;
(2658 real changes made)

.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
         cr2 |    2668  36669748.9    1891.772   2701.815   
>        0   75452.02
      linpob |    2707    37257099    868.1425   151.8468   
> 652.8669   1014.421
     linpobr |    2707    37257099    880.0636   .0000255   
> 880.0635   880.0636

.         lab var cr      "Temporally-adjusted cons pc";

.         lab var cr2     "Spatially & temporally adjusted c
> ons pc";

.         lab var linpob  "Poverty line";

.         lab var linpobr "Real poverty line";

.         lab var spi     "Spatial price index";

.         *calculate poverty measures;
.         gen h = 100     if cr2 <=(linpobr);
(2051 missing values generated)

.         replace  h = 0  if cr2 > (linpobr);
(2051 real changes made)

.         gen             pg      = ((linpobr - cr2 )/linpob
> r) *100;
(49 missing values generated)

.         replace         pg      = 0             if h==0;
(2051 real changes made)

.         gen             spg     = ((( linpobr - cr2 )/ lin
> pobr )^2)*100;
(49 missing values generated)

.         replace         spg     = 0             if h==0;
(2051 real changes made)

.         gen h_ent  =h;

.         gen pg_ent =pg;
(9 missing values generated)

.         gen spg_ent=spg;
(9 missing values generated)

.         lab var h_ent   "Poverty headcount entropy bundle 
> with Maputo food share fixed";

.         lab var pg_ent  "Poverty gap entropy bundle with M
> aputo food share fixed";

.         lab var spg_ent "Squared poverty gap entropy bundl
> e with Maputo food share fixed";

.         sort hhid;

.         merge hhid using "$path/work/hhdata.dta";
(label lnew already defined)
(label lspdomain already defined)
(label lsurvmon already defined)
(label lsurvquar already defined)
(label intresult already defined)
(label SPLIT already defined)
(label strat already defined)
(label lbur already defined)
(label lbreg already defined)
(label df_UBOS_VISITOUTCO already defined)
(label STATUS already defined)
(label lbregu already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop if _merge~=3;
(1 observation deleted)

.         drop _merge;

.         gen popwt=hhsize*hhweight;
(2 missing values generated)

.         lab var popwt "Population weights = hhsize X hhwei
> ght";

.                 * Stata 10.1 syntax ;
.         svyset , clear;

.         svyset [pweight=popwt] , str(strata) psu(psu);

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>

. *MAH: Below at various places the original reg13 has been 
> changed into spdomain or spdomain ;
.                 svy: mean h_ent pg_ent spg_ent;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
       h_ent |   26.20551   1.436047      23.38147    29.029
> 55
      pg_ent |   9.034107   .6832773      7.690416     10.37
> 78
     spg_ent |   4.776468   .5307839      3.732661    5.8202
> 75
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(rural);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
           0 |   7.030556   1.410337      4.257073    9.8040
> 39
           1 |   29.63539    1.66291      26.36521    32.905
> 56
-------------+----------------------------------------------
> --
pg_ent       |
           0 |   2.710193   .7165812      1.301008    4.1193
> 78
           1 |   10.16528   .7930013      8.605815    11.724
> 75
-------------+----------------------------------------------
> --
spg_ent      |
           0 |   1.594614   .5759745      .4619379     2.727
> 29
           1 |   5.345615   .6157267      4.134765    6.5564
> 66
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(strata);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   8.810118   1.910429      5.053186    12.567
> 05
   _subpop_3 |   24.73079   3.256749      18.32627    31.135
> 32
   _subpop_4 |   27.34775   2.433348      22.56248    32.133
> 03
   _subpop_5 |   27.63444   3.402676      20.94294    34.325
> 93
   _subpop_6 |   37.82071   3.884087       30.1825    45.458
> 92
-------------+----------------------------------------------
> --
pg_ent       |
     Kampala |   1.339719   .8309045     -.2942868    2.9737
> 25
   _subpop_2 |   3.435786   1.002555      1.464223    5.4073
> 49
   _subpop_3 |   11.99634   2.455494      7.167516    16.825
> 16
   _subpop_4 |   7.538297   .9403652      5.689032    9.3875
> 61
   _subpop_5 |   8.648147   1.504704      5.689089    11.607
> 21
   _subpop_6 |   12.88469   1.424606      10.08314    15.686
> 23
-------------+----------------------------------------------
> --
spg_ent      |
     Kampala |   .5937125   .4302219     -.2523357    1.4397
> 61
   _subpop_2 |   2.128129   .8541316      .4484464    3.8078
> 12
   _subpop_3 |   8.668379    2.33407      4.078339    13.258
> 42
   _subpop_4 |   3.142837   .5288138      2.102904     4.182
> 77
   _subpop_5 |   3.685791   .7916016      2.129075    5.2425
> 06
   _subpop_6 |   6.547187   .9367709      4.704991    8.3893
> 84
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(spdomain);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent       |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent      |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(spdomain);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent       |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent      |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.                 compress;
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
bswt was float now byte
hhsize was long now byte
one was float now byte
h was float now byte
h_ent was float now byte

.       gen dum=1;

.         sort hhid;

.         *set aside the spatial price index;
.       tempfile spi;

. *      use "$path/work/povmeas_ent.dta", clear;
.       collapse (mean) spi, by(spdomain);

.       sort spdomain;

. save `spi', replace;
(note: file /tmp/St09373.000004 not found)
file /tmp/St09373.000004 saved

. clear;

. **********************************************************
> ****************;
. * Calculate poverty measures with Maputo regions on flexib
> le food shares
> **********************************************************
> ****************;
. use `contpi';
(Household master record (1 record per household))

.         sort spdomain;

.         merge spdomain using `povlines_ent';
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. **********************************************************
> ****************;
. * Create spatial price index, based on the total poverty l
> ine, with
> * adjustment so that mean (and total) nominal consumption 
> equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first. The mid
> dle of the 13
> * codes is code 7 -- that's arbirtary enough.
> **********************************************************
> ****************;
.         gen cr= cons_pc_tpi ;
(49 missing values generated)

.         gen linpob=povline_ent_m;
(9 missing values generated)

.         qui sum linpob if spdomain==1, meanonly;

.         global spi_base=r(mean);

.         gen spi=linpob/$spi_base;
(9 missing values generated)

.         gen cr2=cr/spi;
(49 missing values generated)

.         qui sum cr [aw=hhweight*hhsize];

.         global sumcr=r(sum);

.         qui sum cr2 [aw=hhweight*hhsize];

.         global sumcr2=r(sum);

.         replace spi=spi*$sumcr2/$sumcr;
(2708 real changes made)

.         gen linpobr=linpob/spi;
(9 missing values generated)

.         replace cr2=cr/spi;
(2658 real changes made)

.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
         cr2 |    2668  36669748.9    1891.772   2701.815   
>        0   75452.02
      linpob |    2707    37257099    868.1425   151.8468   
> 652.8669   1014.421
     linpobr |    2707    37257099    880.0636   .0000255   
> 880.0635   880.0636

.         lab var cr      "Temporally-adjusted cons pc";

.         lab var cr2     "Spatially & temporally adjusted c
> ons pc";

.         lab var linpob  "Poverty line";

.         lab var linpobr "Real poverty line";

.         lab var spi     "Spatial price index";

.         *calculate poverty measures;
.         gen h = 100     if cr2 <=(linpobr);
(2051 missing values generated)

.         replace  h = 0 if cr2 > (linpobr);
(2051 real changes made)

.         gen             pg      = ((linpobr - cr2 )/linpob
> r) *100;
(49 missing values generated)

.         replace         pg      = 0             if h==0;
(2051 real changes made)

.         gen             spg     = ((( linpobr - cr2 )/ lin
> pobr )^2)*100;
(49 missing values generated)

.         replace         spg     = 0             if h==0;
(2051 real changes made)

.         gen h_ent_m  =h;

.         gen pg_ent_m =pg;
(9 missing values generated)

.         gen spg_ent_m=spg;
(9 missing values generated)

.         lab var h_ent_m   "Poverty headcount entropy bundl
> e. Food share flexible. Flexible bundle";

.         lab var pg_ent_m  "Poverty gap entropy bundle. Foo
> d share flexible. Flexible bundle";

.         lab var spg_ent_m "Squared poverty gap entropy. Fo
> od share flexible. Flexible bundle";

.         sort hhid;

.         merge hhid using "$path/work/hhdata.dta";
(label lnew already defined)
(label lspdomain already defined)
(label lsurvmon already defined)
(label lsurvquar already defined)
(label intresult already defined)
(label SPLIT already defined)
(label strat already defined)
(label lbur already defined)
(label lbreg already defined)
(label df_UBOS_VISITOUTCO already defined)
(label STATUS already defined)
(label lbregu already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop if _merge~=3;
(1 observation deleted)

.         drop _merge;

.         gen popwt=hhsize*hhweight;
(2 missing values generated)

.         lab var popwt "Population weights = hhsize X hhwei
> ght";

.                 * Stata 10.1 syntax ;
.         svyset , clear;

.         svyset [pweight=popwt] , str(strata) psu(psu);

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>

.                 svy: mean h_ent_m pg_ent_m spg_ent_m;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
     h_ent_m |   26.20551   1.436047      23.38147    29.029
> 55
    pg_ent_m |   9.034107   .6832773      7.690416     10.37
> 78
   spg_ent_m |   4.776468   .5307839      3.732661    5.8202
> 75
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(rural)
> ;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
           0 |   7.030556   1.410337      4.257073    9.8040
> 39
           1 |   29.63539    1.66291      26.36521    32.905
> 56
-------------+----------------------------------------------
> --
pg_ent_m     |
           0 |   2.710193   .7165812      1.301008    4.1193
> 78
           1 |   10.16528   .7930013      8.605815    11.724
> 75
-------------+----------------------------------------------
> --
spg_ent_m    |
           0 |   1.594614   .5759745      .4619379     2.727
> 29
           1 |   5.345615   .6157267      4.134765    6.5564
> 66
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(news);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: news = Central
      Eastern: news = Eastern
     Northern: news = Northern
      Western: news = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent_m     |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent_m    |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(reg_tp
> i);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: reg_tpi = Central
      Eastern: reg_tpi = Eastern
     Northern: reg_tpi = Northern
      Western: reg_tpi = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent_m     |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent_m    |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(strata
> );
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   8.810118   1.910429      5.053186    12.567
> 05
   _subpop_3 |   24.73079   3.256749      18.32627    31.135
> 32
   _subpop_4 |   27.34775   2.433348      22.56248    32.133
> 03
   _subpop_5 |   27.63444   3.402676      20.94294    34.325
> 93
   _subpop_6 |   37.82071   3.884087       30.1825    45.458
> 92
-------------+----------------------------------------------
> --
pg_ent_m     |
     Kampala |   1.339719   .8309045     -.2942868    2.9737
> 25
   _subpop_2 |   3.435786   1.002555      1.464223    5.4073
> 49
   _subpop_3 |   11.99634   2.455494      7.167516    16.825
> 16
   _subpop_4 |   7.538297   .9403652      5.689032    9.3875
> 61
   _subpop_5 |   8.648147   1.504704      5.689089    11.607
> 21
   _subpop_6 |   12.88469   1.424606      10.08314    15.686
> 23
-------------+----------------------------------------------
> --
spg_ent_m    |
     Kampala |   .5937125   .4302219     -.2523357    1.4397
> 61
   _subpop_2 |   2.128129   .8541316      .4484464    3.8078
> 12
   _subpop_3 |   8.668379    2.33407      4.078339    13.258
> 42
   _subpop_4 |   3.142837   .5288138      2.102904     4.182
> 77
   _subpop_5 |   3.685791   .7916016      2.129075    5.2425
> 06
   _subpop_6 |   6.547187   .9367709      4.704991    8.3893
> 84
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(spdoma
> in);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent_m     |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent_m    |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         drop bswt one h pg spg;

.         compress;
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
hhsize was long now byte
h_ent_m was float now byte

. label data "Final data set. Official published poverty rat
> es are calculated from this data set";
note: label truncated to 80 characters

.         sort hhid;

.         save "$path/work/povmeas_ent_flex.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povmeas_ent_flex.dta saved

. gen dum=1;

.         *output the national measures;
.         collapse  (mean) dum h_ent_m pg_ent_m spg_ent_m [a
> w=hhweight*hhsize];

. gen geo="National";

. gen geono=dum;

. tempfile nat;

. save `nat';
file /tmp/St09373.000005 saved

.         *output the rural/urban measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(rural);

. gen geo="Rural/Urban";

. gen geono=rural;

. tempfile rur;

. save `rur';
file /tmp/St09373.000006 saved

.         *output the North South Center measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(news);

. gen geo="North/Center/South";

. gen geono=news;
(1 missing value generated)

. tempfile new;

. save `new';
file /tmp/St09373.000007 saved

.         *output the North South Center rural/urban measure
> s;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(reg_tpi);

. gen geo="TPI - 6 regions";

. gen geono=reg_tpi;

. tempfile rtp;

. save `rtp';
file /tmp/St09373.000008 saved

.         *output the provincial measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(strata);

. gen geo="Provinces";

. gen geono=strata;

. tempfile str;

. save `str';
file /tmp/St09373.000009 saved

.                 *output the dominios espaciais measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(spdomain);

. gen geo="Spatial domains";

. gen geono=spdomain;
(1 missing value generated)

. tempfile r13;

. save `r13';
file /tmp/St09373.00000a saved

. clear;

. set obs 1;
obs was 0, now 1

. gen geo=" ";

. tempfile one;

. save `one';
file /tmp/St09373.00000b saved

. use          `nat';
(Final data set. Official published poverty rates are calcul
> ated from this data s)

. append using `one';

. append using `rur';
geo was str8 now str11

. append using `one';

. append using `new';
geo was str11 now str18

. append using `one';

. append using `rtp';

. append using `one';

. append using `str';

. append using `one';

. append using `r13';

. outsheet geo geono h_ent_m pg_ent_m spg_ent_m dum rural ne
> ws reg_tpi strata spdomain using "$path/work/poverty_ent_f
> lexBask.csv", replace c ;

.         *set aside the spatial price index;
.       tempfile spi_m;

.       use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.       collapse (mean) spi, by(spdomain);

.       rename spi spi_m;

.       sort spdomain;

. save `spi_m', replace;
(note: file /tmp/St09373.00000c not found)
file /tmp/St09373.00000c saved

. use `povlines_ent';
(Household master record (1 record per household))

.        sort spdomain;

.        merge spdomain using `spi';
(label lspdomain already defined)

.        tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          1       20.00       20.00
          3 |          4       80.00      100.00
------------+-----------------------------------
      Total |          5      100.00

.  drop _m;

.        sort spdomain;

.        merge spdomain using `spi_m';
(label lspdomain already defined)

.         tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |          5      100.00      100.00
------------+-----------------------------------
      Total |          5      100.00

.  drop _m;

. save "$path/work/povlines.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines.dta saved

. outsheet spdomain food_povline_ent povline_ent fdshr using
>  "$path/work/povlines.csv", replace c;

.  *********************************************************
> ************************
> * 210_povmeas_ent_flex.do               (end)
> **********************************************************
> ***********************;
. log close;
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/210_povmeas_ent_flex.log
  log type:  text
 closed on:  23 Oct 2013, 16:02:25
------------------------------------------------------------

. 
end of do-file

. do "$path/new/210_povmeas_ent_flex.do"

. 
. 
. if c(os)=="Unix" {
. global path "/home/bjvca/data/data/GAP/Haruna/UNPS_2011/GA
> PP3/"
. }

. else{
. global path "C:\Users\Templeton\Desktop\GAPP\GAPP-UGANDA-H
> ARUNA\UNPS_2011\GAPP3"
. }

. 
. 
. clear all

. set mem 999m

. 
. cap log close

. log using "$path/rep/210_povmeas_ent_flex.log" , replace
------------------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/210_povmeas_ent_flex.log
  log type:  text
 opened on:  23 Oct 2013, 16:02:35

. clear

. set more off

. #delimit ;
delimiter now ;
. **********************************************************
> ***********************
> * 210_povmeas_ent_flex.do               (start)
> *
> * This file produces poverty measures taking the entropy a
> djusted poverty 
> * lines as a base. It produces two sets of poverty measure
> s. In one, 
> * Maputo is treated with the logic of the fixed bundle. In
>  the second, the revealed preference logic
> * is maintained. Here, the flexible bundle is viewed as be
> ing determined by the 
> * lower constraint on the value of the food bundle dictate
> d by P_t2*Q_t1. In this case,
> * the year t2 food shares are calculated and applied.
> *
> * Fixed poverty lines/etc. are mentioned here and there. B
> ut there are NO fixed
> * calculations for Maputo (or other provinces) anymore
> *
> **********************************************************
> ***********************;
. /*
> This file uses:
>         work\povline_food_ent.csv
>         work\conpc.dta
>         work\hhdata.dta
>         work/temp_index_reg_tpi.dta
> 
> This file creates:
>         work\povlines_ent.dta
>         work\povmeas_ent_flex.dta
>         work\povlines_ent.dta
>       work\nat_pov_ent_m.csv
>       work\rur_pov_ent_m.csv
>       work\news_pov_ent_m.csv
>       work\reg_tpi_pov_ent_m.csv
>       work\strata_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>         work\povlines_ent.csv
> */
> 
> 
> 
> **********************************************************
> ****************;
. * Bring in data file with nominal consumption per capita, 
> and deflate it
> * by temporal price index.
> **********************************************************
> ****************;
. use "$path/work/hhdata.dta", clear;
(Household master record (1 record per household))

.         sort reg_tpi survquar;

.         merge reg_tpi survquar using "$path/work/temp_inde
> x_reg_tpi.dta";
variables reg_tpi survquar do not uniquely identify
    observations in the master data
(label lsurvquar already defined)
(label lbreg already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         48        1.77        1.77
          3 |      2,668       98.23      100.00
------------+-----------------------------------
      Total |      2,716      100.00

.         drop _merge;

.         sort hhid;

.         merge hhid using "$path/work/conpc.dta";

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

.         gen food_pc_tpi  = food_pc_nom /tpi_trim;
(49 missing values generated)

.         lab var food_pc_tpi "Temp-adjusted per capita food
>  consumption/day";

.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
(49 missing values generated)

.         lab var cons_pc_tpi "Temp adjusted total consumpti
> on/day";

.         gen one=1;

.         tempfile contpi;

. save `contpi', replace;
(note: file /tmp/St09373.000001 not found)
file /tmp/St09373.000001 saved

. **********************************************************
> ****************;
. * Calculate the food shares for people near the food pover
> ty line
> **********************************************************
> ****************;
. *Bring in entropy estimated flexible lines;
. clear;

. insheet using "$path/work/povline_food_ent.csv";
(3 vars, 4 obs)

.         rename ent food_povline_ent;

.      keep spdomain food_povline_ent;

.      sort spdomain;

. *Bring in fixed bundle poverty lines for Maputo ;
. *This is the same level for both entropy and fixed bundle 
> analysis;
. *since the Q02*P02<=Q96*P02 constraint is binding;
. *$no_temp_rev   merge spdomain using "$path/work/povline_f
> ood_fix.dta";
. *$no_temp_rev    replace food_povline_ent=food_povline_w i
> f spdomain>10;
.       keep spdomain food_povline_ent;

.       sort spdomain;

.       tempfile food_povline_ent;

. save `food_povline_ent';
file /tmp/St09373.000002 saved

. clear;

. use `contpi';
(Household master record (1 record per household))

.         sort spdomain;

.         merge spdomain using `food_povline_ent';
variable spdomain does not uniquely identify observations
    in the master data

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. gen     triwt = 0 ;

. replace triwt = 11 - round(50*abs(cons_pc_tpi/food_povline
> _ent-1)+0.5)
>                 if abs(cons_pc_tpi/food_povline_ent-1)<=0.
> 2;
(322 real changes made)

.         gen tripopwt=triwt*hhweight*hhsize;
(3 missing values generated)

.         collapse (mean) nf_pc_nom food_povline_ent [aw=tri
> popwt] ,
>         by(spdomain);

.         rename nf_pc_nom povline_nf;

.         lab var povline_nf "Nonfood poverty line";

.         sort spdomain;

. *       merge spdomain using "$foodshr_pastSurvey", keep(s
> pdomain $fdshr_t1);
. *       tab _m;
. *       drop _m;
. *       gen fdshr_t1 = $fdshr_t1;
. *       drop $fdshr_t1;
. *       lab var fdshr_t1 "year t1 (e.g. 1996) poverty line
>  food share";
.      *calculate line for all provinces with flexible food 
> shares;
.                         gen povline_ent_m=food_povline_ent
>  + povline_nf;

.         gen fdshr=food_povline_ent/povline_ent;

.         lab var fdshr "year t2 (e.g. 2002) poverty line fo
> od share";

.       *redo for maputo inserting the fixed food share;
.  *     gen povline_ent=povline_ent_m;
. *MAH;
. *$no_temp_rev   replace povline_ent=food_povline_ent/fdshr
> _t1 if spdomain >=11;
. *       lab var povline_ent   "poverty lines with Maputo r
> egions calculated using fixed bundle non-food shares";
.     lab var povline_ent   "poverty lines with all regions 
> calculated using flexible bundle non-food shares";

. *    lab var povline_ent_m "poverty lines with Maputo regi
> ons calculated using flexible bundle non-food shares";
.         sort spdomain;

. tempfile povlines_ent;

. save `povlines_ent', replace;
(note: file /tmp/St09373.000003 not found)
file /tmp/St09373.000003 saved

. clear;

. **********************************************************
> ****************;
. * Calculate poverty measures with all regions using flexib
> le year t2 food shares
> **********************************************************
> ****************;
. use `contpi';
(Household master record (1 record per household))

.         sort spdomain;

.         merge spdomain using `povlines_ent';
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. **********************************************************
> ****************;
. * Create spatial price index, based on the total poverty l
> ine, with
> * adjustment so that mean (and total) nominal consumption 
> equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first. The mid
> dle of the 13
> * codes is code 7 -- that's arbirtary enough.
> **********************************************************
> ****************;
.         gen cr= cons_pc_tpi ;
(49 missing values generated)

.         gen linpob=povline_ent;
(9 missing values generated)

. *MAH;
.  *Now only 6 regions, so base is chosen as the 1;
.         *qui sum linpob if spdomain==7, meanonly;
.         qui sum linpob if spdomain==1, meanonly;

.         global spi_base=r(mean);

.         gen spi=linpob/$spi_base;
(9 missing values generated)

.         gen cr2=cr/spi;
(49 missing values generated)

.         qui sum cr [aw=hhweight*hhsize];

.         global sumcr=r(sum);

.         qui sum cr2 [aw=hhweight*hhsize];

.         global sumcr2=r(sum);

.         replace spi=spi*$sumcr2/$sumcr;
(2708 real changes made)

.         gen linpobr=linpob/spi;
(9 missing values generated)

.         replace cr2=cr/spi;
(2658 real changes made)

.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
         cr2 |    2668  36669748.9    1891.772   2701.815   
>        0   75452.02
      linpob |    2707    37257099    868.1425   151.8468   
> 652.8669   1014.421
     linpobr |    2707    37257099    880.0636   .0000255   
> 880.0635   880.0636

.         lab var cr      "Temporally-adjusted cons pc";

.         lab var cr2     "Spatially & temporally adjusted c
> ons pc";

.         lab var linpob  "Poverty line";

.         lab var linpobr "Real poverty line";

.         lab var spi     "Spatial price index";

.         *calculate poverty measures;
.         gen h = 100     if cr2 <=(linpobr);
(2051 missing values generated)

.         replace  h = 0  if cr2 > (linpobr);
(2051 real changes made)

.         gen             pg      = ((linpobr - cr2 )/linpob
> r) *100;
(49 missing values generated)

.         replace         pg      = 0             if h==0;
(2051 real changes made)

.         gen             spg     = ((( linpobr - cr2 )/ lin
> pobr )^2)*100;
(49 missing values generated)

.         replace         spg     = 0             if h==0;
(2051 real changes made)

.         gen h_ent  =h;

.         gen pg_ent =pg;
(9 missing values generated)

.         gen spg_ent=spg;
(9 missing values generated)

.         lab var h_ent   "Poverty headcount entropy bundle 
> with Maputo food share fixed";

.         lab var pg_ent  "Poverty gap entropy bundle with M
> aputo food share fixed";

.         lab var spg_ent "Squared poverty gap entropy bundl
> e with Maputo food share fixed";

.         sort hhid;

.         merge hhid using "$path/work/hhdata.dta";
(label lnew already defined)
(label lspdomain already defined)
(label lsurvmon already defined)
(label lsurvquar already defined)
(label intresult already defined)
(label SPLIT already defined)
(label strat already defined)
(label lbur already defined)
(label lbreg already defined)
(label df_UBOS_VISITOUTCO already defined)
(label STATUS already defined)
(label lbregu already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop if _merge~=3;
(1 observation deleted)

.         drop _merge;

.         gen popwt=hhsize*hhweight;
(2 missing values generated)

.         lab var popwt "Population weights = hhsize X hhwei
> ght";

.                 * Stata 10.1 syntax ;
.         svyset , clear;

.         svyset [pweight=popwt] , str(strata) psu(psu);

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>

. *MAH: Below at various places the original reg13 has been 
> changed into spdomain or spdomain ;
.                 svy: mean h_ent pg_ent spg_ent;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
       h_ent |   26.20551   1.436047      23.38147    29.029
> 55
      pg_ent |   9.034107   .6832773      7.690416     10.37
> 78
     spg_ent |   4.776468   .5307839      3.732661    5.8202
> 75
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(rural);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
           0 |   7.030556   1.410337      4.257073    9.8040
> 39
           1 |   29.63539    1.66291      26.36521    32.905
> 56
-------------+----------------------------------------------
> --
pg_ent       |
           0 |   2.710193   .7165812      1.301008    4.1193
> 78
           1 |   10.16528   .7930013      8.605815    11.724
> 75
-------------+----------------------------------------------
> --
spg_ent      |
           0 |   1.594614   .5759745      .4619379     2.727
> 29
           1 |   5.345615   .6157267      4.134765    6.5564
> 66
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(strata);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   8.810118   1.910429      5.053186    12.567
> 05
   _subpop_3 |   24.73079   3.256749      18.32627    31.135
> 32
   _subpop_4 |   27.34775   2.433348      22.56248    32.133
> 03
   _subpop_5 |   27.63444   3.402676      20.94294    34.325
> 93
   _subpop_6 |   37.82071   3.884087       30.1825    45.458
> 92
-------------+----------------------------------------------
> --
pg_ent       |
     Kampala |   1.339719   .8309045     -.2942868    2.9737
> 25
   _subpop_2 |   3.435786   1.002555      1.464223    5.4073
> 49
   _subpop_3 |   11.99634   2.455494      7.167516    16.825
> 16
   _subpop_4 |   7.538297   .9403652      5.689032    9.3875
> 61
   _subpop_5 |   8.648147   1.504704      5.689089    11.607
> 21
   _subpop_6 |   12.88469   1.424606      10.08314    15.686
> 23
-------------+----------------------------------------------
> --
spg_ent      |
     Kampala |   .5937125   .4302219     -.2523357    1.4397
> 61
   _subpop_2 |   2.128129   .8541316      .4484464    3.8078
> 12
   _subpop_3 |   8.668379    2.33407      4.078339    13.258
> 42
   _subpop_4 |   3.142837   .5288138      2.102904     4.182
> 77
   _subpop_5 |   3.685791   .7916016      2.129075    5.2425
> 06
   _subpop_6 |   6.547187   .9367709      4.704991    8.3893
> 84
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(spdomain);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent       |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent      |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         svy: mean h_ent pg_ent spg_ent , over(spdomain);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent        |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent       |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent      |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.                 compress;
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
bswt was float now byte
hhsize was long now byte
one was float now byte
h was float now byte
h_ent was float now byte

.       gen dum=1;

.         sort hhid;

.         *set aside the spatial price index;
.       tempfile spi;

. *      use "$path/work/povmeas_ent.dta", clear;
.       collapse (mean) spi, by(spdomain);

.       sort spdomain;

. save `spi', replace;
(note: file /tmp/St09373.000004 not found)
file /tmp/St09373.000004 saved

. clear;

. **********************************************************
> ****************;
. * Calculate poverty measures with Maputo regions on flexib
> le food shares
> **********************************************************
> ****************;
. use `contpi';
(Household master record (1 record per household))

.         sort spdomain;

.         merge spdomain using `povlines_ent';
variable spdomain does not uniquely identify observations
    in the master data
(label lspdomain already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          9        0.33        0.33
          3 |      2,708       99.67      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop _merge;

. **********************************************************
> ****************;
. * Create spatial price index, based on the total poverty l
> ine, with
> * adjustment so that mean (and total) nominal consumption 
> equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first. The mid
> dle of the 13
> * codes is code 7 -- that's arbirtary enough.
> **********************************************************
> ****************;
.         gen cr= cons_pc_tpi ;
(49 missing values generated)

.         gen linpob=povline_ent_m;
(9 missing values generated)

.         qui sum linpob if spdomain==1, meanonly;

.         global spi_base=r(mean);

.         gen spi=linpob/$spi_base;
(9 missing values generated)

.         gen cr2=cr/spi;
(49 missing values generated)

.         qui sum cr [aw=hhweight*hhsize];

.         global sumcr=r(sum);

.         qui sum cr2 [aw=hhweight*hhsize];

.         global sumcr2=r(sum);

.         replace spi=spi*$sumcr2/$sumcr;
(2708 real changes made)

.         gen linpobr=linpob/spi;
(9 missing values generated)

.         replace cr2=cr/spi;
(2658 real changes made)

.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

    Variable |     Obs      Weight        Mean   Std. Dev.  
>      Min        Max
-------------+----------------------------------------------
> -------------------
          cr |    2668  36669748.9    1891.771   3012.061   
>        0   86178.92
         cr2 |    2668  36669748.9    1891.772   2701.815   
>        0   75452.02
      linpob |    2707    37257099    868.1425   151.8468   
> 652.8669   1014.421
     linpobr |    2707    37257099    880.0636   .0000255   
> 880.0635   880.0636

.         lab var cr      "Temporally-adjusted cons pc";

.         lab var cr2     "Spatially & temporally adjusted c
> ons pc";

.         lab var linpob  "Poverty line";

.         lab var linpobr "Real poverty line";

.         lab var spi     "Spatial price index";

.         *calculate poverty measures;
.         gen h = 100     if cr2 <=(linpobr);
(2051 missing values generated)

.         replace  h = 0 if cr2 > (linpobr);
(2051 real changes made)

.         gen             pg      = ((linpobr - cr2 )/linpob
> r) *100;
(49 missing values generated)

.         replace         pg      = 0             if h==0;
(2051 real changes made)

.         gen             spg     = ((( linpobr - cr2 )/ lin
> pobr )^2)*100;
(49 missing values generated)

.         replace         spg     = 0             if h==0;
(2051 real changes made)

.         gen h_ent_m  =h;

.         gen pg_ent_m =pg;
(9 missing values generated)

.         gen spg_ent_m=spg;
(9 missing values generated)

.         lab var h_ent_m   "Poverty headcount entropy bundl
> e. Food share flexible. Flexible bundle";

.         lab var pg_ent_m  "Poverty gap entropy bundle. Foo
> d share flexible. Flexible bundle";

.         lab var spg_ent_m "Squared poverty gap entropy. Fo
> od share flexible. Flexible bundle";

.         sort hhid;

.         merge hhid using "$path/work/hhdata.dta";
(label lnew already defined)
(label lspdomain already defined)
(label lsurvmon already defined)
(label lsurvquar already defined)
(label intresult already defined)
(label SPLIT already defined)
(label strat already defined)
(label lbur already defined)
(label lbreg already defined)
(label df_UBOS_VISITOUTCO already defined)
(label STATUS already defined)
(label lbregu already defined)

.         tab _merge;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |          1        0.04        0.04
          3 |      2,716       99.96      100.00
------------+-----------------------------------
      Total |      2,717      100.00

.         drop if _merge~=3;
(1 observation deleted)

.         drop _merge;

.         gen popwt=hhsize*hhweight;
(2 missing values generated)

.         lab var popwt "Population weights = hhsize X hhwei
> ght";

.                 * Stata 10.1 syntax ;
.         svyset , clear;

.         svyset [pweight=popwt] , str(strata) psu(psu);

      pweight: popwt
          VCE: linearized
  Single unit: missing
     Strata 1: strata
         SU 1: psu
        FPC 1: <zero>

.                 svy: mean h_ent_m pg_ent_m spg_ent_m;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

------------------------------------------------------------
> --
             |             Linearized
             |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
     h_ent_m |   26.20551   1.436047      23.38147    29.029
> 55
    pg_ent_m |   9.034107   .6832773      7.690416     10.37
> 78
   spg_ent_m |   4.776468   .5307839      3.732661    5.8202
> 75
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(rural)
> ;
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

            0: rural = 0
            1: rural = 1

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
           0 |   7.030556   1.410337      4.257073    9.8040
> 39
           1 |   29.63539    1.66291      26.36521    32.905
> 56
-------------+----------------------------------------------
> --
pg_ent_m     |
           0 |   2.710193   .7165812      1.301008    4.1193
> 78
           1 |   10.16528   .7930013      8.605815    11.724
> 75
-------------+----------------------------------------------
> --
spg_ent_m    |
           0 |   1.594614   .5759745      .4619379     2.727
> 29
           1 |   5.345615   .6157267      4.134765    6.5564
> 66
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(news);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: news = Central
      Eastern: news = Eastern
     Northern: news = Northern
      Western: news = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent_m     |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent_m    |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(reg_tp
> i);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: reg_tpi = Central
      Eastern: reg_tpi = Eastern
     Northern: reg_tpi = Northern
      Western: reg_tpi = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent_m     |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent_m    |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(strata
> );
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Kampala: strata = Kampala
    _subpop_2: strata = Other Urban
    _subpop_3: strata = Central rural
    _subpop_4: strata = East rural
    _subpop_5: strata = North rural
    _subpop_6: strata = West rural

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Kampala |   3.662847   1.808575      .1062138     7.219
> 48
   _subpop_2 |   8.810118   1.910429      5.053186    12.567
> 05
   _subpop_3 |   24.73079   3.256749      18.32627    31.135
> 32
   _subpop_4 |   27.34775   2.433348      22.56248    32.133
> 03
   _subpop_5 |   27.63444   3.402676      20.94294    34.325
> 93
   _subpop_6 |   37.82071   3.884087       30.1825    45.458
> 92
-------------+----------------------------------------------
> --
pg_ent_m     |
     Kampala |   1.339719   .8309045     -.2942868    2.9737
> 25
   _subpop_2 |   3.435786   1.002555      1.464223    5.4073
> 49
   _subpop_3 |   11.99634   2.455494      7.167516    16.825
> 16
   _subpop_4 |   7.538297   .9403652      5.689032    9.3875
> 61
   _subpop_5 |   8.648147   1.504704      5.689089    11.607
> 21
   _subpop_6 |   12.88469   1.424606      10.08314    15.686
> 23
-------------+----------------------------------------------
> --
spg_ent_m    |
     Kampala |   .5937125   .4302219     -.2523357    1.4397
> 61
   _subpop_2 |   2.128129   .8541316      .4484464    3.8078
> 12
   _subpop_3 |   8.668379    2.33407      4.078339    13.258
> 42
   _subpop_4 |   3.142837   .5288138      2.102904     4.182
> 77
   _subpop_5 |   3.685791   .7916016      2.129075    5.2425
> 06
   _subpop_6 |   6.547187   .9367709      4.704991    8.3893
> 84
------------------------------------------------------------
> --

.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(spdoma
> in);
(running mean on estimation sample)

Survey: Mean estimation

Number of strata =       6        Number of obs    =      27
> 07
Number of PSUs   =     368        Population size  =  372570
> 99
                                  Design df        =       3
> 62

      Central: spdomain = Central
      Eastern: spdomain = Eastern
     Northern: spdomain = Northern
      Western: spdomain = Western

------------------------------------------------------------
> --
             |             Linearized
        Over |       Mean   Std. Err.     [95% Conf. Interva
> l]
-------------+----------------------------------------------
> --
h_ent_m      |
     Central |   17.97349   2.276299      13.49706    22.449
> 92
     Eastern |    25.7834   2.279131      21.30141     30.26
> 54
    Northern |   26.09884   3.108754      19.98535    32.212
> 32
     Western |   35.91695   3.664216      28.71112    43.122
> 77
-------------+----------------------------------------------
> --
pg_ent_m     |
     Central |   8.743064    1.69764       5.40459    12.081
> 54
     Eastern |   7.148902   .8731815      5.431757    8.8660
> 47
    Northern |   8.108704   1.359715      5.434772    10.782
> 64
     Western |   12.21801   1.336795      9.589155    14.846
> 87
-------------+----------------------------------------------
> --
spg_ent_m    |
     Central |   6.315694   1.599372      3.170467    9.4609
> 21
     Eastern |   2.989722   .4899763      2.026165     3.953
> 28
    Northern |   3.434597   .7127317      2.032982    4.8362
> 12
     Western |   6.201523   .8749096       4.48098    7.9220
> 67
------------------------------------------------------------
> --

.         drop bswt one h pg spg;

.         compress;
survquar was float now byte
survmon was float now byte
rural was float now byte
spdomain was float now byte
news was float now byte
hhsize was long now byte
h_ent_m was float now byte

. label data "Final data set. Official published poverty rat
> es are calculated from this data set";
note: label truncated to 80 characters

.         sort hhid;

.         save "$path/work/povmeas_ent_flex.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povmeas_ent_flex.dta saved

. gen dum=1;

.         *output the national measures;
.         collapse  (mean) dum h_ent_m pg_ent_m spg_ent_m [a
> w=hhweight*hhsize];

. gen geo="National";

. gen geono=dum;

. tempfile nat;

. save `nat';
file /tmp/St09373.000005 saved

.         *output the rural/urban measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(rural);

. gen geo="Rural/Urban";

. gen geono=rural;

. tempfile rur;

. save `rur';
file /tmp/St09373.000006 saved

.         *output the North South Center measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(news);

. gen geo="North/Center/South";

. gen geono=news;
(1 missing value generated)

. tempfile new;

. save `new';
file /tmp/St09373.000007 saved

.         *output the North South Center rural/urban measure
> s;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(reg_tpi);

. gen geo="TPI - 6 regions";

. gen geono=reg_tpi;

. tempfile rtp;

. save `rtp';
file /tmp/St09373.000008 saved

.         *output the provincial measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(strata);

. gen geo="Provinces";

. gen geono=strata;

. tempfile str;

. save `str';
file /tmp/St09373.000009 saved

.                 *output the dominios espaciais measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hh
> weight*hhsize], by(spdomain);

. gen geo="Spatial domains";

. gen geono=spdomain;
(1 missing value generated)

. tempfile r13;

. save `r13';
file /tmp/St09373.00000a saved

. clear;

. set obs 1;
obs was 0, now 1

. gen geo=" ";

. tempfile one;

. save `one';
file /tmp/St09373.00000b saved

. use          `nat';
(Final data set. Official published poverty rates are calcul
> ated from this data s)

. append using `one';

. append using `rur';
geo was str8 now str11

. append using `one';

. append using `new';
geo was str11 now str18

. append using `one';

. append using `rtp';

. append using `one';

. append using `str';

. append using `one';

. append using `r13';

. outsheet geo geono h_ent_m pg_ent_m spg_ent_m dum rural ne
> ws reg_tpi strata spdomain using "$path/work/poverty_ent_f
> lexBask.csv", replace c ;

.         *set aside the spatial price index;
.       tempfile spi_m;

.       use "$path/work/povmeas_ent_flex.dta", clear;
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.       collapse (mean) spi, by(spdomain);

.       rename spi spi_m;

.       sort spdomain;

. save `spi_m', replace;
(note: file /tmp/St09373.00000c not found)
file /tmp/St09373.00000c saved

. use `povlines_ent';
(Household master record (1 record per household))

.        sort spdomain;

.        merge spdomain using `spi';
(label lspdomain already defined)

.        tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          2 |          1       20.00       20.00
          3 |          4       80.00      100.00
------------+-----------------------------------
      Total |          5      100.00

.  drop _m;

.        sort spdomain;

.        merge spdomain using `spi_m';
(label lspdomain already defined)

.         tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |          5      100.00      100.00
------------+-----------------------------------
      Total |          5      100.00

.  drop _m;

. save "$path/work/povlines.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP3//work/
> povlines.dta saved

. outsheet spdomain food_povline_ent povline_ent fdshr using
>  "$path/work/povlines.csv", replace c;

.  *********************************************************
> ************************
> * 210_povmeas_ent_flex.do               (end)
> **********************************************************
> ***********************;
. log close;
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/UNPS_2011/GAPP
> 3//rep/210_povmeas_ent_flex.log
  log type:  text
 closed on:  23 Oct 2013, 16:02:36
------------------------------------------------------------

. 
end of do-file

.  use "$path/work/povmeas_ent_flex.dta", clear
(Final data set. Official published poverty rates are calcul
> ated from this data s)

.  
.  drop if cr2==0
(10 observations deleted)

.  drop if cr2==.
(48 observations deleted)

.  
.  sum cr2 [aw=hhweight*hhsize], detail

           Spatially & temporally adjusted cons pc
------------------------------------------------------------
> -
      Percentiles      Smallest
 1%     42.04627       4.934788
 5%     414.8094       5.764269
10%     560.8513       8.106004       Obs                265
> 8
25%     851.7521       9.727204       Sum of Wgt.  36500196.
> 3

50%     1348.588                      Mean           1900.55
> 9
                        Largest       Std. Dev.      2704.99
> 8
75%     2099.153       32955.51
90%     3587.078       38050.81       Variance        731701
> 5
95%     5037.809        66836.2       Skewness       13.3424
> 5
99%     9218.054       75452.02       Kurtosis       278.331
> 2

.  ineqdeco cr2 [aw=hhweight*hhsize]
 
 
Percentile ratios for distribution of cr2: all valid obs.
------------------------------------------------------------
p90/p10  p90/p50  p10/p50  p75/p25  p75/p50  p25/p50
------------------------------------------------------------
  6.396    2.660    0.416    2.465    1.557    0.632
              
Generalized Entropy indices GE(a), where a = income differen
> ce
 sensitivity parameter, and Gini coefficient

------------------------------------------------------------
  All obs |   GE(-1)     GE(0)     GE(1)     GE(2)      Gini
----------+-------------------------------------------------
          |  0.92883   0.34868   0.39976   1.01284   0.43485
------------------------------------------------------------
   
Atkinson indices, A(e), where e > 0 is the inequality aversi
> on parameter

----------------------------------------------
  All obs |     A(0.5)        A(1)        A(2)
----------+-----------------------------------
          |    0.16478     0.29438     0.65006
----------------------------------------------

. egen rank= rank(cr2)

. sort rank

.  
.  egen totpop=sum(popwt)

. 
. gen incwt=cr2*popwt

. 
. gen cumpop=popwt[1]

. 
. 
. replace cumpop=cumpop[_n-1]+popwt[_n] if _n>1
(2657 real changes made)

. 
. gen popshares=cumpop/totpop*100

. 
. egen totinc=sum(incwt)

. 
. gen cuminc=incwt[1]

. 
. replace cuminc=cuminc[_n-1] + incwt[_n] if _n>1
(2657 real changes made)

. 
. gen incshares=cuminc/totinc*100

. 
. 
. clear

. clear

. 
. if c(os)=="Unix" {
. global path "/home/bjvca/data/data/GAP/Haruna/UNHS_2005/GA
> PP2/"
. }

. else{
. global path "C:\Users\Templeton\Desktop\GAPP\GAPP-UGANDA-H
> ARUNA\UNHS_2005\GAPP2"
. }

. 
. 
. 
. 
. 
. 
. version 10.1

. 
. cd "$path"
/home/bjvca/data/data/GAP/Haruna/UNHS_2005/GAPP2

. 
. cap log close log_total

. cap log close log_tot_s

. cap log close log_000_boom
