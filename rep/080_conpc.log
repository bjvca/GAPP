---------------------------------------------------
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/rep/0
> 80_conpc.log
  log type:  text
 opened on:  20 May 2013, 12:16:18

. set more off

. #delimit ;
delimiter now ;
. *************************************************
> **************************
> * 080_conpc.do          (start)
> *
> * Creates a file with per capita nominal consumpt
> ion divided between food
> * and non-food categories based on the calorie de
> finition of food
> * rather than the COICOP (INE) definition of food
> . ready for 
> * temporal deflation when necessary
> *************************************************
> ***************************;
. /*
> This file uses:
>         work/hhdata.dta
>         work/consump_nom.dta
>       
> This file creates:
>         work/conpc.dta
> */
> 
> 
> 
> *************************************************
> **************************
> * Food expenditure
> *************************************************
> ***************************;
. *use "$path/in/cons_cod.dta";
. use "$path/work/cons_cod.dta";

.             *sort product;
.             *merge product using "$path/work/food
> _cat.dta";
.             *tab _m;
.             *drop _m;
.             keep if food_cat==1;
(322449 observations deleted)

.             collapse (sum) cod_hh_nom, by(hhid);

.             rename cod_hh_nom food_hh_nom;

.                 sort hhid;

.             keep hhid food_hh_nom;

.             tempfile foodexp;

. save `foodexp';
file /tmp/St02502.000007 saved

. *************************************************
> **************************
> * Food expenditure merged with all expenditure
> *************************************************
> ***************************;
. use "$path/work/cons_cod.dta";

. *use "$path/in/cons_cod.dta";
. *use "$path/in/cons_cat.dta";
. sum;

    Variable |       Obs        Mean    Std. Dev.  
>      Min        Max
-------------+-------------------------------------
> -------------------
        hhid |    412045    2.48e+09    1.13e+09   
> 1.01e+09   4.19e+09
     product |    412045    810.2635    358.1243   
>      100        999
    food_cat |    412045    1.782558    .4125064   
>        1          2
    prod_cat |    412045    1.782558    .4125064   
>        1          2
    descript |    412045    1.782558    .4125064   
>        1          2
-------------+-------------------------------------
> -------------------
   quantityd |    412045    .1694884    1.512903   
>        0   364.2857
 cod_hh_nom3 |    412045    83.35781    341.2477   
>        0      18500
  cod_hh_nom |    412045    1602.923    615777.4   
>        0   3.95e+08
 cod_hh_nom2 |    412045    1602.658    615777.4   
>        0   3.95e+08

. collapse (sum) cod_hh_nom, by(hhid);

. *gen cons_pc_nom = cons_hh_nom/hhsize;
. rename cod_hh_nom cons_hh_nom;

. *keep  hhid cons_pc_nom cons_hh_nom ;
. *keep hhid cod_hh_nom;
. *use "$path/in/cons_cod.dta";
. *use "$path/in/consump_nom.dta";
. *use "$path/work/consump_nom.dta";
. *            keep  hhid cons_hh_nom ;
.             display _N;
6775

.             keep  hhid cons_hh_nom ;

.             sort hhid;

.             merge hhid using "$path/work/hhdata.d
> ta";

.             tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      6,775      100.00      100.00
------------+-----------------------------------
      Total |      6,775      100.00

.             drop _m;

. gen cons_pc_nom = cons_hh_nom/hhsize;

.             sort hhid;

.             merge hhid using `foodexp';

.             tab _m;

     _merge |      Freq.     Percent        Cum.
------------+-----------------------------------
          3 |      6,775      100.00      100.00
------------+-----------------------------------
      Total |      6,775      100.00

.                 drop if _merge==2;
(0 observations deleted)

.             replace food_hh_nom=0 if _merge==1 & 
> food_hh_nom==.;
(0 real changes made)

.             drop _m;

.                 gen food_pc_nom=food_hh_nom/hhsiz
> e;

.                 gen nf_hh_nom=cons_hh_nom-food_hh
> _nom;

.             gen nf_pc_nom=nf_hh_nom/hhsize;

.              keep hhid cons_hh_nom food_pc_nom nf
> _pc_nom cons_pc_nom survquar spdomain news reg_tp
> i rural hhweight hhsize;

.             lab var food_pc_nom "nominal food con
> sumption per capita";

.             lab var nf_pc_nom "nominal non-food c
> onsumption per capita";

. keep hhid cons_hh_nom cons_pc_nom food_pc_nom nf_
> pc_nom;

.             sort hhid;

. * MAH ;
.  sum;

    Variable |       Obs        Mean    Std. Dev.  
>      Min        Max
-------------+-------------------------------------
> -------------------
        hhid |      6775    2.51e+09    1.13e+09   
> 1.01e+09   4.19e+09
 cons_hh_nom |      6775    97487.28     4938495   
> 232.1918   4.06e+08
 cons_pc_nom |      6775    20773.97    987396.4   
> 78.55931   8.12e+07
 food_pc_nom |      6775    1257.269    1252.965   
>        0   17857.14
   nf_pc_nom |      6775     19516.7    987342.9   
> 23.11263   8.12e+07

.  codebook hhid;

---------------------------------------------------
hhid                                 Household Code
---------------------------------------------------

                  type:  numeric (double)

                 range:  [1.013e+09,4.193e+09]     
>    units:  1
         unique values:  6775                     m
> issing .:  0/6775

                  mean:   2.5e+09
              std. dev:   1.1e+09

           percentiles:        10%       25%       
> 50%                                              
>           75%                                    
>                     90%
                           1.0e+09   1.1e+09   2.2e
> +09                                              
>       3.2e+09                                    
>                 4.1e+09

. save "$path/work/conpc.dta", replace;
file /home/bjvca/data/data/GAP/Haruna/work/conpc.dt
> a saved

. *************************************************
> **************************
> * 080_conpc.do          (end)
> *************************************************
> ***************************;
. log close;
      name:  <unnamed>
       log:  /home/bjvca/data/data/GAP/Haruna/rep/0
> 80_conpc.log
  log type:  text
 closed on:  20 May 2013, 12:16:18
---------------------------------------------------
