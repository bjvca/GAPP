GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  *File to estimate quantities consistent with revealed preferences
   2   
      This file uses:
               work\product_flex.inc
               work\price_unit_flex.inc
               work\quan_flex.inc
       
      This file creates:
               work\qent.csv
               work\povline_ali_ent.csv
               work\povline_rp_inout.csv
       
  15   
  16  SETS
  17   cod        200910 codes for products used in basket
  18  /
INCLUDE    /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/product_flex.inc
  20  100
  21  105
  22  107
  23  108
  24  109
  25  110
  26  111
  27  112
  28  113
  29  114
  30  115
  31  116
  32  117
  33  119
  34  121
  35  122
  36  123
  37  125
  38  127
  39  131
  40  132
  41  134
  42  135
  43  136
  44  137
  45  138
  46  139
  47  140
  48  141
  49  144
  50  145
  51  146
  52  147
  53  149
  54  150
  55  /
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


  56   
  57   reg        5 spatial domains /1*5/
  58   r(reg)     all included spatial regions /1*5/
  59   
  60   ptit       price table titles
  61  /
  62    count      number of observations making up the price average
  63    price_uw5  average price
  64  /
  65   
  66   qtit       quantity table titles
  67  /
  68    calperg          calories per gram
  69    quan5            quantities in grams
  70    calpp            calories per person by region
  71    povline_a_flex5    value of flexible food bundle
  72  /
  73   
  74   
  75    posquan(cod,reg)  mark positive quantities in each region
  76    posprice(cod,reg) mark the existence of acceptable price info in each region
  77    chkprice(cod,reg) ensure that prices exist once all estimated
  78  ;
  79   
  80  alias(reg,regq);
  81  alias(r,rq);
  82   
  83  SCALAR
  84     caltarg single level of calories to target across regions / 2150 /
  85   ;
  86   
  87  PARAMETERS
  88   
  89    shr(cod,reg)         shares in each basket by region
  90    chkshr(reg)          check that the calculated shares sum to .9
  91    shrmiss(regq,reg)    shares missing in each region pair
  92    povline_ali(reg)       food poverty line
  93    perc_chng(reg)       percent change in line
  94    finmiss(reg)         final missing shares post optimization procedure
  95   ;
  96   
  97  Table  price(cod,reg,ptit)  price and related information
  98                          count   price_uw5
INCLUDE    /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/price_unit_flex.inc
 100  100     .       1       50      .3995661
 101  100     .       2       110     .2184876
 102  100     .       3       84      .2202229
 103  100     .       4       11      .1758367
 104  100     .       5       184     .2527512
 105  105     .       1       45      .2905593
 106  105     .       2       113     .2001425
 107  105     .       3       181     .2801343
 108  105     .       4       74      .1959993
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 109  105     .       5       178     .275541
 110  107     .       1       23      .1046292
 111  107     .       2       100     .1018378
 112  107     .       3       124     .0896228
 113  107     .       4       123     .0567149
 114  107     .       5       127     .0859971
 115  108     .       1       6       .7275812
 116  108     .       2       24      .769823
 117  108     .       3       134     .7153872
 118  108     .       4       66      .6143053
 119  108     .       5       90      .7374247
 120  109     .       1       10      .9547415
 121  109     .       2       16      .4139681
 122  109     .       3       11      .6229341
 123  109     .       4       4       1.587145
 124  109     .       5       37      .3969439
 125  110     .       1       33      1.813905
 126  110     .       2       30      1.614533
 127  110     .       3       38      1.80015
 128  110     .       4       5       1.487485
 129  110     .       5       25      1.943746
 130  111     .       1       1       .7217374
 131  111     .       2       7       .169242
 132  111     .       3       10      .6993675
 133  111     .       4       35      .6695142
 134  111     .       5       6       .554471
 135  112     .       1       7       .3647109
 136  112     .       2       21      .3352112
 137  112     .       3       48      .3609193
 138  112     .       4       30      .2133312
 139  112     .       5       22      .3404024
 140  113     .       1       59      1.108577
 141  113     .       2       116     1.016006
 142  113     .       3       166     .9602482
 143  113     .       4       75      .8451051
 144  113     .       5       132     .981771
 145  114     .       1       28      1.506199
 146  114     .       2       24      2.175135
 147  114     .       3       19      1.517048
 148  114     .       4       11      1.419274
 149  114     .       5       11      1.837839
 150  115     .       1       2       1.211001
 151  115     .       2       6       1.161291
 152  115     .       3       37      .8585979
 153  115     .       4       29      .7711695
 154  115     .       5       66      .9809347
 155  116     .       1       2       .4775274
 156  116     .       2       2       1.606323
 157  116     .       3       68      .5710354
 158  116     .       4       91      .5317915
 159  116     .       5       6       1.066256
 160  117     .       1       24      4.38446
 161  117     .       2       40      3.853101
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 162  117     .       3       48      4.305331
 163  117     .       4       42      3.822375
 164  117     .       5       63      4.031637
 165  119     .       1       2       4.377135
 166  119     .       2       4       4.774646
 167  119     .       3       8       4.186489
 168  119     .       4       8       4.412935
 169  119     .       5       7       3.970834
 170  121     .       1       1       8
 171  121     .       2       3       5.504595
 172  121     .       3       19      5.196193
 173  121     .       4       17      3.940399
 174  121     .       5       5       5.285081
 175  122     .       1       18      1.449571
 176  122     .       2       31      1.275664
 177  122     .       3       52      .8157603
 178  122     .       4       22      .6384202
 179  122     .       5       27      1.443673
 180  123     .       1       16      .6496703
 181  123     .       2       24      .5111118
 182  123     .       3       62      1.46955
 183  123     .       4       55      2.302036
 184  123     .       5       27      .3667793
 185  125     .       1       28      .1962859
 186  125     .       2       53      .1044095
 187  125     .       3       89      .1628442
 188  125     .       4       33      .0566931
 189  125     .       5       58      .1274182
 190  127     .       1       53      2.341839
 191  127     .       2       99      2.222756
 192  127     .       3       194     1.956287
 193  127     .       4       151     3.383706
 194  127     .       5       59      2.843878
 195  131     .       1       8       .8576708
 196  131     .       2       14      .6827322
 197  131     .       3       13      .6756989
 198  131     .       4       4       .556695
 199  131     .       5       25      .5836598
 200  132     .       1       12      .2173409
 201  132     .       2       23      .1915383
 202  132     .       3       35      .164714
 203  132     .       4       30      .0879856
 204  132     .       5       20      .2280992
 205  134     .       1       9       .8052114
 206  134     .       2       31      1.580484
 207  134     .       3       29      1.449852
 208  134     .       4       15      .4124731
 209  134     .       5       44      .6053748
 210  135     .       1       68      .6606739
 211  135     .       2       114     .4931463
 212  135     .       3       182     .5590131
 213  135     .       4       146     .3609089
 214  135     .       5       156     .4818139
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 215  136     .       1       62      .2685795
 216  136     .       2       134     .1335084
 217  136     .       3       178     .1970362
 218  136     .       4       83      .1945357
 219  136     .       5       144     .244285
 220  137     .       1       11      .5530799
 221  137     .       2       18      .3142624
 222  137     .       3       78      .4860094
 223  137     .       4       33      .6788542
 224  137     .       5       40      .4274666
 225  138     .       1       12      .7731788
 226  138     .       2       49      .4740504
 227  138     .       3       140     .5896314
 228  138     .       4       38      .2776411
 229  138     .       5       146     .3504204
 230  139     .       1       17      .8154725
 231  139     .       2       17      .3269101
 232  139     .       3       134     .6853344
 233  139     .       4       195     .385781
 234  139     .       5       38      .6171452
 235  140     .       1       22      1.463846
 236  140     .       2       41      1.096015
 237  140     .       3       32      .8333274
 238  140     .       4       13      .325876
 239  140     .       5       75      1.408306
 240  141     .       1       40      1.434716
 241  141     .       2       81      1.305719
 242  141     .       3       129     1.464372
 243  141     .       4       172     2.409024
 244  141     .       5       183     1.746994
 245  144     .       1       38      2.299025
 246  144     .       2       63      2.315573
 247  144     .       3       70      2.186683
 248  144     .       4       3       2.425533
 249  144     .       5       95      2.780688
 250  145     .       1       3       3.661716
 251  145     .       2       2       2.617319
 252  145     .       3       19      1.703317
 253  145     .       4       36      1.625573
 254  145     .       5       5       .6555687
 255  146     .       1       1       2.526081
 256  146     .       2       3       2.657319
 257  146     .       3       8       2.544639
 258  146     .       4       82      2.139336
 259  146     .       5       4       2.304299
 260  147     .       1       71      2.139035
 261  147     .       2       110     2.118971
 262  147     .       3       201     2.407685
 263  147     .       4       81      2.456134
 264  147     .       5       78      2.378467
 265  149     .       1       62      1.114803
 266  149     .       2       108     .9161736
 267  149     .       3       192     .8433596
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 268  149     .       4       84      .7016258
 269  149     .       5       80      1.083585
 270  150     .       1       66      .8386476
 271  150     .       2       158     .7439898
 272  150     .       3       280     .8823746
 273  150     .       4       234     .6731347
 274  150     .       5       277     1.028211
 275  ;
 276   
 277  Table   quan(cod,reg,qtit)   quantity and related information
 278                             calperg          quan5           calpp      povline_a_flex5
INCLUDE    /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/quan_flex.inc
 280  100     .       1       6.8900000e-01   3.1635291e+02   2.0828870e+03   889.8895
 281  105     .       1       1.0164000e+00   2.4877730e+02   2.0828870e+03   889.8895
 282  107     .       1       1.3440000e+00   2.7116150e+02   2.0828870e+03   889.8895
 283  109     .       1       6.4680000e-01   1.1328105e+01   2.0828870e+03   889.8895
 284  110     .       1       3.6100000e+00   2.4117695e+01   2.0828870e+03   889.8895
 285  113     .       1       3.6500000e+00   9.6109421e+01   2.0828870e+03   889.8895
 286  114     .       1       2.6600000e+00   2.2570501e+01   2.0828870e+03   889.8895
 287  117     .       1       1.7982000e+00   1.0284187e+01   2.0828870e+03   889.8895
 288  122     .       1       6.1610000e-01   1.3243716e+01   2.0828870e+03   889.8895
 289  123     .       1       3.7500000e+00   2.1505423e+01   2.0828870e+03   889.8895
 290  125     .       1       6.0000000e-01   1.2230495e+02   2.0828870e+03   889.8895
 291  127     .       1       8.8400000e+00   1.0466661e+01   2.0828870e+03   889.8895
 292  135     .       1       3.6400000e-01   2.4918102e+01   2.0828870e+03   889.8895
 293  136     .       1       1.6380000e-01   1.0775903e+02   2.0828870e+03   889.8895
 294  140     .       1       1.0300000e+00   2.5315634e+01   2.0828870e+03   889.8895
 295  141     .       1       3.1300000e+00   3.3992294e+01   2.0828870e+03   889.8895
 296  144     .       1       5.8800000e+00   9.4651937e+00   2.0828870e+03   889.8895
 297  147     .       1       3.8700000e+00   3.8810051e+01   2.0828870e+03   889.8895
 298  149     .       1       0.0000000e+00   6.1791992e+00   2.0828870e+03   889.8895
 299  150     .       1       0.0000000e+00   1.0806116e+01   2.0828870e+03   889.8895
 300  100     .       2       6.8900000e-01   3.4815625e+02   2.0002572e+03   555.6854
 301  105     .       2       1.0164000e+00   3.2112827e+02   2.0002572e+03   555.6854
 302  107     .       2       1.3440000e+00   4.2205240e+02   2.0002572e+03   555.6854
 303  108     .       2       3.1400000e+00   1.4101665e+01   2.0002572e+03   555.6854
 304  109     .       2       6.4680000e-01   1.4534823e+01   2.0002572e+03   555.6854
 305  110     .       2       3.6100000e+00   7.5798683e+00   2.0002572e+03   555.6854
 306  112     .       2       9.4600000e-01   2.8239878e+01   2.0002572e+03   555.6854
 307  113     .       2       3.6500000e+00   6.6441505e+01   2.0002572e+03   555.6854
 308  114     .       2       2.6600000e+00   2.2563956e+00   2.0002572e+03   555.6854
 309  117     .       2       1.7982000e+00   4.9135704e+00   2.0002572e+03   555.6854
 310  122     .       2       6.1610000e-01   9.7675896e+00   2.0002572e+03   555.6854
 311  123     .       2       3.7500000e+00   1.3926577e+01   2.0002572e+03   555.6854
 312  125     .       2       6.0000000e-01   1.1214696e+02   2.0002572e+03   555.6854
 313  127     .       2       8.8400000e+00   5.1773572e+00   2.0002572e+03   555.6854
 314  132     .       2       4.3310000e-01   2.7207230e+01   2.0002572e+03   555.6854
 315  134     .       2       4.9400000e-01   4.6651096e+00   2.0002572e+03   555.6854
 316  135     .       2       3.6400000e-01   1.4235684e+01   2.0002572e+03   555.6854
 317  136     .       2       1.6380000e-01   9.6557587e+01   2.0002572e+03   555.6854
 318  138     .       2       2.0160000e-01   1.2983567e+01   2.0002572e+03   555.6854
 319  140     .       2       1.0300000e+00   1.3683453e+01   2.0002572e+03   555.6854
 320  141     .       2       3.1300000e+00   2.6024237e+01   2.0002572e+03   555.6854
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 321  144     .       2       5.8800000e+00   6.8532047e+00   2.0002572e+03   555.6854
 322  147     .       2       3.8700000e+00   1.4670574e+01   2.0002572e+03   555.6854
 323  150     .       2       0.0000000e+00   1.2762251e+01   2.0002572e+03   555.6854
 324  100     .       3       6.8900000e-01   1.6275621e+02   2.0251438e+03   624.908
 325  105     .       3       1.0164000e+00   3.0236621e+02   2.0251438e+03   624.908
 326  107     .       3       1.3440000e+00   2.9571567e+02   2.0251438e+03   624.908
 327  108     .       3       3.1400000e+00   8.0477211e+01   2.0251438e+03   624.908
 328  110     .       3       3.6100000e+00   5.0796714e+00   2.0251438e+03   624.908
 329  112     .       3       9.4600000e-01   4.6999458e+01   2.0251438e+03   624.908
 330  113     .       3       3.6500000e+00   8.9141907e+01   2.0251438e+03   624.908
 331  115     .       3       3.7800000e+00   1.1517554e+01   2.0251438e+03   624.908
 332  116     .       3       3.3900000e+00   1.8216640e+01   2.0251438e+03   624.908
 333  117     .       3       1.7982000e+00   3.1966283e+00   2.0251438e+03   624.908
 334  121     .       3       1.4835000e+00   1.6440440e+00   2.0251438e+03   624.908
 335  122     .       3       6.1610000e-01   1.8336536e+01   2.0251438e+03   624.908
 336  123     .       3       3.7500000e+00   7.0572748e+00   2.0251438e+03   624.908
 337  125     .       3       6.0000000e-01   1.2962259e+02   2.0251438e+03   624.908
 338  127     .       3       8.8400000e+00   6.4345560e+00   2.0251438e+03   624.908
 339  132     .       3       4.3310000e-01   3.7351021e+01   2.0251438e+03   624.908
 340  136     .       3       1.6380000e-01   5.8524574e+01   2.0251438e+03   624.908
 341  137     .       3       2.6400000e-01   1.5200350e+01   2.0251438e+03   624.908
 342  138     .       3       2.0160000e-01   3.1486195e+01   2.0251438e+03   624.908
 343  139     .       3       2.6100000e-01   3.0870062e+01   2.0251438e+03   624.908
 344  140     .       3       1.0300000e+00   9.7259398e+00   2.0251438e+03   624.908
 345  141     .       3       3.1300000e+00   1.7390507e+01   2.0251438e+03   624.908
 346  144     .       3       5.8800000e+00   3.1950347e+00   2.0251438e+03   624.908
 347  147     .       3       3.8700000e+00   1.3644191e+01   2.0251438e+03   624.908
 348  150     .       3       0.0000000e+00   7.1028972e+00   2.0251438e+03   624.908
 349  105     .       4       1.0164000e+00   9.3457939e+01   1.9823389e+03   379.3367
 350  107     .       4       1.3440000e+00   6.8755811e+02   1.9823389e+03   379.3367
 351  108     .       4       3.1400000e+00   4.0281353e+01   1.9823389e+03   379.3367
 352  111     .       4       3.6500000e+00   2.5156038e+01   1.9823389e+03   379.3367
 353  112     .       4       9.4600000e-01   3.2673512e+01   1.9823389e+03   379.3367
 354  113     .       4       3.6500000e+00   3.8450531e+01   1.9823389e+03   379.3367
 355  115     .       4       3.7800000e+00   7.7890711e+00   1.9823389e+03   379.3367
 356  116     .       4       3.3900000e+00   5.0401882e+01   1.9823389e+03   379.3367
 357  117     .       4       1.7982000e+00   2.9504888e+00   1.9823389e+03   379.3367
 358  121     .       4       1.4835000e+00   1.0620807e+00   1.9823389e+03   379.3367
 359  122     .       4       6.1610000e-01   7.2190170e+00   1.9823389e+03   379.3367
 360  123     .       4       3.7500000e+00   3.2967007e+00   1.9823389e+03   379.3367
 361  125     .       4       6.0000000e-01   1.0624693e+02   1.9823389e+03   379.3367
 362  127     .       4       8.8400000e+00   2.7156093e+00   1.9823389e+03   379.3367
 363  132     .       4       4.3310000e-01   4.1305252e+01   1.9823389e+03   379.3367
 364  135     .       4       3.6400000e-01   8.4795027e+00   1.9823389e+03   379.3367
 365  136     .       4       1.6380000e-01   1.8441324e+01   1.9823389e+03   379.3367
 366  138     .       4       2.0160000e-01   1.3435678e+01   1.9823389e+03   379.3367
 367  139     .       4       2.6100000e-01   8.0086433e+01   1.9823389e+03   379.3367
 368  141     .       4       3.1300000e+00   1.8817539e+01   1.9823389e+03   379.3367
 369  145     .       4       8.1000000e-01   4.3211064e+00   1.9823389e+03   379.3367
 370  146     .       4       5.7300000e+00   6.7436819e+00   1.9823389e+03   379.3367
 371  147     .       4       3.8700000e+00   3.6687465e+00   1.9823389e+03   379.3367
 372  150     .       4       0.0000000e+00   9.8833284e+00   1.9823389e+03   379.3367
 373  100     .       5       6.8900000e-01   4.4422830e+02   2.0901316e+03   623.2383
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 8
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 374  105     .       5       1.0164000e+00   3.0452921e+02   2.0901316e+03   623.2383
 375  107     .       5       1.3440000e+00   4.8888885e+02   2.0901316e+03   623.2383
 376  108     .       5       3.1400000e+00   4.5353386e+01   2.0901316e+03   623.2383
 377  109     .       5       6.4680000e-01   2.7513596e+01   2.0901316e+03   623.2383
 378  112     .       5       9.4600000e-01   2.7269753e+01   2.0901316e+03   623.2383
 379  113     .       5       3.6500000e+00   4.8455517e+01   2.0901316e+03   623.2383
 380  115     .       5       3.7800000e+00   1.7611517e+01   2.0901316e+03   623.2383
 381  117     .       5       1.7982000e+00   5.4191651e+00   2.0901316e+03   623.2383
 382  122     .       5       6.1610000e-01   7.2754774e+00   2.0901316e+03   623.2383
 383  125     .       5       6.0000000e-01   9.7438828e+01   2.0901316e+03   623.2383
 384  135     .       5       3.6400000e-01   1.2953432e+01   2.0901316e+03   623.2383
 385  136     .       5       1.6380000e-01   4.1547646e+01   2.0901316e+03   623.2383
 386  138     .       5       2.0160000e-01   3.3594139e+01   2.0901316e+03   623.2383
 387  140     .       5       1.0300000e+00   2.0917173e+01   2.0901316e+03   623.2383
 388  141     .       5       3.1300000e+00   3.9024433e+01   2.0901316e+03   623.2383
 389  144     .       5       5.8800000e+00   5.7105827e+00   2.0901316e+03   623.2383
 390  147     .       5       3.8700000e+00   3.9461751e+00   2.0901316e+03   623.2383
 391  150     .       5       0.0000000e+00   8.1278076e+00   2.0901316e+03   623.2383
 392  ;
 393   
 394    shr(cod,reg)$quan(cod,reg,'povline_a_flex5')
 395                        =price(cod,reg,'price_uw5')*quan(cod,reg,'quan5')/
 396                         quan(cod,reg,'povline_a_flex5');
 397   
 398    chkshr(reg)=sum(cod,shr(cod,reg));
 399   
 400  loop(reg,
 401    abort$(abs(chkshr(reg)-.9) gt .0001) "share does not sum to .9", chkshr ;
 402  );
 403   
 404   
 405  *turn on dynamic sets to indicate positive quantities and existence of
 406  *price info for each region
 407   
 408   posprice(cod,reg)$(price(cod,reg,'price_uw5')
 409                        AND price(cod,reg,'count') gt 4) = yes;
 410   
 411   posquan(cod,reg)$quan(cod,reg,'quan5')=yes;
 412   
 413   shrmiss(regq,reg)=sum(cod$(NOT posprice(cod,reg)), shr(cod,regq));
 414   display shrmiss;
 415   
 416    povline_ali(reg)=sum(cod$posquan(cod,reg),price(cod,reg,'price_uw5')*
 417                                             quan(cod,reg,'quan5'))/.9;
 418   
 419    display povline_ali;
 420   
 421   
 422  *boost values so shares sum to one;
 423  shr(cod,reg)=shr(cod,reg)/chkshr(reg);
 424   
 425  *fill out price matrix with maximum observed price outside of Maputo
 426   
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/11/14 11:22:28 Page 9
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 427  loop((cod,reg)$(NOT posprice(cod,reg) AND posquan(cod,reg)),
 428           loop(r,
 429                   price(cod,reg,'price_uw5')=max(price(cod,reg,'price_uw5'),
 430                                                price(cod,r,'price_uw5'));
 431           );
 432  );
 433   
 434  chkprice(cod,reg)$(NOT price(cod,reg,'price_uw5') AND posquan(cod,reg))=yes;
 435   
 436  display 'should be an empty set', chkprice;
 437   
 438   
 439   
 440   
 441  Variables
 442     z                objective value
 443     q(cod,reg)       revised maximum entropy quanties in grams
 444     s(cod,reg)       derived maximum entropy shares
 445     povline(regq,reg)  estimated revealed preference matrix
 446  ;
 447   
 448   
 449  Equations
 450     obj              objective equation
 451     rev(regq,reg)    revealed preference tests
 452     deflin(regq,reg) define revealed preference matrix
 453     defshr(cod,regq) define the endogenous budget shares
 454     cals(regq)       ensure that each bundle hits the calorie
 455   
 456  ;
 457   
 458     obj ..  z=e= sum((cod,rq)$posquan(cod,rq),
 459                     s(cod,rq)*log(s(cod,rq)/shr(cod,rq)));
 460   
 461     deflin(rq,r) .. povline(rq,r) =e= sum(cod$posquan(cod,rq),
 462                            q(cod,rq)*price(cod,r,'price_uw5'));
 463   
 464     rev(rq,r) ..    povline(r,rq)=g=povline(rq,rq);
 465   
 466     defshr(cod,rq)$posquan(cod,rq) ..
 467               povline(rq,rq)*s(cod,rq)=e= q(cod,rq)*price(cod,rq,'price_uw5');
 468   
 469     cals(rq) .. sum(cod$posquan(cod,rq),
 470                      q(cod,rq)*quan(cod,rq,'calperg'))=e=.95*caltarg;
 471   
 472  *set bounds and starting values for variables
 473   
 474    q.lo(cod,reg)=.00001;
 475    q.up(cod,reg)=inf;
 476    q.l(cod,reg)=quan(cod,reg,'quan5');
 477    q.fx(cod,reg)$(NOT posquan(cod,reg))=0;
 478   
 479    povline.l(regq,reg)= sum(cod$posquan(cod,regq),
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 10
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 480                            q.l(cod,regq)*price(cod,reg,'price_uw5'));
 481   
 482   
 483    display povline.l;
 484   
 485  *print the revealed preference matrix prior to optimisation;
 486  file povline_rp/"/home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/povline_rp_inout.csv"/;
 487  put povline_rp;
 488  povline_rp.pc=5;
 489  povline_rp.nd=0;
 490  put " ";
 491  loop(reg,
 492        put reg.tl;
 493  );
 494  put /;
 495  loop(regq,
 496       put regq.tl;
 497       loop(reg,
 498           put povline.l(regq,reg);
 499       );
 500       put /;
 501  );
 502  put /; put /; put /;
 503   
 504     s.l(cod,regq)= q.l(cod,regq)*price(cod,regq,'price_uw5')/povline.l(regq,regq);
 505     s.lo(cod,regq)=.0001;
 506     s.fx(cod,regq)$(NOT posquan(cod,regq))=0;
 507   
 508   
 509     model revpref /obj, deflin, rev, defshr, cals/;
 510   
 511     revpref.holdfixed=1;
 512   
 513     option limrow=100;
 514   
 515     option nlp=conopt;
 516   
 517     solve revpref using nlp minimizing z;
 518   
 519     povline.l(regq,reg)$(NOT rq(regq) OR NOT r(reg))=0;
 520     display "this is without adjustment for calorie target or 90%", povline.l;
 521   
 522  put /;
 523  loop(rq,
 524       put rq.tl;
 525       loop(r,
 526           put povline.l(rq,r);
 527       );
 528       put /;
 529  );
 530  put /;
 531   
 532   
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 11
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 533  PARAMETERS
 534     qent(cod,reg)  entropy quantities with all adjustments accounted for
 535     povline_ent(reg) entropy line that hits calorie targets (100% food expen)
 536    ;
 537  *readjust quantities to hit regional calorie target and calculate line;
 538     qent(cod,r)=q.l(cod,r)*quan(cod,r,'calpp')/caltarg;
 539   
 540     povline_ent(r)=sum(cod$posquan(cod,r),price(cod,r,'price_uw5')*
 541                                             qent(cod,r))/.9;
 542   
 543     perc_chng(r)=100*(povline_ent(r)/povline_ali(r)-1);
 544   
 545     display perc_chng, povline_ent, povline_ali;
 546   
 547     file res/"/home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/qent.csv"/;
 548   
 549     put res;
 550     res.pc=5;
 551     res.nd=6;
 552   
 553  *recall that the basket reflects 90% of expenditure and 95% of calories";
 554     put "spdomain" ;
 555     put "product" ;
 556     put "quan5";
 557     put "qent";
 558     put "price";
 559     put "calperg";
 560   
 561     put /;
 562   
 563     loop(reg,
 564         loop(cod,
 565             put reg.tl;
 566             put cod.tl;
 567             put quan(cod,reg,'quan5');
 568             put qent(cod,reg);
 569             put price(cod,reg,'price_uw5')
 570             put quan(cod,reg,'calperg');
 571             put /;
 572         );
 573     );
 574   
 575     file lin/"/home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/povline_food_ent.csv"/;
 576   
 577     put lin;
 578     lin.pc=5;
 579  *Flexible, entropy, and fixed food pov lines at 100% expenditure
 580   
 581     put "spdomain";
 582     put "flex";
 583     put "ent";
 584     put /;
 585   
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 12
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 586     loop(reg,
 587           put reg.tl;
 588           put povline_ali(reg);
 589           put povline_ent(reg);
 590           put /;
 591     );
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 13
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/new/190a_revpref13_r_bjorn.gms
     2       19 INCLUDE        1      19  ./home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/product_flex.inc
     3       99 INCLUDE        1      64  ./home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/price_unit_flex.inc
     4      279 INCLUDE        1      69  ./home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/quan_flex.inc


COMPILATION TIME     =        0.002 SECONDS      3 MB  24.1.2 r40979 LEX-LEG
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 14
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    414 PARAMETER shrmiss  shares missing in each region pair

            1           2           4           5

1                               0.037
2                               0.039
3       0.046       0.030       0.011
4       0.198       0.138                   0.038
5       0.028                   0.043


----    419 PARAMETER povline_ali  food poverty line

1 889.889,    2 555.685,    3 624.908,    4 379.337,    5 623.238


----    436 should be an empty set

----    436 SET chkprice  ensure that prices exist once all estimated

                                                      ( EMPTY )


----    483 VARIABLE povline.L  estimated revealed preference matrix

            1           2           3           4           5

1     800.901     657.103     702.661     676.482     742.660
2     650.959     500.117     549.604     497.676     566.534
3     652.486     541.232     562.417     478.096     590.908
4     467.075     425.288     417.580     341.403     431.466
5     675.509     502.631     532.138     480.214     560.914

GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 15
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


---- obj  =E=  objective equation

obj..  z - (1)*s(100,1) - (1)*s(100,2) - (1)*s(100,3) - (1)*s(100,5) - (1)*s(105,1) - (1)*s(105,2) - (1)*s(105,3) - (1)*s(105,4) - (1)*s(105,5) - (1)*s(107,1) - (1)*s(107,2) - (1)*s(107,3) - (1)*s(107,4) - (1)*s(107,5) - (1)*s(108,2) - (1)*s(108,3)
     
      - (1)*s(108,4) - (1)*s(108,5) - (1)*s(109,1) - (1)*s(109,2) - (1)*s(109,5) - (1)*s(110,1) - (1)*s(110,2) - (1)*s(110,3) - (1)*s(111,4) - (1)*s(112,2) - (1)*s(112,3) - (1)*s(112,4) - (1)*s(112,5) - (1)*s(113,1) - (1)*s(113,2) - (1)*s(113,3)
     
      - (1)*s(113,4) - (1)*s(113,5) - (1)*s(114,1) - (1)*s(114,2) - (1)*s(115,3) - (1)*s(115,4) - (1)*s(115,5) - (1)*s(116,3) - (1)*s(116,4) - (1)*s(117,1) - (1)*s(117,2) - (1)*s(117,3) - (1)*s(117,4) - (1)*s(117,5) - (1)*s(121,3) - (1)*s(121,4)
     
      - (1)*s(122,1) - (1)*s(122,2) - (1)*s(122,3) - (1)*s(122,4) - (1)*s(122,5) - (1)*s(123,1) - (1)*s(123,2) - (1)*s(123,3) - (1)*s(123,4) - (1)*s(125,1) - (1)*s(125,2) - (1)*s(125,3) - (1)*s(125,4) - (1)*s(125,5) - (1)*s(127,1) - (1)*s(127,2)
     
      - (1)*s(127,3) - (1)*s(127,4) - (1)*s(132,2) - (1)*s(132,3) - (1)*s(132,4) - (1)*s(134,2) - (1)*s(135,1) - (1)*s(135,2) - (1)*s(135,4) - (1)*s(135,5) - (1)*s(136,1) - (1)*s(136,2) - (1)*s(136,3) - (1)*s(136,4) - (1)*s(136,5) - (1)*s(137,3)
     
      - (1)*s(138,2) - (1)*s(138,3) - (1)*s(138,4) - (1)*s(138,5) - (1)*s(139,3) - (1)*s(139,4) - (1)*s(140,1) - (1)*s(140,2) - (1)*s(140,3) - (1)*s(140,5) - (1)*s(141,1) - (1)*s(141,2) - (1)*s(141,3) - (1)*s(141,4) - (1)*s(141,5) - (1)*s(144,1)
     
      - (1)*s(144,2) - (1)*s(144,3) - (1)*s(144,5) - (1)*s(145,4) - (1)*s(146,4) - (1)*s(147,1) - (1)*s(147,2) - (1)*s(147,3) - (1)*s(147,4) - (1)*s(147,5) - (1)*s(149,1) - (1)*s(150,1) - (1)*s(150,2) - (1)*s(150,3) - (1)*s(150,4) - (1)*s(150,5) =E= 0 ;
     
      (LHS = 0)
     

---- deflin  =E=  define revealed preference matrix

deflin(1,1)..  - 0.3995661*q(100,1) - 0.2905593*q(105,1) - 0.1046292*q(107,1) - 0.9547415*q(109,1) - 1.813905*q(110,1) - 1.108577*q(113,1) - 1.506199*q(114,1) - 4.38446*q(117,1) - 1.449571*q(122,1) - 0.6496703*q(123,1) - 0.1962859*q(125,1)
     
      - 2.341839*q(127,1) - 0.6606739*q(135,1) - 0.2685795*q(136,1) - 1.463846*q(140,1) - 1.434716*q(141,1) - 2.299025*q(144,1) - 2.139035*q(147,1) - 1.114803*q(149,1) - 0.8386476*q(150,1) + povline(1,1) =E= 0 ; (LHS = 0)
     
deflin(1,2)..  - 0.2184876*q(100,1) - 0.2001425*q(105,1) - 0.1018378*q(107,1) - 0.4139681*q(109,1) - 1.614533*q(110,1) - 1.016006*q(113,1) - 2.175135*q(114,1) - 3.853101*q(117,1) - 1.275664*q(122,1) - 0.5111118*q(123,1) - 0.1044095*q(125,1)
     
      - 2.222756*q(127,1) - 0.4931463*q(135,1) - 0.1335084*q(136,1) - 1.096015*q(140,1) - 1.305719*q(141,1) - 2.315573*q(144,1) - 2.118971*q(147,1) - 0.9161736*q(149,1) - 0.7439898*q(150,1) + povline(1,2) =E= 0 ; (LHS = 0)
     
deflin(1,3)..  - 0.2202229*q(100,1) - 0.2801343*q(105,1) - 0.0896228*q(107,1) - 0.6229341*q(109,1) - 1.80015*q(110,1) - 0.9602482*q(113,1) - 1.517048*q(114,1) - 4.305331*q(117,1) - 0.8157603*q(122,1) - 1.46955*q(123,1) - 0.1628442*q(125,1)
     
      - 1.956287*q(127,1) - 0.5590131*q(135,1) - 0.1970362*q(136,1) - 0.8333274*q(140,1) - 1.464372*q(141,1) - 2.186683*q(144,1) - 2.407685*q(147,1) - 0.8433596*q(149,1) - 0.8823746*q(150,1) + povline(1,3) =E= 0 ; (LHS = 0)
     
deflin(1,4)..  - 0.1758367*q(100,1) - 0.1959993*q(105,1) - 0.0567149*q(107,1) - 1.587145*q(109,1) - 1.487485*q(110,1) - 0.8451051*q(113,1) - 1.419274*q(114,1) - 3.822375*q(117,1) - 0.6384202*q(122,1) - 2.302036*q(123,1) - 0.0566931*q(125,1)
     
      - 3.383706*q(127,1) - 0.3609089*q(135,1) - 0.1945357*q(136,1) - 0.325876*q(140,1) - 2.409024*q(141,1) - 2.425533*q(144,1) - 2.456134*q(147,1) - 0.7016258*q(149,1) - 0.6731347*q(150,1) + povline(1,4) =E= 0 ; (LHS = 0)
     
deflin(1,5)..  - 0.2527512*q(100,1) - 0.275541*q(105,1) - 0.0859971*q(107,1) - 0.3969439*q(109,1) - 1.943746*q(110,1) - 0.981771*q(113,1) - 1.837839*q(114,1) - 4.031637*q(117,1) - 1.443673*q(122,1) - 0.3667793*q(123,1) - 0.1274182*q(125,1)
     
      - 2.843878*q(127,1) - 0.4818139*q(135,1) - 0.244285*q(136,1) - 1.408306*q(140,1) - 1.746994*q(141,1) - 2.780688*q(144,1) - 2.378467*q(147,1) - 1.083585*q(149,1) - 1.028211*q(150,1) + povline(1,5) =E= 0 ; (LHS = 0)
     
deflin(2,1)..  - 0.3995661*q(100,2) - 0.2905593*q(105,2) - 0.1046292*q(107,2) - 0.7275812*q(108,2) - 0.9547415*q(109,2) - 1.813905*q(110,2) - 0.3647109*q(112,2) - 1.108577*q(113,2) - 1.506199*q(114,2) - 4.38446*q(117,2) - 1.449571*q(122,2)
     
      - 0.6496703*q(123,2) - 0.1962859*q(125,2) - 2.341839*q(127,2) - 0.2173409*q(132,2) - 0.8052114*q(134,2) - 0.6606739*q(135,2) - 0.2685795*q(136,2) - 0.7731788*q(138,2) - 1.463846*q(140,2) - 1.434716*q(141,2) - 2.299025*q(144,2) - 2.139035*q(147,2)
     
      - 0.8386476*q(150,2) + povline(2,1) =E= 0 ; (LHS = 0)
     
deflin(2,2)..  - 0.2184876*q(100,2) - 0.2001425*q(105,2) - 0.1018378*q(107,2) - 0.769823*q(108,2) - 0.4139681*q(109,2) - 1.614533*q(110,2) - 0.3352112*q(112,2) - 1.016006*q(113,2) - 2.175135*q(114,2) - 3.853101*q(117,2) - 1.275664*q(122,2)
     
      - 0.5111118*q(123,2) - 0.1044095*q(125,2) - 2.222756*q(127,2) - 0.1915383*q(132,2) - 1.580484*q(134,2) - 0.4931463*q(135,2) - 0.1335084*q(136,2) - 0.4740504*q(138,2) - 1.096015*q(140,2) - 1.305719*q(141,2) - 2.315573*q(144,2) - 2.118971*q(147,2)
     
      - 0.7439898*q(150,2) + povline(2,2) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 16
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


     deflin  =E=  define revealed preference matrix

deflin(2,3)..  - 0.2202229*q(100,2) - 0.2801343*q(105,2) - 0.0896228*q(107,2) - 0.7153872*q(108,2) - 0.6229341*q(109,2) - 1.80015*q(110,2) - 0.3609193*q(112,2) - 0.9602482*q(113,2) - 1.517048*q(114,2) - 4.305331*q(117,2) - 0.8157603*q(122,2)
     
      - 1.46955*q(123,2) - 0.1628442*q(125,2) - 1.956287*q(127,2) - 0.164714*q(132,2) - 1.449852*q(134,2) - 0.5590131*q(135,2) - 0.1970362*q(136,2) - 0.5896314*q(138,2) - 0.8333274*q(140,2) - 1.464372*q(141,2) - 2.186683*q(144,2) - 2.407685*q(147,2)
     
      - 0.8823746*q(150,2) + povline(2,3) =E= 0 ; (LHS = 0)
     
deflin(2,4)..  - 0.1758367*q(100,2) - 0.1959993*q(105,2) - 0.0567149*q(107,2) - 0.6143053*q(108,2) - 1.587145*q(109,2) - 1.487485*q(110,2) - 0.2133312*q(112,2) - 0.8451051*q(113,2) - 1.419274*q(114,2) - 3.822375*q(117,2) - 0.6384202*q(122,2)
     
      - 2.302036*q(123,2) - 0.0566931*q(125,2) - 3.383706*q(127,2) - 0.0879856*q(132,2) - 0.4124731*q(134,2) - 0.3609089*q(135,2) - 0.1945357*q(136,2) - 0.2776411*q(138,2) - 0.325876*q(140,2) - 2.409024*q(141,2) - 2.425533*q(144,2) - 2.456134*q(147,2)
     
      - 0.6731347*q(150,2) + povline(2,4) =E= 0 ; (LHS = 0)
     
deflin(2,5)..  - 0.2527512*q(100,2) - 0.275541*q(105,2) - 0.0859971*q(107,2) - 0.7374247*q(108,2) - 0.3969439*q(109,2) - 1.943746*q(110,2) - 0.3404024*q(112,2) - 0.981771*q(113,2) - 1.837839*q(114,2) - 4.031637*q(117,2) - 1.443673*q(122,2)
     
      - 0.3667793*q(123,2) - 0.1274182*q(125,2) - 2.843878*q(127,2) - 0.2280992*q(132,2) - 0.6053748*q(134,2) - 0.4818139*q(135,2) - 0.244285*q(136,2) - 0.3504204*q(138,2) - 1.408306*q(140,2) - 1.746994*q(141,2) - 2.780688*q(144,2) - 2.378467*q(147,2)
     
      - 1.028211*q(150,2) + povline(2,5) =E= 0 ; (LHS = 0)
     
deflin(3,1)..  - 0.3995661*q(100,3) - 0.2905593*q(105,3) - 0.1046292*q(107,3) - 0.7275812*q(108,3) - 1.813905*q(110,3) - 0.3647109*q(112,3) - 1.108577*q(113,3) - 1.211001*q(115,3) - 0.4775274*q(116,3) - 4.38446*q(117,3) - 8*q(121,3) - 1.449571*q(122,3)
     
      - 0.6496703*q(123,3) - 0.1962859*q(125,3) - 2.341839*q(127,3) - 0.2173409*q(132,3) - 0.2685795*q(136,3) - 0.5530799*q(137,3) - 0.7731788*q(138,3) - 0.8154725*q(139,3) - 1.463846*q(140,3) - 1.434716*q(141,3) - 2.299025*q(144,3) - 2.139035*q(147,3)
     
      - 0.8386476*q(150,3) + povline(3,1) =E= 0 ; (LHS = 0)
     
deflin(3,2)..  - 0.2184876*q(100,3) - 0.2001425*q(105,3) - 0.1018378*q(107,3) - 0.769823*q(108,3) - 1.614533*q(110,3) - 0.3352112*q(112,3) - 1.016006*q(113,3) - 1.161291*q(115,3) - 1.606323*q(116,3) - 3.853101*q(117,3) - 5.504595*q(121,3)
     
      - 1.275664*q(122,3) - 0.5111118*q(123,3) - 0.1044095*q(125,3) - 2.222756*q(127,3) - 0.1915383*q(132,3) - 0.1335084*q(136,3) - 0.3142624*q(137,3) - 0.4740504*q(138,3) - 0.3269101*q(139,3) - 1.096015*q(140,3) - 1.305719*q(141,3) - 2.315573*q(144,3)
     
      - 2.118971*q(147,3) - 0.7439898*q(150,3) + povline(3,2) =E= 0 ; (LHS = 0)
     
deflin(3,3)..  - 0.2202229*q(100,3) - 0.2801343*q(105,3) - 0.0896228*q(107,3) - 0.7153872*q(108,3) - 1.80015*q(110,3) - 0.3609193*q(112,3) - 0.9602482*q(113,3) - 0.8585979*q(115,3) - 0.5710354*q(116,3) - 4.305331*q(117,3) - 5.196193*q(121,3)
     
      - 0.8157603*q(122,3) - 1.46955*q(123,3) - 0.1628442*q(125,3) - 1.956287*q(127,3) - 0.164714*q(132,3) - 0.1970362*q(136,3) - 0.4860094*q(137,3) - 0.5896314*q(138,3) - 0.6853344*q(139,3) - 0.8333274*q(140,3) - 1.464372*q(141,3) - 2.186683*q(144,3)
     
      - 2.407685*q(147,3) - 0.8823746*q(150,3) + povline(3,3) =E= 0 ; (LHS = 0)
     
deflin(3,4)..  - 0.1758367*q(100,3) - 0.1959993*q(105,3) - 0.0567149*q(107,3) - 0.6143053*q(108,3) - 1.487485*q(110,3) - 0.2133312*q(112,3) - 0.8451051*q(113,3) - 0.7711695*q(115,3) - 0.5317915*q(116,3) - 3.822375*q(117,3) - 3.940399*q(121,3)
     
      - 0.6384202*q(122,3) - 2.302036*q(123,3) - 0.0566931*q(125,3) - 3.383706*q(127,3) - 0.0879856*q(132,3) - 0.1945357*q(136,3) - 0.6788542*q(137,3) - 0.2776411*q(138,3) - 0.385781*q(139,3) - 0.325876*q(140,3) - 2.409024*q(141,3) - 2.425533*q(144,3)
     
      - 2.456134*q(147,3) - 0.6731347*q(150,3) + povline(3,4) =E= 0 ; (LHS = 0)
     
deflin(3,5)..  - 0.2527512*q(100,3) - 0.275541*q(105,3) - 0.0859971*q(107,3) - 0.7374247*q(108,3) - 1.943746*q(110,3) - 0.3404024*q(112,3) - 0.981771*q(113,3) - 0.9809347*q(115,3) - 1.066256*q(116,3) - 4.031637*q(117,3) - 5.285081*q(121,3)
     
      - 1.443673*q(122,3) - 0.3667793*q(123,3) - 0.1274182*q(125,3) - 2.843878*q(127,3) - 0.2280992*q(132,3) - 0.244285*q(136,3) - 0.4274666*q(137,3) - 0.3504204*q(138,3) - 0.6171452*q(139,3) - 1.408306*q(140,3) - 1.746994*q(141,3) - 2.780688*q(144,3)
     
      - 2.378467*q(147,3) - 1.028211*q(150,3) + povline(3,5) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 17
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


     deflin  =E=  define revealed preference matrix

deflin(4,1)..  - 0.2905593*q(105,4) - 0.1046292*q(107,4) - 0.7275812*q(108,4) - 0.7217374*q(111,4) - 0.3647109*q(112,4) - 1.108577*q(113,4) - 1.211001*q(115,4) - 0.4775274*q(116,4) - 4.38446*q(117,4) - 8*q(121,4) - 1.449571*q(122,4) - 0.6496703*q(123,4)
     
      - 0.1962859*q(125,4) - 2.341839*q(127,4) - 0.2173409*q(132,4) - 0.6606739*q(135,4) - 0.2685795*q(136,4) - 0.7731788*q(138,4) - 0.8154725*q(139,4) - 1.434716*q(141,4) - 3.661716*q(145,4) - 2.526081*q(146,4) - 2.139035*q(147,4) - 0.8386476*q(150,4)
     
      + povline(4,1) =E= 0 ; (LHS = 0)
     
deflin(4,2)..  - 0.2001425*q(105,4) - 0.1018378*q(107,4) - 0.769823*q(108,4) - 0.169242*q(111,4) - 0.3352112*q(112,4) - 1.016006*q(113,4) - 1.161291*q(115,4) - 1.606323*q(116,4) - 3.853101*q(117,4) - 5.504595*q(121,4) - 1.275664*q(122,4)
     
      - 0.5111118*q(123,4) - 0.1044095*q(125,4) - 2.222756*q(127,4) - 0.1915383*q(132,4) - 0.4931463*q(135,4) - 0.1335084*q(136,4) - 0.4740504*q(138,4) - 0.3269101*q(139,4) - 1.305719*q(141,4) - 2.617319*q(145,4) - 2.657319*q(146,4) - 2.118971*q(147,4)
     
      - 0.7439898*q(150,4) + povline(4,2) =E= 0 ; (LHS = 0)
     
deflin(4,3)..  - 0.2801343*q(105,4) - 0.0896228*q(107,4) - 0.7153872*q(108,4) - 0.6993675*q(111,4) - 0.3609193*q(112,4) - 0.9602482*q(113,4) - 0.8585979*q(115,4) - 0.5710354*q(116,4) - 4.305331*q(117,4) - 5.196193*q(121,4) - 0.8157603*q(122,4)
     
      - 1.46955*q(123,4) - 0.1628442*q(125,4) - 1.956287*q(127,4) - 0.164714*q(132,4) - 0.5590131*q(135,4) - 0.1970362*q(136,4) - 0.5896314*q(138,4) - 0.6853344*q(139,4) - 1.464372*q(141,4) - 1.703317*q(145,4) - 2.544639*q(146,4) - 2.407685*q(147,4)
     
      - 0.8823746*q(150,4) + povline(4,3) =E= 0 ; (LHS = 0)
     
deflin(4,4)..  - 0.1959993*q(105,4) - 0.0567149*q(107,4) - 0.6143053*q(108,4) - 0.6695142*q(111,4) - 0.2133312*q(112,4) - 0.8451051*q(113,4) - 0.7711695*q(115,4) - 0.5317915*q(116,4) - 3.822375*q(117,4) - 3.940399*q(121,4) - 0.6384202*q(122,4)
     
      - 2.302036*q(123,4) - 0.0566931*q(125,4) - 3.383706*q(127,4) - 0.0879856*q(132,4) - 0.3609089*q(135,4) - 0.1945357*q(136,4) - 0.2776411*q(138,4) - 0.385781*q(139,4) - 2.409024*q(141,4) - 1.625573*q(145,4) - 2.139336*q(146,4) - 2.456134*q(147,4)
     
      - 0.6731347*q(150,4) + povline(4,4) =E= 0 ; (LHS = 0)
     
deflin(4,5)..  - 0.275541*q(105,4) - 0.0859971*q(107,4) - 0.7374247*q(108,4) - 0.554471*q(111,4) - 0.3404024*q(112,4) - 0.981771*q(113,4) - 0.9809347*q(115,4) - 1.066256*q(116,4) - 4.031637*q(117,4) - 5.285081*q(121,4) - 1.443673*q(122,4)
     
      - 0.3667793*q(123,4) - 0.1274182*q(125,4) - 2.843878*q(127,4) - 0.2280992*q(132,4) - 0.4818139*q(135,4) - 0.244285*q(136,4) - 0.3504204*q(138,4) - 0.6171452*q(139,4) - 1.746994*q(141,4) - 0.6555687*q(145,4) - 2.304299*q(146,4) - 2.378467*q(147,4)
     
      - 1.028211*q(150,4) + povline(4,5) =E= 0 ; (LHS = 0)
     
deflin(5,1)..  - 0.3995661*q(100,5) - 0.2905593*q(105,5) - 0.1046292*q(107,5) - 0.7275812*q(108,5) - 0.9547415*q(109,5) - 0.3647109*q(112,5) - 1.108577*q(113,5) - 1.211001*q(115,5) - 4.38446*q(117,5) - 1.449571*q(122,5) - 0.1962859*q(125,5)
     
      - 0.6606739*q(135,5) - 0.2685795*q(136,5) - 0.7731788*q(138,5) - 1.463846*q(140,5) - 1.434716*q(141,5) - 2.299025*q(144,5) - 2.139035*q(147,5) - 0.8386476*q(150,5) + povline(5,1) =E= 0 ; (LHS = 0)
     
deflin(5,2)..  - 0.2184876*q(100,5) - 0.2001425*q(105,5) - 0.1018378*q(107,5) - 0.769823*q(108,5) - 0.4139681*q(109,5) - 0.3352112*q(112,5) - 1.016006*q(113,5) - 1.161291*q(115,5) - 3.853101*q(117,5) - 1.275664*q(122,5) - 0.1044095*q(125,5)
     
      - 0.4931463*q(135,5) - 0.1335084*q(136,5) - 0.4740504*q(138,5) - 1.096015*q(140,5) - 1.305719*q(141,5) - 2.315573*q(144,5) - 2.118971*q(147,5) - 0.7439898*q(150,5) + povline(5,2) =E= 0 ; (LHS = 0)
     
deflin(5,3)..  - 0.2202229*q(100,5) - 0.2801343*q(105,5) - 0.0896228*q(107,5) - 0.7153872*q(108,5) - 0.6229341*q(109,5) - 0.3609193*q(112,5) - 0.9602482*q(113,5) - 0.8585979*q(115,5) - 4.305331*q(117,5) - 0.8157603*q(122,5) - 0.1628442*q(125,5)
     
      - 0.5590131*q(135,5) - 0.1970362*q(136,5) - 0.5896314*q(138,5) - 0.8333274*q(140,5) - 1.464372*q(141,5) - 2.186683*q(144,5) - 2.407685*q(147,5) - 0.8823746*q(150,5) + povline(5,3) =E= 0 ; (LHS = 0)
     
deflin(5,4)..  - 0.1758367*q(100,5) - 0.1959993*q(105,5) - 0.0567149*q(107,5) - 0.6143053*q(108,5) - 1.587145*q(109,5) - 0.2133312*q(112,5) - 0.8451051*q(113,5) - 0.7711695*q(115,5) - 3.822375*q(117,5) - 0.6384202*q(122,5) - 0.0566931*q(125,5)
     
      - 0.3609089*q(135,5) - 0.1945357*q(136,5) - 0.2776411*q(138,5) - 0.325876*q(140,5) - 2.409024*q(141,5) - 2.425533*q(144,5) - 2.456134*q(147,5) - 0.6731347*q(150,5) + povline(5,4) =E= 0 ; (LHS = 0)
     
deflin(5,5)..  - 0.2527512*q(100,5) - 0.275541*q(105,5) - 0.0859971*q(107,5) - 0.7374247*q(108,5) - 0.3969439*q(109,5) - 0.3404024*q(112,5) - 0.981771*q(113,5) - 0.9809347*q(115,5) - 4.031637*q(117,5) - 1.443673*q(122,5) - 0.1274182*q(125,5)
     
      - 0.4818139*q(135,5) - 0.244285*q(136,5) - 0.3504204*q(138,5) - 1.408306*q(140,5) - 1.746994*q(141,5) - 2.780688*q(144,5) - 2.378467*q(147,5) - 1.028211*q(150,5) + povline(5,5) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 18
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


---- rev  =G=  revealed preference tests

rev(1,2)..  - povline(1,1) + povline(2,1) =G= 0 ; (LHS = -149.942031015685, INFES = 149.942031015685 ****)
     
rev(1,3)..  - povline(1,1) + povline(3,1) =G= 0 ; (LHS = -148.414917350077, INFES = 148.414917350077 ****)
     
rev(1,4)..  - povline(1,1) + povline(4,1) =G= 0 ; (LHS = -333.825986100462, INFES = 333.825986100462 ****)
     
rev(1,5)..  - povline(1,1) + povline(5,1) =G= 0 ; (LHS = -125.391607410965, INFES = 125.391607410965 ****)
     
rev(2,1)..  povline(1,2) - povline(2,2) =G= 0 ; (LHS = 156.985726400232)
     
rev(2,3)..  - povline(2,2) + povline(3,2) =G= 0 ; (LHS = 41.114684457907)
     
rev(2,4)..  - povline(2,2) + povline(4,2) =G= 0 ; (LHS = -74.8290513138759, INFES = 74.8290513138759 ****)
     
rev(2,5)..  - povline(2,2) + povline(5,2) =G= 0 ; (LHS = 2.51419957334178)
     
rev(3,1)..  povline(1,3) - povline(3,3) =G= 0 ; (LHS = 140.243702149242)
     
rev(3,2)..  povline(2,3) - povline(3,3) =G= 0 ; (LHS = -12.8135698933901, INFES = 12.8135698933901 ****)
     
rev(3,4)..  - povline(3,3) + povline(4,3) =G= 0 ; (LHS = -144.836815476463, INFES = 144.836815476463 ****)
     
rev(3,5)..  - povline(3,3) + povline(5,3) =G= 0 ; (LHS = -30.2795396381608, INFES = 30.2795396381608 ****)
     
rev(4,1)..  povline(1,4) - povline(4,4) =G= 0 ; (LHS = 335.07851495235)
     
rev(4,2)..  povline(2,4) - povline(4,4) =G= 0 ; (LHS = 156.273001125095)
     
rev(4,3)..  povline(3,4) - povline(4,4) =G= 0 ; (LHS = 136.692613531778)
     
rev(4,5)..  - povline(4,4) + povline(5,4) =G= 0 ; (LHS = 138.81068766343)
     
rev(5,1)..  povline(1,5) - povline(5,5) =G= 0 ; (LHS = 181.745600136479)
     
rev(5,2)..  povline(2,5) - povline(5,5) =G= 0 ; (LHS = 5.61927935634549)
     
rev(5,3)..  povline(3,5) - povline(5,5) =G= 0 ; (LHS = 29.9933039466625)
     
rev(5,4)..  povline(4,5) - povline(5,5) =G= 0 ; (LHS = -129.448599676623, INFES = 129.448599676623 ****)
     

---- defshr  =E=  define the endogenous budget shares

defshr(100,1)..  - 0.3995661*q(100,1) + (800.900537602264)*s(100,1) + (0.157827211417262)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(100,2)..  - 0.2184876*q(100,2) + (500.116920313903)*s(100,2) + (0.152100079796851)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(100,3)..  - 0.2202229*q(100,3) + (562.417225336856)*s(100,3) + (0.0637296351258468)*povline(3,3) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 19
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


     defshr  =E=  define the endogenous budget shares

defshr(100,5)..  - 0.2527512*q(100,5) + (560.91446889845)*s(100,5) + (0.200171759019623)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(105,1)..  - 0.2905593*q(105,1) + (800.900537602264)*s(105,1) + (0.0902541011650405)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(105,2)..  - 0.2001425*q(105,2) + (500.116920313903)*s(105,2) + (0.12851277804825)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(105,3)..  - 0.2801343*q(105,3) + (562.417225336856)*s(105,3) + (0.150605534052181)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(105,4)..  - 0.1959993*q(105,4) + (341.403071486915)*s(105,4) + (0.0536541471160864)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(105,5)..  - 0.275541*q(105,5) + (560.91446889845)*s(105,5) + (0.149595504671857)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(107,1)..  - 0.1046292*q(107,1) + (800.900537602264)*s(107,1) + (0.0354243872787729)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(107,2)..  - 0.1018378*q(107,2) + (500.116920313903)*s(107,2) + (0.0859416791452339)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(107,3)..  - 0.0896228*q(107,3) + (562.417225336856)*s(107,3) + (0.0471231412469671)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(107,4)..  - 0.0567149*q(107,4) + (341.403071486915)*s(107,4) + (0.114219210984262)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(107,5)..  - 0.0859971*q(107,5) + (560.91446889845)*s(107,5) + (0.0749544282658657)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(108,2)..  - 0.769823*q(108,2) + (500.116920313903)*s(108,2) + (0.0217064962498794)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(108,3)..  - 0.7153872*q(108,3) + (562.417225336856)*s(108,3) + (0.102365937683748)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(108,4)..  - 0.6143053*q(108,4) + (341.403071486915)*s(108,4) + (0.0724804511315573)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(108,5)..  - 0.7374247*q(108,5) + (560.91446889845)*s(108,5) + (0.0596253242151419)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(109,1)..  - 0.9547415*q(109,1) + (800.900537602264)*s(109,1) + (0.0135040638032741)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(109,2)..  - 0.4139681*q(109,2) + (500.116920313903)*s(109,2) + (0.0120310927640075)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(109,5)..  - 0.3969439*q(109,5) + (560.91446889845)*s(109,5) + (0.0194706228932056)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(110,1)..  - 1.813905*q(110,1) + (800.900537602264)*s(110,1) + (0.0546225223920381)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(110,2)..  - 1.614533*q(110,2) + (500.116920313903)*s(110,2) + (0.0244701728914163)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(110,3)..  - 1.80015*q(110,3) + (562.417225336856)*s(110,3) + (0.016258695606688)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(111,4)..  - 0.6695142*q(111,4) + (341.403071486915)*s(111,4) + (0.0493326688110512)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(112,2)..  - 0.3352112*q(112,2) + (500.116920313903)*s(112,2) + (0.0189282205974794)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(112,3)..  - 0.3609193*q(112,3) + (562.417225336856)*s(112,3) + (0.0301609031828275)*povline(3,3) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 20
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


     defshr  =E=  define the endogenous budget shares

defshr(112,4)..  - 0.2133312*q(112,4) + (341.403071486915)*s(112,4) + (0.0204165694608918)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(112,5)..  - 0.3404024*q(112,5) + (560.91446889845)*s(112,5) + (0.0165492064892478)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(113,1)..  - 1.108577*q(113,1) + (800.900537602264)*s(113,1) + (0.133031117600308)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(113,2)..  - 1.016006*q(113,2) + (500.116920313903)*s(113,2) + (0.134978372030804)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(113,3)..  - 0.9602482*q(113,3) + (562.417225336856)*s(113,3) + (0.152197251231146)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(113,4)..  - 0.8451051*q(113,4) + (341.403071486915)*s(113,4) + (0.0951799868240305)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(113,5)..  - 0.981771*q(113,5) + (560.91446889845)*s(113,5) + (0.0848118991724916)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(114,1)..  - 1.506199*q(114,1) + (800.900537602264)*s(114,1) + (0.0424468013687133)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(114,2)..  - 2.175135*q(114,2) + (500.116920313903)*s(114,2) + (0.00981363526018169)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(115,3)..  - 0.8585979*q(115,3) + (562.417225336856)*s(115,3) + (0.0175829388433359)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(115,4)..  - 0.7711695*q(115,4) + (341.403071486915)*s(115,4) + (0.0175941418438049)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(115,5)..  - 0.9809347*q(115,5) + (560.91446889845)*s(115,5) + (0.0307992556848584)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(116,3)..  - 0.5710354*q(116,3) + (562.417225336856)*s(116,3) + (0.0184957818509659)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(116,4)..  - 0.5317915*q(116,4) + (341.403071486915)*s(116,4) + (0.0785092304965695)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(117,1)..  - 4.38446*q(117,1) + (800.900537602264)*s(117,1) + (0.0562998829655081)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(117,2)..  - 3.853101*q(117,2) + (500.116920313903)*s(117,2) + (0.0378561137462161)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(117,3)..  - 4.305331*q(117,3) + (562.417225336856)*s(117,3) + (0.0244703438932268)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(117,4)..  - 3.822375*q(117,4) + (341.403071486915)*s(117,4) + (0.0330338991321355)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(117,5)..  - 4.031637*q(117,5) + (560.91446889845)*s(117,5) + (0.0389508699413211)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(121,3)..  - 5.196193*q(121,3) + (562.417225336856)*s(121,3) + (0.0151893817252403)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(121,4)..  - 3.940399*q(121,4) + (341.403071486915)*s(121,4) + (0.0122583013385681)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(122,1)..  - 1.449571*q(122,1) + (800.900537602264)*s(122,1) + (0.0239701507796587)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(122,2)..  - 1.275664*q(122,2) + (500.116920313903)*s(122,2) + (0.024914498816944)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(122,3)..  - 0.8157603*q(122,3) + (562.417225336856)*s(122,3) + (0.0265963015257253)*povline(3,3) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 21
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


     defshr  =E=  define the endogenous budget shares

defshr(122,4)..  - 0.6384202*q(122,4) + (341.403071486915)*s(122,4) + (0.013499486858366)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(122,5)..  - 1.443673*q(122,5) + (560.91446889845)*s(122,5) + (0.0187255114048266)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(123,1)..  - 0.6496703*q(123,1) + (800.900537602264)*s(123,1) + (0.0174446563038459)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(123,2)..  - 0.5111118*q(123,2) + (500.116920313903)*s(123,2) + (0.0142327474820106)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(123,3)..  - 1.46955*q(123,3) + (562.417225336856)*s(123,3) + (0.0184400792065505)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(123,4)..  - 2.302036*q(123,4) + (341.403071486915)*s(123,4) + (0.022229219144316)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(125,1)..  - 0.1962859*q(125,1) + (800.900537602264)*s(125,1) + (0.029974679823635)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(125,2)..  - 0.1044095*q(125,2) + (500.116920313903)*s(125,2) + (0.0234129411433842)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(125,3)..  - 0.1628442*q(125,3) + (562.417225336856)*s(125,3) + (0.0375313664296739)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(125,4)..  - 0.0566931*q(125,4) + (341.403071486915)*s(125,4) + (0.0176432736851164)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(125,5)..  - 0.1274182*q(125,5) + (560.91446889845)*s(125,5) + (0.0221343551687153)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(127,1)..  - 2.341839*q(127,1) + (800.900537602264)*s(127,1) + (0.0306045929285561)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(127,2)..  - 2.222756*q(127,2) + (500.116920313903)*s(127,2) + (0.0230106227424181)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(127,3)..  - 1.956287*q(127,3) + (562.417225336856)*s(127,3) + (0.0223816726915371)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(127,4)..  - 3.383706*q(127,4) + (341.403071486915)*s(127,4) + (0.0269148822886849)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(132,2)..  - 0.1915383*q(132,2) + (500.116920313903)*s(132,2) + (0.0104200165406084)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(132,3)..  - 0.164714*q(132,3) + (562.417225336856)*s(132,3) + (0.0109389182902589)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(132,4)..  - 0.0879856*q(132,4) + (341.403071486915)*s(132,4) + (0.0106450928064087)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(134,2)..  - 1.580484*q(134,2) + (500.116920313903)*s(134,2) + (0.0147428146930493)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(135,1)..  - 0.6606739*q(135,1) + (800.900537602264)*s(135,1) + (0.0205552860261824)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(135,2)..  - 0.4931463*q(135,2) + (500.116920313903)*s(135,2) + (0.0140372673017399)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(135,4)..  - 0.3609089*q(135,4) + (341.403071486915)*s(135,4) + (0.00896397322576908)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(135,5)..  - 0.4818139*q(135,5) + (560.91446889845)*s(135,5) + (0.0111267295396417)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(136,1)..  - 0.2685795*q(136,1) + (800.900537602264)*s(136,1) + (0.0361366549765732)*povline(1,1) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 22
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


     defshr  =E=  define the endogenous budget shares

defshr(136,2)..  - 0.1335084*q(136,2) + (500.116920313903)*s(136,2) + (0.0257764703104616)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(136,3)..  - 0.1970362*q(136,3) + (562.417225336856)*s(136,3) + (0.0205033899178179)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(136,4)..  - 0.1945357*q(136,4) + (341.403071486915)*s(136,4) + (0.0105080948968683)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(136,5)..  - 0.244285*q(136,5) + (560.91446889845)*s(136,5) + (0.0180944997247834)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(137,3)..  - 0.4860094*q(137,3) + (562.417225336856)*s(137,3) + (0.0131352893376715)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(138,2)..  - 0.4740504*q(138,2) + (500.116920313903)*s(138,2) + (0.012306852417458)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(138,3)..  - 0.5896314*q(138,3) + (562.417225336856)*s(138,3) + (0.0330097450827603)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(138,4)..  - 0.2776411*q(138,4) + (341.403071486915)*s(138,4) + (0.0109263704128941)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(138,5)..  - 0.3504204*q(138,5) + (560.91446889845)*s(138,5) + (0.0209872846552776)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(139,3)..  - 0.6853344*q(139,3) + (562.417225336856)*s(139,3) + (0.0376167629041969)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(139,4)..  - 0.385781*q(139,4) + (341.403071486915)*s(139,4) + (0.0904966205330615)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(140,1)..  - 1.463846*q(140,1) + (800.900537602264)*s(140,1) + (0.0462706513836397)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(140,2)..  - 1.096015*q(140,2) + (500.116920313903)*s(140,2) + (0.0299875271774085)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(140,3)..  - 0.8333274*q(140,3) + (562.417225336856)*s(140,3) + (0.0144108177363098)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(140,5)..  - 1.408306*q(140,5) + (560.91446889845)*s(140,5) + (0.052517419093839)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(141,1)..  - 1.434716*q(141,1) + (800.900537602264)*s(141,1) + (0.060893064480278)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(141,2)..  - 1.305719*q(141,2) + (500.116920313903)*s(141,2) + (0.067944793169715)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(141,3)..  - 1.464372*q(141,3) + (562.417225336856)*s(141,3) + (0.0452798569626868)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(141,4)..  - 2.409024*q(141,4) + (341.403071486915)*s(141,4) + (0.132781181125588)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(141,5)..  - 1.746994*q(141,5) + (560.91446889845)*s(141,5) + (0.121543397584819)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(144,1)..  - 2.299025*q(144,1) + (800.900537602264)*s(144,1) + (0.0271703113239126)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(144,2)..  - 2.315573*q(144,2) + (500.116920313903)*s(144,2) + (0.0317307715900368)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(144,3)..  - 2.186683*q(144,3) + (562.417225336856)*s(144,3) + (0.0124223223403507)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(144,5)..  - 2.780688*q(144,5) + (560.91446889845)*s(144,5) + (0.0283097507149035)*povline(5,5) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 23
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 517


     defshr  =E=  define the endogenous budget shares

defshr(145,4)..  - 1.625573*q(145,4) + (341.403071486915)*s(145,4) + (0.0205747237814069)*povline(4,4) =E= 0 ; (LHS = 0)
     
REMAINING 12 ENTRIES SKIPPED


---- cals  =E=  ensure that each bundle hits the calorie

cals(1)..  0.689*q(100,1) + 1.0164*q(105,1) + 1.344*q(107,1) + 0.6468*q(109,1) + 3.61*q(110,1) + 3.65*q(113,1) + 2.66*q(114,1) + 1.7982*q(117,1) + 0.6161*q(122,1) + 3.75*q(123,1) + 0.6*q(125,1) + 8.84*q(127,1) + 0.364*q(135,1) + 0.1638*q(136,1)
     
      + 1.03*q(140,1) + 3.13*q(141,1) + 5.88*q(144,1) + 3.87*q(147,1) =E= 2042.5 ; (LHS = 1978.742681073, INFES = 63.7573189270004 ****)
     
cals(2)..  0.689*q(100,2) + 1.0164*q(105,2) + 1.344*q(107,2) + 3.14*q(108,2) + 0.6468*q(109,2) + 3.61*q(110,2) + 0.946*q(112,2) + 3.65*q(113,2) + 2.66*q(114,2) + 1.7982*q(117,2) + 0.6161*q(122,2) + 3.75*q(123,2) + 0.6*q(125,2) + 8.84*q(127,2)
     
      + 0.4331*q(132,2) + 0.494*q(134,2) + 0.364*q(135,2) + 0.1638*q(136,2) + 0.2016*q(138,2) + 1.03*q(140,2) + 3.13*q(141,2) + 5.88*q(144,2) + 3.87*q(147,2) =E= 2042.5 ; (LHS = 1900.24424114044, INFES = 142.25575885956 ****)
     
cals(3)..  0.689*q(100,3) + 1.0164*q(105,3) + 1.344*q(107,3) + 3.14*q(108,3) + 3.61*q(110,3) + 0.946*q(112,3) + 3.65*q(113,3) + 3.78*q(115,3) + 3.39*q(116,3) + 1.7982*q(117,3) + 1.4835*q(121,3) + 0.6161*q(122,3) + 3.75*q(123,3) + 0.6*q(125,3)
     
      + 8.84*q(127,3) + 0.4331*q(132,3) + 0.1638*q(136,3) + 0.264*q(137,3) + 0.2016*q(138,3) + 0.261*q(139,3) + 1.03*q(140,3) + 3.13*q(141,3) + 5.88*q(144,3) + 3.87*q(147,3) =E= 2042.5 ; (LHS = 1923.88671451896, INFES = 118.613285481041 ****)
     
cals(4)..  1.0164*q(105,4) + 1.344*q(107,4) + 3.14*q(108,4) + 3.65*q(111,4) + 0.946*q(112,4) + 3.65*q(113,4) + 3.78*q(115,4) + 3.39*q(116,4) + 1.7982*q(117,4) + 1.4835*q(121,4) + 0.6161*q(122,4) + 3.75*q(123,4) + 0.6*q(125,4) + 8.84*q(127,4)
     
      + 0.4331*q(132,4) + 0.364*q(135,4) + 0.1638*q(136,4) + 0.2016*q(138,4) + 0.261*q(139,4) + 3.13*q(141,4) + 0.81*q(145,4) + 5.73*q(146,4) + 3.87*q(147,4) =E= 2042.5 ; (LHS = 1883.22202297791, INFES = 159.27797702209 ****)
     
cals(5)..  0.689*q(100,5) + 1.0164*q(105,5) + 1.344*q(107,5) + 3.14*q(108,5) + 0.6468*q(109,5) + 0.946*q(112,5) + 3.65*q(113,5) + 3.78*q(115,5) + 1.7982*q(117,5) + 0.6161*q(122,5) + 0.6*q(125,5) + 0.364*q(135,5) + 0.1638*q(136,5) + 0.2016*q(138,5)
     
      + 1.03*q(140,5) + 3.13*q(141,5) + 5.88*q(144,5) + 3.87*q(147,5) =E= 2042.5 ; (LHS = 1985.62486631196, INFES = 56.87513368804 ****)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 24
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE revpref Using NLP From line 517


---- z  objective value

z
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       obj


---- q  revised maximum entropy quanties in grams

q(100,1)
                (.LO, .L, .UP, .M = 1E-5, 316.35291, +INF, 0)
       -0.3996  deflin(1,1)
       -0.2185  deflin(1,2)
       -0.2202  deflin(1,3)
       -0.1758  deflin(1,4)
       -0.2528  deflin(1,5)
       -0.3996  defshr(100,1)
        0.689   cals(1)

q(100,2)
                (.LO, .L, .UP, .M = 1E-5, 348.15625, +INF, 0)
       -0.3996  deflin(2,1)
       -0.2185  deflin(2,2)
       -0.2202  deflin(2,3)
       -0.1758  deflin(2,4)
       -0.2528  deflin(2,5)
       -0.2185  defshr(100,2)
        0.689   cals(2)

q(100,3)
                (.LO, .L, .UP, .M = 1E-5, 162.75621, +INF, 0)
       -0.3996  deflin(3,1)
       -0.2185  deflin(3,2)
       -0.2202  deflin(3,3)
       -0.1758  deflin(3,4)
       -0.2528  deflin(3,5)
       -0.2202  defshr(100,3)
        0.689   cals(3)

REMAINING 109 ENTRIES SKIPPED

---- s  derived maximum entropy shares

s(100,1)
                (.LO, .L, .UP, .M = 0.0001, 0.157827211417262, +INF, 0)
      (-1)      obj
     (800.9005) defshr(100,1)

s(100,2)
                (.LO, .L, .UP, .M = 0.0001, 0.152100079796851, +INF, 0)
      (-1)      obj
     (500.1169) defshr(100,2)

GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 25
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE revpref Using NLP From line 517


     s  derived maximum entropy shares

s(100,3)
                (.LO, .L, .UP, .M = 0.0001, 0.0637296351258468, +INF, 0)
      (-1)      obj
     (562.4172) defshr(100,3)

REMAINING 109 ENTRIES SKIPPED

---- povline  estimated revealed preference matrix

povline(1,1)
                (.LO, .L, .UP, .M = -INF, 800.900537602264, +INF, 0)
        1       deflin(1,1)
       -1       rev(1,2)
       -1       rev(1,3)
       -1       rev(1,4)
       -1       rev(1,5)
       (0.1578) defshr(100,1)
       (0.0903) defshr(105,1)
       (0.0354) defshr(107,1)
       (0.0135) defshr(109,1)
       (0.0546) defshr(110,1)
       (0.133)  defshr(113,1)
       (0.0424) defshr(114,1)
       (0.0563) defshr(117,1)
       (0.024)  defshr(122,1)
       (0.0174) defshr(123,1)
       (0.03)   defshr(125,1)
       (0.0306) defshr(127,1)
       (0.0206) defshr(135,1)
       (0.0361) defshr(136,1)
       (0.0463) defshr(140,1)
       (0.0609) defshr(141,1)
       (0.0272) defshr(144,1)
       (0.1037) defshr(147,1)
       (0.0086) defshr(149,1)
       (0.0113) defshr(150,1)

povline(1,2)
                (.LO, .L, .UP, .M = -INF, 657.102646714136, +INF, 0)
        1       deflin(1,2)
        1       rev(2,1)

povline(1,3)
                (.LO, .L, .UP, .M = -INF, 702.660927486098, +INF, 0)
        1       deflin(1,3)
        1       rev(3,1)

REMAINING 22 ENTRIES SKIPPED
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 26
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE revpref Using NLP From line 517


MODEL STATISTICS

BLOCKS OF EQUATIONS           5     SINGLE EQUATIONS          163
BLOCKS OF VARIABLES           4     SINGLE VARIABLES          250
NON ZERO ELEMENTS         1,180     NON LINEAR N-Z            336
DERIVATIVE POOL              10     CONSTANT POOL             128
CODE LENGTH               1,010


GENERATION TIME      =        0.008 SECONDS      4 MB  24.1.2 r40979 LEX-LEG


EXECUTION TIME       =        0.009 SECONDS      4 MB  24.1.2 r40979 LEX-LEG
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 27
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


               S O L V E      S U M M A R Y

     MODEL   revpref             OBJECTIVE  z
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  CONOPT              FROM LINE  517

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      2 Locally Optimal           
**** OBJECTIVE VALUE                0.0505

 RESOURCE USAGE, LIMIT          0.035      1000.000
 ITERATION COUNT, LIMIT        45    2000000000
 EVALUATION ERRORS              0             0
CONOPT 3         24.1.2 r40979 Released Jun 16, 2013 LEG x86_64/Linux         
 
 
    C O N O P T 3   version 3.15K
    Copyright (C)   ARKI Consulting and Development A/S
                    Bagsvaerdvej 246 A
                    DK-2880 Bagsvaerd, Denmark
 
 
    The model has 250 variables and 163 constraints
    with 1180 Jacobian elements, 336 of which are nonlinear.
    The Hessian of the Lagrangian has 112 elements on the diagonal,
    112 elements below the diagonal, and 117 nonlinear variables.
 
 ** Optimal solution. Reduced gradient less than tolerance.
 
 
 CONOPT time Total                            0.034 seconds
   of which: Function evaluations             0.008 = 23.5%
             1st Derivative evaluations       0.002 =  5.9%
             2nd Derivative evaluations       0.002 =  5.9%
             Directional 2nd Derivative       0.000 =  0.0%
 

                           LOWER          LEVEL          UPPER         MARGINAL

---- EQU obj                 .              .              .             1.0000      

  obj  objective equation

---- EQU deflin  define revealed preference matrix

           LOWER          LEVEL          UPPER         MARGINAL

1.1          .              .              .            -0.0012      
1.2          .              .              .             EPS         
1.3          .              .              .             EPS         
1.4          .              .              .             EPS         
1.5          .              .              .             EPS         
2.1          .              .              .             EPS         
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 28
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


     EQU deflin  define revealed preference matrix

           LOWER          LEVEL          UPPER         MARGINAL

2.2          .              .              .            -0.0018      
2.3          .              .              .             EPS         
2.4          .              .              .             EPS         
2.5          .              .              .       -2.479064E-5      
3.1          .              .              .       -8.131822E-5      
3.2          .              .              .             EPS         
3.3          .              .              .            -0.0015      
3.4          .              .              .             EPS         
3.5          .              .              .       -1.742836E-5      
4.1          .              .              .            -0.0002      
4.2          .              .              .             EPS         
4.3          .              .              .             EPS         
4.4          .              .              .            -0.0021      
4.5          .              .              .             EPS         
5.1          .              .              .             EPS         
5.2          .              .              .             EPS         
5.3          .              .              .            -0.0002      
5.4          .              .              .             EPS         
5.5          .              .              .            -0.0016      

---- EQU rev  revealed preference tests

           LOWER          LEVEL          UPPER         MARGINAL

1.2          .            26.5636        +INF            EPS         
1.3          .              .            +INF      8.1318216E-5      
1.4          .              .            +INF            0.0002      
1.5          .            63.2589        +INF            EPS         
2.1          .            20.8911        +INF             .          
2.3          .            22.2431        +INF             .          
2.4          .            45.7089        +INF            EPS         
2.5          .             6.5496        +INF            EPS         
3.1          .            18.8128        +INF             .          
3.2          .            11.5664        +INF            EPS         
3.4          .            16.8462        +INF            EPS         
3.5          .              .            +INF            0.0002      
4.1          .            85.4772        +INF             .          
4.2          .            47.4403        +INF             .          
4.3          .             2.8704        +INF             .          
4.5          .            39.6921        +INF            EPS         
5.1          .            12.0502        +INF             .          
5.2          .              .            +INF      2.4790642E-5      
5.3          .              .            +INF      1.7428357E-5      
5.4          .             0.7112        +INF            EPS         
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 29
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


---- EQU defshr  define the endogenous budget shares

             LOWER          LEVEL          UPPER         MARGINAL

100.1          .              .              .             0.0014      
100.2          .              .              .             0.0018      
100.3          .              .              .             0.0018      
100.5          .              .              .             0.0016      
105.1          .              .              .             0.0016      
105.2          .              .              .             0.0018      
105.3          .              .              .             0.0017      
105.4          .              .              .             0.0020      
105.5          .              .              .             0.0016      
107.1          .              .              .             0.0026      
107.2          .              .              .             0.0018      
107.3          .              .              .             0.0019      
107.4          .              .              .             0.0006      
107.5          .              .              .             0.0012      
108.2          .              .              .             0.0018      
108.3          .              .              .             0.0017      
108.4          .              .              .             0.0019      
108.5          .              .              .             0.0016      
109.1          .              .              .             0.0012      
109.2          .              .              .             0.0019      
109.5          .              .              .             0.0018      
110.1          .              .              .             0.0014      
110.2          .              .              .             0.0019      
110.3          .              .              .             0.0017      
111.4          .              .              .             0.0019      
112.2          .              .              .             0.0018      
112.3          .              .              .             0.0017      
112.4          .              .              .             0.0021      
112.5          .              .              .             0.0017      
113.1          .              .              .             0.0015      
113.2          .              .              .             0.0018      
113.3          .              .              .             0.0017      
113.4          .              .              .             0.0020      
113.5          .              .              .             0.0016      
114.1          .              .              .             0.0014      
114.2          .              .              .             0.0018      
115.3          .              .              .             0.0017      
115.4          .              .              .             0.0021      
115.5          .              .              .             0.0016      
116.3          .              .              .             0.0017      
116.4          .              .              .             0.0018      
117.1          .              .              .             0.0012      
117.2          .              .              .             0.0019      
117.3          .              .              .             0.0017      
117.4          .              .              .             0.0023      
117.5          .              .              .             0.0017      
121.3          .              .              .             0.0017      
121.4          .              .              .             0.0025      
122.1          .              .              .             0.0012      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 30
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


     EQU defshr  define the endogenous budget shares

             LOWER          LEVEL          UPPER         MARGINAL

122.2          .              .              .             0.0019      
122.3          .              .              .             0.0017      
122.4          .              .              .             0.0026      
122.5          .              .              .             0.0017      
123.1          .              .              .             0.0018      
123.2          .              .              .             0.0018      
123.3          .              .              .             0.0016      
123.4          .              .              .             0.0020      
125.1          .              .              .             0.0015      
125.2          .              .              .             0.0018      
125.3          .              .              .             0.0017      
125.4          .              .              .             0.0021      
125.5          .              .              .             0.0016      
127.1          .              .              .             0.0016      
127.2          .              .              .             0.0018      
127.3          .              .              .             0.0017      
127.4          .              .              .             0.0020      
132.2          .              .              .             0.0019      
132.3          .              .              .             0.0017      
132.4          .              .              .             0.0023      
134.2          .              .              .             0.0018      
135.1          .              .              .             0.0012      
135.2          .              .              .             0.0019      
135.4          .              .              .             0.0024      
135.5          .              .              .             0.0017      
136.1          .              .              .             0.0012      
136.2          .              .              .             0.0019      
136.3          .              .              .             0.0017      
136.4          .              .              .             0.0023      
136.5          .              .              .             0.0017      
137.3          .              .              .             0.0017      
138.2          .              .              .             0.0019      
138.3          .              .              .             0.0017      
138.4          .              .              .             0.0027      
138.5          .              .              .             0.0018      
139.3          .              .              .             0.0017      
139.4          .              .              .             0.0025      
140.1          .              .              .             0.0012      
140.2          .              .              .             0.0019      
140.3          .              .              .             0.0017      
140.5          .              .              .             0.0017      
141.1          .              .              .             0.0014      
141.2          .              .              .             0.0019      
141.3          .              .              .             0.0017      
141.4          .              .              .             0.0021      
141.5          .              .              .             0.0017      
144.1          .              .              .             0.0014      
144.2          .              .              .             0.0018      
144.3          .              .              .             0.0017      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 31
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


     EQU defshr  define the endogenous budget shares

             LOWER          LEVEL          UPPER         MARGINAL

144.5          .              .              .             0.0016      
145.4          .              .              .             0.0026      
146.4          .              .              .             0.0021      
147.1          .              .              .             0.0014      
147.2          .              .              .             0.0019      
147.3          .              .              .             0.0017      
147.4          .              .              .             0.0022      
147.5          .              .              .             0.0017      
149.1          .              .              .             0.0012      
150.1          .              .              .             0.0012      
150.2          .              .              .             0.0019      
150.3          .              .              .             0.0016      
150.4          .              .              .             0.0024      
150.5          .              .              .             0.0017      

---- EQU cals  ensure that each bundle hits the calorie

         LOWER          LEVEL          UPPER         MARGINAL

1      2042.5000      2042.5000      2042.5000         0.0001      
2      2042.5000      2042.5000      2042.5000   -7.491519E-6      
3      2042.5000      2042.5000      2042.5000   1.2645690E-5      
4      2042.5000      2042.5000      2042.5000   -8.169776E-5      
5      2042.5000      2042.5000      2042.5000   -3.231392E-5      

                           LOWER          LEVEL          UPPER         MARGINAL

---- VAR z                 -INF            0.0505        +INF             .          

  z  objective value

---- VAR q  revised maximum entropy quanties in grams

             LOWER          LEVEL          UPPER         MARGINAL

100.1   1.0000000E-5       250.4761        +INF             .          
100.2   1.0000000E-5       379.8552        +INF             .          
100.3   1.0000000E-5       174.8150        +INF             .          
100.5   1.0000000E-5       491.9136        +INF             .          
105.1   1.0000000E-5       224.7031        +INF            EPS         
105.2   1.0000000E-5       348.6608        +INF      7.971135E-12      
105.3   1.0000000E-5       313.5887        +INF             .          
105.4   1.0000000E-5       134.8868        +INF             .          
105.5   1.0000000E-5       335.4978        +INF             .          
107.1   1.0000000E-5       490.3263        +INF             .          
107.2   1.0000000E-5       440.1496        +INF             .          
107.3   1.0000000E-5       335.6620        +INF             .          
107.4   1.0000000E-5       490.7827        +INF             .          
107.5   1.0000000E-5       425.5225        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 32
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


     VAR q  revised maximum entropy quanties in grams

             LOWER          LEVEL          UPPER         MARGINAL

108.2   1.0000000E-5        15.2866        +INF             .          
108.3   1.0000000E-5        83.8963        +INF             .          
108.4   1.0000000E-5        56.2474        +INF             .          
108.5   1.0000000E-5        49.1790        +INF            EPS         
109.1   1.0000000E-5         8.2983        +INF             .          
109.2   1.0000000E-5        15.9188        +INF             .          
109.5   1.0000000E-5        33.3198        +INF             .          
110.1   1.0000000E-5        19.4761        +INF             .          
110.2   1.0000000E-5         8.3063        +INF             .          
110.3   1.0000000E-5         5.2030        +INF             .          
111.4   1.0000000E-5        34.2043        +INF             .          
112.2   1.0000000E-5        30.7940        +INF             .          
112.3   1.0000000E-5        48.2996        +INF             .          
112.4   1.0000000E-5        49.9649        +INF             .          
112.5   1.0000000E-5        30.7225        +INF             .          
113.1   1.0000000E-5        85.4937        +INF             .          
113.2   1.0000000E-5        72.1756        +INF             .          
113.3   1.0000000E-5        93.1250        +INF             .          
113.4   1.0000000E-5        56.2985        +INF             .          
113.5   1.0000000E-5        53.1531        +INF             .          
114.1   1.0000000E-5        17.9258        +INF             .          
114.2   1.0000000E-5         2.4709        +INF             .          
115.3   1.0000000E-5        12.2494        +INF             .          
115.4   1.0000000E-5        11.4932        +INF             .          
115.5   1.0000000E-5        19.0757        +INF             .          
116.3   1.0000000E-5        19.2083        +INF             .          
116.4   1.0000000E-5        64.6000        +INF             .          
117.1   1.0000000E-5         7.3855        +INF             .          
117.2   1.0000000E-5         5.4119        +INF             .          
117.3   1.0000000E-5         3.2328        +INF             .          
117.4   1.0000000E-5         4.9472        +INF             .          
117.5   1.0000000E-5         6.4008        +INF             .          
121.3   1.0000000E-5         1.7042        +INF             .          
121.4   1.0000000E-5         1.9892        +INF             .          
122.1   1.0000000E-5         9.5214        +INF             .          
122.2   1.0000000E-5        10.7699        +INF             .          
122.3   1.0000000E-5        19.4402        +INF             .          
122.4   1.0000000E-5        13.5922        +INF            EPS         
122.5   1.0000000E-5         8.1879        +INF             .          
123.1   1.0000000E-5        22.9979        +INF             .          
123.2   1.0000000E-5        14.8494        +INF             .          
123.3   1.0000000E-5         7.0051        +INF             .          
123.4   1.0000000E-5         4.7510        +INF             .          
125.1   1.0000000E-5       106.9078        +INF             .          
125.2   1.0000000E-5       121.1751        +INF             .          
125.3   1.0000000E-5       135.2940        +INF             .          
125.4   1.0000000E-5       156.6646        +INF             .          
125.5   1.0000000E-5       107.8834        +INF             .          
127.1   1.0000000E-5         9.6501        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 33
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


     VAR q  revised maximum entropy quanties in grams

             LOWER          LEVEL          UPPER         MARGINAL

127.2   1.0000000E-5         5.6391        +INF             .          
127.3   1.0000000E-5         6.8016        +INF             .          
127.4   1.0000000E-5         3.9523        +INF             .          
132.2   1.0000000E-5        29.8063        +INF             .          
132.3   1.0000000E-5        39.1327        +INF             .          
132.4   1.0000000E-5        67.8999        +INF             .          
134.2   1.0000000E-5         5.0957        +INF             .          
135.1   1.0000000E-5        18.0828        +INF             .          
135.2   1.0000000E-5        15.6475        +INF             .          
135.4   1.0000000E-5        15.1114        +INF             .          
135.5   1.0000000E-5        15.3424        +INF             .          
136.1   1.0000000E-5        78.5425        +INF             .          
136.2   1.0000000E-5       107.1477        +INF             .          
136.3   1.0000000E-5        60.5402        +INF             .          
136.4   1.0000000E-5        31.3337        +INF             .          
136.5   1.0000000E-5        47.6332        +INF             .          
137.3   1.0000000E-5        15.4657        +INF             .          
138.2   1.0000000E-5        14.2436        +INF             .          
138.3   1.0000000E-5        32.1597        +INF             .          
138.4   1.0000000E-5        27.1820        +INF             .          
138.5   1.0000000E-5        42.0067        +INF      5.388790E-11      
139.3   1.0000000E-5        31.4557        +INF             .          
139.4   1.0000000E-5       149.6925        +INF             .          
140.1   1.0000000E-5        18.5807        +INF             .          
140.2   1.0000000E-5        15.0907        +INF             .          
140.3   1.0000000E-5        10.3297        +INF             .          
140.5   1.0000000E-5        23.4584        +INF             .          
141.1   1.0000000E-5        27.8433        +INF             .          
141.2   1.0000000E-5        28.5510        +INF             .          
141.3   1.0000000E-5        17.8270        +INF             .          
141.4   1.0000000E-5        28.5441        +INF             .          
141.5   1.0000000E-5        43.8854        +INF             .          
144.1   1.0000000E-5         7.9725        +INF             .          
144.2   1.0000000E-5         7.5004        +INF             .          
144.3   1.0000000E-5         3.3026        +INF             .          
144.5   1.0000000E-5         6.3487        +INF             .          
145.4   1.0000000E-5         8.2728        +INF             .          
146.4   1.0000000E-5        10.3848        +INF             .          
147.1   1.0000000E-5        30.9226        +INF             .          
147.2   1.0000000E-5        16.0857        +INF             .          
147.3   1.0000000E-5        13.8422        +INF             .          
147.4   1.0000000E-5         5.6897        +INF             .          
147.5   1.0000000E-5         4.5280        +INF             .          
149.1   1.0000000E-5         4.3044        +INF             .          
150.1   1.0000000E-5         7.5275        +INF             .          
150.2   1.0000000E-5        14.1473        +INF             .          
150.3   1.0000000E-5         7.1546        +INF             .          
150.4   1.0000000E-5        17.0930        +INF             .          
150.5   1.0000000E-5         9.4911        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 34
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


---- VAR s  derived maximum entropy shares

             LOWER          LEVEL          UPPER         MARGINAL

100.1         0.0001         0.1467        +INF             .          
100.2         0.0001         0.1525        +INF             .          
100.3         0.0001         0.0657        +INF             .          
100.5         0.0001         0.2014        +INF             .          
105.1         0.0001         0.0957        +INF             .          
105.2         0.0001         0.1283        +INF             .          
105.3         0.0001         0.1498        +INF      4.5335536E-9      
105.4         0.0001         0.0535        +INF      2.5255717E-8      
105.5         0.0001         0.1498        +INF             .          
107.1         0.0001         0.0752        +INF             .          
107.2         0.0001         0.0824        +INF             .          
107.3         0.0001         0.0513        +INF      8.8929983E-9      
107.4         0.0001         0.0563        +INF             .          
107.5         0.0001         0.0593        +INF             .          
108.2         0.0001         0.0216        +INF      8.9464469E-9      
108.3         0.0001         0.1023        +INF      6.3549003E-9      
108.4         0.0001         0.0699        +INF      -2.434369E-8      
108.5         0.0001         0.0588        +INF             .          
109.1         0.0001         0.0116        +INF      3.4779564E-8      
109.2         0.0001         0.0121        +INF      -2.036121E-8      
109.5         0.0001         0.0214        +INF             .          
110.1         0.0001         0.0518        +INF      6.1408252E-8      
110.2         0.0001         0.0246        +INF      3.9629446E-9      
110.3         0.0001         0.0160        +INF      -4.386301E-9      
111.4         0.0001         0.0463        +INF      -1.143470E-8      
112.2         0.0001         0.0190        +INF      -4.605118E-9      
112.3         0.0001         0.0297        +INF      -2.802206E-8      
112.4         0.0001         0.0216        +INF      -3.620501E-8      
112.5         0.0001         0.0169        +INF      1.1237084E-8      
113.1         0.0001         0.1389        +INF      -2.459049E-9      
113.2         0.0001         0.1348        +INF      6.5032083E-9      
113.3         0.0001         0.1525        +INF             .          
113.4         0.0001         0.0962        +INF      -6.497356E-9      
113.5         0.0001         0.0845        +INF      2.1025318E-8      
114.1         0.0001         0.0396        +INF      -1.678058E-8      
114.2         0.0001         0.0099        +INF      -1.082942E-8      
115.3         0.0001         0.0179        +INF      1.7630325E-8      
115.4         0.0001         0.0179        +INF      -2.437721E-9      
115.5         0.0001         0.0303        +INF      5.4103912E-8      
116.3         0.0001         0.0187        +INF             .          
116.4         0.0001         0.0695        +INF      8.2592014E-9      
117.1         0.0001         0.0475        +INF      -4.054364E-9      
117.2         0.0001         0.0383        +INF      9.3935559E-9      
117.3         0.0001         0.0237        +INF            EPS         
117.4         0.0001         0.0382        +INF      -2.061529E-8      
117.5         0.0001         0.0418        +INF      -5.964269E-9      
121.3         0.0001         0.0151        +INF      -1.538972E-8      
121.4         0.0001         0.0158        +INF      1.6478383E-8      
122.1         0.0001         0.0202        +INF      8.0537420E-9      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 35
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


     VAR s  derived maximum entropy shares

             LOWER          LEVEL          UPPER         MARGINAL

122.2         0.0001         0.0253        +INF      -2.282699E-8      
122.3         0.0001         0.0270        +INF      -5.634131E-8      
122.4         0.0001         0.0175        +INF             .          
122.5         0.0001         0.0192        +INF      -8.343693E-9      
123.1         0.0001         0.0219        +INF      2.0738711E-8      
123.2         0.0001         0.0139        +INF             .          
123.3         0.0001         0.0176        +INF      -2.006652E-8      
123.4         0.0001         0.0221        +INF      -5.869910E-9      
125.1         0.0001         0.0308        +INF      -3.317228E-9      
125.2         0.0001         0.0233        +INF      1.3506109E-8      
125.3         0.0001         0.0376        +INF      1.3030228E-8      
125.4         0.0001         0.0180        +INF      -2.664294E-8      
125.5         0.0001         0.0223        +INF      2.9817649E-8      
127.1         0.0001         0.0331        +INF      6.6692016E-9      
127.2         0.0001         0.0230        +INF      1.4547825E-8      
127.3         0.0001         0.0227        +INF            EPS         
127.4         0.0001         0.0270        +INF            EPS         
132.2         0.0001         0.0105        +INF      1.5608324E-8      
132.3         0.0001         0.0110        +INF      -3.841022E-8      
132.4         0.0001         0.0121        +INF      -1.178183E-8      
134.2         0.0001         0.0148        +INF             .          
135.1         0.0001         0.0175        +INF      -4.247296E-9      
135.2         0.0001         0.0142        +INF      -8.451871E-9      
135.4         0.0001         0.0110        +INF      -3.877634E-9      
135.5         0.0001         0.0120        +INF      3.4501525E-8      
136.1         0.0001         0.0309        +INF      -4.118333E-9      
136.2         0.0001         0.0263        +INF      3.0536493E-8      
136.3         0.0001         0.0203        +INF      1.8962141E-8      
136.4         0.0001         0.0123        +INF      1.6375326E-8      
136.5         0.0001         0.0189        +INF      -4.354740E-8      
137.3         0.0001         0.0128        +INF      -2.657465E-9      
138.2         0.0001         0.0124        +INF      -3.419377E-8      
138.3         0.0001         0.0323        +INF      6.2605904E-9      
138.4         0.0001         0.0153        +INF      -7.829635E-9      
138.5         0.0001         0.0238        +INF             .          
139.3         0.0001         0.0368        +INF      -1.428289E-8      
139.4         0.0001         0.1168        +INF             .          
140.1         0.0001         0.0399        +INF      -1.429553E-8      
140.2         0.0001         0.0304        +INF      3.3080675E-8      
140.3         0.0001         0.0147        +INF      -1.359972E-8      
140.5         0.0001         0.0535        +INF      -4.668035E-8      
141.1         0.0001         0.0586        +INF      -5.122647E-8      
141.2         0.0001         0.0685        +INF      2.3649751E-8      
141.3         0.0001         0.0445        +INF      1.7562475E-8      
141.4         0.0001         0.1390        +INF             .          
141.5         0.0001         0.1242        +INF      -3.274210E-8      
144.1         0.0001         0.0269        +INF      -1.297167E-8      
144.2         0.0001         0.0319        +INF      1.2891305E-8      
144.3         0.0001         0.0123        +INF      -2.829865E-8      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 36
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


     VAR s  derived maximum entropy shares

             LOWER          LEVEL          UPPER         MARGINAL

144.5         0.0001         0.0286        +INF      -3.197914E-8      
145.4         0.0001         0.0272        +INF             .          
146.4         0.0001         0.0449        +INF      -3.031718E-8      
147.1         0.0001         0.0970        +INF      -6.466827E-9      
147.2         0.0001         0.0626        +INF             .          
147.3         0.0001         0.0568        +INF      9.0367148E-9      
147.4         0.0001         0.0283        +INF      -9.560656E-9      
147.5         0.0001         0.0174        +INF      -1.741469E-8      
149.1         0.0001         0.0070        +INF      -9.838441E-9      
150.1         0.0001         0.0093        +INF      -3.763034E-8      
150.2         0.0001         0.0193        +INF      2.4479897E-8      
150.3         0.0001         0.0108        +INF      -1.415895E-8      
150.4         0.0001         0.0233        +INF      -2.915770E-8      
150.5         0.0001         0.0158        +INF      -2.272812E-8      

---- VAR povline  estimated revealed preference matrix

           LOWER          LEVEL          UPPER         MARGINAL

1.1        -INF          682.1817        +INF             .          
1.2        -INF          564.9881        +INF             .          
1.3        -INF          605.2176        +INF             .          
1.4        -INF          580.0024        +INF             .          
1.5        -INF          629.2728        +INF             .          
2.1        -INF          708.7453        +INF             .          
2.2        -INF          544.0970        +INF             .          
2.3        -INF          597.9713        +INF             .          
2.4        -INF          541.9655        +INF             .          
2.5        -INF          617.2226        +INF             .          
3.1        -INF          682.1817        +INF             .          
3.2        -INF          566.3401        +INF             .          
3.3        -INF          586.4048        +INF             .          
3.4        -INF          497.3957        +INF             .          
3.5        -INF          617.2226        +INF             .          
4.1        -INF          682.1817        +INF             .          
4.2        -INF          589.8059        +INF             .          
4.3        -INF          603.2510        +INF             .          
4.4        -INF          494.5252        +INF             .          
4.5        -INF          617.9338        +INF             .          
5.1        -INF          745.4406        +INF             .          
5.2        -INF          550.6466        +INF             .          
5.3        -INF          586.4048        +INF             .          
5.4        -INF          534.2173        +INF             .          
5.5        -INF          617.2226        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 37
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 517


**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
                             0     ERRORS
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/11/14 11:22:28 Page 38
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    520 this is without adjustment for calorie target or 90%

----    520 VARIABLE povline.L  estimated revealed preference matrix

            1           2           3           4           5

1     682.182     564.988     605.218     580.002     629.273
2     708.745     544.097     597.971     541.966     617.223
3     682.182     566.340     586.405     497.396     617.223
4     682.182     589.806     603.251     494.525     617.934
5     745.441     550.647     586.405     534.217     617.223


----    545 PARAMETER perc_chng  percent change in line

1 -17.482,    2   1.217,    3  -1.790,    4  33.555,    5   6.975


----    545 PARAMETER povline_ent  entropy line that hits calorie targets (100% food expen)

1 734.319,    2 562.446,    3 613.723,    4 506.624,    5 666.706


----    545 PARAMETER povline_ali  food poverty line

1 889.889,    2 555.685,    3 624.908,    4 379.337,    5 623.238


**** REPORT FILE SUMMARY

povline_rp /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/povline_rp_inout.csv
res /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/qent.csv
lin /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/work/povline_food_ent.csv


EXECUTION TIME       =        0.005 SECONDS      3 MB  24.1.2 r40979 LEX-LEG


USER: Computer Services                              G130401:1333CP-GEN
      International Food Policy Research Institute               DC2119


**** FILE SUMMARY

Input      /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/new/190a_revpref13_r_bjorn.gms
Output     /home/bjvca/data/data/GAP/Haruna/UNPS_2009_10/new/list.lst
