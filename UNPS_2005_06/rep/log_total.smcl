{smcl}
{com}{sf}{ul off}{txt}{.-}
      name:  {res}log_tot_s
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/rep/log_total.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}10 Mar 2014, 14:46:59

{com}. log using "$path/rep/000_boom.log"  , name(log_000_boom) replace
{txt}{.-}
      name:  {res}log_000_boom
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/rep/000_boom.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:46:59

{com}. 
. display "* # * # * # * # * # * # * # * # * # * # * # * # * # * # * # * # *"
{res}* # * # * # * # * # * # * # * # * # * # * # * # * # * # * # * # *

{com}. display ""
{res}

{com}. display "Generel information:"
{res}Generel information:

{com}. display "   UGANDA NATIONAL PANEL SURVEY 2005/06"
{res}   UGANDA NATIONAL PANEL SURVEY 2005/06

{com}. display "   Poverty rate estimation"
{res}   Poverty rate estimation

{com}. display "   Methodology: Iterative procedure and revealed preferences tests"
{res}   Methodology: Iterative procedure and revealed preferences tests

{com}. display ""
{res}

{com}. display "* # * # * # * # * # * # * # * # * # * # * # * # * # * # * # * # *"
{res}* # * # * # * # * # * # * # * # * # * # * # * # * # * # * # * # *

{com}. 
. 
. **************************************************************************

. * 000_boom.do(start)

. *

. * Reminders:

. *1) Check very top of this file to make sure you are on the right path! 

. *2) GAMS 22.5 must be placed onto the path. See 190_revpref13_m1.bat.

. *   Typically this needs to be edited.

. *   3) In case of implementing a new survey the user must make necessary

. *      changes in 010_initial.do, 020_hhdata.do and 030_rawdata.do.

. *

. * Process:

. * - The do-file prefix indicates first time a do-file is called

. *

. * KS, 2003

. * CA, 2009-2010

. * MAH, Apr. 2012

. **************************************************************************

. 
. clear all

. set more off

. set mem 700m

. 
. noisily display "Start time: " "$S_TIME"
{res}Start time: 14:47:00

{com}. 
. 
. 
. **************************************************************************

. * Macros. Region definitions. Demographic definitions.

. **************************************************************************

. do "$path/new/final_tableA1-A5-Haruna-2005_06.do"
{txt}
{com}. **     PROGRAMME:    preparing_household data_UNPS_2005-2006 for Uganda_tables_A1_to_A5      
. **     AUTHOR:       HARUNA SEKABIRA
. **     OBJECTIVE:    Create standard tables A1 to A5 for UNPS 2011/2012
. **     DATA IN:      GSEC1.dta
. **                                       GSEC2.dta
. **                                       GSEC3.dta
. **                   GSEC15B.dta, etc.
. **     DATA OUT:     hhdata.dta (table A1)
. **                                       indata.dta (table A2)
. **                                       calperg.dta (table A3)
. **                   cons_cod_trans.dta (table A4)
. **                   cons_cod.dta (table A5), 
. **     NOTES:           the files in the in folder here have been copied from the World Bank Website (http://go.worldbank.org/VX1NA9WGC0) and original zipped folder put in the "in" folder
. clear
{txt}
{com}. set logtype text
{txt}
{com}. capture log close
{txt}
{com}. set more off
{txt}
{com}. if c(os)=="Unix" {c -(}
. global path "/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/"
. {c )-}
{txt}
{com}. else{c -(}
. global path "C:\Users\Haruna\Desktop\GAPP\UNPS_2005_06"
. {c )-}
{txt}
{com}. 
. 
. * ====================Table A1==========================: Household Characteristics and interview details
. use "$path/in/GSEC1.dta" 
{txt}
{com}. ***------- Primary Sampling Unit
. * The primary sampling unit for the 2012 is the comm, using codes as of 2005/6 UNHS and is the enumeration area.
. codebook comm 

{txt}{hline}
{res}comm{right:EA Code in 2005/06}
{txt}{hline}

{col 19}type:  numeric ({res}long{txt})

{col 18}range:  [{res}10130002{txt},{res}41530009{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}322{col 51}{txt}missing .:  {res}0{txt}/{res}3123

{txt}{col 19}mean:{res}{col 26} 2.4e+07
{txt}{col 15}std. dev:{res}{col 26} 1.2e+07

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+07{col 37} 1.1e+07{col 47} 2.1e+07{col 57} 3.1e+07{col 67} 4.1e+07
{txt}
{com}.         /* There are 321 unique values, the UNHS 10/11 report mentions 322, located in C:\Users\Haruna\Desktop\GAPP\UNHS_2011\GAPP3\working-files */
. rename comm psu
{txt}
{com}. label variable psu "Primary Sampling Unit"
{txt}
{com}. ***------Interview date
. ** the interview date was in three propotions, the day, month and year and all these had been entered separately. However, this infromation is 
. ** replicated below in the survey quarters and months better thus might be a repeat to do it here.
. ***------- Interview Quarter
. * For the Mozambique Data, instead of using the regular quarter definition for their "surquar" variable they defined the quarters
. * relative to the time period covered by the survey: the survey ran from Sept 2008 to August 2009 so they defined the quarters
. * as follows: Sept-Nov 08, Dec08-Feb09, Mar-May 08 and June-Aug 08.
. * I will use the same framework
. *the one below corresponds to this: "tab month year,m" in other versions
. tab h1bq2b h1bq2c, m 

  {txt}Month of {c |}   Year of interview
 interview {c |}      2005       2006 {c |}     Total
{hline 11}{c +}{hline 22}{c +}{hline 10}
         5 {c |}{res}       323         13 {txt}{c |}{res}       336 
{txt}         6 {c |}{res}       457         38 {txt}{c |}{res}       495 
{txt}         7 {c |}{res}       277        171 {txt}{c |}{res}       448 
{txt}         8 {c |}{res}       338        315 {txt}{c |}{res}       653 
{txt}         9 {c |}{res}       356        332 {txt}{c |}{res}       688 
{txt}        10 {c |}{res}       247        232 {txt}{c |}{res}       479 
{txt}        11 {c |}{res}         9         11 {txt}{c |}{res}        20 
{txt}         . {c |}{res}         4          0 {txt}{c |}{res}         4 
{txt}{hline 11}{c +}{hline 22}{c +}{hline 10}
     Total {c |}{res}     2,011      1,112 {txt}{c |}{res}     3,123 

{txt}
{com}. drop if h1bq2b == . | h1bq2b == 0
{txt}(4 observations deleted)

{com}.         /* According to the repartition of months and year, the survey ran from November 2011 to January 2013. I will define the
>          * the quarters accordingly */
. gen float survquar=1 if h1bq2b>=5 & h1bq2b<=7 & h1bq2c==2005 
{txt}(2062 missing values generated)

{com}. replace survquar=2 if h1bq2b>=8 & h1bq2b<=10  & h1bq2c==2005
{txt}(941 real changes made)

{com}. replace survquar=3 if h1bq2b>=5 & h1bq2b<=6  & h1bq2c==2006 | h1bq2b == 11 & h1bq2c == 2005
{txt}(60 real changes made)

{com}. replace survquar=4 if h1bq2b>=7 & h1bq2b<=9  & h1bq2c==2006
{txt}(818 real changes made)

{com}. replace survquar=5 if h1bq2b>=10 & h1bq2b<=11  & h1bq2c==2006
{txt}(243 real changes made)

{com}. label define lsurvquar 1 "May '05 - Jul-'05" 2 "Aug-Oct 05" 3 "Nov '05 & May-Jun 06" 4 "Jul-Sept 2006" 5 "Oct-Nov '06"
{txt}
{com}. label values survquar lsurvquar
{txt}
{com}. label variable survquar "Sequential Survey Quarter (May-Nov'05 & May-Nov '06)"
{txt}
{com}. tab survquar

   {txt}Sequential Survey {c |}
 Quarter (May-Nov'05 {c |}
      & May-Nov '06) {c |}      Freq.     Percent        Cum.
{hline 21}{c +}{hline 35}
   May '05 - Jul-'05 {c |}{res}      1,057       33.89       33.89
{txt}          Aug-Oct 05 {c |}{res}        941       30.17       64.06
{txt}Nov '05 & May-Jun 06 {c |}{res}         60        1.92       65.98
{txt}       Jul-Sept 2006 {c |}{res}        818       26.23       92.21
{txt}         Oct-Nov '06 {c |}{res}        243        7.79      100.00
{txt}{hline 21}{c +}{hline 35}
               Total {c |}{res}      3,119      100.00
{txt}
{com}. ***------- Sequential Interview month 
. * Following the Mozambique file, I am creating a survey month variable rather than an interview date variable as per the excel sheet
. * Number 1 corresponds to the first month of the survey and not to January.
. gen float survmon=1 if h1bq2b==5 & h1bq2c==2005
{txt}(2796 missing values generated)

{com}. replace survmon=2 if h1bq2b==6 & h1bq2c==2005
{txt}(457 real changes made)

{com}. replace survmon=3 if h1bq2b==7 & h1bq2c==2005
{txt}(277 real changes made)

{com}. replace survmon=4 if h1bq2b==8 & h1bq2c==2005
{txt}(338 real changes made)

{com}. replace survmon=5 if h1bq2b==9 & h1bq2c==2005
{txt}(356 real changes made)

{com}. replace survmon=6 if h1bq2b==10 & h1bq2c==2005
{txt}(247 real changes made)

{com}. replace survmon=7 if h1bq2b==11 & h1bq2c==2005
{txt}(9 real changes made)

{com}. replace survmon=8 if h1bq2b==5 & h1bq2c==2006
{txt}(13 real changes made)

{com}. replace survmon=9 if h1bq2b==6 & h1bq2c==2006
{txt}(38 real changes made)

{com}. replace survmon=10 if h1bq2b==7 & h1bq2c==2006
{txt}(171 real changes made)

{com}. replace survmon=11 if h1bq2b==8 & h1bq2c==2006                          
{txt}(315 real changes made)

{com}. replace survmon=12 if h1bq2b==9 & h1bq2c==2006
{txt}(332 real changes made)

{com}. replace survmon=13 if h1bq2b==10 & h1bq2c==2006
{txt}(232 real changes made)

{com}. replace survmon=14 if h1bq2b==11 & h1bq2c==2006 
{txt}(11 real changes made)

{com}. **** there was only one person in January 2013, hence it is added on to Dec '12
. label define lsurvmon 1 "May 05" 2 "Jun 05" 3 "Jul 05" 4 "Aug 05" 5 "Sept 05" 6 "Oct 05" 7 "Nov 05" 8 "May 06" 9 "Jun 06" 10 "Jul 06" 11 "Aug 06" 12 "Sept 06" 13 "Oct 06" 14 "Nov 06"
{txt}
{com}. label values survmon lsurvmon
{txt}
{com}. tab survmon,m

    {txt}survmon {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
     May 05 {c |}{res}        323       10.36       10.36
{txt}     Jun 05 {c |}{res}        457       14.65       25.01
{txt}     Jul 05 {c |}{res}        277        8.88       33.89
{txt}     Aug 05 {c |}{res}        338       10.84       44.73
{txt}    Sept 05 {c |}{res}        356       11.41       56.14
{txt}     Oct 05 {c |}{res}        247        7.92       64.06
{txt}     Nov 05 {c |}{res}          9        0.29       64.35
{txt}     May 06 {c |}{res}         13        0.42       64.76
{txt}     Jun 06 {c |}{res}         38        1.22       65.98
{txt}     Jul 06 {c |}{res}        171        5.48       71.47
{txt}     Aug 06 {c |}{res}        315       10.10       81.56
{txt}    Sept 06 {c |}{res}        332       10.64       92.21
{txt}     Oct 06 {c |}{res}        232        7.44       99.65
{txt}     Nov 06 {c |}{res}         11        0.35      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}. label variable survmon "Sequential Survey Month (November 2011 = January '13)"
{txt}
{com}. ***------- Household Sample Weight
. rename hmult hhweight
{txt}
{com}. label variable hhweight "Household sample weight"
{txt}
{com}. ***------- Household id
. codebook HHID /*there are  3,119 unique values and 3,119 observations in the dataset so the variable "hh" uniquely identifies the observations */

{txt}{hline}
{res}HHID{right:household  code}
{txt}{hline}

{col 19}type:  string ({res}str10{txt})

{col 10}unique values:  {res}3119{col 51}{txt}missing "":  {res}0{txt}/{res}3119

{txt}{col 15}examples:  {res}"1081000309"
{col 26}"2053000907"
{col 26}"3041000204"
{col 26}"4023002511"
{txt}
{com}. rename HHID hhid
{txt}
{com}. label variable hhid "Household ID"
{txt}
{com}. ***------- Geographical Stratification during sampling
. 
. tab region

     {txt}Region {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res}        324       10.39       10.39
{txt}    Central {c |}{res}        700       22.44       32.83
{txt}    Eastern {c |}{res}        697       22.35       55.18
{txt}   Northern {c |}{res}        695       22.28       77.46
{txt}    Western {c |}{res}        703       22.54      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}. gen float strata = 1 if region ==0 & urban == 1 | region == 1 & urban ==1
{txt}(2659 missing values generated)

{com}. replace strata = 2 if region ==0 & urban == 0 | region == 1 & urban ==0
{txt}(564 real changes made)

{com}. replace strata = 3 if region ==2 & urban==1
{txt}(135 real changes made)

{com}. replace strata = 4 if region ==2 & urban==0
{txt}(562 real changes made)

{com}. replace strata = 5 if region ==3 & urban==1
{txt}(137 real changes made)

{com}. replace strata = 6 if region ==3 & urban==0
{txt}(558 real changes made)

{com}. replace strata = 7 if region ==4 & urban==1
{txt}(128 real changes made)

{com}. replace strata = 8 if region ==4 & urban==0
{txt}(575 real changes made)

{com}. la define lstrata 1 "central urban" 2 "central rural" 3 "Eastern urban" 4 "Eastern rural" 5 "Northern urban" 6 "Northern rural" 7 "Western Urban" 8 "Western rural"
{txt}
{com}. la values strata lstrata
{txt}
{com}. label variable strata "Geographical stratification variable during sampling (ranging from 1 to 6 sub regions)"
{txt}note: label truncated to 80 characters

{com}. tab strata

  {txt}Geographical {c |}
stratification {c |}
      variable {c |}
        during {c |}
      sampling {c |}
 (ranging from {c |}
 1 to 6 sub re {c |}      Freq.     Percent        Cum.
{hline 15}{c +}{hline 35}
 central urban {c |}{res}        460       14.75       14.75
{txt} central rural {c |}{res}        564       18.08       32.83
{txt} Eastern urban {c |}{res}        135        4.33       37.16
{txt} Eastern rural {c |}{res}        562       18.02       55.18
{txt}Northern urban {c |}{res}        137        4.39       59.57
{txt}Northern rural {c |}{res}        558       17.89       77.46
{txt} Western Urban {c |}{res}        128        4.10       81.56
{txt} Western rural {c |}{res}        575       18.44      100.00
{txt}{hline 15}{c +}{hline 35}
         Total {c |}{res}      3,119      100.00
{txt}
{com}. ***----------------------rural/urban identifier 
. tab urban

 {txt}substratum {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res}      2,259       72.43       72.43
{txt}      urban {c |}{res}        860       27.57      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}. gen rural=1 if urban==0
{txt}(860 missing values generated)

{com}. replace rural=0 if urban==1
{txt}(860 real changes made)

{com}. label define lrural 1 "Rural" 0 "Urban"
{txt}
{com}. la values rural lrural
{txt}
{com}. label variable rural "Rural/Urban Location"
{txt}
{com}. tab rural,m

{txt}Rural/Urban {c |}
   Location {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
      Urban {c |}{res}        860       27.57       27.57
{txt}      Rural {c |}{res}      2,259       72.43      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}. ***-----Regions used for temporal price index calculations
. tab region,m 

     {txt}Region {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res}        324       10.39       10.39
{txt}    Central {c |}{res}        700       22.44       32.83
{txt}    Eastern {c |}{res}        697       22.35       55.18
{txt}   Northern {c |}{res}        695       22.28       77.46
{txt}    Western {c |}{res}        703       22.54      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}. replace region = 1 if region == 0
{txt}(324 real changes made)

{com}. la define lregion 1 "Central" 2 "Eastern" 3 "Northern" 4 "Western"
{txt}
{com}. la values region lregion 
{txt}
{com}. clonevar reg_tpi = region
{txt}
{com}. label variable reg_tpi "Regions used for temporal price index calculations"
{txt}
{com}. tab reg_tpi 

    {txt}Regions {c |}
   used for {c |}
   temporal {c |}
price index {c |}
calculation {c |}
          s {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
    Central {c |}{res}      1,024       32.83       32.83
{txt}    Eastern {c |}{res}        697       22.35       55.18
{txt}   Northern {c |}{res}        695       22.28       77.46
{txt}    Western {c |}{res}        703       22.54      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}. ***------ Spatial domains (each with its own poverty line)
. tab strata

  {txt}Geographical {c |}
stratification {c |}
      variable {c |}
        during {c |}
      sampling {c |}
 (ranging from {c |}
 1 to 6 sub re {c |}      Freq.     Percent        Cum.
{hline 15}{c +}{hline 35}
 central urban {c |}{res}        460       14.75       14.75
{txt} central rural {c |}{res}        564       18.08       32.83
{txt} Eastern urban {c |}{res}        135        4.33       37.16
{txt} Eastern rural {c |}{res}        562       18.02       55.18
{txt}Northern urban {c |}{res}        137        4.39       59.57
{txt}Northern rural {c |}{res}        558       17.89       77.46
{txt} Western Urban {c |}{res}        128        4.10       81.56
{txt} Western rural {c |}{res}        575       18.44      100.00
{txt}{hline 15}{c +}{hline 35}
         Total {c |}{res}      3,119      100.00
{txt}
{com}. *  Geographical |
. *stratification |
. *      variable |
. *        during |
. *      sampling |
.  *(ranging from |
.  *1 to 6 sub re |      Freq.     Percent        Cum.
. *---------------+-----------------------------------
. * central urban |        460       14.75       14.75
. * central rural |        564       18.08       32.83
. * Eastern urban |        135        4.33       37.16
. * Eastern rural |        562       18.02       55.18
. *Northern urban |        137        4.39       59.57
. *Northern rural |        558       17.89       77.46
. * Western Urban |        128        4.10       81.56
. * Western rural |        575       18.44      100.00
. *---------------+-----------------------------------
. *         Total |      3,119      100.00
. 
. * In the Arndt & Simler 2010 paper the spatial domains are a combinaison of regions and rural/urban delimitations + the capital
. * city, however in the 2010/11 some urban sections have far less than 200 respondents, so we shall combine all other regions 
. * (rural + urban)except the central since its urban would be boosted by Kampala, getting us 5 spatial domains
. gen float spdomain=1 if strata==1 | strata==1
{txt}(2659 missing values generated)

{com}. replace spdomain=2 if strata==2
{txt}(564 real changes made)

{com}. replace spdomain=3 if strata==3 | strata==4
{txt}(697 real changes made)

{com}. replace spdomain=4 if strata==5 | strata==6
{txt}(695 real changes made)

{com}. replace spdomain=5 if strata==7 | strata==8
{txt}(703 real changes made)

{com}. label define lspdomain 1 "Central Urban" 2 "Central Rural" 3 "Eastern" 4 "Northern" 5 "Western" 
{txt}
{com}. label values spdomain lspdomain
{txt}
{com}. label variable spdomain "Spatial domains: each with own poverty line (they are 5)"
{txt}
{com}. tab spdomain

      {txt}Spatial {c |}
domains: each {c |}
     with own {c |}
 poverty line {c |}
 (they are 5) {c |}      Freq.     Percent        Cum.
{hline 14}{c +}{hline 35}
Central Urban {c |}{res}        460       14.75       14.75
{txt}Central Rural {c |}{res}        564       18.08       32.83
{txt}      Eastern {c |}{res}        697       22.35       55.18
{txt}     Northern {c |}{res}        695       22.28       77.46
{txt}      Western {c |}{res}        703       22.54      100.00
{txt}{hline 14}{c +}{hline 35}
        Total {c |}{res}      3,119      100.00
{txt}
{com}. ***---------------News; another way to specify variables, is the traditional Uganda regions, North east central and western, represented in region
. gen float news=1 if region==1 
{txt}(2095 missing values generated)

{com}. replace news=2  if region==2 
{txt}(697 real changes made)

{com}. replace news=3  if region==3 
{txt}(695 real changes made)

{com}. replace news=4  if region==4 
{txt}(703 real changes made)

{com}. label define lnews 1 "Central" 2 "Eastern" 3 "Northern" 4 "Western" 
{txt}
{com}. label values news lnews
{txt}
{com}. label variable new "regions north, east, central and western; other ways to dissagregate poverty lines"
{txt}note: label truncated to 80 characters

{com}. tab news

    {txt}regions {c |}
     north, {c |}
      east, {c |}
central and {c |}
   western; {c |}
 other ways {c |}
         to {c |}
dissagregat {c |}
  e poverty {c |}
        lin {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
    Central {c |}{res}      1,024       32.83       32.83
{txt}    Eastern {c |}{res}        697       22.35       55.18
{txt}   Northern {c |}{res}        695       22.28       77.46
{txt}    Western {c |}{res}        703       22.54      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}. ****-------geo1-geo?; other administrative geographical boundariies where a survey is representative is not required as also done in news rural and others
. *** -------------------Bootstrap weights: the toolkit requires that this should be=1 for all households and we generate it below
. gen float bswt=1
{txt}
{com}. label variable bswt "bootstrap weights; and all equal to 1 for all households, as a toolkit requirement"
{txt}note: label truncated to 80 characters

{com}. sort hhid
{txt}
{com}. save "$path/in/hhdata_hhsize.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/hhdata_hhsize.dta saved

{com}. save "$path/out/hhdata_hhsize.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdata_hhsize.dta saved

{com}. **** --------------------------------Household size
. ** Since we need Household size in the hhdata.dta, and it was unavailable in the GSEC1.dta, we use the Unique person identifier in GSEC2.dta
. clear 
{txt}
{com}. use "$path/in/GSEC2.dta"
{txt}
{com}. rename pid indlin
{txt}
{com}. bysort HHID: gen pid=_n
{txt}
{com}. order HH pid
{txt}
{com}. collapse (count) pid, by (HHID)
{txt}
{com}. rename pid hhsize
{txt}
{com}. la var hhsize "number of household menbers"
{txt}
{com}. rename HHID hhid
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/in/hhsize.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/hhsize.dta saved

{com}. clear 
{txt}
{com}. use "$path/in/hhdata_hhsize.dta"
{txt}
{com}. merge 1:1 hhid using "$path/in/hhsize.dta"
{res}{txt}hhid was {res}str10{txt} now {res}str11

{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}               4
{txt}{col 9}from master{col 30}{res}               0{txt}  (_merge==1)
{col 9}from using{col 30}{res}               4{txt}  (_merge==2)

{col 5}matched{col 30}{res}           3,119{txt}  (_merge==3)
{col 5}{hline 41}

{com}. tab _m

                 {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 24}{c +}{hline 35}
         using only (2) {c |}{res}          4        0.13        0.13
{txt}            matched (3) {c |}{res}      3,119       99.87      100.00
{txt}{hline 24}{c +}{hline 35}
                  Total {c |}{res}      3,123      100.00
{txt}
{com}. drop _m 
{txt}
{com}. sort hhid
{txt}
{com}. destring hhid, replace
{txt}hhid has all characters numeric; {res}replaced {txt}as {res}double
{txt}
{com}. destring psu, replace
{txt}psu already numeric; no {res}replace
{txt}
{com}. save "$path/out/hhdata.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdata.dta saved

{com}. save "$path/in/hhdata.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/hhdata.dta saved

{com}. *====================== Table A2===================================: Individual characteristics - demographics
. clear
{txt}
{com}. use "$path/in/GSEC2.dta" 
{txt}
{com}. sort HHID
{txt}
{com}. ***----- Household members
. *According to enumerator manual of 2011/12, Usual and Regular household members are defined as : *Usual members: those persons who have been living in the 
. *household for 6 months or more during the last 12 months. members who have come to stay in the household permanently usual members, even though they have 
. *lived in this household for less than 6 *months. children born to usual members during the last 12 months are usual members. Both these categories will 
. *be given code "1" or "2" depending upon whether they are present or absent on the date of the interview. *Regular members refer to those persons who would 
. *have been usual members of this household, but have been away for more than six months during the last 12 months, for education purposes, search of
. *employment, business transactions etc. and living in boarding schools, lodging houses or hostels etc.*These will be coded "3" or "4" depending upon presence 
. *or absence on the date of the interview. For the purposes of the calculation of a poverty line we'll exclude from the household the members who have left 
. *the household permanently or died We'll keep the members away for more than 6 months but present on the day of the interview */
. rename  tid resident
{txt}
{com}. tab resident

           {txt}what is the {c |}
    residential status {c |}      Freq.     Percent        Cum.
{hline 23}{c +}{hline 35}
  Usual member present {c |}{res}     15,172       90.53       90.53
{txt}   Usual member absent {c |}{res}        792        4.73       95.26
{txt}Regular member present {c |}{res}        204        1.22       96.47
{txt} Regular Member absent {c |}{res}        591        3.53      100.00
{txt}{hline 23}{c +}{hline 35}
                 Total {c |}{res}     16,759      100.00
{txt}
{com}. *drop if resident==7
. ***------ Household ID
. rename HHID hhid
{txt}
{com}. label variable hhid "Household ID"
{txt}
{com}. ***------ Individual ID
. destring hhid PID, replace
{txt}hhid has all characters numeric; {res}replaced {txt}as {res}double
{txt}PID has all characters numeric; {res}replaced {txt}as {res}double
{txt}
{com}. gen double indid = hhid*100 +  PID
{txt}
{com}. codebook indid

{txt}{hline}
{res}indid{right:(unlabeled)}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}2.026e+11{txt},{res}4.612e+12{txt}]{col 55}units:  {res}100
{col 10}{txt}unique values:  {res}16759{col 51}{txt}missing .:  {res}0{txt}/{res}16759

{txt}{col 19}mean:{res}{col 26} 1.2e+12
{txt}{col 15}std. dev:{res}{col 26} 1.3e+12

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 2.1e+11{col 37} 4.1e+11{col 47} 6.2e+11{col 57} 1.2e+12{col 67} 3.4e+12
{txt}
{com}. * There are 16,759 unique values, and there are 16,759 observations in the dataset so indid uniquely identifies the data
. *duplicates report indid
. *duplicates list indid
. *duplicates drop indid, force
. *codebook indid 
. *there are now 17043 and 17,043 observations implying that indid now uniquely identifies the data
. label variable indid "Individual ID"
{txt}
{com}. ***------ Sex
. rename  h2q4 sex
{txt}
{com}. label variable sex "Sex"
{txt}
{com}. ***------ Age
. rename  h2q9 age
{txt}
{com}. label variable age "Age in years"
{txt}
{com}. * In order to have the information on whether the mother resides in the house or not we need the file "GSEC3"
. sort indid
{txt}
{com}. save "$path/in/temp_A2_1.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/temp_A2_1.dta saved

{com}. clear
{txt}
{com}. use "$path/in/GSEC3.dta" 
{txt}
{com}. ***------ Individual ID
. rename HHID hhid
{txt}
{com}. destring hhid PID,replace
{txt}hhid has all characters numeric; {res}replaced {txt}as {res}double
{txt}PID has all characters numeric; {res}replaced {txt}as {res}double
{txt}
{com}. gen double indid=hhid*100 +  PID
{txt}
{com}. label variable indid "Individual ID"
{txt}
{com}. codebook indid

{txt}{hline}
{res}indid{right:Individual ID}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}2.026e+11{txt},{res}4.612e+12{txt}]{col 55}units:  {res}100
{col 10}{txt}unique values:  {res}16329{col 51}{txt}missing .:  {res}0{txt}/{res}16329

{txt}{col 19}mean:{res}{col 26} 1.1e+12
{txt}{col 15}std. dev:{res}{col 26} 1.2e+12

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 2.1e+11{col 37} 4.1e+11{col 47} 6.2e+11{col 57} 1.2e+12{col 67} 3.4e+12
{txt}
{com}. * There are 16,329 unique values, and there are 16,329 observations in the dataset so indid uniquely identifies data
. *duplicates report indid
. *duplicates list indid
. *duplicates drop indid, force
. *codebook indid 
. ***----- Mother lives in household?
. tab h3q6,m

      {txt}is tha {c |}
     natural {c |}
   mother of {c |}
 name living {c |}
  in this hh {c |}      Freq.     Percent        Cum.
{hline 13}{c +}{hline 35}
         yes {c |}{res}      8,123       49.75       49.75
{txt}no but alive {c |}{res}      5,046       30.90       80.65
{txt} no but dead {c |}{res}      3,106       19.02       99.67
{txt}no dont know {c |}{res}         30        0.18       99.85
{txt}           . {c |}{res}         24        0.15      100.00
{txt}{hline 13}{c +}{hline 35}
       Total {c |}{res}     16,329      100.00
{txt}
{com}. *There are 7,122  (ie 43.1 %) missing responses,: 1: Yes = 6,913 2: No = 1,95 3: Dead = 363 4: Missing = 6,882. I will group them 
. gen motherhh=1 if h3q5==1 
{txt}(16328 missing values generated)

{com}. replace motherhh=0 if h3q6==2 | h3q6==3 | h3q6==4 | h3q6==.
{txt}(8206 real changes made)

{com}. label variable motherhh "Mother lives in hh"
{txt}
{com}. label define lmoth 0 "No" 1 "Yes"
{txt}
{com}. label values motherhh lmoth
{txt}
{com}. keep indid motherhh
{txt}
{com}. tab motherhh

     {txt}Mother {c |}
lives in hh {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
         No {c |}{res}      8,206      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      8,206      100.00
{txt}
{com}. sort indid
{txt}
{com}. merge 1:1 indid using "$path/in/temp_A2_1.dta"
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}             430
{txt}{col 9}from master{col 30}{res}               0{txt}  (_merge==1)
{col 9}from using{col 30}{res}             430{txt}  (_merge==2)

{col 5}matched{col 30}{res}          16,329{txt}  (_merge==3)
{col 5}{hline 41}

{com}. tab _merge

                 {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 24}{c +}{hline 35}
         using only (2) {c |}{res}        430        2.57        2.57
{txt}            matched (3) {c |}{res}     16,329       97.43      100.00
{txt}{hline 24}{c +}{hline 35}
                  Total {c |}{res}     16,759      100.00
{txt}
{com}. drop _merge
{txt}
{com}. keep hhid indid sex age motherhh
{txt}
{com}. save "$path/out/indata.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/indata.dta saved

{com}. save "$path/in/indata.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/indata.dta saved

{com}. * ========================Table A3============================: Calorie content of food items
. * we compiled the calorie content and edible portion in an excel file then converted that file into a STATA file located in "in" folder
. clear
{txt}
{com}. use "$path/in/foodcomp_uganda_PANNELsurvey2005.dta"
{txt}
{com}. * Since they did not include edible portions in the file I assume that the calorie per gram is only for the edible portion.
. * ----------- computing calperg that way
. destring kcal_100g edible, replace
{txt}kcal_100g has all characters numeric; {res}replaced {txt}as {res}int
{txt}edible has all characters numeric; {res}replaced {txt}as {res}byte
{txt}
{com}. gen double calperg=((kcal_100g*edible)/100)/100
{txt}
{com}. keep product descript calperg
{txt}
{com}. label variable product "Food product code: numerical"
{txt}
{com}. label variable descript "Product Description: incl. product code in the beginning"
{txt}
{com}. label variable calperg "Calorie content of food product: calories per gram"
{txt}
{com}. destring product, replace
{txt}product has all characters numeric; {res}replaced {txt}as {res}int
{txt}
{com}. sort product
{txt}
{com}. save "$path/out/calperg.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/calperg.dta saved

{com}. save "$path/in/calperg.dta",replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/calperg.dta saved

{com}. clear
{txt}
{com}. * ===================Table A4=============: Amount and Quantity of food transactoin - Transaction level
. use "$path/in/GSEC14A.dta"
{txt}
{com}. sort HHID
{txt}
{com}. rename HHID hhid
{txt}
{com}. la var hhid "household id"
{txt}
{com}. ** we drop alcoholic and tobacco as these were not considered basic in foods generally and by GAPP, these included beer-152, other alcoholic dricns-153
. ** cigarettes-155, other tobacco-156 and beer taken in restaurants-159, just like we did in the 2009 poverty calculations
. rename h14aq2 itmcd
{txt}
{com}. rename h14aq3 untcd
{txt}
{com}. drop if inlist( itmcd ,152,153,155,156,159)
{txt}(1396 observations deleted)

{com}. duplicates report  hhid itmcd

{p 0 4}{txt}Duplicates in terms of {res} hhid itmcd{p_end}

{txt}{hline 10}{c TT}{hline 27}
   copies {c |} observations       surplus
{hline 10}{c +}{hline 27}
        1 {c |}        {res}38996             0
        {txt}2 {c |}            {res}2             1
{txt}{hline 10}{c BT}{hline 27}

{com}. *duplicates list  hhid itmcd
. codebook hhid

{txt}{hline}
{res}hhid{right:household id}
{txt}{hline}

{col 19}type:  string ({res}str11{txt}), but longest is str10

{col 10}unique values:  {res}3120{col 51}{txt}missing "":  {res}0{txt}/{res}38998

{txt}{col 15}examples:  {res}"1071000209"
{col 26}"2033002307"
{col 26}"3023000301"
{col 26}"4023001103"
{txt}
{com}. egen quantity=rowtotal( h14aq4 h14aq6 h14aq8 h14aq10)
{txt}
{com}. la var quantity "quantity of food consumed by the household including purchases, at home, away from home & kind"
{txt}note: label truncated to 80 characters

{com}. ** these quantities and values are collected by UBOS at a 7 days basis, thus we divide by 7 to get the daily figures as a requirement by GAPP 
. gen quantityd = quantity/7
{txt}
{com}. drop quantity h14aq10 h14aq8 h14aq6 h14aq4
{txt}
{com}. la var quantityd "daily household food consumption"
{txt}
{com}. egen value=rowtotal ( h14aq5 h14aq7 h14aq9 h14aq11 )
{txt}
{com}. la var value "household food consumption in seven days"
{txt}
{com}. gen valuez = value/7 
{txt}
{com}. la var valuez "daily value of food consumed by the household"
{txt}
{com}. rename quantityd quantityz
{txt}
{com}. drop value h14aq11 h14aq9 h14aq7 h14aq5 h14aq13 h14aq12
{txt}
{com}. gen unit = 1
{txt}
{com}. la var unit "set equal to one since all observations are converted into kg"
{txt}
{com}. gen food_cat = 1
{txt}
{com}. la var food_cat "food category equals 1, if product is food and 0 if non food"
{txt}
{com}. rename itmcd product
{txt}
{com}. la var product "Food product code: numerical"
{txt}
{com}. destring product, replace
{txt}product already numeric; no {res}replace
{txt}
{com}. save "$path/in/household_table4.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/household_table4.dta saved

{com}. save "$path/out/household_table4.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/household_table4.dta saved

{com}. count
{res}38998
{txt}
{com}. sort product untcd
{txt}
{com}. 
. replace product=100 if product==101  | product==102  | product==103  | product==104
{txt}(1529 real changes made)

{com}. 
. ** to convert quantities of food in standard units, the Kilograms, a file called "conversions_all.dta" generated by Fiona with equivalents of local units into 
. * kilograms located in the "in" folder was used. for UNPS 2009, and 2010 data we used "Conversionfactors.dta", by Haruna, also in "in" folder
. merge m:1 product untcd using  "$path/in/conversionfactors.dta"
{res}{txt}untcd was {res}byte{txt} now {res}int

{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}           3,418
{txt}{col 9}from master{col 30}{res}           2,563{txt}  (_merge==1)
{col 9}from using{col 30}{res}             855{txt}  (_merge==2)

{col 5}matched{col 30}{res}          36,435{txt}  (_merge==3)
{col 5}{hline 41}

{com}. tab _m

                 {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 24}{c +}{hline 35}
        master only (1) {c |}{res}      2,563        6.43        6.43
{txt}         using only (2) {c |}{res}        855        2.15        8.58
{txt}            matched (3) {c |}{res}     36,435       91.42      100.00
{txt}{hline 24}{c +}{hline 35}
                  Total {c |}{res}     39,853      100.00
{txt}
{com}. drop _m
{txt}
{com}. *label drop _all
. save "$path/in/household_table4cf.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/household_table4cf.dta saved

{com}. save "$path/out/household_table4cf.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/household_table4cf.dta saved

{com}. gen quantity = quantityz * qkg_uca
{txt}(3566 missing values generated)

{com}. la var quantity "daily quantity consumed in Kgs per household"
{txt}
{com}. la var value  "daily value of consumption in UGX per per household"
{txt}
{com}. sort hhid
{txt}
{com}. label drop _all
{txt}
{com}. destring hhid, replace
{txt}hhid has all characters numeric; {res}replaced {txt}as {res}double
{txt}(855 missing values generated)

{com}. save "$path/out/cons_cod_trans.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/cons_cod_trans.dta saved

{com}. save "$path/in/cons_cod_trans.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/cons_cod_trans.dta saved

{com}. **================ Table 5===============: TOTAL AMOUNT AND QUANTITY OF PRODUCTS: Food as well as non food
. **  DATA IN:       GSEC4.dta : On Education costs, column h4q15g which has all total school expenses, it is on 365 dayss basis
. **                 GSEC5.dta : On Medical Expenditure, column h5q12, on 30 days basis
. **                 GSEC14.dta : On assets Expenditure, column h14q5 on total estimated present value, considering 10% value used per 365 days basis
. **                 GSEC15C.dta: On non-durables and frequently purchased items e.g imputed rent, electricity, soap etc,on 30days basis, columns h15cq: 5,7 & 9 for value
. **                 GSEC15D.dta: On semi-durable goods and services e.g. clothes, furniture, equipments, column; h15dq:5,7&9, on 365 days basis for value
. **                 GSEC15E.dta:     On Non-consumption expenses like taxes, remitances away, subscriptions etc, on 365 days basis, colum 3::file is MISSING in W.B, data supplied
. **  DATA OUT: cons_cod.dta
. clear
{txt}
{com}. ***----------------------calculating Education expenses
. use "$path/in/GSEC4.dta"
{txt}
{com}. rename HHID hhid
{txt}
{com}. codebook hhid

{txt}{hline}
{res}hhid{right:Unique HH Identifier Across Panel Waves}
{txt}{hline}

{col 19}type:  string ({res}str11{txt}), but longest is str10

{col 10}unique values:  {res}3121{col 51}{txt}missing "":  {res}0{txt}/{res}13441

{txt}{col 15}examples:  {res}"1083002009"
{col 26}"2073000601"
{col 26}"3041000701"
{col 26}"4023003010"
{txt}
{com}. keep hhid h4q10f
{txt}
{com}. sort hhid
{txt}
{com}. ** since total education expenses were clooected in h4q10f and since is at yearly basis, we divided it by 365 to get daily expenses on education
. gen educationd = h4q10f/365
{txt}(7047 missing values generated)

{com}. 
. replace educationd=0
{txt}(12862 real changes made)

{com}. la var educationd "daily household expense on education"
{txt}
{com}. drop h4q10f
{txt}
{com}. save "$path/out/hhdeducationexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdeducationexp.dta saved

{com}. clear
{txt}
{com}. **---------------------calculating medical expenses
. use "$path/in/GSEC5.dta"
{txt}
{com}. rename HHID hhid
{txt}
{com}. sort hhid
{txt}
{com}. keep hhid h5q10 h5q11 
{txt}
{com}. egen medicalexp = rowtotal (h5q10 h5q11 ) 
{txt}
{com}. gen medicalexpd = medicalexp/30
{txt}
{com}. replace medicalexpd=0
{txt}(4513 real changes made)

{com}. drop h5q10 h5q11
{txt}
{com}. la var medicalexpd "household daily expenditure"
{txt}
{com}. save "$path/out/hhdmedicalexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdmedicalexp.dta saved

{com}. clear
{txt}
{com}. ****---------------calculating expenses on basic durable assests
. use "$path/in/GSEC12A.dta"
{txt}
{com}. des

{txt}Contains data from {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/GSEC12A.dta
{txt}  obs:{res}        68,332                          
{txt} vars:{res}             9                          9 Feb 2012 15:57
{txt} size:{res}     1,776,632                          
{txt}{hline}
              storage  display     value
variable name   type   format      label      variable label
{hline}
{p 0 48}{res}{bind:HHID           }{txt}{bind: str11  }{bind:{txt}%11s       }{space 1}{bind:         }{bind:  }{res}{res}Unique HH Identifier Across Panel Waves{p_end}
{p 0 48}{bind:h12aq2         }{txt}{bind: int    }{bind:{txt}%34.0g     }{space 1}{bind:H12AQ2   }{bind:  }{res}{res}asset code{p_end}
{p 0 48}{bind:h12aq3         }{txt}{bind: byte   }{bind:{txt}%8.0g      }{space 1}{bind:H12AQ3   }{bind:  }{res}{res}does any member of your hh own (asset) at present{p_end}
{p 0 48}{bind:h12aq4         }{txt}{bind: byte   }{bind:{txt}%8.0g      }{space 1}{bind:         }{bind:  }{res}{res}how many do your hh hold at present.number{p_end}
{p 0 48}{bind:h12aq5         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}how many do your hh hold at present.total estimated value{p_end}
{p 0 48}{bind:h12aq6         }{txt}{bind: byte   }{bind:{txt}%8.0g      }{space 1}{bind:H12AQ6   }{bind:  }{res}{res}did any member of your hh own (asset) 12months ago{p_end}
{p 0 48}{bind:h12aq7         }{txt}{bind: byte   }{bind:{txt}%8.0g      }{space 1}{bind:         }{bind:  }{res}{res}how many did your hh own 12months ago.number{p_end}
{p 0 48}{bind:h12aq8         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}how many did your hh own 12months ago.total estimated value{p_end}
{p 0 48}{bind:h12aq9         }{txt}{bind: byte   }{bind:{txt}%13.0g     }{space 1}{bind:H12AQ9   }{bind:  }{res}{res}compared with 2001 would you say that your  (...)is{p_end}
{txt}{hline}
Sorted by:  {res}HHID  h12aq2
{txt}
{com}. save "$path/out/hhddurables.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhddurables.dta saved

{com}. 
. *keep if inlist( h12aq2 ,02,03,10,11,12,13) 
. drop if inlist(h12aq2, 1, 2 )
{txt}(6228 observations deleted)

{com}. 
. gen assetvalue = h12aq5
{txt}(42166 missing values generated)

{com}. ** i took land-03, bicycle-10, motor cycle-11 and motorvehicle-12, boat-13 and other buildings-02, as durables and assumed that a year, 
. ** the household can use 0.1% of these assests, just to limit the influence of assests that were inflating unnecessarily especially the urban poverty estimates,
. ** house not treated as an asset as the toolkit takes care of imputed rent
. gen dassetvalue = (assetvalue*0.1)/365
{txt}(42166 missing values generated)

{com}. 
. la var dassetvalue "household daily durables expenditure"
{txt}
{com}. rename HHID hhid
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhddurablesexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhddurablesexp.dta saved

{com}. clear
{txt}
{com}. **----------------------calculating expenses on basic non durable assest
. use "$path/in/GSEC12A.dta"
{txt}
{com}. save "$path/out/hhnondurables.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhnondurables.dta saved

{com}. rename HHID hhid
{txt}
{com}. drop if inlist(  h12aq2 ,01,02,03,10,11,12,13)
{txt}(21759 observations deleted)

{com}. gen nondurablevalue = h12aq5
{txt}(31856 missing values generated)

{com}. ** also discounted them by 1% to get rough value used per year, we considered furniture-04, Hh appliances as Kettle,flat iron-05, electronics as tv-06, 
. *radio-07, generators-08, solar-panel-09, other transport mean -14, jewelry&watches-15, mobilephone-16, computer-17, internet-18, other elwctronics-19, 
. *otherassets as lawn mores-20,  others;-21 & 22, NOTE: figures are codes in data set
. la var nondurablevalue "household daily non-durables expenditure"
{txt}
{com}. sort hhid
{txt}
{com}. gen dnondurables = (nondurablevalue*0.01)/365
{txt}(31856 missing values generated)

{com}. la var dnondurables "household daily non-durables expenditure"
{txt}
{com}. keep hhid dnondurables nondurablevalue
{txt}
{com}. save "$path/out/hhdnondurablesexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdnondurablesexp.dta saved

{com}. clear
{txt}
{com}. ***-------------------calculating expenses on basic frequently bought items
. use "$path/in/GSEC14B.dta"
{txt}
{com}. des

{txt}Contains data from {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/GSEC14B.dta
{txt}  obs:{res}        33,876                          
{txt} vars:{res}            10                          9 Feb 2012 15:57
{txt} size:{res}     1,558,296                          
{txt}{hline}
              storage  display     value
variable name   type   format      label      variable label
{hline}
{p 0 48}{res}{bind:HHID           }{txt}{bind: str11  }{bind:{txt}%11s       }{space 1}{bind:         }{bind:  }{res}{res}Unique HH Identifier Across Panel Waves{p_end}
{p 0 48}{bind:h14bq2         }{txt}{bind: int    }{bind:{txt}%54.0g     }{space 1}{bind:H14BQ2   }{bind:  }{res}{res}Consumption Item Code{p_end}
{p 0 48}{bind:h14bq3         }{txt}{bind: byte   }{bind:{txt}%34.0g     }{space 1}{bind:H14BQ3   }{bind:  }{res}{res}unit of quantity{p_end}
{p 0 48}{bind:h14bq4         }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}purchase quantity{p_end}
{p 0 48}{bind:h14bq5         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}purchase value{p_end}
{p 0 48}{bind:h14bq6         }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}home produced quantity{p_end}
{p 0 48}{bind:h14bq7         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}home produced value{p_end}
{p 0 48}{bind:h14bq8         }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}received in kind quantity{p_end}
{p 0 48}{bind:h14bq9         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}received in kind value{p_end}
{p 0 48}{bind:h14bq10        }{txt}{bind: double }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}unit price{p_end}
{txt}{hline}
Sorted by:  {res}HHID  h14bq2
{txt}
{com}. rename HHID hhid
{txt}
{com}. sort hhid
{txt}
{com}. ** here we considered rent of rented house-301, imputed rent of own house-302, imputed rent of free given house-303, repair expenses-304, water-305 
. ** electricity-306, generator fuels-307, parafin-308, charcoal-309, firewood-310, matches-451, washing soap-452, bathing soap-453, toothpaste-454, 
. ** taxifares-463, and expenditure on phones not owned-468, and we dropped others-311, cosmetics-455, handbags-456, batteries-drycells-457, newspapers-458, 
. * others-459, tires-461, petrol-462, bus fares-464, bodaboda fare-465, stamps/envelops-466, mobilephoneairtime-467 and others-469,health fees as 
. *consultation-501, medicine-502, hospitalcharges-503, traditionaldoctors-504, others-505 since medical expenses were cosidered in section 5, 
. * sports/theater-601, drycleaning-602, houseboys-603, barbers&beauty shops-604 and lodging-605. THESE HAVE BEEN CONSIDERED NON BASIC
. drop if inlist( h14bq2 ,311,455,456,457,458,459,461,462,464,465,466,467,469,501,502,503,504,505,601,602,603,604,605)
{txt}(9010 observations deleted)

{com}. egen hhfrequents = rowtotal ( h14bq5 h14bq7 h14bq9)
{txt}
{com}. gen dhhfrequents = hhfrequents/30
{txt}
{com}. la var dhhfrequents "daily household expenditure on frequently bought commodities"
{txt}
{com}. tostring hhid, force replace
{txt}hhid already string; no {res}replace
{txt}
{com}. save "$path/out/hhdfrequentsexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdfrequentsexp.dta saved

{com}. clear
{txt}
{com}. ****------------------calculating basic expenses on semi durables
. **   in considering semi durable goods and services, the value of those services and goods recieved in kind, column h15dq9 of GSEC15D.dta has been excluded
. **   just as in kind food consumptions were eliminated in table 4 as per the GAPP guidelines, These have also been discounted by 10% usage per year
. use "$path/in/GSEC14C.dta"
{txt}
{com}. save "$path/out/hhsemidurables.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhsemidurables.dta saved

{com}. des

{txt}Contains data from {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhsemidurables.dta
{txt}  obs:{res}        28,662                          
{txt} vars:{res}             5                          10 Mar 2014 14:47
{txt} size:{res}       716,550                          
{txt}{hline}
              storage  display     value
variable name   type   format      label      variable label
{hline}
{p 0 48}{res}{bind:HHID           }{txt}{bind: str11  }{bind:{txt}%11s       }{space 1}{bind:         }{bind:  }{res}{res}Unique HH Identifier Across Panel Waves{p_end}
{p 0 48}{bind:h14cq2         }{txt}{bind: int    }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}Consumption Item Code{p_end}
{p 0 48}{bind:h14cq3         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}purchases value{p_end}
{p 0 48}{bind:h14cq4         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}consumption out of hh/enterprise stock{p_end}
{p 0 48}{bind:h14cq5         }{txt}{bind: long   }{bind:{txt}%12.0g     }{space 1}{bind:         }{bind:  }{res}{res}value received in kind{p_end}
{txt}{hline}
Sorted by:  {res}HHID  h14cq2
{txt}
{com}. sort HHID
{txt}
{com}. rename HHID hhid
{txt}
{com}. ** we have considered the following men clothing-201, womenclothing-202, childrenclothing-203, men footware-206, women footware-207, children footware-208
. ** bedding mattress-304, blankets-305, charcoal/parafin stoves-402, plastic plates and tumblers-502, and dropped other clothing-204, tailoring materials-205, 
. *other footware-209, furniture items-301, carpets-302, curtains&bedsheets-303, others-306, kettles-401, tv&radio-403, byclcles-404, radio-405, motors-406, 
. *motorcycles-407,computers-408, phone handsets-409, others-410, jewelry&watches-411,glass/table ware of codes 501 and 503-506, education cost (601-605)
. *as education done in section 4, and others like functions & premiums (701-703) ** as these have been consideered NON BASIC
. *drop if inlist( h14cq2 ,204,205,208,209,301,302,303,306,401,403,404,405,406,407,408,409,410,411,501,503,504,505,506,601,602,603,604,605,701,702,703)
. egen hhsemidurables = rowtotal ( h14cq3 h14cq4 h14cq5)
{txt}
{com}. sort hhid
{txt}
{com}. gen hhdsemidurs = (hhsemidurables*0.5)/365
{txt}
{com}. la var hhdsemidurs "household daily semi durables goods and seervices expenses"
{txt}
{com}. drop hhsemidurables
{txt}
{com}. tostring hhid, force replace
{txt}hhid already string; no {res}replace
{txt}
{com}. save "$path/out/hhdsemidurablesexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdsemidurablesexp.dta saved

{com}. clear
{txt}
{com}. 
. use "$path/in/GSEC14D.dta"
{txt}
{com}. save "$path/in/hhnonconsmpexptaxes.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/hhnonconsmpexptaxes.dta saved

{com}. sort HHID
{txt}
{com}. rename HHID hhid
{txt}
{com}. ** we only considered graduated tax-904, that may cause arrest if not paid and it used to be per head paid to local government annually
. ** and dropped income tax-901, property tax-902, user fees-903, social security payments-905, remmitances-906, funerals-907 and others-909
. drop if inlist( itmcd ,901,902,903,905,906,907,909)
{txt}(3742 observations deleted)

{com}. gen hhdnonconsumpexp = value/365
{txt}(2 missing values generated)

{com}. la var hhdnonconsumpexp "hh daily expenditure on taxes, contributions, donations, duties, etc"
{txt}
{com}. sort hhid 
{txt}
{com}. collapse hhdnonconsumpexp, by (hhid)
{txt}
{com}. save "$path/out/hhdnonconsumpexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdnonconsumpexp.dta saved

{com}. clear
{txt}
{com}. ****-----------------------calculating basic non-consumption expenses
. ** The file GSEC15E.dta, where this information was kept was absent
. ** after generating all daily non food total household expenditures of various considered items, then we start merging these  SIX hhd--- prefixed files, and ending with sufix exp to get all non food hh daily expenditure
. use "$path/out/hhdeducationexp.dta", clear
{txt}
{com}. collapse (sum) educationd , by(hhid)
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhdeducationexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdeducationexp.dta saved

{com}. use "$path/out/hhdmedicalexp.dta", clear
{txt}
{com}. collapse (sum) medicalexpd , by(hhid)
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhdmedicalexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdmedicalexp.dta saved

{com}. use "$path/out/hhdeducationexp.dta", clear
{txt}
{com}. merge 1:1 hhid using "$path/out/hhdmedicalexp.dta"
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}               3
{txt}{col 9}from master{col 30}{res}               3{txt}  (_merge==1)
{col 9}from using{col 30}{res}               0{txt}  (_merge==2)

{col 5}matched{col 30}{res}           3,118{txt}  (_merge==3)
{col 5}{hline 41}

{com}. drop _merge
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhdeduc&medicex.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdeduc&medicex.dta saved

{com}. use "$path/out/hhddurablesexp.dta"
{txt}
{com}. collapse (sum) dassetvalue , by(hhid)
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhddurablesexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhddurablesexp.dta saved

{com}. use "$path/out/hhdeduc&medicex.dta"
{txt}
{com}. merge 1:1 hhid using "$path/out/hhddurablesexp.dta"
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}               5
{txt}{col 9}from master{col 30}{res}               4{txt}  (_merge==1)
{col 9}from using{col 30}{res}               1{txt}  (_merge==2)

{col 5}matched{col 30}{res}           3,117{txt}  (_merge==3)
{col 5}{hline 41}

{com}. drop _merge
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhdeduc&medic&durabex.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdeduc&medic&durabex.dta saved

{com}. use "$path/out/hhdnondurablesexp.dta"
{txt}
{com}. collapse (sum) dnondurables , by(hhid)
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhdnondurablesexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdnondurablesexp.dta saved

{com}. use "$path/out/hhdeduc&medic&durabex.dta"
{txt}
{com}. merge 1:1 hhid using "$path/out/hhdnondurablesexp.dta"
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}               5
{txt}{col 9}from master{col 30}{res}               5{txt}  (_merge==1)
{col 9}from using{col 30}{res}               0{txt}  (_merge==2)

{col 5}matched{col 30}{res}           3,117{txt}  (_merge==3)
{col 5}{hline 41}

{com}. drop _merge
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhdeduc&medic&durab&nondurabex.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdeduc&medic&durab&nondurabex.dta saved

{com}. clear
{txt}
{com}. use "$path/out/hhdfrequentsexp.dta"
{txt}
{com}. tostring hhid, force replace
{txt}hhid already string; no {res}replace
{txt}
{com}. collapse (sum) dhhfrequents , by(hhid)
{txt}
{com}. sort hhid
{txt}
{com}. tostring hhid, force replace
{txt}hhid already string; no {res}replace
{txt}
{com}. save "$path/out/hhdfrequentsexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdfrequentsexp.dta saved

{com}. use "$path/out/hhdeduc&medic&durab&nondurabex.dta"
{txt}
{com}. merge 1:1 hhid using "$path/out/hhdfrequentsexp.dta" 
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}               0
{txt}{col 5}matched{col 30}{res}           3,122{txt}  (_merge==3)
{col 5}{hline 41}

{com}. drop _merge
{txt}
{com}. sort hhid
{txt}
{com}. save "$path/out/hhdeduc&medic&durab&nondurab&freqsex.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdeduc&medic&durab&nondurab&freqsex.dta saved

{com}. use "$path/out/hhdsemidurablesexp.dta"
{txt}
{com}. tostring hhid, force replace
{txt}hhid already string; no {res}replace
{txt}
{com}. collapse (sum) hhdsemidurs , by(hhid)
{txt}
{com}. sort hhid
{txt}
{com}. tostring hhid, force replace
{txt}hhid already string; no {res}replace
{txt}
{com}. save "$path/out/hhdsemidurablesexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdsemidurablesexp.dta saved

{com}. use "$path/out/hhdeduc&medic&durab&nondurab&freqsex.dta"
{txt}
{com}. merge 1:1 hhid using "$path/out/hhdsemidurablesexp.dta"
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}              42
{txt}{col 9}from master{col 30}{res}              42{txt}  (_merge==1)
{col 9}from using{col 30}{res}               0{txt}  (_merge==2)

{col 5}matched{col 30}{res}           3,080{txt}  (_merge==3)
{col 5}{hline 41}

{com}. drop _merge
{txt}
{com}. sort hhid
{txt}
{com}. merge 1:1 hhid using "$path/out/hhdnonconsumpexp.dta"
{res}
{txt}{col 5}Result{col 38}# of obs.
{col 5}{hline 41}
{col 5}not matched{col 30}{res}           2,197
{txt}{col 9}from master{col 30}{res}           2,197{txt}  (_merge==1)
{col 9}from using{col 30}{res}               0{txt}  (_merge==2)

{col 5}matched{col 30}{res}             925{txt}  (_merge==3)
{col 5}{hline 41}

{com}. save "$path/out/hhdeduc&medic&durab&nondurab&freqs&semidurabex.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhdeduc&medic&durab&nondurab&freqs&semidurabex.dta saved

{com}. gen hhnonfoodexp =  educationd+medicalexpd+dassetvalue+dnondurables+dhhfrequents+hhdsemidurs
{txt}(49 missing values generated)

{com}. la var hhnonfoodexp "household total non food expenditure"
{txt}
{com}. keep hhid hhnonfoodexp
{txt}
{com}. gen product = 0
{txt}
{com}. la var product "product code equal to 1 for food and 0 for non food"
{txt}
{com}. gen food_cat = 0
{txt}
{com}. la var food_cat "food product or not equals 1 for foods and 0 for non foods"
{txt}
{com}. gen prod_cat = 2
{txt}
{com}. la var prod_cat "COICOP product categories, 2 for all non food"
{txt}
{com}. replace product = 2 if product==0
{txt}(3122 real changes made)

{com}. replace food_cat = 2 if food_cat==0
{txt}(3122 real changes made)

{com}. gen descript = 2
{txt}
{com}. la var descript "product description including product code but equals 2 for all non-foods"
{txt}
{com}. save "$path/out/hhtotalnonfoodexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhtotalnonfoodexp.dta saved

{com}. label define descrip 2 " non food", add
{txt}
{com}. label values descript descrip
{txt}
{com}. label define descrip 1 " food", add
{txt}
{com}. replace descript = 1 in 6
{txt}(1 real change made)

{com}. replace descript = 2 in 6
{txt}(1 real change made)

{com}. sort hhid
{txt}
{com}. destring hhid, replace
{txt}hhid has all characters numeric; {res}replaced {txt}as {res}double
{txt}
{com}. save "$path/out/hhtotalnonfoodexp.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/hhtotalnonfoodexp.dta saved

{com}. use "$path/out/hhtotalnonfoodexp.dta"
{txt}
{com}. append using  "$path/out/cons_cod_trans.dta"
{txt}
{com}. rename quantityz quantityd
{txt}
{com}. egen cod_hh_nom = rowtotal( hhnonfoodexp valuez)
{txt}
{com}. la var cod_hh_nom "total household daily expenditure"
{txt}
{com}. la var quantityd "housedhold daily quantity of food consumed in Kgs"
{txt}
{com}. drop unit
{txt}
{com}. drop hhnonfoodexp
{txt}
{com}. sort hhid
{txt}
{com}. replace product = 999 if product==2
{txt}(3122 real changes made)

{com}. la var product "product code is 999, if product is non food"
{txt}
{com}. replace prod_cat = 1 if prod_cat==.
{txt}(39853 real changes made)

{com}. replace descript=1 if descript==.
{txt}(2563 real changes made)

{com}. label drop _all
{txt}
{com}. save "$path/out/cons_cod.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//out/cons_cod.dta saved

{com}. save "$path/in/cons_cod.dta", replace
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//in/cons_cod.dta saved

{com}. 
. 
{txt}end of do-file

{com}. do "$path/new/010_initial.do"
{txt}
{com}. cap log close
{txt}
{com}. log using "$path/rep/010_initial.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/010_initial.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:03
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. ******************************************************************************
> * 010_initial.do                (start)
> ******************************************************************************;
. ******************************************************************************
> * Purpose: Set some globals
> ******************************************************************************;
. ******************************************************************************
> * TPI basket
> ******************************************************************************;
. * Number of items for Uganda i primarily set it to 30 on considering a product for appearing over 1000 times on households menu min was 1085 and max was 6157 however the relevant code in new is atvivated to take care of this automatically;
. global product_tpi_n "30";
{txt}
{com}. * Code choose $product_tpi_n ;
. global product_tpi   "product_tpi==1";
{txt}
{com}. * Initial (arbitrary) quantile defining poor for price index calculations.
> * Mozambique: bottom 60%. Vietnam: bottom 20%. Tanzania: bottom 40% . Uganda: headcount 2009 24.5% ;
. global tpi_bottom "50";
{txt}
{com}.  * Set the number of regions in the TPI calc for Uganda are set to 4 as east central north and east;
. global n_tpi "5";
{txt}
{com}. * To reproduce the mozambique 10 numbers, the following global should be commented out. It controls a line in 140_iterate.do 
> * where observations not measured in kg are dropped. For all other datasets, all observations should be converted to kg's before
> * the toolkit is run. For all other datasets, this line should therefore be included.
> global MZ "*";
. ******************************************************************************
> * Initial (arbitrary) quantile defining the (relatively) poor.
> ******************************************************************************;
. global bottom "50";
{txt}
{com}. ******************************************************************************
> * Number of iterations in 140_iterate.do
> ******************************************************************************;
. global it_n "5";
{txt}
{com}. ******************************************************************************
> * Set the number of regions in the spatial domain;
. ******************************************************************************;
. global n_spdom "5";
{txt}
{com}. ******************* we deleted East urban (132 hhds), North urban (172 hhds) and West urban (107 hhds) because too few observations were in those spatial domains;
.  ******************************************************************************
> * Revealed preferences choices
> ******************************************************************************;
. * Activate GAMS program according to number of regions in spatial domain;
. *global revpref "190_revpref13_m1.bat";
. *global no_temp_rev " ";
. * k spatial regions and no intertemporal revealed preference condition:
>   Activate the next two lines below;
. global no_temp_rev "*";
{txt}
{com}. global revpref "190_revpref13_r.bat";
{txt}
{com}.  **************************************************************************
> * 010_initial.do                (end)
> **************************************************************************;
. log close;
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/010_initial.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:47:03
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. 
. *do "C:\user\gapp\z_data_preb/new/100_collect_expen_moz.do"

. *s;

. 
. *do "C:\user\gapp\z_data_preb/new/000_boom.do"

. 
. *global path "C:\user\gapp"

. 
. 
. 
. **************************************************************************;

. **************************************************************************;

. * This is the block of do files to set up the data to get nominal

. * consumption. These DO NOT need to be bootstrapped.

. **************************************************************************;

. **************************************************************************;

. 
. * This code produces some once for all data for the in-folder. Don't

. * run it unless you know what you are doing!!!

. * Produces education expenditure

. *do "$path\new\Create/education_Create.do"

. * Imputation of missing recepts-in-kind. Run the code without this first...

. *do "$path\new\Create/0_code_chain.do"

. * First poverty lines dependent on IAF

. *do "$path\new\Create/povlines_first_iof_Create.do"

. * Match product codes for different surveys

. *do "$path\new\Create/match96_02_Create.do"

. * Basket from previous survey

. *do "$path\new\Create/smallbasket_iof_Create.do"

. * Match product codes between surveys

. *do "$path\new\Create/rev_pref_matchcodes_02-96_iof_Create.do"

. * Update poverty lines

. *do "$path\new\Create/povlines-96-v1-vers7_iof_Create.do"

. * Food share

. *do "$path\new\Create/foodshr96_iof_Create.do"

. 
. *do "$path\new\Create/.do"

. *do "$path\new\Create/.do"

. 
. */

. * This set of files takes the raw data and creates more handy data 

. * sets in the work-folder

. do "$path/new/020_in_2_work_folder.do"
{txt}
{com}. clear all
{txt}
{com}. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-HARUNA"
. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/020_hhdata.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/020_hhdata.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:04
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 020_hhdata.do         (start)
> *
> * Organize the hhid identifier in the HHData file the same way, and keep
> * only the relevant variables.
> *
> * This file sets:
> * - interview month, quarter and year
> * - regions: make all needed regions. But in the end only the one specified
> *            in initial.do are kept. These are
> *            - rural: 0=urban, 1=rural
> *            - news: speficifying North, East, West, South. But combinations
> *                    are also possible, eg. North-East, Center,...
> *            - reg_tpi: regions with own TPI
> *            - strata: strata regions
> *            - spdomain: spatial domains (regions with own poverty line)
> *            - news_ru_ur: combination of news and rural
> **************************************************************************;
. use "$path/in/hhdata.dta", clear;
{txt}
{com}. *recode spdomain 10=1 11=2 20=3 30=4 40=5 these have been set to five for Uganda to ensure hwe have at least 1000 households per domain;
. tab spdomain, missing;

      {txt}Spatial {c |}
domains: each {c |}
     with own {c |}
 poverty line {c |}
 (they are 5) {c |}      Freq.     Percent        Cum.
{hline 14}{c +}{hline 35}
Central Urban {c |}{res}        460       14.73       14.73
{txt}Central Rural {c |}{res}        564       18.06       32.79
{txt}      Eastern {c |}{res}        697       22.32       55.11
{txt}     Northern {c |}{res}        695       22.25       77.36
{txt}      Western {c |}{res}        703       22.51       99.87
{txt}            . {c |}{res}          4        0.13      100.00
{txt}{hline 14}{c +}{hline 35}
        Total {c |}{res}      3,123      100.00
{txt}
{com}.         sort hhid;
{txt}
{com}.         save "$path/work/hhdata.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/hhdata.dta saved

{com}.         sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}      3123    2.43e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 10}hh {c |}{res}         0
{txt}{space 9}psu {c |}{res}      3119    2.42e+07    1.16e+07   1.01e+07   4.15e+07
{txt}{space 6}region {c |}{res}      3119    2.345303    1.154947          1          4
{txt}{space 4}h1aq1_05 {c |}{res}      3119    241.3331    115.9545        101        415
{txt}{hline 13}{c +}{hline 56}
{space 7}h1aq1 {c |}{res}      3119     243.201    116.4849        101        419
{txt}{space 7}urban {c |}{res}      3119    .2757294    .4469527          0          1
{txt}tracking_s~e {c |}{res}      3119    .2055146    .4041419          0          1
{txt}{space 4}inidpcmp {c |}{res}      3119           2           0          2          2
{txt}{space 6}h1bq2a {c |}{res}      3119    16.73549    6.425793          3         31
{txt}{hline 13}{c +}{hline 56}
{space 6}h1bq2b {c |}{res}      3119    7.762744    1.607834          5         11
{txt}{space 6}h1bq2c {c |}{res}      3119    2005.357    .4790494       2005       2006
{txt}interview_~t {c |}{res}      3119    1.000321    .0179057          1          2
{txt}{space 8}wave {c |}{res}      3119           0           0          0          0
{txt}{space 4}hhweight {c |}{res}      3119    1673.657     752.607   140.8407   5553.862
{txt}{hline 13}{c +}{hline 56}
{space 5}stratum {c |}{res}      3119    3.711446    1.623898          1          6
{txt}{space 4}survquar {c |}{res}      3119    2.438602    1.384417          1          5
{txt}{space 5}survmon {c |}{res}      3119    6.258416     4.17765          1         14
{txt}{space 6}strata {c |}{res}      3119    4.414877    2.449958          1          8
{txt}{space 7}rural {c |}{res}      3119    .7242706    .4469527          0          1
{txt}{hline 13}{c +}{hline 56}
{space 5}reg_tpi {c |}{res}      3119    2.345303    1.154947          1          4
{txt}{space 4}spdomain {c |}{res}      3119     3.19782    1.362579          1          5
{txt}{space 8}news {c |}{res}      3119    2.345303    1.154947          1          4
{txt}{space 8}bswt {c |}{res}      3119           1           0          1          1
{txt}{space 6}hhsize {c |}{res}      3123    5.366314    3.108797          1         29
{txt}
{com}. use "$path/in/indata.dta", clear;
{txt}
{com}.         *sort hhid;
.         save "$path/work/indata.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/indata.dta saved

{com}.         sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 7}indid {c |}{res}     16759    1.15e+12    1.25e+12   2.03e+11   4.61e+12
{txt}{space 4}motherhh {c |}{res}      8206           0           0          0          0
{txt}{space 8}hhid {c |}{res}     16759    2.47e+09    1.15e+09   1.01e+09   4.19e+09
{txt}{space 9}sex {c |}{res}     16759    1.511248    .4998884          1          2
{txt}{space 9}age {c |}{res}     16759    19.75619    17.18438          0        102
{txt}
{com}. use "$path/in/calperg.dta", clear;
{txt}
{com}.         *sort hhid;
.         save "$path/work/calperg.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/calperg.dta saved

{com}.         sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}product {c |}{res}        62       130.5    18.04162        100        161
{txt}{space 4}descript {c |}{res}         0
{txt}{space 5}calperg {c |}{res}        62    1.980935    2.136932          0       8.84
{txt}
{com}. use "$path/in/cons_cod.dta", clear;
{txt}
{com}.                 save "$path/work/cons_cod.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_cod.dta saved

{com}. use "$path/in/cons_cod_trans.dta", clear;
{txt}
{com}.                 save "$path/work/cons_cod_trans.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_cod_trans.dta saved

{com}. /*
> use "$path/in/cons_cod_trans.dta", clear;
>         *sort hhid;
>         sum;
> for var value quantityd cod_hh_nom cod_hh_nom2 cod_hh_nom3: replace X=0 if X==.;
> collapse food_cat prod_cat (sum) value quantityd cod_hh_nom cod_hh_nom2 cod_hh_nom3, by(hhid product descript);
>         save "$path/work/cons_cod.dta", replace;
>         sum;
> */
>  
> **************************************************************************
> * 020_hhdata.do         (end)
> **************************************************************************;
. cap log close;
{txt}
{com}. 
{txt}end of do-file

{com}. 
. /*
{err}unrecognized command:  / invalid command name
{txt}{search r(199):r(199);}

{com}. * All kind of raw expenditure is handled: daily, own and monthly, rent and use value, education etc.

. do "$path/new/030_rawdata.do"
{err}{p 0 4 2}
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//new/030_rawdata.do
not found
{p_end}
{txt}{search r(601):r(601);}

{com}. 
. * Data set specific changes to each processed raw data set takes place here

. do "$path/new/040_specifities.do"
{err}{p 0 4 2}
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//new/040_specifities.do
not found
{p_end}
{txt}{search r(601):r(601);}

{com}. 
. * These files summarizes and checks the data. But no temporal deflation done here yet

. do "$path/new/050_consump_nom.do"
{err}{p 0 4 2}
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//new/050_consump_nom.do
not found
{p_end}
{txt}{search r(601):r(601);}

{com}. 
. * Bring in data on food product's calories per gram

. do "$path/new/060_calperg.do"
{err}{p 0 4 2}
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//new/060_calperg.do
not found
{p_end}
{txt}{search r(601):r(601);}

{com}. */

. **********************************************************************;

. **********************************************************************;

. 
. do "$path/new/070_calpp.do"/* Calories per person in spatial domains*/
{txt}
{com}. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-HARUNA"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/070_calpp.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/070_calpp.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:05
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. *global fert_rate "fert_rate";
. ***********************************************************************
> * 070_calpp.do          (start)
> *
> * Purpose: Determine calories required for each person per domain per day.
> ***********************************************************************;
. /*
> This file uses:
>         work/indata.dta
>         work/hhdata.dta
> 
> This file creates:
>         work/calpp.dta
> */
> 
> *-------------------------------------------------------------------------*
> * Include fertility rates from csv-file
> *-------------------------------------------------------------------------*;
. clear;
{txt}
{com}. insheet sex rural age fert_rate using "$path/in/fert_rate_Uganda.csv";
{txt}(4 vars, 96 obs)

{com}. ***************************************** check for Ugandan fertility rates *************************************
> *************************************************************************************************************;
. sort sex rural age;
{txt}
{com}. tempfile fert_rate;
{txt}
{com}. save `fert_rate';
{txt}file /tmp/St02564.000001 saved

{com}. list;
{txt}
     {c TLC}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c TRC}
     {c |} {res}sex   rural   age   fert_r~e {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
  1. {c |} {res}  2       0    12       .008 {txt}{c |}
  2. {c |} {res}  2       0    13       .008 {txt}{c |}
  3. {c |} {res}  2       0    14       .008 {txt}{c |}
  4. {c |} {res}  2       0    15       .134 {txt}{c |}
  5. {c |} {res}  2       0    16       .134 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
  6. {c |} {res}  2       0    17       .134 {txt}{c |}
  7. {c |} {res}  2       0    18       .134 {txt}{c |}
  8. {c |} {res}  2       0    19       .134 {txt}{c |}
  9. {c |} {res}  2       0    20       .313 {txt}{c |}
 10. {c |} {res}  2       0    21       .313 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 11. {c |} {res}  2       0    22       .313 {txt}{c |}
 12. {c |} {res}  2       0    23       .313 {txt}{c |}
 13. {c |} {res}  2       0    24       .313 {txt}{c |}
 14. {c |} {res}  2       0    25       .291 {txt}{c |}
 15. {c |} {res}  2       0    26       .291 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 16. {c |} {res}  2       0    27       .291 {txt}{c |}
 17. {c |} {res}  2       0    28       .291 {txt}{c |}
 18. {c |} {res}  2       0    29       .291 {txt}{c |}
 19. {c |} {res}  2       0    30       .232 {txt}{c |}
 20. {c |} {res}  2       0    31       .232 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 21. {c |} {res}  2       0    32       .232 {txt}{c |}
 22. {c |} {res}  2       0    33       .232 {txt}{c |}
 23. {c |} {res}  2       0    34       .232 {txt}{c |}
 24. {c |} {res}  2       0    35       .172 {txt}{c |}
 25. {c |} {res}  2       0    36       .172 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 26. {c |} {res}  2       0    37       .172 {txt}{c |}
 27. {c |} {res}  2       0    38       .172 {txt}{c |}
 28. {c |} {res}  2       0    39       .172 {txt}{c |}
 29. {c |} {res}  2       0    40       .074 {txt}{c |}
 30. {c |} {res}  2       0    41       .074 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 31. {c |} {res}  2       0    42       .074 {txt}{c |}
 32. {c |} {res}  2       0    43       .074 {txt}{c |}
 33. {c |} {res}  2       0    44       .074 {txt}{c |}
 34. {c |} {res}  2       0    45       .023 {txt}{c |}
 35. {c |} {res}  2       0    46       .023 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 36. {c |} {res}  2       0    47       .023 {txt}{c |}
 37. {c |} {res}  2       0    48       .023 {txt}{c |}
 38. {c |} {res}  2       0    49       .023 {txt}{c |}
 39. {c |} {res}  2       0    50       .006 {txt}{c |}
 40. {c |} {res}  2       0    51       .006 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 41. {c |} {res}  2       0    52       .006 {txt}{c |}
 42. {c |} {res}  2       0    53       .006 {txt}{c |}
 43. {c |} {res}  2       0    54       .006 {txt}{c |}
 44. {c |} {res}  2       0    55       .006 {txt}{c |}
 45. {c |} {res}  2       0    56       .006 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 46. {c |} {res}  2       0    57       .006 {txt}{c |}
 47. {c |} {res}  2       0    58       .006 {txt}{c |}
 48. {c |} {res}  2       0    59       .006 {txt}{c |}
 49. {c |} {res}  2       1    12       .008 {txt}{c |}
 50. {c |} {res}  2       1    13       .008 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 51. {c |} {res}  2       1    14       .008 {txt}{c |}
 52. {c |} {res}  2       1    15       .134 {txt}{c |}
 53. {c |} {res}  2       1    16       .134 {txt}{c |}
 54. {c |} {res}  2       1    17       .134 {txt}{c |}
 55. {c |} {res}  2       1    18       .134 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 56. {c |} {res}  2       1    19       .134 {txt}{c |}
 57. {c |} {res}  2       1    20       .313 {txt}{c |}
 58. {c |} {res}  2       1    21       .313 {txt}{c |}
 59. {c |} {res}  2       1    22       .313 {txt}{c |}
 60. {c |} {res}  2       1    23       .313 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 61. {c |} {res}  2       1    24       .313 {txt}{c |}
 62. {c |} {res}  2       1    25       .291 {txt}{c |}
 63. {c |} {res}  2       1    26       .291 {txt}{c |}
 64. {c |} {res}  2       1    27       .291 {txt}{c |}
 65. {c |} {res}  2       1    28       .291 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 66. {c |} {res}  2       1    29       .291 {txt}{c |}
 67. {c |} {res}  2       1    30       .232 {txt}{c |}
 68. {c |} {res}  2       1    31       .232 {txt}{c |}
 69. {c |} {res}  2       1    32       .232 {txt}{c |}
 70. {c |} {res}  2       1    33       .232 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 71. {c |} {res}  2       1    34       .232 {txt}{c |}
 72. {c |} {res}  2       1    35       .172 {txt}{c |}
 73. {c |} {res}  2       1    36       .172 {txt}{c |}
 74. {c |} {res}  2       1    37       .172 {txt}{c |}
 75. {c |} {res}  2       1    38       .172 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 76. {c |} {res}  2       1    39       .172 {txt}{c |}
 77. {c |} {res}  2       1    40       .074 {txt}{c |}
 78. {c |} {res}  2       1    41       .074 {txt}{c |}
 79. {c |} {res}  2       1    42       .074 {txt}{c |}
 80. {c |} {res}  2       1    43       .074 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 81. {c |} {res}  2       1    44       .074 {txt}{c |}
 82. {c |} {res}  2       1    45       .023 {txt}{c |}
 83. {c |} {res}  2       1    46       .023 {txt}{c |}
 84. {c |} {res}  2       1    47       .023 {txt}{c |}
 85. {c |} {res}  2       1    48       .023 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 86. {c |} {res}  2       1    49       .023 {txt}{c |}
 87. {c |} {res}  2       1    50       .006 {txt}{c |}
 88. {c |} {res}  2       1    51       .006 {txt}{c |}
 89. {c |} {res}  2       1    52       .006 {txt}{c |}
 90. {c |} {res}  2       1    53       .006 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 91. {c |} {res}  2       1    54       .006 {txt}{c |}
 92. {c |} {res}  2       1    55       .006 {txt}{c |}
 93. {c |} {res}  2       1    56       .006 {txt}{c |}
 94. {c |} {res}  2       1    57       .006 {txt}{c |}
 95. {c |} {res}  2       1    58       .006 {txt}{c |}
     {c LT}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c RT}
 96. {c |} {res}  2       1    59       .006 {txt}{c |}
     {c BLC}{hline 5}{c -}{hline 7}{c -}{hline 5}{c -}{hline 10}{c BRC}

{com}. *-------------------------------------------------------------------------*
> * Now do the calorie needs for individuals
> *-------------------------------------------------------------------------*;
. use "$path/work/indata.dta";
{txt}
{com}. * CA bootstrap modification;
. sort hhid;
{txt}
{com}. merge hhid using "$path/work/hhdata.dta";
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}. tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     16,759      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     16,759      100.00
{txt}
{com}.  drop _m;
{txt}
{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 7}indid {c |}{res}     16759    1.15e+12    1.25e+12   2.03e+11   4.61e+12
{txt}{space 4}motherhh {c |}{res}      8206           0           0          0          0
{txt}{space 8}hhid {c |}{res}     16759    2.47e+09    1.15e+09   1.01e+09   4.19e+09
{txt}{space 9}sex {c |}{res}     16759    1.511248    .4998884          1          2
{txt}{space 9}age {c |}{res}     16759    19.75619    17.18438          0        102
{txt}{hline 13}{c +}{hline 56}
{space 10}hh {c |}{res}         0
{txt}{space 9}psu {c |}{res}     16731    2.45e+07    1.14e+07   1.01e+07   4.15e+07
{txt}{space 6}region {c |}{res}     16731    2.379953    1.140978          1          4
{txt}{space 4}h1aq1_05 {c |}{res}     16731    244.8445    114.4735        101        415
{txt}{space 7}h1aq1 {c |}{res}     16731    246.7354    115.0025        101        419
{txt}{hline 13}{c +}{hline 56}
{space 7}urban {c |}{res}     16731    .2545574    .4356252          0          1
{txt}tracking_s~e {c |}{res}     16731    .2037535    .4027998          0          1
{txt}{space 4}inidpcmp {c |}{res}     16731           2           0          2          2
{txt}{space 6}h1bq2a {c |}{res}     16731    16.78083    6.442273          3         31
{txt}{space 6}h1bq2b {c |}{res}     16731    7.682027    1.614348          5         11
{txt}{hline 13}{c +}{hline 56}
{space 6}h1bq2c {c |}{res}     16731    2005.375    .4840427       2005       2006
{txt}interview_~t {c |}{res}     16731    1.000418    .0204508          1          2
{txt}{space 8}wave {c |}{res}     16731           0           0          0          0
{txt}{space 4}hhweight {c |}{res}     16731    1683.355    737.5353   140.8407   5553.862
{txt}{space 5}stratum {c |}{res}     16731    3.784651    1.590639          1          6
{txt}{hline 13}{c +}{hline 56}
{space 4}survquar {c |}{res}     16731    2.461419    1.413745          1          5
{txt}{space 5}survmon {c |}{res}     16731    6.304465    4.259338          1         14
{txt}{space 6}strata {c |}{res}     16731    4.505349    2.406286          1          8
{txt}{space 7}rural {c |}{res}     16731    .7454426    .4356252          0          1
{txt}{space 5}reg_tpi {c |}{res}     16731    2.379953    1.140978          1          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     16731      3.2539    1.326619          1          5
{txt}{space 8}news {c |}{res}     16731    2.379953    1.140978          1          4
{txt}{space 8}bswt {c |}{res}     16731           1           0          1          1
{txt}{space 6}hhsize {c |}{res}     16759    7.166716    3.472568          1         29
{txt}
{com}. * Include fertility rates;
. sort sex rural age;
{txt}
{com}. merge sex rural age using `fert_rate';
{txt}{p 0 4 2}
variable{txt}s{txt} sex
rural
age
do not uniquely identify observations in
the master data
{p_end}

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 7}indid {c |}{res}     16759    1.15e+12    1.25e+12   2.03e+11   4.61e+12
{txt}{space 4}motherhh {c |}{res}      8206           0           0          0          0
{txt}{space 8}hhid {c |}{res}     16759    2.47e+09    1.15e+09   1.01e+09   4.19e+09
{txt}{space 9}sex {c |}{res}     16759    1.511248    .4998884          1          2
{txt}{space 9}age {c |}{res}     16759    19.75619    17.18438          0        102
{txt}{hline 13}{c +}{hline 56}
{space 10}hh {c |}{res}         0
{txt}{space 9}psu {c |}{res}     16731    2.45e+07    1.14e+07   1.01e+07   4.15e+07
{txt}{space 6}region {c |}{res}     16731    2.379953    1.140978          1          4
{txt}{space 4}h1aq1_05 {c |}{res}     16731    244.8445    114.4735        101        415
{txt}{space 7}h1aq1 {c |}{res}     16731    246.7354    115.0025        101        419
{txt}{hline 13}{c +}{hline 56}
{space 7}urban {c |}{res}     16731    .2545574    .4356252          0          1
{txt}tracking_s~e {c |}{res}     16731    .2037535    .4027998          0          1
{txt}{space 4}inidpcmp {c |}{res}     16731           2           0          2          2
{txt}{space 6}h1bq2a {c |}{res}     16731    16.78083    6.442273          3         31
{txt}{space 6}h1bq2b {c |}{res}     16731    7.682027    1.614348          5         11
{txt}{hline 13}{c +}{hline 56}
{space 6}h1bq2c {c |}{res}     16731    2005.375    .4840427       2005       2006
{txt}interview_~t {c |}{res}     16731    1.000418    .0204508          1          2
{txt}{space 8}wave {c |}{res}     16731           0           0          0          0
{txt}{space 4}hhweight {c |}{res}     16731    1683.355    737.5353   140.8407   5553.862
{txt}{space 5}stratum {c |}{res}     16731    3.784651    1.590639          1          6
{txt}{hline 13}{c +}{hline 56}
{space 4}survquar {c |}{res}     16731    2.461419    1.413745          1          5
{txt}{space 5}survmon {c |}{res}     16731    6.304465    4.259338          1         14
{txt}{space 6}strata {c |}{res}     16731    4.505349    2.406286          1          8
{txt}{space 7}rural {c |}{res}     16731    .7454426    .4356252          0          1
{txt}{space 5}reg_tpi {c |}{res}     16731    2.379953    1.140978          1          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     16731      3.2539    1.326619          1          5
{txt}{space 8}news {c |}{res}     16731    2.379953    1.140978          1          4
{txt}{space 8}bswt {c |}{res}     16731           1           0          1          1
{txt}{space 6}hhsize {c |}{res}     16759    7.166716    3.472568          1         29
{txt}{space 3}fert_rate {c |}{res}      4895    .1603115    .1141129       .006       .313
{txt}{hline 13}{c +}{hline 56}
{space 6}_merge {c |}{res}     16759    1.584164    .9094666          1          3
{txt}
{com}. * Do calorie calculations ;
.     gen num=1;
{txt}
{com}.     gen cal = .;
{txt}(16759 missing values generated)

{com}. * Same assumptions about sex/age specific calories need in IAF 1997, IAF 2003 and IOF 2009;
. * Children (no difference between boys and girls)   ;
.      replace cal =  820 if age < 1;
{txt}(636 real changes made)

{com}. * Add 500 cal per day for mothers in first six months of breast feeding
> * We assume that 60% of children under 1 are under six months old
> * And that all of them breast feed
> * We add these mother requirements of 300 on average to each child under 1 whose mother is alive;
.     replace cal = 1120 if age <  1 & motherhh==1;
{txt}(0 real changes made)

{com}.     replace cal = 1150 if age >= 1 & age <2;
{txt}(571 real changes made)

{com}.     replace cal = 1350 if age >= 2 & age <3;
{txt}(637 real changes made)

{com}.     replace cal = 1550 if age >= 3 & age <5;
{txt}(1080 real changes made)

{com}. * Males ;
.     replace cal = 1850 if age >=  5 & age <7  & sex==1;
{txt}(582 real changes made)

{com}.     replace cal = 2100 if age >=  7 & age <10 & sex==1;
{txt}(773 real changes made)

{com}.     replace cal = 2200 if age >= 10 & age <12 & sex==1;
{txt}(486 real changes made)

{com}.     replace cal = 2400 if age >= 12 & age <14 & sex==1;
{txt}(532 real changes made)

{com}.     replace cal = 2650 if age >= 14 & age <16 & sex==1;
{txt}(471 real changes made)

{com}.     replace cal = 2850 if age >= 16 & age <18 & sex==1;
{txt}(384 real changes made)

{com}.     replace cal = 3000 if age >= 18 & age <30 & sex==1;
{txt}(1590 real changes made)

{com}.     replace cal = 2900 if age >= 30 & age <60 & sex==1;
{txt}(1606 real changes made)

{com}.     replace cal = 2450 if age>=60 & age~=. & sex==1;
{txt}(312 real changes made)

{com}. * Girls 5-12 years (probability of pregnancy assumed = 0) ;
.     replace cal = 1750 if age >=  5 & age < 7 & sex==2;
{txt}(563 real changes made)

{com}.     replace cal = 1800 if age >=  7 & age <10 & sex==2;
{txt}(755 real changes made)

{com}.     replace cal = 1950 if age >= 10 & age <12 & sex==2;
{txt}(540 real changes made)

{com}. * Women with a correction for pregnancy. We add 285 calories per for the final trimester.
> * To do this we find the probability that rural and urban women are pregnant from
> * live births data in the 1997 census over the past 12 months (no correction for still births).
> * 3/4*probability of birth gives probability of preganancy. Probability of final trimester is one
> * third of that of that or 1/4 of the probability of birth
> 
> * Women urban;
.     replace cal = 2100 + (fert_rate*285)/4 if age >= 12 & age <14 & sex==2 & rural==0;
{txt}(134 real changes made)

{com}.     replace cal = 2150 + (fert_rate*285)/4 if age >= 14 & age <18 & sex==2 & rural==0;
{txt}(222 real changes made)

{com}.     replace cal = 2100 + (fert_rate*285)/4 if age >= 18 & age <30 & sex==2 & rural==0;
{txt}(623 real changes made)

{com}.     replace cal = 2150 + (fert_rate*285)/4 if age >= 30 & age <60 & sex==2 & rural==0;
{txt}(422 real changes made)

{com}. * Women rural;
.     replace cal = 2100 + (fert_rate*285)/4 if age >= 12 & age <14 & sex==2 & rural==1;
{txt}(374 real changes made)

{com}.     replace cal = 2150 + (fert_rate*285)/4 if age >= 14 & age <18 & sex==2 & rural==1;
{txt}(630 real changes made)

{com}.     replace cal = 2100 + (fert_rate*285)/4 if age >= 18 & age <30 & sex==2 & rural==1;
{txt}(1242 real changes made)

{com}.     replace cal = 2150 + (fert_rate*285)/4 if age >= 30 & age <60 & sex==2 & rural==1;
{txt}(1248 real changes made)

{com}. * Women 60+ are not pregnant ;
.     replace cal = 1950 if age>=60 & age~=. & sex==2;
{txt}(339 real changes made)

{com}.     count if cal ==.;
{res}    7
{txt}
{com}.     *Fill in these two observations for IAF 2002/03:;
.     * 1) this one is a child;
.     *replace cal = 1500 if cal ==. & age==.;
.     * 2) this one is 21 years old;
.     *replace cal = 2500 if cal ==. & b2==.;
.     collapse (sum) cal num (max) psu hhsize hhweight strata rural spdomain, by (hhid);
{txt}
{com}.     gen chk=hhsize - num;
{txt}
{com}.     sum chk;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 9}chk {c |}{res}      3123           0           0          0          0
{txt}
{com}.     drop chk;
{txt}
{com}.     gen calpp = cal / hhsize;
{txt}
{com}.     sort spdomain;
{txt}
{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}      3123    2.43e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 9}cal {c |}{res}      3123    11467.27    6718.735       1950   70377.13
{txt}{space 9}num {c |}{res}      3123    5.366314    3.108797          1         29
{txt}{space 9}psu {c |}{res}      3119    2.42e+07    1.16e+07   1.01e+07   4.15e+07
{txt}{space 6}hhsize {c |}{res}      3123    5.366314    3.108797          1         29
{txt}{hline 13}{c +}{hline 56}
{space 4}hhweight {c |}{res}      3119    1673.657     752.607   140.8407   5553.862
{txt}{space 6}strata {c |}{res}      3119    4.414877    2.449958          1          8
{txt}{space 7}rural {c |}{res}      3119    .7242706    .4469527          0          1
{txt}{space 4}spdomain {c |}{res}      3119     3.19782    1.362579          1          5
{txt}{space 7}calpp {c |}{res}      3123    2185.638     303.542       1310       3000
{txt}
{com}. * MAH ;
.  sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}      3123    2.43e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 9}cal {c |}{res}      3123    11467.27    6718.735       1950   70377.13
{txt}{space 9}num {c |}{res}      3123    5.366314    3.108797          1         29
{txt}{space 9}psu {c |}{res}      3119    2.42e+07    1.16e+07   1.01e+07   4.15e+07
{txt}{space 6}hhsize {c |}{res}      3123    5.366314    3.108797          1         29
{txt}{hline 13}{c +}{hline 56}
{space 4}hhweight {c |}{res}      3119    1673.657     752.607   140.8407   5553.862
{txt}{space 6}strata {c |}{res}      3119    4.414877    2.449958          1          8
{txt}{space 7}rural {c |}{res}      3119    .7242706    .4469527          0          1
{txt}{space 4}spdomain {c |}{res}      3119     3.19782    1.362579          1          5
{txt}{space 7}calpp {c |}{res}      3123    2185.638     303.542       1310       3000
{txt}
{com}.  codebook hhid;

{txt}{hline}
{res}hhid{right:Household ID}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3123{col 51}{txt}missing .:  {res}0{txt}/{res}3123

{txt}{col 19}mean:{res}{col 26} 2.4e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.2e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}. collapse (mean) calpp[aw=hhsize*hhweight], by (spdomain);
{txt}
{com}. sort spdomain;
{txt}
{com}. save "$path/work/calpp.dta",replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/calpp.dta saved

{com}. ***********************************************************************
> * 070_calpp.do          (end)
> ***********************************************************************;
. log close;
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/070_calpp.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:47:06
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. do "$path/new/080_conpc.do"/* Nominal food/non-food expenditure */
{txt}
{com}. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-HARUNA"
. clear all
{txt}
{com}. set mem 100m
{txt}
{com}. 
. clear
{txt}
{com}. cap log close
{txt}
{com}. log using "$path/rep/080_conpc.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/080_conpc.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:06
{txt}
{com}. set more off
{txt}
{com}. 
. 
. ***************************************************************************
. * 080_conpc.do          (start)
. *
. * Creates a file with per capita nominal consumption divided between food
. * and non-food categories based on the calorie definition of food
. * rather than the COICOP (INE) definition of food. ready for 
. * temporal deflation when necessary
. **************************************************************************** 
. 
. /*
> This file uses:
>         work/hhdata.dta
>         work/consump_nom.dta
>       
> This file creates:
>         work/conpc.dta
> */
. 
. 
. 
. ***************************************************************************
. * Food expenditure
. **************************************************************************** 
. *use "$path/in/cons_cod.dta" 
. use "$path/work/cons_cod.dta" 
{txt}
{com}.             *sort product 
.             *merge product using "$path/work/food_cat.dta" 
.             *tab _m 
.             *drop _m 
.             keep if food_cat==1 
{txt}(3977 observations deleted)

{com}.             collapse (sum) cod_hh_nom, by(hhid) 
{txt}
{com}.             rename cod_hh_nom food_hh_nom 
{txt}
{com}.                 sort hhid 
{txt}
{com}.             keep hhid food_hh_nom 
{txt}
{com}.             tempfile foodexp 
{txt}
{com}. save `foodexp' 
{txt}file /tmp/St02564.000001 saved

{com}. 
. ***************************************************************************
. * Food expenditure merged with all expenditure
. **************************************************************************** 
. use "$path/work/cons_cod.dta" 
{txt}
{com}. *use "$path/in/cons_cod.dta" 
. *use "$path/in/cons_cat.dta" 
. sum 

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     42120    2.35e+09    1.17e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     42975    193.7532    225.9257        100        999
{txt}{space 4}food_cat {c |}{res}     42120    1.074122    .2619717          1          2
{txt}{space 4}prod_cat {c |}{res}     42975    1.072647     .259559          1          2
{txt}{space 4}descript {c |}{res}     42975    112.7149    45.82533          1        172
{txt}{hline 13}{c +}{hline 56}
{space 7}untcd {c |}{res}     38654    42.16236    29.89049          1        143
{txt}{space 3}quantityd {c |}{res}     38998    .5255736     .974978          0   57.14286
{txt}{space 6}valuez {c |}{res}     38998    254.6912    460.8533          0   39285.71
{txt}{space 6}untdes {c |}{res}     37290    40.64728    29.24059          1        143
{txt}{space 5}qkg_uca {c |}{res}     36999     2.23029    5.213349       .001      186.2
{txt}{hline 13}{c +}{hline 56}
{space 4}quantity {c |}{res}     36287    .9825775    2.842624          0      135.2
{txt}{space 2}cod_hh_nom {c |}{res}     42975    430.3994    1512.109          0   72488.63
{txt}
{com}. collapse (sum) cod_hh_nom, by(hhid) 
{txt}
{com}. *gen cons_pc_nom = cons_hh_nom/hhsize 
. rename cod_hh_nom cons_hh_nom 
{txt}
{com}. *keep  hhid cons_pc_nom cons_hh_nom  
. *keep hhid cod_hh_nom 
. *use "$path/in/cons_cod.dta" 
. *use "$path/in/consump_nom.dta" 
. *use "$path/work/consump_nom.dta" 
. *            keep  hhid cons_hh_nom  
.             display _N 
{res}3123
{txt}
{com}.             keep  hhid cons_hh_nom  
{txt}
{com}.             sort hhid 
{txt}
{com}.             merge hhid using "$path/work/hhdata.dta" 
{txt}
{com}.             tab _m 

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          2 {c |}{res}          1        0.03        0.06
{txt}          3 {c |}{res}      3,122       99.94      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.             drop _m 
{txt}
{com}. gen cons_pc_nom = cons_hh_nom/hhsize 
{txt}(2 missing values generated)

{com}.             sort hhid 
{txt}
{com}.             merge hhid using `foodexp' 
{txt}
{com}.             tab _m 

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          4        0.13        0.13
{txt}          3 {c |}{res}      3,120       99.87      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.                 drop if _merge==2 
{txt}(0 observations deleted)

{com}.             replace food_hh_nom=0 if _merge==1 & food_hh_nom==. 
{txt}(4 real changes made)

{com}.             drop _m 
{txt}
{com}.                 gen food_pc_nom=food_hh_nom/hhsize 
{txt}(1 missing value generated)

{com}.                 gen nf_hh_nom=cons_hh_nom-food_hh_nom 
{txt}(1 missing value generated)

{com}.             gen nf_pc_nom=nf_hh_nom/hhsize 
{txt}(2 missing values generated)

{com}.  
.             keep hhid cons_hh_nom food_pc_nom nf_pc_nom cons_pc_nom survquar spdomain news reg_tpi rural hhweight hhsize 
{txt}
{com}.             lab var food_pc_nom "nominal food consumption per capita" 
{txt}
{com}.             lab var nf_pc_nom "nominal non-food consumption per capita" 
{txt}
{com}. keep hhid cons_hh_nom cons_pc_nom food_pc_nom nf_pc_nom 
{txt}
{com}.             sort hhid 
{txt}
{com}. 
. * MAH   sum  codebook hhid 
. save "$path/work/conpc.dta", replace 
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/conpc.dta saved

{com}. 
. 
. ***************************************************************************
. * 080_conpc.do          (end)
. **************************************************************************** 
. 
. 
. log close 
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/080_conpc.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:47:06
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. do "$path/new/090_temp_index.do"
{txt}
{com}. *global path "C:/Users/Templeton/Desktop/GAPP/GAPP-UGANDA-HARUNA"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/090_temp_index.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/090_temp_index.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:06
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 090_temp_index.do     (start)
> **************************************************************************;
. *do "$path/new/010_initial.do";
. **************************************************************************
> * Program to compute the temporal price index (intra-survey)
> * 
> * The index is based on 6 regions (North/Center/South by rural/urban) 
> * and four quarters. For IAF 2002/03 (t=t1) it is based on the same 9
> * commodities used for the analysis of the 1996 IAF (t=t0), 
> * except that we have to go to 8 commodities because the 2002-03 survey 
> * does not distinguish between large and small groundnuts, which were 
> * separate items in the old index. For IOF 2008/09 (t=t2) we expand the
> * the food basket to include the 15 most important food products among
> * the poorest.
> *
> * The commodity weights for the items vary by the 6 regions, and are 
> * calculated from the observations in the IAF2002, using the relatively 
> * poor households (below median nominal consumption per capita).
> *
> * The unit values (prices) calculated here are also based on the prices 
> * paid by the relatively poor, using the same definition.
> *
> * K Simler, Sep 2003
> * CA
> * MAH, April 2010
> * URB, Feb 2013 (automatization to any number of n_tpi's)
> **************************************************************************;
. /*
> This file uses:
>         work/own.dta
>         work/receipts.dta
>         work/daily.dta
>         work/hhdata
>         work/cons_cat.dta
> 
> This file creates:
>         work/tpi_unit_val_quarterly.dta
>         work/tpi_unit_val_monthly.dta
>         work/tpi_news_share.dta
>         work/tpi_reg_tpi_share.dta
>         work/temp_index_news.dta
>         work/temp_index_reg_tpi.dta
> */      
> 
> 
> **************************************************************************
> * Either the products used for intertemporal price index is specified
> * explicitly, or they are automatically found as the the n_tpi products
> * with the highest weighted expenditure shares among the $bottom % poorest
> * part of the population
> **************************************************************************;
. * Generating the n_tpi most important food items for the poorest $bottom % ;
. **************************************************************************
> * Find the n_tpi most important food products among the lowest $bottom %
> * (start)
> **************************************************************************;
. *------------------------------------------------------------------------*
> * Population weights for each HH
> *------------------------------------------------------------------------*;
. use "$path/work/hhdata.dta", clear;
{txt}
{com}. keep hhid hhweight hhsize;
{txt}
{com}. gen popwt = hhweight*hhsize;
{txt}(4 missing values generated)

{com}. lab var popwt "Population weights = hhsize X hhweight";
{txt}
{com}. sort hhid;
{txt}
{com}. tempfile popwt;
{txt}
{com}. save `popwt', replace;
{txt}(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}      3123    2.43e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 4}hhweight {c |}{res}      3119    1673.657     752.607   140.8407   5553.862
{txt}{space 6}hhsize {c |}{res}      3123    5.366314    3.108797          1         29
{txt}{space 7}popwt {c |}{res}      3119    9029.887     6948.95     201.98   61536.83
{txt}
{com}. *------------------------------------------------------------------------*
> * Make list of all consumed products
> *------------------------------------------------------------------------*;
. *use "$path/in/cons_cod.dta", clear;
. *save "$path/work/cons_cod.dta", replace;
. use "$path/work/cons_cod.dta", clear;
{txt}
{com}. keep product descript;
{txt}
{com}. collapse product, by(descript);
{txt}
{com}. sort product;
{txt}
{com}. tempfile descript;
{txt}
{com}. save `descript', replace;
{txt}(note: file /tmp/St02564.000002 not found)
file /tmp/St02564.000002 saved

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 4}descript {c |}{res}        71    134.0986    30.19988          1        172
{txt}{space 5}product {c |}{res}        71     150.174    104.0955        100        999
{txt}
{com}. *------------------------------------------------------------------------*
> * Find the poorest part of the population
> *------------------------------------------------------------------------*;
. use
> "$path/work/cons_cod.dta", clear;
{txt}
{com}. *use
> *"$path/work/cons_cod.dta", clear;
. ********************************************check the COICOP categories to create the variable prod_cat, for the moment it is equal to food_cat******;
. keep hhid prod_cat product cod_hh_nom;
{txt}
{com}. sort hhid;
{txt}
{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     42120    2.35e+09    1.17e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     42975    193.7532    225.9257        100        999
{txt}{space 4}prod_cat {c |}{res}     42975    1.072647     .259559          1          2
{txt}{space 2}cod_hh_nom {c |}{res}     42975    430.3994    1512.109          0   72488.63
{txt}
{com}. merge hhid using `popwt';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     42121    2.35e+09    1.17e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     42975    193.7532    225.9257        100        999
{txt}{space 4}prod_cat {c |}{res}     42975    1.072647     .259559          1          2
{txt}{space 2}cod_hh_nom {c |}{res}     42975    430.3994    1512.109          0   72488.63
{txt}{space 4}hhweight {c |}{res}     42063    1663.904    765.4544   140.8407   5553.862
{txt}{hline 13}{c +}{hline 56}
{space 6}hhsize {c |}{res}     42121    5.699366    3.142954          1         29
{txt}{space 7}popwt {c |}{res}     42063    9531.535    7231.145     201.98   61536.83
{txt}{space 6}_merge {c |}{res}     42976    2.960187    .2793194          1          3
{txt}
{com}. drop _merge;
{txt}
{com}. preserve;
{txt}
{com}. collapse (sum) cod_hh_nom (mean) popwt hhweight hhsize, by(hhid);
{txt}
{com}. gen cod_pc_nom = cod_hh_nom/hhsize;
{txt}(1 missing value generated)

{com}.         sum cod_pc_nom [aw=popwt] , detail;

                         {txt}cod_pc_nom
{hline 61}
      Percentiles      Smallest
 1%    {res} 186.1903              0
{txt} 5%    {res} 275.7369       103.3254
{txt}10%    {res} 353.8824       125.3987       {txt}Obs         {res}       3119
{txt}25%    {res} 489.4693       126.4294       {txt}Sum of Wgt. {res} 28164219.1

{txt}50%    {res} 769.2858                      {txt}Mean          {res} 1059.709
                        {txt}Largest       Std. Dev.     {res}  1073.31
{txt}75%    {res} 1221.598       20495.57
{txt}90%    {res} 2053.998       20954.27       {txt}Variance      {res}  1151995
{txt}95%    {res} 2859.285       22853.78       {txt}Skewness      {res} 5.701393
{txt}99%    {res} 5168.295       23846.89       {txt}Kurtosis      {res}  70.5224
{txt}
{com}.         global medcpc_= r(p$tpi_bottom);
{txt}
{com}.         gen bottom_ = cod_pc_nom <= $medcpc_;
{txt}
{com}. sum [aw=popwt];

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 8}hhid {c |}{res}    3119  28164219.1    2.48e+09   1.19e+09   1.01e+09   4.19e+09
{txt}{space 2}cod_hh_nom {c |}{res}    3119  28164219.1    7210.542   7751.913          0   84210.06
{txt}{space 7}popwt {c |}{res}    3119  28164219.1    14375.74   9296.074     201.98   61536.83
{txt}{space 4}hhweight {c |}{res}    3119  28164219.1    2006.475   790.1052   140.8407   5553.862
{txt}{space 6}hhsize {c |}{res}    3119  28164219.1    7.167363   3.433959          1         29
{txt}{hline 13}{c +}{hline 65}
{space 2}cod_pc_nom {c |}{res}    3119  28164219.1    1059.709    1073.31          0   23846.89
{txt}{space 5}bottom_ {c |}{res}    3119  28164219.1    .5005946   .5000798          0          1
{txt}
{com}. sum [aw=hhweight];

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 8}hhid {c |}{res}    3119  5220136.65    2.44e+09   1.20e+09   1.01e+09   4.19e+09
{txt}{space 2}cod_hh_nom {c |}{res}    3119  5220136.65    5717.451   6407.983          0   84210.06
{txt}{space 7}popwt {c |}{res}    3119  5220136.65    10825.54   7890.683     201.98   61536.83
{txt}{space 4}hhweight {c |}{res}    3119  5220136.65     2011.98   812.8751   140.8407   5553.862
{txt}{space 6}hhsize {c |}{res}    3119  5220136.65    5.395303    3.09255          1         29
{txt}{hline 13}{c +}{hline 65}
{space 2}cod_pc_nom {c |}{res}    3119  5220136.65    1248.649   1406.246          0   23846.89
{txt}{space 5}bottom_ {c |}{res}    3119  5220136.65    .4413824   .4966317          0          1
{txt}
{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}      3123    2.43e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 2}cod_hh_nom {c |}{res}      3124    5920.748    6787.715          0   84210.06
{txt}{space 7}popwt {c |}{res}      3119    9029.887     6948.95     201.98   61536.83
{txt}{space 4}hhweight {c |}{res}      3119    1673.657     752.607   140.8407   5553.862
{txt}{space 6}hhsize {c |}{res}      3123    5.366314    3.108797          1         29
{txt}{hline 13}{c +}{hline 56}
{space 2}cod_pc_nom {c |}{res}      3123     1329.67    1627.455          0   23846.89
{txt}{space 5}bottom_ {c |}{res}      3124    .4372599    .4961275          0          1
{txt}
{com}. keep if bottom_==1;
{txt}(1758 observations deleted)

{com}. keep hhid;
{txt}
{com}. sort hhid;
{txt}
{com}. tempfile hhid;
{txt}
{com}. save `hhid';
{txt}file /tmp/St02564.000004 saved

{com}. restore;
{txt}
{com}. sort hhid;
{txt}
{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     42121    2.35e+09    1.17e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     42975    193.7532    225.9257        100        999
{txt}{space 4}prod_cat {c |}{res}     42975    1.072647     .259559          1          2
{txt}{space 2}cod_hh_nom {c |}{res}     42975    430.3994    1512.109          0   72488.63
{txt}{space 4}hhweight {c |}{res}     42063    1663.904    765.4544   140.8407   5553.862
{txt}{hline 13}{c +}{hline 56}
{space 6}hhsize {c |}{res}     42121    5.699366    3.142954          1         29
{txt}{space 7}popwt {c |}{res}     42063    9531.535    7231.145     201.98   61536.83
{txt}
{com}. merge hhid using `hhid';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}. tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}     27,655       64.35       64.35
{txt}          3 {c |}{res}     15,321       35.65      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     42,976      100.00
{txt}
{com}. keep if _m==3;
{txt}(27655 observations deleted)

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     15321    2.68e+09    9.79e+08   1.02e+09   4.19e+09
{txt}{space 5}product {c |}{res}     15320    208.0257    247.8593        100        999
{txt}{space 4}prod_cat {c |}{res}     15320    1.089099    .2848962          1          2
{txt}{space 2}cod_hh_nom {c |}{res}     15320     265.924     418.148          0   7644.004
{txt}{space 4}hhweight {c |}{res}     15292    1691.487    626.3613   140.8407     4498.1
{txt}{hline 13}{c +}{hline 56}
{space 6}hhsize {c |}{res}     15321     6.45715    2.964676          1         29
{txt}{space 7}popwt {c |}{res}     15292    10866.38    6567.464    225.125   56511.65
{txt}{space 6}_merge {c |}{res}     15321           3           0          3          3
{txt}
{com}. *------------------------------------------------------------------------*
> * Keep only food product expenditure by the poor. Calculate food product
> * share of total food expenditure by the poor
> *------------------------------------------------------------------------*;
. keep if prod_cat==1;
{txt}(1366 observations deleted)

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     13955    2.68e+09    9.79e+08   1.02e+09   4.19e+09
{txt}{space 5}product {c |}{res}     13955     130.657    16.01476        100        161
{txt}{space 4}prod_cat {c |}{res}     13955           1           0          1          1
{txt}{space 2}cod_hh_nom {c |}{res}     13955    195.7463    277.9207          0       4000
{txt}{space 4}hhweight {c |}{res}     13929     1691.59    624.9568   140.8407     4498.1
{txt}{hline 13}{c +}{hline 56}
{space 6}hhsize {c |}{res}     13955    6.487567    2.968187          1         29
{txt}{space 7}popwt {c |}{res}     13929     10917.5    6581.081    225.125   56511.65
{txt}{space 6}_merge {c |}{res}     13955           3           0          3          3
{txt}
{com}. sort product;
{txt}
{com}. *preserve;
. collapse (sum) cod_hh_nom [aw=hhweight], by(product);
{txt}
{com}. sort cod;
{txt}
{com}. egen total=sum(cod_hh_nom);
{txt}
{com}. gen sh=100*cod_hh_nom/total;
{txt}
{com}. *------------------------------------------------------------------------*
> * Include product labels
> *------------------------------------------------------------------------*;
. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}product {c |}{res}        53    130.3019    16.22034        100        161
{txt}{space 2}cod_hh_nom {c |}{res}        53    51685.07     70019.9          0   285452.1
{txt}{space 7}total {c |}{res}        53     2739309           0    2739309    2739309
{txt}{space 10}sh {c |}{res}        53    1.886792    2.556116          0   10.42059
{txt}
{com}. sort product;
{txt}
{com}. merge product using `descript';
{txt}
{com}. tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}         18       25.35       25.35
{txt}          3 {c |}{res}         53       74.65      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         71      100.00
{txt}
{com}. keep if _merge==1 | _merge==3;
{txt}(18 observations deleted)

{com}. drop _merge;
{txt}
{com}. sort sh;
{txt}
{com}. *list;
. list in -$product_tpi_n/-1;
{txt}
     {c TLC}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c TRC}
     {c |} {res}product   cod_hh~m     total         sh   descript {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 24. {c |} {res}    146   23070.11   2739309   .8421873        146 {txt}{c |}
 25. {c |} {res}    150   25316.98   2739309   .9242105        150 {txt}{c |}
 26. {c |} {res}    157   27412.62   2739309   1.000713        157 {txt}{c |}
 27. {c |} {res}    143   28630.19   2739309   1.045161        143 {txt}{c |}
 28. {c |} {res}    144   29305.61   2739309   1.069818        144 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 29. {c |} {res}    134   30007.02   2739309   1.095423        134 {txt}{c |}
 30. {c |} {res}    109   31458.23   2739309     1.1484        109 {txt}{c |}
 31. {c |} {res}    161    31797.2   2739309   1.160775        161 {txt}{c |}
 32. {c |} {res}    119   32056.73   2739309   1.170249        119 {txt}{c |}
 33. {c |} {res}    110   35221.35   2739309   1.285775        110 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 34. {c |} {res}    138   35735.55   2739309   1.304546        138 {txt}{c |}
 35. {c |} {res}    121   38001.51   2739309   1.387266        121 {txt}{c |}
 36. {c |} {res}    112   44222.42   2739309   1.614364        112 {txt}{c |}
 37. {c |} {res}    136   46645.93   2739309   1.702836        136 {txt}{c |}
 38. {c |} {res}    140   47757.93   2739309    1.74343        140 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 39. {c |} {res}    115   54456.53   2739309   1.987966        115 {txt}{c |}
 40. {c |} {res}    122   55961.67   2739309   2.042912        122 {txt}{c |}
 41. {c |} {res}    116   57174.44   2739309   2.087185        116 {txt}{c |}
 42. {c |} {res}    127   57759.82   2739309   2.108555        127 {txt}{c |}
 43. {c |} {res}    139   60254.97   2739309   2.199641        139 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 44. {c |} {res}    125   67827.11   2739309   2.476067        125 {txt}{c |}
 45. {c |} {res}    123   74151.96   2739309   2.706959        123 {txt}{c |}
 46. {c |} {res}    117   96047.05   2739309   3.506251        117 {txt}{c |}
 47. {c |} {res}    147   119788.4   2739309   4.372942        147 {txt}{c |}
 48. {c |} {res}    107   150986.5   2739309   5.511846        107 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 49. {c |} {res}    108   208942.2   2739309   7.627553        108 {txt}{c |}
 50. {c |} {res}    100   237663.9   2739309   8.676054        100 {txt}{c |}
 51. {c |} {res}    141   240267.8   2739309   8.771111        141 {txt}{c |}
 52. {c |} {res}    113   251597.5   2739309   9.184708        113 {txt}{c |}
 53. {c |} {res}    105   285452.1   2739309   10.42059        105 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c BRC}

{com}. list product descript in -$product_tpi_n/-1;
{txt}
     {c TLC}{hline 9}{c -}{hline 10}{c TRC}
     {c |} {res}product   descript {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 24. {c |} {res}    146        146 {txt}{c |}
 25. {c |} {res}    150        150 {txt}{c |}
 26. {c |} {res}    157        157 {txt}{c |}
 27. {c |} {res}    143        143 {txt}{c |}
 28. {c |} {res}    144        144 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 29. {c |} {res}    134        134 {txt}{c |}
 30. {c |} {res}    109        109 {txt}{c |}
 31. {c |} {res}    161        161 {txt}{c |}
 32. {c |} {res}    119        119 {txt}{c |}
 33. {c |} {res}    110        110 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 34. {c |} {res}    138        138 {txt}{c |}
 35. {c |} {res}    121        121 {txt}{c |}
 36. {c |} {res}    112        112 {txt}{c |}
 37. {c |} {res}    136        136 {txt}{c |}
 38. {c |} {res}    140        140 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 39. {c |} {res}    115        115 {txt}{c |}
 40. {c |} {res}    122        122 {txt}{c |}
 41. {c |} {res}    116        116 {txt}{c |}
 42. {c |} {res}    127        127 {txt}{c |}
 43. {c |} {res}    139        139 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 44. {c |} {res}    125        125 {txt}{c |}
 45. {c |} {res}    123        123 {txt}{c |}
 46. {c |} {res}    117        117 {txt}{c |}
 47. {c |} {res}    147        147 {txt}{c |}
 48. {c |} {res}    107        107 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 49. {c |} {res}    108        108 {txt}{c |}
 50. {c |} {res}    100        100 {txt}{c |}
 51. {c |} {res}    141        141 {txt}{c |}
 52. {c |} {res}    113        113 {txt}{c |}
 53. {c |} {res}    105        105 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 10}{c BRC}

{com}. *restore;
. *------------------------------------------------------------------------*
> * Keep the required number of most important food products
> *------------------------------------------------------------------------*;
. keep in -$product_tpi_n/-1;
{txt}(23 observations deleted)

{com}. list;
{txt}
     {c TLC}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c TRC}
     {c |} {res}product   cod_hh~m     total         sh   descript {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
  1. {c |} {res}    146   23070.11   2739309   .8421873        146 {txt}{c |}
  2. {c |} {res}    150   25316.98   2739309   .9242105        150 {txt}{c |}
  3. {c |} {res}    157   27412.62   2739309   1.000713        157 {txt}{c |}
  4. {c |} {res}    143   28630.19   2739309   1.045161        143 {txt}{c |}
  5. {c |} {res}    144   29305.61   2739309   1.069818        144 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
  6. {c |} {res}    134   30007.02   2739309   1.095423        134 {txt}{c |}
  7. {c |} {res}    109   31458.23   2739309     1.1484        109 {txt}{c |}
  8. {c |} {res}    161    31797.2   2739309   1.160775        161 {txt}{c |}
  9. {c |} {res}    119   32056.73   2739309   1.170249        119 {txt}{c |}
 10. {c |} {res}    110   35221.35   2739309   1.285775        110 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 11. {c |} {res}    138   35735.55   2739309   1.304546        138 {txt}{c |}
 12. {c |} {res}    121   38001.51   2739309   1.387266        121 {txt}{c |}
 13. {c |} {res}    112   44222.42   2739309   1.614364        112 {txt}{c |}
 14. {c |} {res}    136   46645.93   2739309   1.702836        136 {txt}{c |}
 15. {c |} {res}    140   47757.93   2739309    1.74343        140 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 16. {c |} {res}    115   54456.53   2739309   1.987966        115 {txt}{c |}
 17. {c |} {res}    122   55961.67   2739309   2.042912        122 {txt}{c |}
 18. {c |} {res}    116   57174.44   2739309   2.087185        116 {txt}{c |}
 19. {c |} {res}    127   57759.82   2739309   2.108555        127 {txt}{c |}
 20. {c |} {res}    139   60254.97   2739309   2.199641        139 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 21. {c |} {res}    125   67827.11   2739309   2.476067        125 {txt}{c |}
 22. {c |} {res}    123   74151.96   2739309   2.706959        123 {txt}{c |}
 23. {c |} {res}    117   96047.05   2739309   3.506251        117 {txt}{c |}
 24. {c |} {res}    147   119788.4   2739309   4.372942        147 {txt}{c |}
 25. {c |} {res}    107   150986.5   2739309   5.511846        107 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c RT}
 26. {c |} {res}    108   208942.2   2739309   7.627553        108 {txt}{c |}
 27. {c |} {res}    100   237663.9   2739309   8.676054        100 {txt}{c |}
 28. {c |} {res}    141   240267.8   2739309   8.771111        141 {txt}{c |}
 29. {c |} {res}    113   251597.5   2739309   9.184708        113 {txt}{c |}
 30. {c |} {res}    105   285452.1   2739309   10.42059        105 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c BRC}

{com}. gen product_tpi=1;
{txt}
{com}. keep product product_tpi;
{txt}
{com}. list;
{txt}
     {c TLC}{hline 9}{c -}{hline 10}{c TRC}
     {c |} {res}product   produc~i {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
  1. {c |} {res}    146          1 {txt}{c |}
  2. {c |} {res}    150          1 {txt}{c |}
  3. {c |} {res}    157          1 {txt}{c |}
  4. {c |} {res}    143          1 {txt}{c |}
  5. {c |} {res}    144          1 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
  6. {c |} {res}    134          1 {txt}{c |}
  7. {c |} {res}    109          1 {txt}{c |}
  8. {c |} {res}    161          1 {txt}{c |}
  9. {c |} {res}    119          1 {txt}{c |}
 10. {c |} {res}    110          1 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 11. {c |} {res}    138          1 {txt}{c |}
 12. {c |} {res}    121          1 {txt}{c |}
 13. {c |} {res}    112          1 {txt}{c |}
 14. {c |} {res}    136          1 {txt}{c |}
 15. {c |} {res}    140          1 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 16. {c |} {res}    115          1 {txt}{c |}
 17. {c |} {res}    122          1 {txt}{c |}
 18. {c |} {res}    116          1 {txt}{c |}
 19. {c |} {res}    127          1 {txt}{c |}
 20. {c |} {res}    139          1 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 21. {c |} {res}    125          1 {txt}{c |}
 22. {c |} {res}    123          1 {txt}{c |}
 23. {c |} {res}    117          1 {txt}{c |}
 24. {c |} {res}    147          1 {txt}{c |}
 25. {c |} {res}    107          1 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c RT}
 26. {c |} {res}    108          1 {txt}{c |}
 27. {c |} {res}    100          1 {txt}{c |}
 28. {c |} {res}    141          1 {txt}{c |}
 29. {c |} {res}    113          1 {txt}{c |}
 30. {c |} {res}    105          1 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 10}{c BRC}

{com}. sort product;
{txt}
{com}. tempfile product_tpi;
{txt}
{com}. save `product_tpi', replace;
{txt}(note: file /tmp/St02564.000005 not found)
file /tmp/St02564.000005 saved

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}product {c |}{res}        30       127.5    16.77591        100        161
{txt}{space 1}product_tpi {c |}{res}        30           1           0          1          1
{txt}
{com}. clear;
{txt}
{com}. **************************************************************************
> * Find the n_tpi most important food products among the lowest $bottom %
> * (end)
> **************************************************************************;
. **************************************************************************;
. * First, need to calculate the average prices for the food items, by 
> * strata and quarter. For this, we are using the "unit values"
> * (value/quantity) for the observations in the consumption questionnaires,
> * including daily, own and receipts-in-kind.
> *
> * The unit values are constructed as sum(value)/sum(quantity), which effectively
> * weights them by the quantity and value of the transaction. Sampling
> * weights are also used.
> *
> * Get the own consumption file, and limit analysis to the observations
> * in KGs where both value and quantity are available.
> **************************************************************************;
. use "$path/work/cons_cod.dta";
{txt}
{com}. *use "$path/work/cons_cod.dta";
. keep if prod_cat==1;
{txt}(3122 observations deleted)

{com}. drop if quantityd==0 | quantityd==.;
{txt}(2057 observations deleted)

{com}. *keep if quantityd!=. & cod_hh_nom2!=.;
. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     37796    2.36e+09    1.17e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     37796     129.612    15.56369        100        158
{txt}{space 4}food_cat {c |}{res}     37796           1           0          1          1
{txt}{space 4}prod_cat {c |}{res}     37796           1           0          1          1
{txt}{space 4}descript {c |}{res}     37796    124.8312    28.44431          1        158
{txt}{hline 13}{c +}{hline 56}
{space 7}untcd {c |}{res}     37796    41.40547    29.19073          1         99
{txt}{space 3}quantityd {c |}{res}     37796     .542288    .9857734   .0057143   57.14286
{txt}{space 6}valuez {c |}{res}     37796    238.0692    351.5228          0       7500
{txt}{space 6}untdes {c |}{res}     36432    39.82636     28.4377          1         99
{txt}{space 5}qkg_uca {c |}{res}     36284    2.194586    4.830398       .001     113.25
{txt}{hline 13}{c +}{hline 56}
{space 4}quantity {c |}{res}     36284    .9826587    2.842728      .0001      135.2
{txt}{space 2}cod_hh_nom {c |}{res}     37796    238.0692    351.5228          0       7500
{txt}
{com}. sort product;
{txt}
{com}. merge product using `product_tpi';
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

{com}. tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}      8,873       23.47       23.47
{txt}          2 {c |}{res}          2        0.01       23.48
{txt}          3 {c |}{res}     28,923       76.52      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     37,798      100.00
{txt}
{com}. drop _merge;
{txt}
{com}. keep if $product_tpi;
{txt}(8873 observations deleted)

{com}. *        replace valued_ac=0 if valued_ac==.;
. *        replace quantityd_ac=0 if quantityd_ac==.;
.         gen valued_tot=cod_hh_nom;
{txt}(2 missing values generated)

{com}.         gen quantityd_tot=quantityd;
{txt}(2 missing values generated)

{com}. *               replace quantityd_tot=0 if (valued_tot>0 & valued_tot<.) & quantityd_tot==.;
.         keep if quantityd_tot!=. & valued_tot!=.;
{txt}(2 observations deleted)

{com}.                 collapse (sum) valued_tot quantityd_tot, by(hhid product);
{txt}
{com}.                 sort hhid;
{txt}
{com}. tempfile acredd;
{txt}
{com}. save `acredd' , replace;
{txt}(note: file /tmp/St02564.000006 not found)
file /tmp/St02564.000006 saved

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     28800    2.39e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     28800    127.6664    15.94733        100        150
{txt}{space 2}valued_tot {c |}{res}     28800    274.7174     386.191   1.428571       7500
{txt}quantityd_~t {c |}{res}     28800    .5733206    .9622761   .0071429         50
{txt}
{com}. /*
> **************************************************************************;
> * Create a data set with an empty 1 observation. Used to avoid empty data
> * sets when the survey do not have the Mozambican set up
> **************************************************************************;
> use "$path/work/own.dta";
> 
> preserve;
> keep in 1;
> drop unit valued quantityd;
> gen unit=2;
> gen valued=0;
> gen quantityd=0;
> tempfile 1obs;
> save `1obs';
> restore;
> 
> **************************************************************************;
> * Own consumption
> **************************************************************************;
> sum;
> sort product;
> merge product using `product_tpi';
> tab _merge;
> drop _merge;
> 
> keep if $product_tpi;
> 
> 
> 
> * Comment out below if IAF 2002/03 ( START ) ;
> 
> rename quantityd quantity;
> do "$path/new/110a_conversions.do";
> rename quantity quantityd;
> 
> * Comment out below if IAF 2002/03 ( END ) ;
> 
> 
> 
>         keep if unit==2 & quantityd!=. & valued!=.;
>         collapse (sum) valued quantityd , by(hhid product);
>         rename valued valued_ac;
>         rename quantityd quantityd_ac;
>         compress;
>         sort hhid product;
>         tempfile ac;
> save `ac', replace;
> 
> **************************************************************************;
> * Now do a similar thing with receipts-in-kind file.
> **************************************************************************;
> use "$path/work/receipts.dta";
> 
> sum;
> sort product;
> merge product using `product_tpi';
> tab _merge;
> drop _merge;
> 
> 
> 
> keep if $product_tpi;
> append using `1obs';
> 
> 
> 
> * Comment out below if IAF 2002/03 ( START ) ;
> 
> rename quantityd quantity;
> do "$path/new/110a_conversions.do";
> rename quantity quantityd;
> 
> * Comment out below if IAF 2002/03 ( END ) ;
> 
> 
> 
>         keep if unit==2 & quantityd!=. & valued!=.;
>         collapse (sum) valued quantityd , by(hhid product);
>         rename valued valued_re;
>         rename quantityd quantityd_re;
>         compress;
>         sort hhid product;
>         tempfile re;
> save `re', replace;
> 
> **************************************************************************;
> * And also with the daily expenditure file.
> **************************************************************************;
> use "$path/work/daily.dta";
> 
> sum;
> sort product;
> merge product using `product_tpi';
> tab _merge;
> drop _merge;
> 
> keep if $product_tpi;
> 
> 
> 
> * Comment out below if IAF 2002/03 ( START ) ;
> 
> *rename quantityd quantity;
> do "$path/new/110a_conversions.do";
> *rename quantity quantityd;
> 
> * Comment out below if IAF 2002/03 ( END ) ;
> 
> 
> 
>         collapse (sum) value quantity days , 
>                 by(hhid product unit);
> 
>         gen valued=value/7 if days<=7;
>         replace valued=value/days if days>7 & days<.;
>         gen quantityd=quantity/7 if days<=7;
>         replace quantityd=quantity/days if days>7 & days<.;
> 
>         keep if unit==2 & quantityd!=. & valued!=.;
>         collapse (sum) valued quantityd , by(hhid product);
> 
>         rename valued valued_dd;
>         rename quantityd quantityd_dd;
>         compress;
>         sort hhid product;
>         tempfile dd;
> save `dd', replace;
> 
> 
> 
> 
> **************************************************************************;
> * Merge the three components (own, daily, receipts) together at the HH/product level, 
> * then aggregate to the regional level, using the sample weights (hhweight).
> * We DON'T want to weight by "hhsize" because the quantity and value are
> * already for the household (i.e., other things equal, larger households
> * are buying larger quantities, and therefore already getting more weight).
> * Then calculate sum(val)/sum(quantity) to get the quantity weighted mean
> * unit value in each strata in each quarter.
> **************************************************************************;
> use `ac';
>         sort hhid product;
>         merge hhid product using `re';
>         tab _m;
>         drop _m;
>         
>         sort hhid product;
>         merge hhid product using `dd';
>         tab _m;
>         drop _m;
>         
>         replace valued_ac=0 if valued_ac==.;
>         replace valued_re=0 if valued_re==.;
>         replace valued_dd=0 if valued_dd==.;
>         replace quantityd_ac=0 if quantityd_ac==.;
>         replace quantityd_re=0 if quantityd_re==.;
>         replace quantityd_dd=0 if quantityd_dd==.;
> 
>         gen valued_tot=valued_ac+valued_re+valued_dd;
>         gen quantityd_tot=quantityd_ac+quantityd_re+quantityd_dd;
> 
>         sort hhid;
> 
>         tempfile acredd;
> save `acredd' , replace;
> */
> 
> 
> 
> use "$path/work/hhdata.dta";
{txt}
{com}.         keep strata hhid hhweight hhsize rural survmon survquar news spdomain reg_tpi;
{txt}
{com}.         sort hhid;
{txt}
{com}.         tempfile hhd;
{txt}
{com}. save `hhd' , replace;
{txt}(note: file /tmp/St02564.000007 not found)
file /tmp/St02564.000007 saved

{com}. use `acredd', clear;
{txt}
{com}.         merge hhid using `hhd';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        109        0.38        0.38
{txt}          3 {c |}{res}     28,800       99.62      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     28,909      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.                 tab survquar , miss;

   {txt}Sequential Survey {c |}
 Quarter (May-Nov'05 {c |}
      & May-Nov '06) {c |}      Freq.     Percent        Cum.
{hline 21}{c +}{hline 35}
   May '05 - Jul-'05 {c |}{res}      9,769       33.79       33.79
{txt}          Aug-Oct 05 {c |}{res}      8,847       30.60       64.40
{txt}Nov '05 & May-Jun 06 {c |}{res}        530        1.83       66.23
{txt}       Jul-Sept 2006 {c |}{res}      7,537       26.07       92.30
{txt}         Oct-Nov '06 {c |}{res}      2,185        7.56       99.86
{txt}                   . {c |}{res}         41        0.14      100.00
{txt}{hline 21}{c +}{hline 35}
               Total {c |}{res}     28,909      100.00
{txt}
{com}.                 tab survmon survquar, miss;

{txt}Sequential {c |}
    Survey {c |}
     Month {c |}
 (November {c |}
    2011 = {c |}
   January {c |}       Sequential Survey Quarter (May-Nov'05 & May-Nov '06)
      '13) {c |} May '05 -  Aug-Oct 0  Nov '05 &  Jul-Sept   Oct-Nov '          . {c |}     Total
{hline 11}{c +}{hline 66}{c +}{hline 10}
    May 05 {c |}{res}     3,058          0          0          0          0          0 {txt}{c |}{res}     3,058 
{txt}    Jun 05 {c |}{res}     4,288          0          0          0          0          0 {txt}{c |}{res}     4,288 
{txt}    Jul 05 {c |}{res}     2,423          0          0          0          0          0 {txt}{c |}{res}     2,423 
{txt}    Aug 05 {c |}{res}         0      3,043          0          0          0          0 {txt}{c |}{res}     3,043 
{txt}   Sept 05 {c |}{res}         0      3,412          0          0          0          0 {txt}{c |}{res}     3,412 
{txt}    Oct 05 {c |}{res}         0      2,392          0          0          0          0 {txt}{c |}{res}     2,392 
{txt}    Nov 05 {c |}{res}         0          0         84          0          0          0 {txt}{c |}{res}        84 
{txt}    May 06 {c |}{res}         0          0        118          0          0          0 {txt}{c |}{res}       118 
{txt}    Jun 06 {c |}{res}         0          0        328          0          0          0 {txt}{c |}{res}       328 
{txt}    Jul 06 {c |}{res}         0          0          0      1,521          0          0 {txt}{c |}{res}     1,521 
{txt}    Aug 06 {c |}{res}         0          0          0      2,995          0          0 {txt}{c |}{res}     2,995 
{txt}   Sept 06 {c |}{res}         0          0          0      3,021          0          0 {txt}{c |}{res}     3,021 
{txt}    Oct 06 {c |}{res}         0          0          0          0      2,109          0 {txt}{c |}{res}     2,109 
{txt}    Nov 06 {c |}{res}         0          0          0          0         76          0 {txt}{c |}{res}        76 
{txt}         . {c |}{res}         0          0          0          0          0         41 {txt}{c |}{res}        41 
{txt}{hline 11}{c +}{hline 66}{c +}{hline 10}
     Total {c |}{res}     9,769      8,847        530      7,537      2,185         41 {txt}{c |}{res}    28,909 

{txt}
{com}.         compress;
{txt}product was {res}float{txt} now {res}int
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}
{com}.         sort hhid;
{txt}
{com}. save `acredd', replace;
{txt}file /tmp/St02564.000006 saved

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     28909    2.39e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     28800    127.6664    15.94733        100        150
{txt}{space 2}valued_tot {c |}{res}     28800    274.7174     386.191   1.428571       7500
{txt}quantityd_~t {c |}{res}     28800    .5733206    .9622761   .0071429         50
{txt}{space 4}hhweight {c |}{res}     28868    1670.244    757.6454   140.8407   5553.862
{txt}{hline 13}{c +}{hline 56}
{space 4}survquar {c |}{res}     28868    2.429195    1.377738          1          5
{txt}{space 5}survmon {c |}{res}     28868    6.230394    4.164311          1         14
{txt}{space 6}strata {c |}{res}     28868    4.299051    2.452283          1          8
{txt}{space 7}rural {c |}{res}     28868    .7014341    .4576369          0          1
{txt}{space 5}reg_tpi {c |}{res}     28868    2.298808    1.154778          1          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     28868    3.140051    1.370939          1          5
{txt}{space 8}news {c |}{res}     28868    2.298808    1.154778          1          4
{txt}{space 6}hhsize {c |}{res}     28909    5.744543    3.100327          1         29
{txt}
{com}. **************************************************************************;
. * Need to merge with the file that has nominal consumption per household,
> * and compute nominal consumption per capita from that, so that we can
> * choose the relatively poor (i.e., below median nominal consumption per
> * capita).
> **************************************************************************;
. use "$path/work/conpc.dta", clear;
{txt}
{com}. keep hhid cons_hh_nom;
{txt}
{com}. *use "$path/in/cons_cat.dta" ;
. *save "$path/work/cons_cat.dta", replace ;
. *use "$path/work/cons_cat.dta" ;
. *CA modified to merge in hhdata for bootstrap;
.        sort hhid;
{txt}
{com}.         merge hhid using "$path/work/hhdata.dta";
{txt}
{com}.           tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.  drop _m;
{txt}
{com}.         collapse (mean) cons_hh_nom hhsize hhweight , by(hhid);
{txt}
{com}.         gen cpc=cons_hh_nom/hhsize;
{txt}(2 missing values generated)

{com}.         sum cpc [aw=hhsize*hhweight] , detail;

                             {txt}cpc
{hline 61}
      Percentiles      Smallest
 1%    {res} 192.6279       103.3254
{txt} 5%    {res} 279.1713       125.3987
{txt}10%    {res} 353.8824       126.4294       {txt}Obs         {res}       3118
{txt}25%    {res}   489.79       141.0714       {txt}Sum of Wgt. {res} 28155664.2

{txt}50%    {res} 769.2858                      {txt}Mean          {res} 1060.031
                        {txt}Largest       Std. Dev.     {res} 1073.314
{txt}75%    {res} 1221.598       20495.57
{txt}90%    {res} 2062.153       20954.27       {txt}Variance      {res}  1152003
{txt}95%    {res} 2859.285       22853.78       {txt}Skewness      {res} 5.702454
{txt}99%    {res} 5168.295       23846.89       {txt}Kurtosis      {res} 70.53564
{txt}
{com}.         global medcpc=r(p$tpi_bottom);
{txt}
{com}.         gen bottom_tpi=cpc<=$medcpc;
{txt}
{com}.         keep hhid bottom_tpi;
{txt}
{com}.         sort hhid;
{txt}
{com}.         tempfile bottom_tpi;
{txt}
{com}. save `bottom_tpi', replace;
{txt}(note: file /tmp/St02564.000008 not found)
file /tmp/St02564.000008 saved

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}      3123    2.43e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 2}bottom_tpi {c |}{res}      3124    .4369398    .4960869          0          1
{txt}
{com}. use `acredd' ;
{txt}
{com}.         merge hhid using `bottom_tpi';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          1        0.00        0.00
{txt}          3 {c |}{res}     28,909      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     28,910      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         keep if bottom_tpi;
{txt}(17832 observations deleted)

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     11078    2.69e+09    9.81e+08   1.02e+09   4.19e+09
{txt}{space 5}product {c |}{res}     11066    128.5111    15.93723        100        150
{txt}{space 2}valued_tot {c |}{res}     11066    221.6525    297.9822   3.571429       4000
{txt}quantityd_~t {c |}{res}     11066    .6175737    .9334974   .0142857         26
{txt}{space 4}hhweight {c |}{res}     11055    1695.147    627.2694   140.8407     4498.1
{txt}{hline 13}{c +}{hline 56}
{space 4}survquar {c |}{res}     11055    2.335866    1.388388          1          5
{txt}{space 5}survmon {c |}{res}     11055    5.907644    4.143839          1         14
{txt}{space 6}strata {c |}{res}     11055     5.07924    1.990764          1          8
{txt}{space 7}rural {c |}{res}     11055     .885934    .3179058          0          1
{txt}{space 5}reg_tpi {c |}{res}     11055    2.596653    .9812092          1          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     11055    3.578381    1.019346          1          5
{txt}{space 8}news {c |}{res}     11055    2.596653    .9812092          1          4
{txt}{space 6}hhsize {c |}{res}     11078    6.444485     2.92606          1         29
{txt}{space 2}bottom_tpi {c |}{res}     11078           1           0          1          1
{txt}
{com}. * Drop one HH with extremely high quantity and low value in IAF 2002/03 (t=t1) ;
. *        drop if hhid==263001;
.         preserve;
{txt}
{com}.                 collapse (sum) valued_tot quantityd_tot [aw=hhweight] , 
>                                 by(reg_tpi news product survmon);
{txt}
{com}.                         drop if product==.;
{txt}(8 observations deleted)

{com}.                         gen ppkg=valued_tot/quantityd_tot;
{txt}
{com}.                         lab var ppkg "Unit value per kg";
{txt}
{com}.                         sort reg_tpi product ;
{txt}
{com}.                         compress;
{txt}
{com}.                         tempfile uvm;
{txt}
{com}.                 save `uvm', replace;
{txt}(note: file /tmp/St02564.00000a not found)
file /tmp/St02564.00000a saved

{com}.                 save "$path/work/tpi_unit_val_monthly.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/tpi_unit_val_monthly.dta saved

{com}.         restore;
{txt}
{com}.         preserve;
{txt}
{com}.                 collapse (sum) valued_tot quantityd_tot [aw=hhweight] , 
>                                 by(reg_tpi news product survquar);
{txt}
{com}.                         drop if product==.;
{txt}(6 observations deleted)

{com}.                         gen ppkg=valued_tot/quantityd_tot;
{txt}
{com}.                         sort reg_tpi product survquar;
{txt}
{com}.                         list in  1/3;
{txt}
     {c TLC}{hline 9}{c -}{hline 19}{c -}{hline 9}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c TRC}
     {c |} {res}product            survquar   reg_tpi      news   valued~t   quanti~t       ppkg {txt}{c |}
     {c LT}{hline 9}{c -}{hline 19}{c -}{hline 9}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
  1. {c |} {res}    100   May '05 - Jul-'05   Central   Central   15969.55   12.19603   1309.405 {txt}{c |}
  2. {c |} {res}    100          Aug-Oct 05   Central   Central   11058.25   7.464759   1481.394 {txt}{c |}
  3. {c |} {res}    100       Jul-Sept 2006   Central   Central   16799.21   12.75837   1316.721 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 19}{c -}{hline 9}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c BRC}

{com}.                         list in -3/-1;
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c -}{hline 9}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c TRC}
     {c |} {res}product        survquar   reg_tpi      news   valued~t   quanti~t       ppkg {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c -}{hline 9}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
439. {c |} {res}    150      Aug-Oct 05   Western   Western     1271.7   6.681939    190.319 {txt}{c |}
440. {c |} {res}    150   Jul-Sept 2006   Western   Western   1944.216   9.488426   204.9039 {txt}{c |}
441. {c |} {res}    150     Oct-Nov '06   Western   Western   322.1541   1.559935   206.5177 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c -}{hline 9}{c -}{hline 9}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c BRC}

{com}.                         tempfile uvq;
{txt}
{com}.                 save "$path/work/tpi_unit_val_quarterly.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/tpi_unit_val_quarterly.dta saved

{com}.                 save `uvq', replace;
{txt}(note: file /tmp/St02564.00000c not found)
file /tmp/St02564.00000c saved

{com}.         restore;
{txt}
{com}.         **************************************************************************;
. * Toss out the bottom 5% and top 5% of the HH-LEVEL prices per kg in
> * each reg_tpi & product combination. This should eliminate outliers that
> * may have an undue influence on the price calculation. Then use sample
> * weighting PLUS quantity weighting on those HH-level observations.
> **************************************************************************;
.         preserve;
{txt}
{com}.                 gen hhppkg=valued_tot/quantityd_tot;
{txt}(12 missing values generated)

{com}.                 egen lower5=pctile(hhppkg), p(5) by(reg_tpi product);
{txt}(12 missing values generated)

{com}.                 egen upper5=pctile(hhppkg), p(95) by(reg_tpi product);
{txt}(12 missing values generated)

{com}.                 keep if hhppkg>=lower5 & hhppkg<=upper5;
{txt}(556 observations deleted)

{com}.                                 gen hhqtywt=hhweight*quantityd_tot;
{txt}(35 missing values generated)

{com}.                                 collapse (sum) valued_tot quantityd_tot [aw=hhqtywt] , 
>                                 by(reg_tpi news product survquar);
{txt}
{com}.                         drop if product==.;
{txt}(0 observations deleted)

{com}.                         gen ppkg_trim=valued_tot/quantityd_tot;
{txt}
{com}.                         lab var ppkg_trim "90% trimmed unit value per kg";
{txt}
{com}.                         sort reg_tpi product survquar;
{txt}
{com}.                         list , nol;
{txt}
     {c TLC}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c TRC}
     {c |} {res}product   survquar   reg_tpi   news   valued~t   quanti~t   ppkg_t~m {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
  1. {c |} {res}    100          1         1      1   31050.14   22.36237     1388.5 {txt}{c |}
  2. {c |} {res}    100          2         1      1   13470.42   11.59048   1162.197 {txt}{c |}
  3. {c |} {res}    100          4         1      1    19063.2   14.84122   1284.477 {txt}{c |}
  4. {c |} {res}    100          5         1      1   6346.565   4.335784   1463.764 {txt}{c |}
  5. {c |} {res}    105          1         1      1   24914.17   31.09283   801.2834 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
  6. {c |} {res}    105          2         1      1   19079.73    22.3184   854.8879 {txt}{c |}
  7. {c |} {res}    105          4         1      1   20121.33   28.23954   712.5235 {txt}{c |}
  8. {c |} {res}    105          5         1      1   13213.03    7.26683   1818.266 {txt}{c |}
  9. {c |} {res}    107          1         1      1   18021.82   37.45608   481.1454 {txt}{c |}
 10. {c |} {res}    107          2         1      1   16158.36   21.82102   740.4952 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 11. {c |} {res}    107          4         1      1   9745.876   13.41197   726.6553 {txt}{c |}
 12. {c |} {res}    107          5         1      1   3900.957   6.024129   647.5554 {txt}{c |}
 13. {c |} {res}    108          1         1      1   2720.338   6.321983   430.2983 {txt}{c |}
 14. {c |} {res}    108          2         1      1   321.4645   .7501794   428.5168 {txt}{c |}
 15. {c |} {res}    108          4         1      1   3401.845   7.382059   460.8261 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 16. {c |} {res}    108          5         1      1   2452.092   7.603622     322.49 {txt}{c |}
 17. {c |} {res}    109          1         1      1   761.9048   .4761905       1600 {txt}{c |}
 18. {c |} {res}    109          2         1      1   710.5352   1.003751   707.8802 {txt}{c |}
 19. {c |} {res}    109          4         1      1   1434.724   1.428571   1004.307 {txt}{c |}
 20. {c |} {res}    110          1         1      1   2998.664   2.794584   1073.027 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 21. {c |} {res}    110          2         1      1   5952.055   5.302676   1122.462 {txt}{c |}
 22. {c |} {res}    110          4         1      1   2505.805   2.746029   912.5195 {txt}{c |}
 23. {c |} {res}    110          5         1      1   762.3681   .6353068       1200 {txt}{c |}
 24. {c |} {res}    112          1         1      1   8638.122   96.81876    89.2195 {txt}{c |}
 25. {c |} {res}    112          2         1      1   285.7143   1.428571        200 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 26. {c |} {res}    112          4         1      1    414.132   3.385985   122.3077 {txt}{c |}
 27. {c |} {res}    113          1         1      1   25646.89   40.02989   640.6935 {txt}{c |}
 28. {c |} {res}    113          2         1      1   47552.62   83.14722   571.9087 {txt}{c |}
 29. {c |} {res}    113          4         1      1   20051.33   37.02082   541.6231 {txt}{c |}
 30. {c |} {res}    113          5         1      1   8404.481   14.25764   589.4721 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 31. {c |} {res}    115          1         1      1   924.0752   2.247082   411.2334 {txt}{c |}
 32. {c |} {res}    115          2         1      1   404.3108   .4147557   974.8168 {txt}{c |}
 33. {c |} {res}    115          4         1      1   407.8501   1.387114   294.0278 {txt}{c |}
 34. {c |} {res}    115          5         1      1   788.5464   1.750934   450.3576 {txt}{c |}
 35. {c |} {res}    116          1         1      1   14.28571   .2857143         50 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 36. {c |} {res}    117          1         1      1   4327.102   1.868485   2315.834 {txt}{c |}
 37. {c |} {res}    117          2         1      1   3759.464   1.511288    2487.59 {txt}{c |}
 38. {c |} {res}    117          4         1      1   4539.488   1.951237   2326.467 {txt}{c |}
 39. {c |} {res}    117          5         1      1   1255.535   .4757439   2639.099 {txt}{c |}
 40. {c |} {res}    119          1         1      1   257.1429   .1428571       1800 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 41. {c |} {res}    119          2         1      1   314.2857   .1428571       2200 {txt}{c |}
 42. {c |} {res}    121          1         1      1   987.4776   .2857143   3456.172 {txt}{c |}
 43. {c |} {res}    121          2         1      1   1290.389   .2857143   4516.363 {txt}{c |}
 44. {c |} {res}    121          4         1      1   1327.876   .5714286   2323.783 {txt}{c |}
 45. {c |} {res}    122          1         1      1   4336.329   10.68984   405.6497 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 46. {c |} {res}    122          2         1      1   7925.481    8.99736   880.8674 {txt}{c |}
 47. {c |} {res}    122          4         1      1   3949.882   6.681002   591.2111 {txt}{c |}
 48. {c |} {res}    122          5         1      1   1051.435   1.850639   568.1468 {txt}{c |}
 49. {c |} {res}    123          1         1      1   3376.936    11.7405   287.6313 {txt}{c |}
 50. {c |} {res}    123          2         1      1   1578.245   7.862275   200.7364 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 51. {c |} {res}    123          4         1      1   1486.409   6.312201   235.4819 {txt}{c |}
 52. {c |} {res}    123          5         1      1   2798.025   27.16512   103.0007 {txt}{c |}
 53. {c |} {res}    125          1         1      1   9014.344   26.59099   338.9999 {txt}{c |}
 54. {c |} {res}    125          2         1      1   6265.147   29.62701   211.4674 {txt}{c |}
 55. {c |} {res}    125          4         1      1   3337.475   12.68168    263.173 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 56. {c |} {res}    125          5         1      1   10353.41   49.32473    209.903 {txt}{c |}
 57. {c |} {res}    127          1         1      1    2339.56   28.11753   83.20646 {txt}{c |}
 58. {c |} {res}    127          2         1      1   1919.657   23.25116   82.56177 {txt}{c |}
 59. {c |} {res}    127          4         1      1   2062.639   25.74401   80.12114 {txt}{c |}
 60. {c |} {res}    127          5         1      1   699.5163   9.489016   73.71854 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 61. {c |} {res}    134          1         1      1   2830.762    14.2602   198.5078 {txt}{c |}
 62. {c |} {res}    134          2         1      1    3011.99   6.420524    469.119 {txt}{c |}
 63. {c |} {res}    134          4         1      1   12570.08   29.56691   425.1401 {txt}{c |}
 64. {c |} {res}    134          5         1      1   1368.208   6.999391   195.4753 {txt}{c |}
 65. {c |} {res}    136          1         1      1   3967.915   39.02188   101.6844 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 66. {c |} {res}    136          2         1      1   3402.726   29.46202   115.4953 {txt}{c |}
 67. {c |} {res}    136          4         1      1    2930.76   26.17429   111.9709 {txt}{c |}
 68. {c |} {res}    136          5         1      1   841.4545   7.897409   106.5482 {txt}{c |}
 69. {c |} {res}    138          1         1      1   2137.343    21.5845   99.02212 {txt}{c |}
 70. {c |} {res}    138          2         1      1   5029.618    47.0823   106.8261 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 71. {c |} {res}    138          4         1      1   1004.165   9.893947   101.4929 {txt}{c |}
 72. {c |} {res}    138          5         1      1   727.4298   8.249875   88.17464 {txt}{c |}
 73. {c |} {res}    139          1         1      1    625.902   6.286078   99.56956 {txt}{c |}
 74. {c |} {res}    139          2         1      1   550.3973   5.214247   105.5564 {txt}{c |}
 75. {c |} {res}    139          4         1      1   769.0334   7.794882   98.65876 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 76. {c |} {res}    139          5         1      1   644.4208   7.163976   89.95295 {txt}{c |}
 77. {c |} {res}    140          1         1      1   8451.925   28.33922   298.2412 {txt}{c |}
 78. {c |} {res}    140          2         1      1   368.5357   1.197043   307.8718 {txt}{c |}
 79. {c |} {res}    140          4         1      1   257.1429   .8571429        300 {txt}{c |}
 80. {c |} {res}    141          1         1      1   7860.869   22.16986   354.5747 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 81. {c |} {res}    141          2         1      1      12443    30.2139   411.8304 {txt}{c |}
 82. {c |} {res}    141          4         1      1   13073.09   27.93229    468.028 {txt}{c |}
 83. {c |} {res}    141          5         1      1   8579.286   15.02531   570.9891 {txt}{c |}
 84. {c |} {res}    143          1         1      1   2155.047   3.442937   625.9327 {txt}{c |}
 85. {c |} {res}    143          2         1      1   169.9573   .2578785   659.0594 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 86. {c |} {res}    143          4         1      1   753.3078   .6605421   1140.439 {txt}{c |}
 87. {c |} {res}    144          1         1      1   569.5909   1.703622   334.3411 {txt}{c |}
 88. {c |} {res}    144          2         1      1   4046.539   11.60391   348.7221 {txt}{c |}
 89. {c |} {res}    144          4         1      1   2451.214   7.486633   327.4121 {txt}{c |}
 90. {c |} {res}    144          5         1      1   847.0567   4.825843   175.5251 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 91. {c |} {res}    146          1         1      1   71.42857   .0714286       1000 {txt}{c |}
 92. {c |} {res}    146          2         1      1   57.14286   .2857143        200 {txt}{c |}
 93. {c |} {res}    147          1         1      1   10030.75   5.522516   1816.336 {txt}{c |}
 94. {c |} {res}    147          2         1      1      12787   8.095111   1579.595 {txt}{c |}
 95. {c |} {res}    147          4         1      1    10350.8   6.578101   1573.523 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
 96. {c |} {res}    147          5         1      1   3497.648   2.219922   1575.572 {txt}{c |}
 97. {c |} {res}    150          1         1      1   1175.517   6.912663   170.0527 {txt}{c |}
 98. {c |} {res}    150          2         1      1   1325.627   6.934003   191.1778 {txt}{c |}
 99. {c |} {res}    150          4         1      1   915.2883   5.463646   167.5234 {txt}{c |}
100. {c |} {res}    150          5         1      1    526.957   2.890811   182.2869 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
101. {c |} {res}    100          1         2      2   7199.485   6.701557     1074.3 {txt}{c |}
102. {c |} {res}    100          2         2      2   25997.67   20.76133   1252.216 {txt}{c |}
103. {c |} {res}    100          4         2      2      30661   21.32415   1437.854 {txt}{c |}
104. {c |} {res}    100          5         2      2   14092.53   16.90049   833.8532 {txt}{c |}
105. {c |} {res}    105          1         2      2   66653.79    145.904   456.8333 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
106. {c |} {res}    105          2         2      2   64764.03    104.472   619.9175 {txt}{c |}
107. {c |} {res}    105          3         2      2   332.1429   1.214286   273.5294 {txt}{c |}
108. {c |} {res}    105          4         2      2   28631.32   32.29985   886.4227 {txt}{c |}
109. {c |} {res}    105          5         2      2   3039.184   3.979407   763.7278 {txt}{c |}
110. {c |} {res}    107          1         2      2   14334.03   25.72579   557.1852 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
111. {c |} {res}    107          2         2      2   9113.504   10.89238   836.6865 {txt}{c |}
112. {c |} {res}    107          3         2      2   128.5714   .4285714        300 {txt}{c |}
113. {c |} {res}    107          4         2      2   9036.914   17.37915    519.986 {txt}{c |}
114. {c |} {res}    107          5         2      2    4284.21   4.964618   862.9486 {txt}{c |}
115. {c |} {res}    108          1         2      2   66299.99    179.971   368.3927 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
116. {c |} {res}    108          2         2      2   11442.33   38.62062   296.2751 {txt}{c |}
117. {c |} {res}    108          4         2      2   13376.97    43.1264   310.1806 {txt}{c |}
118. {c |} {res}    108          5         2      2    6392.56   17.60043   363.2049 {txt}{c |}
119. {c |} {res}    109          1         2      2   105.4431   .2857143   369.0507 {txt}{c |}
120. {c |} {res}    109          2         2      2   485.8338   1.020273   476.1804 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
121. {c |} {res}    109          4         2      2   357.1429   .7142857        500 {txt}{c |}
122. {c |} {res}    110          1         2      2   9379.672   10.32681   908.2839 {txt}{c |}
123. {c |} {res}    110          2         2      2   7632.524   9.537962   800.2259 {txt}{c |}
124. {c |} {res}    110          3         2      2   267.8571   .3571429        750 {txt}{c |}
125. {c |} {res}    110          4         2      2   3672.132   3.660146   1003.275 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
126. {c |} {res}    110          5         2      2    3049.25    2.81177   1084.459 {txt}{c |}
127. {c |} {res}    112          1         2      2    23096.3   294.0182   78.55399 {txt}{c |}
128. {c |} {res}    112          2         2      2   3074.602   59.58986   51.59605 {txt}{c |}
129. {c |} {res}    113          1         2      2   46740.54   87.07559   536.7813 {txt}{c |}
130. {c |} {res}    113          2         2      2   42753.76   109.8079   389.3506 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
131. {c |} {res}    113          3         2      2   1418.076   4.134111   343.0183 {txt}{c |}
132. {c |} {res}    113          4         2      2   32987.91   70.53026   467.7128 {txt}{c |}
133. {c |} {res}    113          5         2      2   25992.28   55.51959    468.164 {txt}{c |}
134. {c |} {res}    115          1         2      2   17312.27   29.92039   578.6112 {txt}{c |}
135. {c |} {res}    115          2         2      2   7892.361   20.80586   379.3336 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
136. {c |} {res}    115          4         2      2   6589.507   14.10947   467.0273 {txt}{c |}
137. {c |} {res}    115          5         2      2   10364.86   28.19486   367.6154 {txt}{c |}
138. {c |} {res}    116          1         2      2    17234.3    128.705   133.9055 {txt}{c |}
139. {c |} {res}    116          2         2      2   995.3412   3.822424   260.3953 {txt}{c |}
140. {c |} {res}    116          4         2      2   3115.137   22.10295   140.9376 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
141. {c |} {res}    116          5         2      2   124.2045   .4722403   263.0113 {txt}{c |}
142. {c |} {res}    117          1         2      2   27123.64   11.05744   2452.976 {txt}{c |}
143. {c |} {res}    117          2         2      2   11280.37   4.642283   2429.918 {txt}{c |}
144. {c |} {res}    117          3         2      2   142.8571   .0714286       2000 {txt}{c |}
145. {c |} {res}    117          4         2      2   9159.621   3.742912   2447.191 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
146. {c |} {res}    117          5         2      2   971.1666   .4046528       2400 {txt}{c |}
147. {c |} {res}    119          1         2      2   8761.363   3.500906   2502.599 {txt}{c |}
148. {c |} {res}    119          2         2      2   526.8841   .2142857   2458.792 {txt}{c |}
149. {c |} {res}    119          4         2      2   523.4845   .2331708   2245.069 {txt}{c |}
150. {c |} {res}    119          5         2      2   3473.379   1.447241       2400 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
151. {c |} {res}    121          1         2      2   7527.598   2.401398   3134.673 {txt}{c |}
152. {c |} {res}    121          2         2      2   4620.345   1.494158   3092.272 {txt}{c |}
153. {c |} {res}    121          4         2      2   2693.196   .8571429   3142.062 {txt}{c |}
154. {c |} {res}    121          5         2      2   1749.904   .5714286   3062.332 {txt}{c |}
155. {c |} {res}    122          1         2      2   25990.55   34.05213   763.2576 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
156. {c |} {res}    122          2         2      2   3884.959   5.859834   662.9811 {txt}{c |}
157. {c |} {res}    122          4         2      2   5651.907   10.73887    526.304 {txt}{c |}
158. {c |} {res}    122          5         2      2   911.1735   1.294677   703.7845 {txt}{c |}
159. {c |} {res}    123          1         2      2   16696.37   48.10662   347.0701 {txt}{c |}
160. {c |} {res}    123          2         2      2   5010.975   14.11866   354.9187 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
161. {c |} {res}    123          3         2      2   71.42857   .7142857        100 {txt}{c |}
162. {c |} {res}    123          4         2      2   7885.568   23.07918   341.6745 {txt}{c |}
163. {c |} {res}    123          5         2      2   3192.284   13.35988   238.9456 {txt}{c |}
164. {c |} {res}    125          1         2      2   20106.53   95.04843   211.5398 {txt}{c |}
165. {c |} {res}    125          2         2      2   7404.022   32.68016   226.5601 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
166. {c |} {res}    125          3         2      2        200          2        100 {txt}{c |}
167. {c |} {res}    125          4         2      2   3918.958   18.20266   215.2959 {txt}{c |}
168. {c |} {res}    125          5         2      2   4442.436   23.78972   186.7377 {txt}{c |}
169. {c |} {res}    127          1         2      2   8226.069   131.1404   62.72718 {txt}{c |}
170. {c |} {res}    127          2         2      2   6952.387      94.14   73.85157 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
171. {c |} {res}    127          3         2      2   57.14286   .5714286   99.99999 {txt}{c |}
172. {c |} {res}    127          4         2      2   8407.001   131.3132   64.02252 {txt}{c |}
173. {c |} {res}    127          5         2      2   3016.704   39.54492    76.2855 {txt}{c |}
174. {c |} {res}    134          1         2      2   5729.161   10.19897   561.7393 {txt}{c |}
175. {c |} {res}    134          2         2      2   980.2945   2.317878   422.9276 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
176. {c |} {res}    134          4         2      2    6361.27   18.23098   348.9263 {txt}{c |}
177. {c |} {res}    134          5         2      2   1479.078   9.214026   160.5246 {txt}{c |}
178. {c |} {res}    136          1         2      2   17280.03   141.5853   122.0468 {txt}{c |}
179. {c |} {res}    136          2         2      2   3750.861   35.00291   107.1585 {txt}{c |}
180. {c |} {res}    136          3         2      2   28.57143   .2857143   99.99999 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
181. {c |} {res}    136          4         2      2   4358.046   37.52402   116.1402 {txt}{c |}
182. {c |} {res}    136          5         2      2    4567.81   34.02384   134.2532 {txt}{c |}
183. {c |} {res}    138          1         2      2   10274.57    104.983   97.86884 {txt}{c |}
184. {c |} {res}    138          2         2      2   6979.165   57.91332   120.5105 {txt}{c |}
185. {c |} {res}    138          3         2      2   42.85714   .4285714        100 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
186. {c |} {res}    138          4         2      2   6774.006   53.23784   127.2404 {txt}{c |}
187. {c |} {res}    138          5         2      2   4982.448   65.36463   76.22543 {txt}{c |}
188. {c |} {res}    139          1         2      2   20102.28   217.4746   92.43506 {txt}{c |}
189. {c |} {res}    139          2         2      2   4677.759   48.78619   95.88284 {txt}{c |}
190. {c |} {res}    139          3         2      2   165.7143   1.657143        100 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
191. {c |} {res}    139          4         2      2   4510.176   43.54403   103.5774 {txt}{c |}
192. {c |} {res}    139          5         2      2   3422.066   33.08124   103.4443 {txt}{c |}
193. {c |} {res}    140          1         2      2   3897.419    15.7478   247.4898 {txt}{c |}
194. {c |} {res}    140          2         2      2   2722.638   7.363594   369.7431 {txt}{c |}
195. {c |} {res}    140          4         2      2   178.5714   .3571429        500 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
196. {c |} {res}    140          5         2      2   42.85714   .1428571        300 {txt}{c |}
197. {c |} {res}    141          1         2      2   35632.17   104.7127   340.2851 {txt}{c |}
198. {c |} {res}    141          2         2      2   8094.866   22.90144   353.4654 {txt}{c |}
199. {c |} {res}    141          3         2      2   171.4286   .2857143        600 {txt}{c |}
200. {c |} {res}    141          4         2      2   9281.632    15.1991   610.6697 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
201. {c |} {res}    141          5         2      2   3836.587   4.869616   787.8624 {txt}{c |}
202. {c |} {res}    143          1         2      2   5865.148   28.57389   205.2625 {txt}{c |}
203. {c |} {res}    143          2         2      2   1291.546    5.48361   235.5284 {txt}{c |}
204. {c |} {res}    143          3         2      2        200          2        100 {txt}{c |}
205. {c |} {res}    143          4         2      2   3735.457    7.90057   472.8086 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
206. {c |} {res}    143          5         2      2   619.6393   .7992913   775.2358 {txt}{c |}
207. {c |} {res}    144          1         2      2   2946.637   16.54455   178.1032 {txt}{c |}
208. {c |} {res}    144          2         2      2   3412.961   10.65731    320.246 {txt}{c |}
209. {c |} {res}    144          3         2      2   28.57143   .2857143   99.99999 {txt}{c |}
210. {c |} {res}    144          4         2      2   3485.979   14.90004   233.9577 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
211. {c |} {res}    144          5         2      2   2013.474   13.64064   147.6085 {txt}{c |}
212. {c |} {res}    146          1         2      2   655.8042   1.525141   429.9957 {txt}{c |}
213. {c |} {res}    146          2         2      2   42.85714   .1428571        300 {txt}{c |}
214. {c |} {res}    146          4         2      2   401.1453   .6553973   612.0643 {txt}{c |}
215. {c |} {res}    147          1         2      2   27035.16   19.49232   1386.964 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
216. {c |} {res}    147          2         2      2   17328.13   17.14604    1010.62 {txt}{c |}
217. {c |} {res}    147          3         2      2      712.5   .4464286       1596 {txt}{c |}
218. {c |} {res}    147          4         2      2   11715.73   7.887061   1485.437 {txt}{c |}
219. {c |} {res}    147          5         2      2   7874.616   5.316633   1481.128 {txt}{c |}
220. {c |} {res}    150          1         2      2   3085.388   18.62915   165.6215 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
221. {c |} {res}    150          2         2      2   1707.664   12.68932   134.5749 {txt}{c |}
222. {c |} {res}    150          3         2      2   59.52381   .3928572   151.5151 {txt}{c |}
223. {c |} {res}    150          4         2      2   1664.072   9.927602   167.6207 {txt}{c |}
224. {c |} {res}    150          5         2      2   792.4355   4.849155   163.4173 {txt}{c |}
225. {c |} {res}    100          1         3      3    378.327    .496062   762.6608 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
226. {c |} {res}    100          2         3      3        100   .1428571   699.9999 {txt}{c |}
227. {c |} {res}    100          3         3      3   3855.737   1.728453   2230.745 {txt}{c |}
228. {c |} {res}    100          4         3      3   338.3396   .2857143   1184.189 {txt}{c |}
229. {c |} {res}    105          1         3      3   19373.97   103.4535   187.2723 {txt}{c |}
230. {c |} {res}    105          2         3      3   13506.06   57.65408   234.2602 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
231. {c |} {res}    105          3         3      3   3531.237   14.11329   250.2065 {txt}{c |}
232. {c |} {res}    105          4         3      3   16155.26   68.39981   236.1887 {txt}{c |}
233. {c |} {res}    107          1         3      3   25485.35   94.01256   271.0845 {txt}{c |}
234. {c |} {res}    107          2         3      3    20969.7   70.46394   297.5948 {txt}{c |}
235. {c |} {res}    107          3         3      3    3129.77   14.03646   222.9743 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
236. {c |} {res}    107          4         3      3   25322.59   86.00251   294.4401 {txt}{c |}
237. {c |} {res}    107          5         3      3   57.14286   .1428571        400 {txt}{c |}
238. {c |} {res}    108          1         3      3   40151.92   253.8609    158.165 {txt}{c |}
239. {c |} {res}    108          2         3      3    17911.8   69.18621   258.8926 {txt}{c |}
240. {c |} {res}    108          3         3      3    18965.2   69.34852   273.4766 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
241. {c |} {res}    108          4         3      3   24506.94   157.6042   155.4967 {txt}{c |}
242. {c |} {res}    108          5         3      3   2592.857   1.163265   2228.948 {txt}{c |}
243. {c |} {res}    109          1         3      3   42.85714   .1428571        300 {txt}{c |}
244. {c |} {res}    109          4         3      3   85.71429   .4285714        200 {txt}{c |}
245. {c |} {res}    110          1         3      3   1150.776   1.585297   725.9053 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
246. {c |} {res}    110          2         3      3   682.6998   1.337749   510.3348 {txt}{c |}
247. {c |} {res}    110          3         3      3   85.71429   .0714286       1200 {txt}{c |}
248. {c |} {res}    110          4         3      3   1600.262   3.066602   521.8356 {txt}{c |}
249. {c |} {res}    112          1         3      3   9976.777   119.1061    83.7638 {txt}{c |}
250. {c |} {res}    112          2         3      3   13756.72   161.1557   85.36289 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
251. {c |} {res}    112          4         3      3   28.57143   .2857143   99.99999 {txt}{c |}
252. {c |} {res}    113          1         3      3   32258.18   215.6159   149.6094 {txt}{c |}
253. {c |} {res}    113          2         3      3   27718.66   191.8597   144.4736 {txt}{c |}
254. {c |} {res}    113          3         3      3   6297.851   61.54399   102.3309 {txt}{c |}
255. {c |} {res}    113          4         3      3   21734.01   133.1294   163.2548 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
256. {c |} {res}    115          1         3      3   6346.507   56.02795   113.2739 {txt}{c |}
257. {c |} {res}    115          2         3      3   4775.515   38.10229   125.3341 {txt}{c |}
258. {c |} {res}    115          3         3      3   192.8571   1.285714        150 {txt}{c |}
259. {c |} {res}    115          4         3      3   10947.55   71.90379   152.2527 {txt}{c |}
260. {c |} {res}    116          1         3      3   21516.29    132.731   162.1045 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
261. {c |} {res}    116          2         3      3   8523.057   52.13503   163.4804 {txt}{c |}
262. {c |} {res}    116          3         3      3        200          2        100 {txt}{c |}
263. {c |} {res}    116          4         3      3   23273.86   122.1411   190.5489 {txt}{c |}
264. {c |} {res}    116          5         3      3   185.7143   1.857143        100 {txt}{c |}
265. {c |} {res}    117          1         3      3    5284.54   2.198922   2403.242 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
266. {c |} {res}    117          2         3      3   9729.745   3.965071   2453.864 {txt}{c |}
267. {c |} {res}    117          3         3      3   876.6579   .3506632       2500 {txt}{c |}
268. {c |} {res}    117          4         3      3   14259.51   6.055076   2354.968 {txt}{c |}
269. {c |} {res}    119          1         3      3   2243.472    1.19786   1872.899 {txt}{c |}
270. {c |} {res}    119          2         3      3   5003.518   3.016396   1658.774 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
271. {c |} {res}    119          3         3      3   1390.399   1.214347   1144.976 {txt}{c |}
272. {c |} {res}    119          4         3      3   12279.46   5.935045   2068.976 {txt}{c |}
273. {c |} {res}    121          1         3      3   3935.423   1.142857   3443.495 {txt}{c |}
274. {c |} {res}    121          2         3      3   3209.522    1.34293   2389.939 {txt}{c |}
275. {c |} {res}    121          3         3      3   1389.469   .4902245   2834.353 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
276. {c |} {res}    121          4         3      3   7094.181   2.148056   3302.605 {txt}{c |}
277. {c |} {res}    122          1         3      3   6415.298   43.02032   149.1225 {txt}{c |}
278. {c |} {res}    122          2         3      3   2328.272    1.89654   1227.642 {txt}{c |}
279. {c |} {res}    122          3         3      3   714.2857   .4761905       1500 {txt}{c |}
280. {c |} {res}    122          4         3      3   3610.949   5.571543   648.1058 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
281. {c |} {res}    123          1         3      3   11238.39   50.90057    220.791 {txt}{c |}
282. {c |} {res}    123          2         3      3   7528.825   30.46615    247.121 {txt}{c |}
283. {c |} {res}    123          3         3      3   3845.737   7.357995    522.661 {txt}{c |}
284. {c |} {res}    123          4         3      3   10319.18   31.84796   324.0138 {txt}{c |}
285. {c |} {res}    125          1         3      3   4303.167   29.30909   146.8202 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
286. {c |} {res}    125          2         3      3   8969.032   80.56241   111.3302 {txt}{c |}
287. {c |} {res}    125          4         3      3   7698.461   41.58231   185.1379 {txt}{c |}
288. {c |} {res}    127          1         3      3   9247.367   99.18546   93.23309 {txt}{c |}
289. {c |} {res}    127          2         3      3   11278.05   92.18477   122.3418 {txt}{c |}
290. {c |} {res}    127          3         3      3   1838.827   12.87337   142.8396 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
291. {c |} {res}    127          4         3      3   11660.75   109.4786   106.5117 {txt}{c |}
292. {c |} {res}    127          5         3      3   28.57143   .5714286         50 {txt}{c |}
293. {c |} {res}    134          1         3      3   646.5477   5.183231   124.7384 {txt}{c |}
294. {c |} {res}    134          2         3      3   474.2204   4.742204        100 {txt}{c |}
295. {c |} {res}    134          4         3      3   593.6421   2.840218   209.0129 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
296. {c |} {res}    136          1         3      3   3980.208   35.17219   113.1635 {txt}{c |}
297. {c |} {res}    136          2         3      3    5912.09   45.97603   128.5907 {txt}{c |}
298. {c |} {res}    136          3         3      3   562.5074   5.031091   111.8063 {txt}{c |}
299. {c |} {res}    136          4         3      3   2839.657   22.91418   123.9258 {txt}{c |}
300. {c |} {res}    138          1         3      3   3050.415   37.46634   81.41749 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
301. {c |} {res}    138          2         3      3   737.3316    8.49449   86.80116 {txt}{c |}
302. {c |} {res}    138          3         3      3   100.9201   1.028295   98.14317 {txt}{c |}
303. {c |} {res}    138          4         3      3   1662.936   13.65208   121.8083 {txt}{c |}
304. {c |} {res}    139          1         3      3   29358.39      345.7   84.92447 {txt}{c |}
305. {c |} {res}    139          2         3      3    13302.6   137.6319   96.65352 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
306. {c |} {res}    139          3         3      3   1477.566   22.30568   66.24169 {txt}{c |}
307. {c |} {res}    139          4         3      3   11458.25   143.2321   79.99783 {txt}{c |}
308. {c |} {res}    139          5         3      3   57.14286    .952381         60 {txt}{c |}
309. {c |} {res}    140          1         3      3   2193.584   11.25486   194.9011 {txt}{c |}
310. {c |} {res}    140          2         3      3   6595.465   34.63333   190.4369 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
311. {c |} {res}    141          1         3      3   41528.47    169.516   244.9826 {txt}{c |}
312. {c |} {res}    141          2         3      3   28566.77   114.8472   248.7372 {txt}{c |}
313. {c |} {res}    141          3         3      3   11126.19   53.96189   206.1861 {txt}{c |}
314. {c |} {res}    141          4         3      3      44197   205.3512   215.2265 {txt}{c |}
315. {c |} {res}    141          5         3      3   1218.045   2.774436   439.0244 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
316. {c |} {res}    143          1         3      3   3544.486   31.87277   111.2073 {txt}{c |}
317. {c |} {res}    143          2         3      3   4232.483    28.8011   146.9556 {txt}{c |}
318. {c |} {res}    143          3         3      3   1122.329   10.74163   104.4841 {txt}{c |}
319. {c |} {res}    143          4         3      3   3146.676   25.33604   124.1976 {txt}{c |}
320. {c |} {res}    144          1         3      3   171.4286   .8571429        200 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
321. {c |} {res}    144          4         3      3   123.6423   .2857143    432.748 {txt}{c |}
322. {c |} {res}    146          1         3      3   10319.62   50.60872   203.9098 {txt}{c |}
323. {c |} {res}    146          2         3      3   4480.607   16.08158   278.6174 {txt}{c |}
324. {c |} {res}    146          3         3      3   2652.356    16.7205    158.629 {txt}{c |}
325. {c |} {res}    146          4         3      3   10094.91   39.96539   252.5912 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
326. {c |} {res}    146          5         3      3   571.4286   2.857143        200 {txt}{c |}
327. {c |} {res}    147          1         3      3   9443.149   38.72586   243.8461 {txt}{c |}
328. {c |} {res}    147          2         3      3   10193.39    25.7653   395.6247 {txt}{c |}
329. {c |} {res}    147          3         3      3   3296.624   21.75947    151.503 {txt}{c |}
330. {c |} {res}    147          4         3      3   11593.39   28.27507   410.0215 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
331. {c |} {res}    147          5         3      3   85.71429   .4285714        200 {txt}{c |}
332. {c |} {res}    150          1         3      3   3460.231   31.03369   111.4992 {txt}{c |}
333. {c |} {res}    150          2         3      3   2294.165   18.08048   126.8863 {txt}{c |}
334. {c |} {res}    150          3         3      3   818.9608   7.371365   111.1003 {txt}{c |}
335. {c |} {res}    150          4         3      3   2704.006   19.40228   139.3654 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
336. {c |} {res}    150          5         3      3   52.04082   .5204082        100 {txt}{c |}
337. {c |} {res}    100          1         4      4   91626.24   56.67748   1616.625 {txt}{c |}
338. {c |} {res}    100          2         4      4      24213   21.02853   1151.436 {txt}{c |}
339. {c |} {res}    100          4         4      4   59291.93   51.74507   1145.847 {txt}{c |}
340. {c |} {res}    100          5         4      4   5906.718   3.402249   1736.122 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
341. {c |} {res}    105          1         4      4   42959.38   45.51204   943.9124 {txt}{c |}
342. {c |} {res}    105          2         4      4   16373.67   22.52246   726.9929 {txt}{c |}
343. {c |} {res}    105          4         4      4   28128.81   20.42452   1377.208 {txt}{c |}
344. {c |} {res}    105          5         4      4   3670.155   1.923703   1907.859 {txt}{c |}
345. {c |} {res}    107          1         4      4   13898.52   19.44127   714.8975 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
346. {c |} {res}    107          2         4      4   15539.77   24.61611   631.2845 {txt}{c |}
347. {c |} {res}    107          4         4      4   18099.54    22.6771   798.1421 {txt}{c |}
348. {c |} {res}    107          5         4      4   4659.516   15.24905    305.561 {txt}{c |}
349. {c |} {res}    108          1         4      4   13087.59   100.5098   130.2122 {txt}{c |}
350. {c |} {res}    108          2         4      4   15434.22   73.15989   210.9655 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
351. {c |} {res}    108          4         4      4   19873.84   100.9422   196.8833 {txt}{c |}
352. {c |} {res}    108          5         4      4   10913.27   16.99183   642.2657 {txt}{c |}
353. {c |} {res}    109          1         4      4   22540.24   18.58565   1212.776 {txt}{c |}
354. {c |} {res}    109          2         4      4   2759.562   4.166276   662.3569 {txt}{c |}
355. {c |} {res}    109          4         4      4   6762.517   6.031243   1121.248 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
356. {c |} {res}    109          5         4      4   857.1429   .2857143       3000 {txt}{c |}
357. {c |} {res}    110          1         4      4   2977.825   5.214624   571.0526 {txt}{c |}
358. {c |} {res}    110          2         4      4   282.1967   .4641781   607.9492 {txt}{c |}
359. {c |} {res}    110          4         4      4   4558.865   4.979353   915.5536 {txt}{c |}
360. {c |} {res}    112          1         4      4   11688.28   153.1888   76.29986 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
361. {c |} {res}    112          4         4      4   751.4995   14.65687   51.27284 {txt}{c |}
362. {c |} {res}    113          1         4      4   41460.18   83.63968      495.7 {txt}{c |}
363. {c |} {res}    113          2         4      4   18855.57   89.73698   210.1204 {txt}{c |}
364. {c |} {res}    113          4         4      4   19079.21   74.81256   255.0268 {txt}{c |}
365. {c |} {res}    113          5         4      4   1060.575   4.891467   216.8215 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
366. {c |} {res}    115          1         4      4   19213.11   46.19314   415.9299 {txt}{c |}
367. {c |} {res}    115          2         4      4   3375.674   9.098119   371.0299 {txt}{c |}
368. {c |} {res}    115          4         4      4   6526.351   20.26636   322.0288 {txt}{c |}
369. {c |} {res}    115          5         4      4   382.4965   .9562412        400 {txt}{c |}
370. {c |} {res}    116          1         4      4   7566.026   15.57352   485.8263 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
371. {c |} {res}    116          2         4      4   1211.426   5.935877   204.0854 {txt}{c |}
372. {c |} {res}    116          4         4      4   193.2143   .7482144   258.2339 {txt}{c |}
373. {c |} {res}    117          1         4      4   9905.652   4.660649   2125.381 {txt}{c |}
374. {c |} {res}    117          2         4      4   6372.654   2.977197   2140.488 {txt}{c |}
375. {c |} {res}    117          4         4      4   13538.89   6.083515   2225.505 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
376. {c |} {res}    117          5         4      4   1597.313   .7986567       2000 {txt}{c |}
377. {c |} {res}    119          1         4      4   572.4499   .2453843   2332.871 {txt}{c |}
378. {c |} {res}    119          2         4      4   727.4125   .3026439   2403.526 {txt}{c |}
379. {c |} {res}    119          4         4      4   5123.252   2.242924   2284.185 {txt}{c |}
380. {c |} {res}    121          2         4      4   1399.076   .4285714    3264.51 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
381. {c |} {res}    121          4         4      4   2001.106   .5714286   3501.935 {txt}{c |}
382. {c |} {res}    121          5         4      4   571.4286   .2857143       2000 {txt}{c |}
383. {c |} {res}    122          1         4      4   678.0171   .5306788   1277.641 {txt}{c |}
384. {c |} {res}    122          2         4      4   2067.331   3.612219   572.3161 {txt}{c |}
385. {c |} {res}    122          4         4      4   4961.527   3.784728   1310.933 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
386. {c |} {res}    123          1         4      4   1781.204   2.679742   664.6924 {txt}{c |}
387. {c |} {res}    123          2         4      4   3210.207   3.257946    985.347 {txt}{c |}
388. {c |} {res}    123          4         4      4    7105.37   7.278644   976.1943 {txt}{c |}
389. {c |} {res}    123          5         4      4   1026.811   1.142857   898.4597 {txt}{c |}
390. {c |} {res}    125          1         4      4   10778.95   60.35729   178.5858 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
391. {c |} {res}    125          2         4      4   1839.056   11.36651   161.7961 {txt}{c |}
392. {c |} {res}    125          4         4      4   6590.826    33.6811   195.6832 {txt}{c |}
393. {c |} {res}    125          5         4      4   1855.317   10.32778   179.6434 {txt}{c |}
394. {c |} {res}    127          1         4      4   2529.517   20.18435   125.3207 {txt}{c |}
395. {c |} {res}    127          2         4      4     558.32   3.557831   156.9271 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
396. {c |} {res}    127          4         4      4   2378.084    16.0141   148.4994 {txt}{c |}
397. {c |} {res}    127          5         4      4   840.1196   8.378963   100.2653 {txt}{c |}
398. {c |} {res}    134          1         4      4   1709.931   10.86813   157.3345 {txt}{c |}
399. {c |} {res}    134          2         4      4   2007.389   23.26647   86.27821 {txt}{c |}
400. {c |} {res}    134          4         4      4   2054.398   16.02095    128.232 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
401. {c |} {res}    134          5         4      4   57.14286   1.142857         50 {txt}{c |}
402. {c |} {res}    136          1         4      4   3263.538   25.27314   129.1307 {txt}{c |}
403. {c |} {res}    136          2         4      4   4035.656   24.97969   161.5575 {txt}{c |}
404. {c |} {res}    136          4         4      4   3015.463   19.05719   158.2323 {txt}{c |}
405. {c |} {res}    136          5         4      4    619.753   3.242196   191.1522 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
406. {c |} {res}    138          1         4      4   4946.664   45.58166   108.5231 {txt}{c |}
407. {c |} {res}    138          2         4      4   2050.038   13.76324   148.9503 {txt}{c |}
408. {c |} {res}    138          4         4      4   2154.449   27.22131   79.14567 {txt}{c |}
409. {c |} {res}    138          5         4      4   698.6798   7.960438   87.76901 {txt}{c |}
410. {c |} {res}    139          1         4      4   2344.531   20.97858   111.7583 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
411. {c |} {res}    139          2         4      4   3095.796   23.51724   131.6394 {txt}{c |}
412. {c |} {res}    139          4         4      4   246.1545   1.411155   174.4348 {txt}{c |}
413. {c |} {res}    140          1         4      4   34644.92   117.3369   295.2603 {txt}{c |}
414. {c |} {res}    140          2         4      4   1234.244   1.414903    872.317 {txt}{c |}
415. {c |} {res}    140          4         4      4   7340.503   16.16053   454.2242 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
416. {c |} {res}    141          1         4      4   33542.67   93.06965   360.4039 {txt}{c |}
417. {c |} {res}    141          2         4      4   25931.12   79.38882   326.6345 {txt}{c |}
418. {c |} {res}    141          4         4      4   35142.84   82.04635   428.3291 {txt}{c |}
419. {c |} {res}    141          5         4      4   8176.142   19.98008   409.2146 {txt}{c |}
420. {c |} {res}    143          1         4      4   1743.989   3.331035   523.5577 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
421. {c |} {res}    143          2         4      4    2114.02   4.701605    449.638 {txt}{c |}
422. {c |} {res}    143          4         4      4   2696.988   4.849624   556.1232 {txt}{c |}
423. {c |} {res}    143          5         4      4    370.109   .7109869   520.5568 {txt}{c |}
424. {c |} {res}    144          1         4      4   10094.22   18.95455   532.5488 {txt}{c |}
425. {c |} {res}    144          2         4      4   7171.987   12.76068    562.038 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
426. {c |} {res}    144          4         4      4    3220.66   6.297252   511.4389 {txt}{c |}
427. {c |} {res}    144          5         4      4        250          1        250 {txt}{c |}
428. {c |} {res}    146          2         4      4   235.4197   .5714286   411.9844 {txt}{c |}
429. {c |} {res}    146          4         4      4   71.42857   1.428571         50 {txt}{c |}
430. {c |} {res}    146          5         4      4   431.3975   1.260911   342.1316 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
431. {c |} {res}    147          1         4      4   8912.133    6.03984   1475.558 {txt}{c |}
432. {c |} {res}    147          2         4      4   4126.054   2.859719   1442.818 {txt}{c |}
433. {c |} {res}    147          4         4      4   5365.207   3.333597   1609.435 {txt}{c |}
434. {c |} {res}    147          5         4      4   1305.525   .9574323   1363.569 {txt}{c |}
435. {c |} {res}    150          1         4      4   3245.487   15.80602   205.3324 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c RT}
436. {c |} {res}    150          2         4      4    1474.83   8.004668   184.2462 {txt}{c |}
437. {c |} {res}    150          4         4      4   2117.508   11.16862   189.5945 {txt}{c |}
438. {c |} {res}    150          5         4      4   367.2519   1.781368   206.1629 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 10}{c -}{hline 9}{c -}{hline 6}{c -}{hline 10}{c -}{hline 10}{c -}{hline 10}{c BRC}

{com}.                         tempfile uvq2;
{txt}
{com}.                         keep reg_tpi product survquar ppkg_trim;
{txt}
{com}.                 save `uvq2', replace;
{txt}(note: file /tmp/St02564.00000e not found)
file /tmp/St02564.00000e saved

{com}.                                 use `uvq' ;
{txt}
{com}.                         merge reg_tpi product survquar using `uvq2';
{txt}(label lsurvquar already defined)
(label lregion already defined)

{com}.                         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          3        0.68        0.68
{txt}          3 {c |}{res}        438       99.32      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        441      100.00
{txt}
{com}.                         drop _merge;
{txt}
{com}.                 save `uvq', replace;
{txt}file /tmp/St02564.00000c saved

{com}.                 save "$path/work/tpi_unit_val_quarterly.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/tpi_unit_val_quarterly.dta saved

{com}.         restore;
{txt}
{com}. **************************************************************************;
. * Now calculate the weights for the temporal price index. The weights
> * will be based on the bottom 50% of the national nominal consumption
> * per capita (see below). We let the weights vary by strata (3 regions X rural/urban).
> *
> * First, make a small file that has the total nominal HH daily consumption,
> * to use as our denominator. We cannot simply use the `bottom_tpi' file that
> * was created earlier because we will need some other variables from
> * the cons_cat.dta file.
> **************************************************************************;
. use "$path/work/conpc.dta", clear;
{txt}
{com}. keep hhid cons_hh_nom;
{txt}
{com}. *use "$path/in/cons_cat.dta", clear ;
. *CA modified to merge in hhdata for bootstrap;
.        sort hhid;
{txt}
{com}.         merge hhid using "$path/work/hhdata.dta";
{txt}
{com}.           tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         collapse (mean) cons_hh_nom hhsize strata hhweight rural news survquar reg_tpi,
>                 by(hhid);
{txt}
{com}.         lab var cons_hh_nom "Nominal daily HH consumption";
{txt}
{com}.         rename hhsize   cc_hhs;
{txt}
{com}.         rename strata   cc_reg;
{txt}
{com}.         rename hhweight cc_hhw;
{txt}
{com}.         rename rural    cc_rur;
{txt}
{com}.         rename news     cc_news;
{txt}
{com}.         rename survquar cc_qua;
{txt}
{com}.         rename reg_tpi  cc_reg_tpi;
{txt}
{com}.         sort hhid;
{txt}
{com}.         tempfile thhcons;
{txt}
{com}. save `thhcons', replace;
{txt}(note: file /tmp/St02564.00000f not found)
file /tmp/St02564.00000f saved

{com}. **************************************************************************;
. * Merge the file with consumption on the food products with HH consumption file,
> * then use "fillin" to take care of cases where a household did not
> * consume all n_tpi commodities. Note that we need to do the merge
> * first because there are some households that are not in `acredd' at
> * all, because they did not consume *any* of the n_tpi items. Then replace
> * missing values in the "filled in" observations with the relevant values 
> * for that household.
> **************************************************************************;
. use `acredd';
{txt}
{com}.         cap drop _merge;
{txt}
{com}.         drop if product==.;
{txt}(109 observations deleted)

{com}.         merge hhid using `thhcons';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        110        0.38        0.38
{txt}          3 {c |}{res}     28,800       99.62      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     28,910      100.00
{txt}
{com}.         for var valued_tot quantityd_tot : replace X=0 if _merge==2;

{res}->  replace valued_tot=0 if _merge==2
{txt}(110 real changes made)

{res}->  replace quantityd_tot=0 if _merge==2
{txt}(110 real changes made)

{com}.                 /*
>         for var valued_ac quantityd_ac valued_re quantityd_re valued_dd quantityd_dd 
>                 valued_tot quantityd_tot : replace X=0 if _merge==2;
>                                 */
> 
>         replace hhsize  =cc_hhs     if _merge==2;
{txt}(109 real changes made)

{com}.         replace strata  =cc_reg     if _merge==2;
{txt}(109 real changes made)

{com}.         replace hhweight=cc_hhw     if _merge==2;
{txt}(109 real changes made)

{com}.         replace rural   =cc_rur     if _merge==2;
{txt}(109 real changes made)

{com}.         replace news    =cc_news        if _merge==2;
{txt}(109 real changes made)

{com}.         replace survquar=cc_qua     if _merge==2;
{txt}(109 real changes made)

{com}.         replace reg_tpi =cc_reg_tpi     if _merge==2;
{txt}(109 real changes made)

{com}.         drop _merge cc_* ;
{txt}
{com}.                 fillin hhid product;
{txt}
{com}.         replace valued_tot=0 if _fillin;
{txt}(61686 real changes made)

{com}.                 for var quantityd_tot 
>                 strata rural hhweight hhsize survquar survmon news reg_tpi cons_hh_nom :
>                 egen tmp=mean(X), by(hhid) \
>                 replace X=tmp if _fillin \
>                 drop tmp;

{res}->  egen tmp=mean(quantityd_tot), by(hhid)

->  replace quantityd_tot=tmp if _fillin
{txt}(61686 real changes made)

{res}->  drop tmp

->  egen tmp=mean(strata), by(hhid)
{txt}(145 missing values generated)

{res}->  replace strata=tmp if _fillin
{txt}(61583 real changes made)

{res}->  drop tmp

->  egen tmp=mean(rural), by(hhid)
{txt}(145 missing values generated)

{res}->  replace rural=tmp if _fillin
{txt}(61583 real changes made)

{res}->  drop tmp

->  egen tmp=mean(hhweight), by(hhid)
{txt}(145 missing values generated)

{res}->  replace hhweight=tmp if _fillin
{txt}(61583 real changes made)

{res}->  drop tmp

->  egen tmp=mean(hhsize), by(hhid)
{txt}(29 missing values generated)

{res}->  replace hhsize=tmp if _fillin
{txt}(61658 real changes made)

{res}->  drop tmp

->  egen tmp=mean(survquar), by(hhid)
{txt}(145 missing values generated)

{res}->  replace survquar=tmp if _fillin
{txt}(61583 real changes made)

{res}->  drop tmp

->  egen tmp=mean(survmon), by(hhid)
{txt}(3306 missing values generated)

{res}->  replace survmon=tmp if _fillin
{txt}(58531 real changes made)

{res}->  drop tmp

->  egen tmp=mean(news), by(hhid)
{txt}(145 missing values generated)

{res}->  replace news=tmp if _fillin
{txt}(61583 real changes made)

{res}->  drop tmp

->  egen tmp=mean(reg_tpi), by(hhid)
{txt}(145 missing values generated)

{res}->  replace reg_tpi=tmp if _fillin
{txt}(61583 real changes made)

{res}->  drop tmp

->  egen tmp=mean(cons_hh_nom), by(hhid)
{txt}(29 missing values generated)

{res}->  replace cons_hh_nom=tmp if _fillin
{txt}(61658 real changes made)

{res}->  drop tmp
{txt}
{com}.                                 /*
>         for var valued_ac quantityd_ac valued_re quantityd_re valued_dd quantityd_dd 
>                 quantityd_tot 
>                 strata rural hhweight hhsize survquar survmon news reg_tpi cons_hh_nom :
>                 egen tmp=mean(X), by(hhid) \
>                 replace X=tmp if _fillin \
>                 drop tmp;
>                                 */
> 
> **************************************************************************;
. * Now calculate the shares, and then the mean shares in each strata, 
> * using hhweight*hhsize weighting. 
> * Note that we are not doing quantity weighting now for the shares.
> **************************************************************************;
.         gen share = valued_tot/cons_hh_nom ;
{txt}(58 missing values generated)

{com}.         gen popwt = hhsize*hhweight;
{txt}(145 missing values generated)

{com}.         lab var share "HH share in total consumption";
{txt}
{com}.         lab var popwt "Population weight: hhsize*hhweight";
{txt}
{com}. **************************************************************************;
. * Select the bottom 50% (weighted) of the distribution of nominal per 
> * capita consumption.
> **************************************************************************;
.         gen cpc=cons_hh_nom/hhsize;
{txt}(58 missing values generated)

{com}.         sum cpc [aw=hhweight] , detail;

                             {txt}cpc
{hline 61}
      Percentiles      Smallest
 1%    {res} 197.5413       103.3254
{txt} 5%    {res} 297.8005       103.3254
{txt}10%    {res}  376.696       103.3254       {txt}Obs         {res}      90422
{txt}25%    {res} 534.2612       103.3254       {txt}Sum of Wgt. {res}  151348521

{txt}50%    {res}  851.058                      {txt}Mean          {res} 1248.942
                        {txt}Largest       Std. Dev.     {res} 1406.063
{txt}75%    {res} 1406.032       23846.89
{txt}90%    {res} 2557.521       23846.89       {txt}Variance      {res}  1977014
{txt}95%    {res} 3482.337       23846.89       {txt}Skewness      {res} 5.749453
{txt}99%    {res} 6548.099       23846.89       {txt}Kurtosis      {res} 61.60169
{txt}
{com}.         global medcpc=r(p$tpi_bottom);
{txt}
{com}. * MAH ;
.  sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     90567    2.43e+09    1.16e+09   1.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     87472      125.25    14.67179        100        150
{txt}{space 2}valued_tot {c |}{res}     90596    87.33123    252.5384          0       7500
{txt}quantityd_~t {c |}{res}     90596    .5735846    .6567883          0         50
{txt}{space 4}hhweight {c |}{res}     90451    1673.657    752.4905   140.8407   5553.862
{txt}{hline 13}{c +}{hline 56}
{space 4}survquar {c |}{res}     90451    2.438602    1.384203          1          5
{txt}{space 5}survmon {c |}{res}     87290    6.217276    4.164974          1         14
{txt}{space 6}strata {c |}{res}     90451    4.414877    2.449579          1          8
{txt}{space 7}rural {c |}{res}     90451    .7242706    .4468835          0          1
{txt}{space 5}reg_tpi {c |}{res}     90451    2.345303    1.154768          1          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     28759    3.142216    1.369879          1          5
{txt}{space 8}news {c |}{res}     90451    2.345303    1.154768          1          4
{txt}{space 6}hhsize {c |}{res}     90567    5.366314    3.108316          1         29
{txt}{space 1}cons_hh_nom {c |}{res}     90567    5922.644    6786.925          0   84210.06
{txt}{space 5}_fillin {c |}{res}     90596     .680891    .4661339          0          1
{txt}{hline 13}{c +}{hline 56}
{space 7}share {c |}{res}     90538    .0176602    .0483751          0          1
{txt}{space 7}popwt {c |}{res}     90451    9029.887    6947.874     201.98   61536.83
{txt}{space 9}cpc {c |}{res}     90538    1330.096     1627.29   103.3254   23846.89
{txt}
{com}.  codebook hhid;

{txt}{hline}
{res}hhid{right:Unique HH Identifier Across Panel Waves}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3123{col 51}{txt}missing .:  {res}29{txt}/{res}90596

{txt}{col 19}mean:{res}{col 26} 2.4e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.2e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}.         keep if cpc<=$medcpc;
{txt}(46110 observations deleted)

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     44486    2.71e+09    1.00e+09   1.02e+09   4.19e+09
{txt}{space 5}product {c |}{res}     42952      125.25    14.67188        100        150
{txt}{space 2}valued_tot {c |}{res}     44486    64.41537    190.2396          0       4000
{txt}quantityd_~t {c |}{res}     44486    .6369598    .6198901          0         26
{txt}{space 4}hhweight {c |}{res}     44399    1704.946    659.9521   140.8407   5553.862
{txt}{hline 13}{c +}{hline 56}
{space 4}survquar {c |}{res}     44399    2.354017    1.387212          1          5
{txt}{space 5}survmon {c |}{res}     43993    5.941332    4.130882          1         14
{txt}{space 6}strata {c |}{res}     44399    5.109079    2.042163          1          8
{txt}{space 7}rural {c |}{res}     44399    .8850425    .3189743          0          1
{txt}{space 5}reg_tpi {c |}{res}     44399    2.612018    1.004748          1          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     12716    3.547421    1.051875          1          5
{txt}{space 8}news {c |}{res}     44399    2.612018    1.004748          1          4
{txt}{space 6}hhsize {c |}{res}     44486    6.065189    2.892215          1         29
{txt}{space 1}cons_hh_nom {c |}{res}     44486    3137.395    1825.995        150   15722.37
{txt}{space 5}_fillin {c |}{res}     44486    .7133255    .4522132          0          1
{txt}{hline 13}{c +}{hline 56}
{space 7}share {c |}{res}     44486    .0207117    .0571617          0          1
{txt}{space 7}popwt {c |}{res}     44399    10313.72    6505.607    225.125    57829.4
{txt}{space 9}cpc {c |}{res}     44486    527.9537    178.9447   103.3254    851.058
{txt}
{com}.                 collapse (mean) share (median) medshare=share [aw=popwt] , 
>                         by(reg_tpi product);
{txt}
{com}.                 egen sumsh=sum(share) , by(reg_tpi);
{txt}
{com}.                 replace share=share/sumsh;
{txt}(112 real changes made)

{com}.                 drop sumsh;
{txt}
{com}.                 egen sumsh=sum(medshare) , by(reg_tpi);
{txt}
{com}.                 replace medshare=medshare/sumsh;
{txt}(24 real changes made)

{com}.                 drop sumsh;
{txt}
{com}.                 lab var share "Reg 6: Mean HH share of total consumption";
{txt}
{com}.                 lab var medshare "Reg 6: Median HH share of total consumption";
{txt}
{com}.                 sort reg_tpi product;
{txt}
{com}.                 save "$path/work/tpi_reg_tpi_share.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/tpi_reg_tpi_share.dta saved

{com}.                 tempfile tempwt6;
{txt}
{com}.                 save `tempwt6', replace;
{txt}(note: file /tmp/St02564.00000g not found)
file /tmp/St02564.00000g saved

{com}. use `uvq', clear;
{txt}
{com}.         sort reg_tpi product;
{txt}
{com}. save , replace;
{txt}file /tmp/St02564.00000c saved

{com}. use `tempwt6';
{txt}
{com}.         merge reg_tpi product using `uvq';
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
product
do not uniquely identify observations in
/tmp/St02564.00000c
{p_end}
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          4        0.90        0.90
{txt}          3 {c |}{res}        441       99.10      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        445      100.00
{txt}
{com}.         gen tpi1     =ppkg     *share;
{txt}(4 missing values generated)

{com}.         gen tpi1_trim=ppkg_trim*share;
{txt}(7 missing values generated)

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}product {c |}{res}       441    125.5442    14.78831        100        150
{txt}{space 5}reg_tpi {c |}{res}       445    2.498876    1.085583          1          4
{txt}{space 7}share {c |}{res}       445    .0383485    .0407269          0   .1976485
{txt}{space 4}medshare {c |}{res}       445    .0404494    .1027744          0   .6404065
{txt}{space 4}survquar {c |}{res}       441    2.848073    1.471564          1          5
{txt}{hline 13}{c +}{hline 56}
{space 8}news {c |}{res}       441    2.498866    1.085283          1          4
{txt}{space 2}valued_tot {c |}{res}       441    5545.762    7720.548   14.28571   60589.15
{txt}quantityd_~t {c |}{res}       441     15.4772    22.73993   .0714286   173.9763
{txt}{space 8}ppkg {c |}{res}       441    692.7551    758.9424         50   4516.363
{txt}{space 3}ppkg_trim {c |}{res}       438    652.3875    771.3226         50   4516.363
{txt}{hline 13}{c +}{hline 56}
{space 6}_merge {c |}{res}       445    2.982022    .1889765          1          3
{txt}{space 8}tpi1 {c |}{res}       441    28.71811     47.2602   .0012743   333.6888
{txt}{space 3}tpi1_trim {c |}{res}       438    26.71146    45.53869   .0012743   343.1419
{txt}
{com}. keep if survquar!=.;
{txt}(4 observations deleted)

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}product {c |}{res}       441    125.5442    14.78831        100        150
{txt}{space 5}reg_tpi {c |}{res}       441    2.498866    1.085283          1          4
{txt}{space 7}share {c |}{res}       441    .0386964    .0407464   .0000255   .1976485
{txt}{space 4}medshare {c |}{res}       441    .0408163    .1031678          0   .6404065
{txt}{space 4}survquar {c |}{res}       441    2.848073    1.471564          1          5
{txt}{hline 13}{c +}{hline 56}
{space 8}news {c |}{res}       441    2.498866    1.085283          1          4
{txt}{space 2}valued_tot {c |}{res}       441    5545.762    7720.548   14.28571   60589.15
{txt}quantityd_~t {c |}{res}       441     15.4772    22.73993   .0714286   173.9763
{txt}{space 8}ppkg {c |}{res}       441    692.7551    758.9424         50   4516.363
{txt}{space 3}ppkg_trim {c |}{res}       438    652.3875    771.3226         50   4516.363
{txt}{hline 13}{c +}{hline 56}
{space 6}_merge {c |}{res}       441           3           0          3          3
{txt}{space 8}tpi1 {c |}{res}       441    28.71811     47.2602   .0012743   333.6888
{txt}{space 3}tpi1_trim {c |}{res}       438    26.71146    45.53869   .0012743   343.1419
{txt}
{com}. list in  1/3;

     {txt}{c TLC}{hline 9}{c TT}{hline 9}{c TT}{hline 10}{c TT}{hline 10}{c TT}{hline 19}{c TT}{hline 9}{c TT}{hline 10}{c TRC}
  1. {c |} product {c |} reg_tpi {c |}    share {c |} medshare {c |}          survquar {c |}    news {c |} valued~t {c |}
     {c |} {res}    100 {txt}{c |} {res}Central {txt}{c |} {res}.1245395 {txt}{c |} {res}       0 {txt}{c |} {res}May '05 - Jul-'05 {txt}{c |} {res}Central {txt}{c |} {res}15969.55 {txt}{c |}
     {c LT}{hline 9}{c BT}{hline 3}{c TT}{hline 5}{c BT}{hline 7}{c TT}{hline 2}{c BT}{hline 10}{c +}{hline 11}{c TT}{hline 7}{c BT}{hline 5}{c TT}{hline 3}{c BT}{hline 10}{c RT}
     {c |}  quanti~t   {c |}      ppkg   {c |}  ppkg_t~m   {c |}  _merge   {c |}      tpi1   {c |}   tpi1_t~m   {c |}
     {c |}  {res}12.19603   {txt}{c |}  {res}1309.405   {txt}{c |}  {res}  1388.5   {txt}{c |}  {res}     3   {txt}{c |}  {res}163.0727   {txt}{c |}   {res} 172.923   {txt}{c |}
     {c BLC}{hline 13}{c BT}{hline 13}{c BT}{hline 13}{c BT}{hline 11}{c BT}{hline 13}{c BT}{hline 14}{c BRC}

     {c TLC}{hline 9}{c TT}{hline 9}{c TT}{hline 10}{c TT}{hline 10}{c TT}{hline 19}{c TT}{hline 9}{c TT}{hline 10}{c TRC}
  2. {c |} product {c |} reg_tpi {c |}    share {c |} medshare {c |}          survquar {c |}    news {c |} valued~t {c |}
     {c |} {res}    105 {txt}{c |} {res}Central {txt}{c |} {res}.1627478 {txt}{c |} {res}.3548732 {txt}{c |} {res}May '05 - Jul-'05 {txt}{c |} {res}Central {txt}{c |} {res}19836.72 {txt}{c |}
     {c LT}{hline 9}{c BT}{hline 3}{c TT}{hline 5}{c BT}{hline 7}{c TT}{hline 2}{c BT}{hline 10}{c +}{hline 11}{c TT}{hline 7}{c BT}{hline 5}{c TT}{hline 3}{c BT}{hline 10}{c RT}
     {c |}  quanti~t   {c |}      ppkg   {c |}  ppkg_t~m   {c |}  _merge   {c |}      tpi1   {c |}   tpi1_t~m   {c |}
     {c |}  {res}21.78891   {txt}{c |}  {res}910.4047   {txt}{c |}  {res}801.2834   {txt}{c |}  {res}     3   {txt}{c |}  {res}148.1664   {txt}{c |}   {res}130.4071   {txt}{c |}
     {c BLC}{hline 13}{c BT}{hline 13}{c BT}{hline 13}{c BT}{hline 11}{c BT}{hline 13}{c BT}{hline 14}{c BRC}

     {c TLC}{hline 9}{c TT}{hline 9}{c TT}{hline 10}{c TT}{hline 10}{c TT}{hline 19}{c TT}{hline 9}{c TT}{hline 10}{c TRC}
  3. {c |} product {c |} reg_tpi {c |}    share {c |} medshare {c |}          survquar {c |}    news {c |} valued~t {c |}
     {c |} {res}    107 {txt}{c |} {res}Central {txt}{c |} {res}.0871047 {txt}{c |} {res}       0 {txt}{c |} {res}May '05 - Jul-'05 {txt}{c |} {res}Central {txt}{c |} {res}9570.623 {txt}{c |}
     {c LT}{hline 9}{c BT}{hline 3}{c TT}{hline 5}{c BT}{hline 7}{c TT}{hline 2}{c BT}{hline 10}{c +}{hline 11}{c TT}{hline 7}{c BT}{hline 5}{c TT}{hline 3}{c BT}{hline 10}{c RT}
     {c |}  quanti~t   {c |}      ppkg   {c |}  ppkg_t~m   {c |}  _merge   {c |}      tpi1   {c |}   tpi1_t~m   {c |}
     {c |}  {res}15.48085   {txt}{c |}  {res}618.2235   {txt}{c |}  {res}481.1454   {txt}{c |}  {res}     3   {txt}{c |}  {res}53.85015   {txt}{c |}   {res}41.91001   {txt}{c |}
     {c BLC}{hline 13}{c BT}{hline 13}{c BT}{hline 13}{c BT}{hline 11}{c BT}{hline 13}{c BT}{hline 14}{c BRC}

{com}. list in -3/-1;

     {txt}{c TLC}{hline 9}{c TT}{hline 9}{c TT}{hline 9}{c TT}{hline 10}{c TT}{hline 15}{c TT}{hline 9}{c TT}{hline 10}{c TRC}
439. {c |} product {c |} reg_tpi {c |}   share {c |} medshare {c |}      survquar {c |}    news {c |} valued~t {c |}
     {c |} {res}    150 {txt}{c |} {res}Western {txt}{c |} {res}.010944 {txt}{c |} {res}.0249144 {txt}{c |} {res}   Aug-Oct 05 {txt}{c |} {res}Western {txt}{c |} {res}  1271.7 {txt}{c |}
     {c LT}{hline 9}{c BT}{hline 2}{c TT}{hline 6}{c BT}{hline 5}{c TT}{hline 3}{c BT}{hline 8}{c TT}{hline 1}{c BT}{hline 8}{c TT}{hline 6}{c BT}{hline 6}{c TT}{hline 2}{c BT}{hline 10}{c RT}
     {c |}  quanti~t  {c |}      ppkg  {c |}  ppkg_t~m  {c |}  _merge  {c |}      tpi1   {c |}  tpi1_t~m   {c |}
     {c |}  {res}6.681939  {txt}{c |}  {res} 190.319  {txt}{c |}  {res}184.2462  {txt}{c |}  {res}     3  {txt}{c |}  {res}2.082845   {txt}{c |}  {res}2.016385   {txt}{c |}
     {c BLC}{hline 12}{c BT}{hline 12}{c BT}{hline 12}{c BT}{hline 10}{c BT}{hline 13}{c BT}{hline 13}{c BRC}

     {c TLC}{hline 9}{c TT}{hline 9}{c TT}{hline 9}{c TT}{hline 10}{c TT}{hline 15}{c TT}{hline 9}{c TT}{hline 10}{c TRC}
440. {c |} product {c |} reg_tpi {c |}   share {c |} medshare {c |}      survquar {c |}    news {c |} valued~t {c |}
     {c |} {res}    150 {txt}{c |} {res}Western {txt}{c |} {res}.010944 {txt}{c |} {res}.0249144 {txt}{c |} {res}Jul-Sept 2006 {txt}{c |} {res}Western {txt}{c |} {res}1944.216 {txt}{c |}
     {c LT}{hline 9}{c BT}{hline 2}{c TT}{hline 6}{c BT}{hline 5}{c TT}{hline 3}{c BT}{hline 8}{c TT}{hline 1}{c BT}{hline 8}{c TT}{hline 6}{c BT}{hline 6}{c TT}{hline 2}{c BT}{hline 10}{c RT}
     {c |}  quanti~t  {c |}      ppkg  {c |}  ppkg_t~m  {c |}  _merge  {c |}      tpi1   {c |}  tpi1_t~m   {c |}
     {c |}  {res}9.488426  {txt}{c |}  {res}204.9039  {txt}{c |}  {res}189.5945  {txt}{c |}  {res}     3  {txt}{c |}  {res}2.242463   {txt}{c |}  {res}2.074916   {txt}{c |}
     {c BLC}{hline 12}{c BT}{hline 12}{c BT}{hline 12}{c BT}{hline 10}{c BT}{hline 13}{c BT}{hline 13}{c BRC}

     {c TLC}{hline 9}{c TT}{hline 9}{c TT}{hline 9}{c TT}{hline 10}{c TT}{hline 15}{c TT}{hline 9}{c TT}{hline 10}{c TRC}
441. {c |} product {c |} reg_tpi {c |}   share {c |} medshare {c |}      survquar {c |}    news {c |} valued~t {c |}
     {c |} {res}    150 {txt}{c |} {res}Western {txt}{c |} {res}.010944 {txt}{c |} {res}.0249144 {txt}{c |} {res}  Oct-Nov '06 {txt}{c |} {res}Western {txt}{c |} {res}322.1541 {txt}{c |}
     {c LT}{hline 9}{c BT}{hline 2}{c TT}{hline 6}{c BT}{hline 5}{c TT}{hline 3}{c BT}{hline 8}{c TT}{hline 1}{c BT}{hline 8}{c TT}{hline 6}{c BT}{hline 6}{c TT}{hline 2}{c BT}{hline 10}{c RT}
     {c |}  quanti~t  {c |}      ppkg  {c |}  ppkg_t~m  {c |}  _merge  {c |}      tpi1   {c |}  tpi1_t~m   {c |}
     {c |}  {res}1.559935  {txt}{c |}  {res}206.5177  {txt}{c |}  {res}206.1629  {txt}{c |}  {res}     3  {txt}{c |}  {res}2.260123   {txt}{c |}  {res}2.256241   {txt}{c |}
     {c BLC}{hline 12}{c BT}{hline 12}{c BT}{hline 12}{c BT}{hline 10}{c BT}{hline 13}{c BT}{hline 13}{c BRC}

{com}.         **************************************************************************;
. * Find TPI level and indexes for non-trimmed and trimmed prices
> **************************************************************************;
. * Not trimmed ;
.         collapse (sum) tpi1 tpi1_trim  , by(reg_tpi survquar);
{txt}
{com}.                 for num 1/$n_tpi :
>                         sum tpi1 if reg_tpi==X & survquar==2 , meanonly \
>                         sum tpi1 if reg_tpi==X & survquar==4 , meanonly \
>                         global baseX=r(mean);

{res}->  sum tpi1 if reg_tpi==1 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==1 & survquar==4 , meanonly

->  global base1=r(mean)

->  sum tpi1 if reg_tpi==2 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==2 & survquar==4 , meanonly

->  global base2=r(mean)

->  sum tpi1 if reg_tpi==3 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==3 & survquar==4 , meanonly

->  global base3=r(mean)

->  sum tpi1 if reg_tpi==4 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==4 & survquar==4 , meanonly

->  global base4=r(mean)

->  sum tpi1 if reg_tpi==5 & survquar==2 , meanonly

->  sum tpi1 if reg_tpi==5 & survquar==4 , meanonly

->  global base5=r(mean)
{txt}
{com}.                 lab var tpi1 "Temporal price index before normalization";
{txt}
{com}.                                 foreach v of numlist 1/$n_tpi {c -(} ;
{txt}  2{com}.                                         if `v'==1 {c -(} ;
{txt}  3{com}.                                                 gen tpi=tpi1/${c -(}base`v'{c )-} if reg_tpi==`v' ;
{txt}  4{com}.                                         {c )-} ;
{txt}  5{com}.                                         if `v'>1 {c -(} ;
{txt}  6{com}.                                                 replace tpi=tpi1/${c -(}base`v'{c )-} if reg_tpi==`v' ;
{txt}  7{com}.                                         {c )-} ;
{txt}  8{com}.                                 {c )-} ;
{txt}(14 missing values generated)
(5 real changes made)
(5 real changes made)
(4 real changes made)
(0 real changes made)

{com}.                                                                                                 *gen     tpi=tpi1/$base1 if reg_tpi==1;
.                 *replace tpi=tpi1/$base2 if reg_tpi==2;
.                 *replace tpi=tpi1/$base3 if reg_tpi==3;
.                 *replace tpi=tpi1/$base4 if reg_tpi==4;
.                 *replace tpi=tpi1/$base5 if reg_tpi==5;
.                 *replace tpi=tpi1/$base6 if reg_tpi==6;
.                                                                                 lab var tpi "Temporal price index (Q4=1)";
{txt}
{com}. * Trimmed ;
.                 for num 1/$n_tpi :
>                         sum tpi1_trim if reg_tpi==X & survquar==2 , meanonly \
>                         sum tpi1_trim if reg_tpi==X & survquar==4 , meanonly \
>                         global baseX=r(mean);

{res}->  sum tpi1_trim if reg_tpi==1 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==1 & survquar==4 , meanonly

->  global base1=r(mean)

->  sum tpi1_trim if reg_tpi==2 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==2 & survquar==4 , meanonly

->  global base2=r(mean)

->  sum tpi1_trim if reg_tpi==3 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==3 & survquar==4 , meanonly

->  global base3=r(mean)

->  sum tpi1_trim if reg_tpi==4 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==4 & survquar==4 , meanonly

->  global base4=r(mean)

->  sum tpi1_trim if reg_tpi==5 & survquar==2 , meanonly

->  sum tpi1_trim if reg_tpi==5 & survquar==4 , meanonly

->  global base5=r(mean)
{txt}
{com}.                 lab var tpi1_trim "Six regions: TRIMMED Temporal price index before normalization";
{txt}
{com}.                                 foreach v of numlist 1/$n_tpi {c -(} ;
{txt}  2{com}.                                         if `v'==1 {c -(} ;
{txt}  3{com}.                                                 gen tpi_trim=tpi1_trim/${c -(}base`v'{c )-} if reg_tpi==`v' ;
{txt}  4{com}.                                         {c )-} ;
{txt}  5{com}.                                         if `v'>1 {c -(} ;
{txt}  6{com}.                                                 replace tpi_trim=tpi1_trim/${c -(}base`v'{c )-} if reg_tpi==`v' ;
{txt}  7{com}.                                         {c )-} ;
{txt}  8{com}.                                 {c )-} ;
{txt}(14 missing values generated)
(5 real changes made)
(5 real changes made)
(4 real changes made)
(0 real changes made)

{com}.                                                 lab var tpi_trim "TRIMMED Temporal price index (Q4=1)";
{txt}
{com}.                 sort reg_tpi survquar;
{txt}
{com}.             drop if reg_tpi<1 | reg_tpi>$n_tpi;
{txt}(0 observations deleted)

{com}. gen tpi_diff = tpi - tpi_trim;
{txt}
{com}. lab var tpi_diff "TPI difference btw trimmed/untrimmed";
{txt}
{com}. twoway (connected tpi_trim survquar),yline(1) by(, title("TPI: Trimmed"))
> by(reg_tpi) sav("$path/work/reg_tpi-tpi_trim", replace);
{res}{txt}(file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/reg_tpi-tpi_trim.gph saved)

{com}. graph export "$path/work/reg_tpi-tpi_trim.tif", replace;
{txt}(file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/reg_tpi-tpi_trim.tif written in TIFF format)

{com}. list reg_tpi survquar tpi tpi_trim tpi_diff;
{txt}
     {c TLC}{hline 10}{c -}{hline 22}{c -}{hline 10}{c -}{hline 10}{c -}{hline 11}{c TRC}
     {c |} {res} reg_tpi               survquar        tpi   tpi_trim    tpi_diff {txt}{c |}
     {c LT}{hline 10}{c -}{hline 22}{c -}{hline 10}{c -}{hline 10}{c -}{hline 11}{c RT}
  1. {c |} {res} Central      May '05 - Jul-'05   1.023404   1.037946    -.014542 {txt}{c |}
  2. {c |} {res} Central             Aug-Oct 05   1.145034   1.058962    .0860724 {txt}{c |}
  3. {c |} {res} Central          Jul-Sept 2006          1          1           0 {txt}{c |}
  4. {c |} {res} Central            Oct-Nov '06   1.123757   1.223628   -.0998706 {txt}{c |}
  5. {c |} {res} Eastern      May '05 - Jul-'05   1.058028   .8873101     .170718 {txt}{c |}
     {c LT}{hline 10}{c -}{hline 22}{c -}{hline 10}{c -}{hline 10}{c -}{hline 11}{c RT}
  6. {c |} {res} Eastern             Aug-Oct 05   .9829763   .8727097    .1102666 {txt}{c |}
  7. {c |} {res} Eastern   Nov '05 & May-Jun 06    .329728   .4442574   -.1145294 {txt}{c |}
  8. {c |} {res} Eastern          Jul-Sept 2006          1          1           0 {txt}{c |}
  9. {c |} {res} Eastern            Oct-Nov '06   1.087058   .9541122    .1329454 {txt}{c |}
 10. {c |} {res}Northern      May '05 - Jul-'05   .8942134    .936161   -.0419477 {txt}{c |}
     {c LT}{hline 10}{c -}{hline 22}{c -}{hline 10}{c -}{hline 10}{c -}{hline 11}{c RT}
 11. {c |} {res}Northern             Aug-Oct 05   .9299877     .98029   -.0503023 {txt}{c |}
 12. {c |} {res}Northern   Nov '05 & May-Jun 06   .9631566   .9508332    .0123234 {txt}{c |}
 13. {c |} {res}Northern          Jul-Sept 2006          1          1           0 {txt}{c |}
 14. {c |} {res}Northern            Oct-Nov '06   .9321731    1.04144    -.109267 {txt}{c |}
 15. {c |} {res} Western      May '05 - Jul-'05   .9381497   1.015202   -.0770526 {txt}{c |}
     {c LT}{hline 10}{c -}{hline 22}{c -}{hline 10}{c -}{hline 10}{c -}{hline 11}{c RT}
 16. {c |} {res} Western             Aug-Oct 05   .9113454   .8591004     .052245 {txt}{c |}
 17. {c |} {res} Western          Jul-Sept 2006          1          1           0 {txt}{c |}
 18. {c |} {res} Western            Oct-Nov '06   1.152315   1.181831   -.0295157 {txt}{c |}
     {c BLC}{hline 10}{c -}{hline 22}{c -}{hline 10}{c -}{hline 10}{c -}{hline 11}{c BRC}

{com}.                 sort reg_tpi survquar;
{txt}
{com}. keep reg_tpi survquar tpi_trim;
{txt}
{com}. save "$path/work/temp_index_reg_tpi.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/temp_index_reg_tpi.dta saved

{com}.                        **************************************************************************
> * 090_temp_index.do     (end)
> **************************************************************************;
. cap log close;
{txt}
{com}. 
{txt}end of do-file

{com}. do "$path/new/100_food_basket_flex.do"/* Flexible food basket */
{txt}
{com}. *global path "C:/user/gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/100_food_basket_flex.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/100_food_basket_flex.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:25
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 100_food_basket_flex.do     (start)
> *
> * This file is to get the data from the cons_cod.dta in work and then 
> * to create the do file with the 90% of the consumption expenditures 
> * using a flexible basket of goods.
> *
> * NOTE: we actually keep goods representing 95% of expenditure
> * in order to facilitate dropping of some goods (such as rats) where
> * quantity and nutrition information is unknown.
> *
> * We base our basket on the bottom 60 percent of consumption per capita
> * (weighted by hhweight*hhsize). We use the TEMPORALLY-ADJUSTED
> * NOMINAL consumption because we don't have a spatial adjustment yet.
> *
> * (Then we iterate this process to arrive at a final food bundle in later code)
> **************************************************************************;
. *CA modified to bring in hhdata into bootstrap;
. /*
> This file uses:
>                 work/cons_cod.dta
>                 work/hhdata.dta
>                 work/products.dta
>                 work/consump_nom.dta
>                 work/temp_index_reg_tpi.dta
>                 work/food_cat.dta
> 
> This file creates:
>                 work/food_basket_flex.dta
>                 work/codes_food_basket_flex.dta
> */
> 
> 
> 
> *do "$path/new/010_initial.do";
. **************************************************************************;
. * First, make a small temp file that has the temporally adjusted 
> * nominal consumption per capita, using work/consump_nom and 
> * work/temp_index_reg_tpi.dta. Make a dummy variable indicating
> * whether they are in the bottom 60%.
> **************************************************************************;
. use "$path/work/conpc.dta", clear;
{txt}
{com}. *use "$path/work/consump_nom.dta", clear;
. *CA modified to merge in work/hhdata.dta for bootstrap;
.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/hhdata.dta";
{txt}
{com}.         tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _m;
{txt}
{com}.         keep hhid hhweight hhsize cons_pc_nom reg_tpi rural survquar;
{txt}
{com}.         sort reg_tpi survquar;
{txt}
{com}.         cap drop _merge;
{txt}
{com}.         merge reg_tpi survquar using "$path/work/temp_index_reg_tpi.dta";
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
survquar
do not uniquely identify observations in
the master data
{p_end}
(label lsurvquar already defined)
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         15        0.48        0.48
{txt}          3 {c |}{res}      3,109       99.52      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/conpc.dta";
{txt}
{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.                 gen food_pc_tpi  = food_pc_nom /tpi_trim;
{txt}(15 missing values generated)

{com}.         lab var food_pc_tpi "Temp-adjusted per capita food consumption/day";
{txt}
{com}.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
{txt}(16 missing values generated)

{com}.         lab var cons_pc_tpi "Temp adjusted total consumption/day";
{txt}
{com}.         gen one=1;
{txt}
{com}.         tempfile contpi;
{txt}
{com}.         save `contpi', replace;
{txt}(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved

{com}.         collapse (p$bottom) one cons_pc_tpi [aw=hhsize*hhweight] ;
{txt}
{com}.         rename cons_pc_tpi pctile_60;
{txt}
{com}.         tempfile 60pct;
{txt}
{com}.         sort one;
{txt}
{com}.         save `60pct', replace;
{txt}(note: file /tmp/St02564.000002 not found)
file /tmp/St02564.000002 saved

{com}.                 use `contpi';
{txt}
{com}.                 sort one;
{txt}
{com}.                 merge one using `60pct';
{txt}{p 0 4 2}
variable{txt} one
does not uniquely identify observations in
the master data
{p_end}

{com}.                 tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.                 drop _merge;
{txt}
{com}.                 drop one;
{txt}
{com}.                         gen bottom_basket=cons_pc_tpi< pctile_60;
{txt}
{com}.                 tab bottom_basket [aw=hhsize*hhweight];

{txt}bottom_bask {c |}
         et {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 1,564.9929       50.18       50.18
{txt}          1 {c |}{res} 1,554.0071       49.82      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}
{com}.                 lab var bottom_basket "=1 if in bottom 60% of PCE";
{txt}
{com}.                                 sort hhid;
{txt}
{com}. save `contpi' , replace;
{txt}file /tmp/St02564.000001 saved

{com}. **************************************************************************;
. * Next, need to keep only the food products in order to calculate the 
> * food poverty line, and then calculate the food expenses by code.
> **************************************************************************;
. use "$path/work/cons_cod.dta";
{txt}
{com}. /*
>         sort product;
>         merge product using "$path/work/food_cat.dta";
>         tab _merge;
>         keep if _merge==3;
>         drop _merge;
> */
>         
>         keep if food_cat==1;
{txt}(3977 observations deleted)

{com}.         codebook hhid;

{txt}{hline}
{res}hhid{right:Unique HH Identifier Across Panel Waves}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3120{col 51}{txt}missing .:  {res}0{txt}/{res}38998

{txt}{col 19}mean:{res}{col 26} 2.3e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.1e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}.         sort hhid;
{txt}
{com}. **************************************************************************;
. * Next, merge in the consumption information, and select those in bottom
> * 60% of nominal distribution, after making temporal adjustment. 
> **************************************************************************;
.         merge hhid using `contpi';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          4        0.01        0.01
{txt}          3 {c |}{res}     38,998       99.99      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,002      100.00
{txt}
{com}.         keep if _merge==3;
{txt}(4 observations deleted)

{com}.         drop _merge;
{txt}
{com}.         keep if bottom_basket==1;
{txt}(25093 observations deleted)

{com}.      **************************************************************************;
. * Calculate food shares. Since we're only doing shares here, we can
> * work with the expenditures without doing temporal adjustment.
> **************************************************************************;
.           gen  food_expenditure= cod_hh_nom;
{txt}
{com}.                             *gen  food_expenditure= own_valued + daily_valued + monthly_valued + educ_valued;
.           egen tot_food_expen= sum (food_expen), by (hhid) ;
{txt}
{com}.           count if food_expenditure==.;
{res}    0
{txt}
{com}.           count if tot_food_expen==.;
{res}    0
{txt}
{com}.                     gen food_share= food_expenditure/tot_food_expen;
{txt}
{com}.           count if food_share==.;
{res}    0
{txt}
{com}.           drop if food_share==.;
{txt}(0 observations deleted)

{com}.           sort hhid product;
{txt}
{com}.                         tempfile food_basket_flex;
{txt}
{com}. save `food_basket_flex', replace;
{txt}(note: file /tmp/St02564.000003 not found)
file /tmp/St02564.000003 saved

{com}. ********************************************************************************;
. * Now prepare to get the variable spdomain to the using dataset, and then find the 
> * total shares by each product in order to select the most important goods in the 
> * basket.
> ********************************************************************************;
.                 preserve;
{txt}
{com}.                 use "$path/work/hhdata.dta", clear;
{txt}
{com}.                         keep hhid spdomain;
{txt}
{com}.                         sort hhid;
{txt}
{com}.                         tempfile spdomain;
{txt}
{com}.                 save `spdomain' , replace;
{txt}(note: file /tmp/St02564.000005 not found)
file /tmp/St02564.000005 saved

{com}.                 restore;
{txt}
{com}.                            collapse (mean) hhweight, by (hhid);
{txt}
{com}.            sort hhid ;
{txt}
{com}.             merge hhid using `spdomain';
{txt}
{com}.            tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}      1,766       56.55       56.55
{txt}          3 {c |}{res}      1,357       43.45      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,123      100.00
{txt}
{com}.            drop if _m==2;
{txt}(1766 observations deleted)

{com}.            drop _merge;
{txt}
{com}.             collapse (sum) hhweight , by(spdomain);
{txt}
{com}.            rename hhweight tothhweight;
{txt}
{com}.            tempfile tothhweight;
{txt}
{com}. save `tothhweight';
{txt}file /tmp/St02564.000006 saved

{com}. use `food_basket_flex';
{txt}
{com}.           sort hhid;
{txt}
{com}.           merge hhid using `spdomain';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}.           tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}      1,766       11.27       11.27
{txt}          3 {c |}{res}     13,905       88.73      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     15,671      100.00
{txt}
{com}.           sort _m;
{txt}
{com}.           drop if _m==2;
{txt}(1766 observations deleted)

{com}.           drop _m;
{txt}
{com}.           sort spdomain;
{txt}
{com}.             merge spdomain using `tothhweight';
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

{com}.           tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     13,905      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     13,905      100.00
{txt}
{com}.           drop _merge;
{txt}
{com}.             sort spdomain product;
{txt}
{com}.             gen f_share_w=(food_share*hhweight)/tothhweight;
{txt}
{com}.                                                 *drop descript;
.                         *gen descript = 0;
.             collapse (sum) f_share_w, by(spdomain product);
{txt}
{com}.                      sort spdomain f_share_w;
{txt}
{com}.           by spdomain: gen cumshr= sum(f_share_w);
{txt}
{com}.                     count if cumshr<=.075;
{res}  118
{txt}
{com}.           drop if cumshr<=.075;
{txt}(118 observations deleted)

{com}.             lab var f_share_w "average food share for the 13 regions";
{txt}
{com}. save "$path/work/food_basket_flex.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/food_basket_flex.dta saved

{com}. * List first spatial region to get an idea about contents;
. list product spdomain f_share_w cumshr if spdomain==1;
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c -}{hline 10}{c -}{hline 10}{c TRC}
     {c |} {res}product        spdomain   f_shar~w     cumshr {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c -}{hline 10}{c -}{hline 10}{c RT}
  1. {c |} {res}    149   Central Urban     .00871   .0760886 {txt}{c |}
  2. {c |} {res}    150   Central Urban   .0094023   .0854908 {txt}{c |}
  3. {c |} {res}    114   Central Urban   .0099662    .095457 {txt}{c |}
  4. {c |} {res}    134   Central Urban   .0119157   .1073727 {txt}{c |}
  5. {c |} {res}    125   Central Urban    .012526   .1198987 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c -}{hline 10}{c -}{hline 10}{c RT}
  6. {c |} {res}    135   Central Urban   .0141241   .1340228 {txt}{c |}
  7. {c |} {res}    140   Central Urban    .016719   .1507417 {txt}{c |}
  8. {c |} {res}    117   Central Urban   .0194072   .1701489 {txt}{c |}
  9. {c |} {res}    161   Central Urban   .0276729   .1978219 {txt}{c |}
 10. {c |} {res}    127   Central Urban   .0277953   .2256172 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c -}{hline 10}{c -}{hline 10}{c RT}
 11. {c |} {res}    136   Central Urban   .0294572   .2550744 {txt}{c |}
 12. {c |} {res}    122   Central Urban   .0308958   .2859702 {txt}{c |}
 13. {c |} {res}    157   Central Urban   .0362997   .3222699 {txt}{c |}
 14. {c |} {res}    123   Central Urban   .0376731    .359943 {txt}{c |}
 15. {c |} {res}    144   Central Urban   .0507403   .4106833 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c -}{hline 10}{c -}{hline 10}{c RT}
 16. {c |} {res}    141   Central Urban    .053628   .4643113 {txt}{c |}
 17. {c |} {res}    100   Central Urban   .0608637    .525175 {txt}{c |}
 18. {c |} {res}    105   Central Urban   .0690821    .594257 {txt}{c |}
 19. {c |} {res}    107   Central Urban   .0830494   .6773064 {txt}{c |}
 20. {c |} {res}    147   Central Urban   .0905686   .7678751 {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c -}{hline 10}{c -}{hline 10}{c RT}
 21. {c |} {res}    113   Central Urban   .1092901   .8771651 {txt}{c |}
 22. {c |} {res}    110   Central Urban   .1228348          1 {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c -}{hline 10}{c -}{hline 10}{c BRC}

{com}.                     gen numreg=1;
{txt}
{com}.           collapse (sum) numreg cumshr, by (product);
{txt}
{com}.                           keep product  numreg;
{txt}
{com}.           display _N;
{res}39
{txt}
{com}.                     lab var numreg "number of goods in the basket";
{txt}
{com}. /*
>           merge product using "$path/work/products.dta";
>             tab _merge;
>           keep if _merge==3;
> */
>           keep product  numreg;
{txt}
{com}.             sort product;
{txt}
{com}.                display _N;
{res}39
{txt}
{com}.   save "$path/work/codes_food_basket_flex.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/codes_food_basket_flex.dta saved

{com}. **************************************************************************
> * 100_food_basket_flex.do     (end)
> **************************************************************************;
. cap log close;
{txt}
{com}. 
{txt}end of do-file

{com}. do "$path/new/110_price_unit_flex.do"/* Flexible basket: Prices */
{txt}
{com}. *global path "C:/user/gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/110_price_unit_flex.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/110_price_unit_flex.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:25
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. ****************************************************************************************
> * 110_price_unit_flex.do                (start)
> *
> * Purpose: This do file creates a price_unit_flex database with the unit prices of the
> * goods of the flexible food basket in order to determine the poverty lines per spatial
> * domain. It uses the files work/daily.dta and work/own.dta file and draw unit prices
> * by: sum of values and quantity
> ****************************************************************************************;
. *CA modified to bring in work/hhdata.dta for bootstrap
> *CA check for price calcs conditional on number of observations;
. /*
> This file uses:
>         work/daily.dta
>         work/own.dta
>         work/hhdata.dta
>         work/consump_nom.dta
>         work/codes_food_basket_flex.dta
>         work/temp_index_reg_tpi.dta
>           new/conversions.do
> 
> This file creates:
>         work/price_unit_flex.dta
>         work/bottom_basket.dta
> */
> 
> 
> 
> 
> *do "$path/new/010_initial.do";
. **************************************************************************************
> * Create sorted data set with daily and own and the matched codes
> **************************************************************************************;
. use "$path/work/cons_cod_trans.dta", clear;
{txt}
{com}. *use "$path/in/cons_cod_trans.dta", clear;
. *save "$path/work/cons_cod_trans.dta", replace;
. *drop if quantityd==0 ;
. keep hhid product food_cat valuez quantity unit;
{txt}
{com}. rename valuez    value;
{txt}
{com}. *rename quantityz quantity;
. drop if quantity==0 ;
{txt}(3 observations deleted)

{com}. *drop count;
.         sort product;
{txt}
{com}.         gen count=1;
{txt}
{com}.                 tempfile dd_acsort;
{txt}
{com}. save `dd_acsort', replace;
{txt}(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved

{com}. /*
> use "$path/work/daily.dta";
> tempfile dd_acsort;
>         drop days;
>         sort product;
>         tempfile dd_acsort;
> save `dd_acsort', replace;
> 
> use "$path/work/own.dta";
>         keep hhid product valued quantityd unit;
>         rename valued value;
>         rename quantityd quantity;
> 
>         *CHECK THE ZEROS IN quantity FOR NOW DELETE;
>         drop if quantity==0;
> 
>         append using `dd_acsort';
> 
> *CA modified to merge in work/hhdata.dta for bootstrap;
>         sort hhid;
>       merge hhid using "$path/work/hhdata.dta";
>       tab _m;
> 
> * Drop observations if non existent in HH data set;
> drop if _m!=3;
> drop _m;
> 
> 
>         sort product;
>         gen count=1;
> 
> 
> save `dd_acsort', replace;
> */
> 
> 
> **************************************************************************************;
. * Merge the flexible food basket codes with the daily and own data sets
> * Drop all codes not a part of the flexible food basket
> **************************************************************************************;
.         merge product using "$path/work/codes_food_basket_flex.dta";
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float
{txt}
{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}      3,634        9.12        9.12
{txt}          3 {c |}{res}     36,216       90.88      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,850      100.00
{txt}
{com}.         drop if _merge~=3;
{txt}(3634 observations deleted)

{com}.         drop _merge;
{txt}
{com}. **************************************************************************************;
. * Drop observations where product code or quantity or value information is unavailable
> **************************************************************************************;
.                                 codebook hhid;

{txt}{hline}
{res}hhid{right:household id}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3118{col 51}{txt}missing .:  {res}505{txt}/{res}36216

{txt}{col 19}mean:{res}{col 26} 2.4e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.1e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}. *        drop if product==. | value==. | quantity==.  ;
.                                 codebook hhid;

{txt}{hline}
{res}hhid{right:household id}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3118{col 51}{txt}missing .:  {res}505{txt}/{res}36216

{txt}{col 19}mean:{res}{col 26} 2.4e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.1e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}. **************************************************************************************;
. * Convert non-KG quantities (units and liters) to kilograms;
. **************************************************************************************;
. *do "$path/new/110a_conversions.do"
> 
> ********************************************************************
> * There remain a few difficult to interpret observations such as liters
> * of fish and liters of pasta. These are dropped
> ********************************************************************;
. *        drop if unit~=2;
. ********************************************************************
> * Merge in labels for the 13 spatial domains
> ********************************************************************;
.         preserve;
{txt}
{com}.                 use "$path/work/hhdata.dta", clear;
{txt}
{com}.                                                                         keep hhid spdomain reg_tpi survquar;
{txt}
{com}.                         sort hhid;
{txt}
{com}.                         tempfile spdomainreg_tpi;
{txt}
{com}.                 save `spdomainreg_tpi', replace;
{txt}(note: file /tmp/St02564.000003 not found)
file /tmp/St02564.000003 saved

{com}.                                 codebook hhid;

{txt}{hline}
{res}hhid{right:Household ID}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3123{col 51}{txt}missing .:  {res}0{txt}/{res}3123

{txt}{col 19}mean:{res}{col 26} 2.4e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.2e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}.         restore;
{txt}
{com}.                 sort hhid;
{txt}
{com}.         merge hhid using `spdomainreg_tpi';
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        505        1.39        1.39
{txt}          2 {c |}{res}          5        0.01        1.41
{txt}          3 {c |}{res}     35,711       98.59      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     36,221      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         drop if product==.;
{txt}(5 observations deleted)

{com}. codebook hhid;

{txt}{hline}
{res}hhid{right:household id}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3118{col 51}{txt}missing .:  {res}505{txt}/{res}36216

{txt}{col 19}mean:{res}{col 26} 2.4e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.1e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}. tab spd;

      {txt}Spatial {c |}
domains: each {c |}
     with own {c |}
 poverty line {c |}
 (they are 5) {c |}      Freq.     Percent        Cum.
{hline 14}{c +}{hline 35}
Central Urban {c |}{res}      5,906       16.56       16.56
{txt}Central Rural {c |}{res}      6,566       18.41       34.97
{txt}      Eastern {c |}{res}      8,446       23.68       58.66
{txt}     Northern {c |}{res}      7,117       19.96       78.61
{txt}      Western {c |}{res}      7,627       21.39      100.00
{txt}{hline 14}{c +}{hline 35}
        Total {c |}{res}     35,662      100.00
{txt}
{com}. sum if spd>=3;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     23239    3.06e+09    8.30e+08   2.01e+09   4.19e+09
{txt}{space 5}product {c |}{res}     23744    129.8697    16.25222        100        161
{txt}{space 7}value {c |}{res}     23239    241.6601    391.0277   1.428571   19285.71
{txt}{space 8}unit {c |}{res}     23239           1           0          1          1
{txt}{space 4}food_cat {c |}{res}     23239           1           0          1          1
{txt}{hline 13}{c +}{hline 56}
{space 4}quantity {c |}{res}     21501     1.13447    3.211978   .0014286      135.2
{txt}{space 7}count {c |}{res}     23744           1           0          1          1
{txt}{space 6}numreg {c |}{res}     23744    3.880686    1.395461          1          5
{txt}{space 4}survquar {c |}{res}     23190    2.326693    1.361816          1          5
{txt}{space 5}reg_tpi {c |}{res}     23190    2.964683    .8317951          2          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     23190    3.964683    .8317951          3          5
{txt}
{com}. table spdomain, content(mean quantity count quantity count hhid) row missing;

{txt}{hline 14}{c TT}{hline 47}
Spatial       {c |}
domains: each {c |}
with own      {c |}
poverty line  {c |}
(they are 5)  {c |} mean(quantity)     N(quantity)         N(hhid)
{hline 14}{c +}{hline 47}
Central Urban {c |}       {res}.6272362           5,578           5,906
{txt}Central Rural {c |}       {res}1.137202           6,316           6,566
      {txt}Eastern {c |}        {res}.932739           8,185           8,446
     {txt}Northern {c |}       {res}1.077276           5,808           7,117
      {txt}Western {c |}       {res}1.401658           7,462           7,627
              {txt}{c |} 
        Total {c |}       {res}1.050459          33,349          35,662
{txt}{hline 14}{c BT}{hline 47}

{com}.         drop if product==. | value==. | quantity==.  ;
{txt}(2821 observations deleted)

{com}. codebook hhid;

{txt}{hline}
{res}hhid{right:household id}
{txt}{hline}

{col 19}type:  numeric ({res}double{txt})

{col 18}range:  [{res}1.013e+09{txt},{res}4.193e+09{txt}]{col 55}units:  {res}1
{col 10}{txt}unique values:  {res}3021{col 51}{txt}missing .:  {res}0{txt}/{res}33395

{txt}{col 19}mean:{res}{col 26} 2.4e+09
{txt}{col 15}std. dev:{res}{col 26} 1.2e+09

{txt}{col 12}percentiles:{col 32}10%{col 42}25%{col 52}50%{col 62}75%{col 72}90%
{res}{col 27} 1.0e+09{col 37} 1.1e+09{col 47} 2.1e+09{col 57} 3.2e+09{col 67} 4.1e+09
{txt}
{com}. tab spd;

      {txt}Spatial {c |}
domains: each {c |}
     with own {c |}
 poverty line {c |}
 (they are 5) {c |}      Freq.     Percent        Cum.
{hline 14}{c +}{hline 35}
Central Urban {c |}{res}      5,578       16.73       16.73
{txt}Central Rural {c |}{res}      6,316       18.94       35.67
{txt}      Eastern {c |}{res}      8,185       24.54       60.21
{txt}     Northern {c |}{res}      5,808       17.42       77.62
{txt}      Western {c |}{res}      7,462       22.38      100.00
{txt}{hline 14}{c +}{hline 35}
        Total {c |}{res}     33,349      100.00
{txt}
{com}. ********************************************************************
> * Merge in temporal price index to convert nominal value to real
> ********************************************************************;
.         sort reg_tpi survquar;
{txt}
{com}.         merge reg_tpi survquar using "$path/work/temp_index_reg_tpi.dta";
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
survquar
do not uniquely identify observations in
the master data
{p_end}
(label lsurvquar already defined)
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        162        0.49        0.49
{txt}          3 {c |}{res}     33,233       99.51      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     33,395      100.00
{txt}
{com}.         drop if _merge ~= 3;
{txt}(162 observations deleted)

{com}.         drop _merge;
{txt}
{com}.         gen value_r=value/tpi_trim;
{txt}
{com}. **************************************************************************;
. * Identify relatively poor households, based on nominal temporally adjusted
> * consumption per capita. Only work with these households for the price
> * calculations.
> **************************************************************************;
.                 preserve;
{txt}
{com}.                         use "$path/work/conpc.dta", clear;
{txt}
{com}. *                       use "$path/work/consump_nom.dta", clear;
. *CA modified to merge in work/hhdata.dta for bootstrap;
.         sort hhid;
{txt}
{com}.       merge hhid using "$path/work/hhdata.dta";
{txt}
{com}.       tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.       drop _m;
{txt}
{com}. *CA modified to keep bswt;
.                                 keep hhid hhweight hhsize cons_pc_nom bswt ;
{txt}
{com}.                                 sort hhid;
{txt}
{com}.                                 merge hhid using `spdomainreg_tpi';
{txt}(label lsurvquar already defined)
(label lregion already defined)
(label lspdomain already defined)

{com}.                                 tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.                                 drop _merge;
{txt}
{com}.                                 sort reg_tpi survquar;
{txt}
{com}.                                 cap drop _merge;
{txt}
{com}.                                 merge reg_tpi survquar using "$path/work/temp_index_reg_tpi.dta";
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
survquar
do not uniquely identify observations in
the master data
{p_end}
(label lsurvquar already defined)
(label lregion already defined)

{com}.                                 tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         15        0.48        0.48
{txt}          3 {c |}{res}      3,109       99.52      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.                                 drop _merge;
{txt}
{com}.                                 sort hhid;
{txt}
{com}.                                 merge hhid using "$path/work/conpc.dta";
{txt}
{com}.                                 tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.                                 drop _merge;
{txt}
{com}.                                 gen food_pc_tpi  = food_pc_nom /tpi_trim;
{txt}(15 missing values generated)

{com}.                                 lab var food_pc_tpi "Temp-adjusted per capita food consumption/day";
{txt}
{com}.                                                                 * Non-food not TPI adjusted ;
.                                 gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
{txt}(16 missing values generated)

{com}.                                 lab var cons_pc_tpi "Temp adjusted total consumption/day";
{txt}
{com}.                                 gen one=1;
{txt}
{com}.                                 tempfile contpi;
{txt}
{com}.                                 save `contpi', replace;
{txt}(note: file /tmp/St02564.000005 not found)
file /tmp/St02564.000005 saved

{com}.                                 collapse (p$bottom) one cons_pc_tpi [aw=hhsize*hhweight], by(spdomain) ;
{txt}
{com}.                                 rename cons_pc_tpi pctile_60;
{txt}
{com}.                                 tempfile 60pct;
{txt}
{com}.                                 sort spdomain;
{txt}
{com}.                                 save `60pct', replace;
{txt}(note: file /tmp/St02564.000006 not found)
file /tmp/St02564.000006 saved

{com}.                                 use `contpi';
{txt}
{com}.                                         sort spdomain;
{txt}
{com}.                                         merge spdomain using `60pct';
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

{com}.                                         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.                                         drop _merge;
{txt}
{com}.                                         drop one;
{txt}
{com}.                                         sort spdomain;
{txt}
{com}.                                         gen bottom_basket=cons_pc_tpi< pctile_60;
{txt}
{com}.                                         by spdomain: tab bottom_basket [aw=hhsize*hhweight];

{txt}{hline}
-> spdomain = Central Urban

bottom_bask {c |}
         et {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 233.467673       50.75       50.75
{txt}          1 {c |}{res} 226.532327       49.25      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        460      100.00

{txt}{hline}
-> spdomain = Central Rural

bottom_bask {c |}
         et {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 285.075201       50.55       50.55
{txt}          1 {c |}{res} 278.924799       49.45      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        564      100.00

{txt}{hline}
-> spdomain = Eastern

bottom_bask {c |}
         et {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 348.971102       50.07       50.07
{txt}          1 {c |}{res} 348.028898       49.93      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        697      100.00

{txt}{hline}
-> spdomain = Northern

bottom_bask {c |}
         et {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 347.620933       50.02       50.02
{txt}          1 {c |}{res} 347.379067       49.98      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        695      100.00

{txt}{hline}
-> spdomain = Western

bottom_bask {c |}
         et {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 351.585126       50.01       50.01
{txt}          1 {c |}{res} 351.414874       49.99      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        703      100.00

{txt}{hline}
-> spdomain = .
no observations


{com}.                                         lab var bottom_basket "=1 if in bottom (60%) of PCE";
{txt}
{com}.                                         sort hhid;
{txt}
{com}.                                                                 save "$path/work/bottom_basket.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/bottom_basket.dta saved

{com}.         restore;
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/bottom_basket.dta";
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)
(label lregion already defined)
(label lsurvquar already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        115        0.34        0.34
{txt}          3 {c |}{res}     33,233       99.66      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     33,348      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.                         * Only keep price observations for the poor ;
.         keep if bottom_basket==1;
{txt}(20996 observations deleted)

{com}.         **************************************************************************;
. * Toss out the bottom 5% and top 5% of the HH-LEVEL prices per kg in
> * for each spdomain & product combination. This should eliminate outliers
> * that may have an undue influence on the price calculation. 
> **************************************************************************;
.                 gen hhppkg=value_r/quantity;
{txt}(17 missing values generated)

{com}.                 egen lower5=pctile(hhppkg), p(5) by(spdomain product);
{txt}(17 missing values generated)

{com}.                 egen upper5=pctile(hhppkg), p(95) by(spdomain product);
{txt}(17 missing values generated)

{com}. sum;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}hhid {c |}{res}     12352    2.31e+09    1.18e+09   1.02e+09   4.19e+09
{txt}{space 5}product {c |}{res}     12335    129.2812    16.03414        100        154
{txt}{space 7}value {c |}{res}     12335    207.2503    291.3657   2.857143       4200
{txt}{space 8}unit {c |}{res}     12335           1           0          1          1
{txt}{space 4}food_cat {c |}{res}     12335           1           0          1          1
{txt}{hline 13}{c +}{hline 56}
{space 4}quantity {c |}{res}     12335    1.069382    3.051545   .0002857      135.2
{txt}{space 7}count {c |}{res}     12335           1           0          1          1
{txt}{space 6}numreg {c |}{res}     12335    4.007296    1.348036          1          5
{txt}{space 4}survquar {c |}{res}     12352    2.455149    1.429734          1          5
{txt}{space 5}reg_tpi {c |}{res}     12352    2.217212    1.170655          1          4
{txt}{hline 13}{c +}{hline 56}
{space 4}spdomain {c |}{res}     12352    3.038941    1.396767          1          5
{txt}{space 4}tpi_trim {c |}{res}     12352    .9958938    .0821045   .8591004   1.223628
{txt}{space 5}value_r {c |}{res}     12335    207.9584    289.5788    2.75269       4200
{txt}{space 1}cons_pc_nom {c |}{res}     12352    635.1346    344.6575   103.3254   1949.757
{txt}{space 4}hhweight {c |}{res}     12352    1769.408     712.246   140.8407   5553.862
{txt}{hline 13}{c +}{hline 56}
{space 8}bswt {c |}{res}     12352           1           0          1          1
{txt}{space 6}hhsize {c |}{res}     12352    6.443491    2.985493          1         29
{txt}{space 1}cons_hh_nom {c |}{res}     12352    3940.417    2690.047        150   27429.27
{txt}{space 1}food_pc_nom {c |}{res}     12352     398.762    189.5894          0   1347.619
{txt}{space 3}nf_pc_nom {c |}{res}     12352    236.3726    201.0937          0   1344.332
{txt}{hline 13}{c +}{hline 56}
{space 1}food_pc_tpi {c |}{res}     12352    397.2113    176.2312          0   1298.352
{txt}{space 1}cons_pc_tpi {c |}{res}     12352    633.5839     328.135   106.8324   1747.104
{txt}{space 3}pctile_60 {c |}{res}     12352     904.575    414.6753   501.5237   1751.113
{txt}bottom_bas~t {c |}{res}     12352           1           0          1          1
{txt}{space 6}hhppkg {c |}{res}     12335    795.7898    1088.115   6.223299   48172.07
{txt}{hline 13}{c +}{hline 56}
{space 6}lower5 {c |}{res}     12335    347.6065    406.6277   14.10155   2832.963
{txt}{space 6}upper5 {c |}{res}     12335    1608.903    1555.171   47.68716   10201.06
{txt}
{com}. describe;

{txt}Contains data from {res}/tmp/St02564.000001
{txt}  obs:{res}        12,352                          
{txt} vars:{res}            27                          10 Mar 2014 14:47
{txt} size:{res}     1,445,184                          (_dta has notes)
{txt}{hline}
              storage  display     value
variable name   type   format      label      variable label
{hline}
{p 0 48}{res}{bind:hhid           }{txt}{bind: double }{bind:{txt}%10.0g     }{space 1}{bind:         }{bind:  }{res}{res}household id{p_end}
{p 0 48}{bind:product        }{txt}{bind: float  }{bind:{txt}%34.0g     }{space 1}{bind:H14AQ2   }{bind:  }{res}{res}Food product code: numerical{p_end}
{p 0 48}{bind:value          }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}daily value of consumption in UGX per per household{p_end}
{p 0 48}{bind:unit           }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}set equal to one since all observations are converted into kg{p_end}
{p 0 48}{bind:food_cat       }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}food category equals 1, if product is food and 0 if non food{p_end}
{p 0 48}{bind:quantity       }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}daily quantity consumed in Kgs per household{p_end}
{p 0 48}{bind:count          }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}{p_end}
{p 0 48}{bind:numreg         }{txt}{bind: double }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}number of goods in the basket{p_end}
{p 0 48}{bind:survquar       }{txt}{bind: float  }{bind:{txt}%20.0g     }{space 1}{txt}lsurvquar{p_end}
{p 0 48}{space 44}{bind:  }{res}{res}Sequential Survey Quarter (May-Nov'05 & May-Nov '06){p_end}
{p 0 48}{bind:reg_tpi        }{txt}{bind: byte   }{bind:{txt}%9.0g      }{space 1}{bind:lregion  }{bind:  }{res}{res}Regions used for temporal price index calculations{p_end}
{p 0 48}{bind:spdomain       }{txt}{bind: float  }{bind:{txt}%13.0g     }{space 1}{txt}lspdomain{p_end}
{p 0 48}{space 44}{bind:  }{res}{res}Spatial domains: each with own poverty line (they are 5){p_end}
{p 0 48}{bind:tpi_trim       }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}TRIMMED Temporal price index (Q4=1){p_end}
{p 0 48}{bind:value_r        }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}{p_end}
{p 0 48}{bind:cons_pc_nom    }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}{p_end}
{p 0 48}{bind:hhweight       }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}Household sample weight{p_end}
{p 0 48}{bind:bswt           }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}bootstrap weights; and all equal to 1 for all households, as a toolkit requireme{p_end}
{p 0 48}{bind:hhsize         }{txt}{bind: long   }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}number of household menbers{p_end}
{p 0 48}{bind:cons_hh_nom    }{txt}{bind: double }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}(sum) cod_hh_nom{p_end}
{p 0 48}{bind:food_pc_nom    }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}nominal food consumption per capita{p_end}
{p 0 48}{bind:nf_pc_nom      }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}nominal non-food consumption per capita{p_end}
{p 0 48}{bind:food_pc_tpi    }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}Temp-adjusted per capita food consumption/day{p_end}
{p 0 48}{bind:cons_pc_tpi    }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}Temp adjusted total consumption/day{p_end}
{p 0 48}{bind:pctile_60      }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}(p 50) cons_pc_tpi{p_end}
{p 0 48}{bind:bottom_basket  }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}=1 if in bottom (60%) of PCE{p_end}
{p 0 48}{bind:hhppkg         }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}{p_end}
{p 0 48}{bind:lower5         }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}{p_end}
{p 0 48}{bind:upper5         }{txt}{bind: float  }{bind:{txt}%9.0g      }{space 1}{bind:         }{bind:  }{res}{res}{p_end}
{txt}{hline}
Sorted by:  
{res}     Note:  dataset has changed since last saved
{txt}
{com}. keep if hhppkg-lower5>=0 & hhppkg-upper5<=0;
{txt}(882 observations deleted)

{com}. *********************************************************************
> * Note that we do prices in three ways. First, by summing quantity and value 
> * This average price price_unitw is thus quantity/value weighted. Second, we
> * calculate the price and take simple means for a transaction weighted
> * price, price_unitt. Last we take the median, price_unitm. But in the end
> * we only use price_unitw
> *********************************************************************;
.         gen price_unitt=value_r/(quantity*1000);
{txt}
{com}.         gen price_unitm=price_unitt;
{txt}
{com}.                 *CA modified to count the boot sample weight bswt;
.         collapse (sum) quantity value_r count bswt 
>                  (mean) price_unitt 
>                  (median) price_unitm [aw=hhweight], by(spdomain product);
{txt}
{com}.         *Generate weighted price per gram ;
.         gen price_unitw=value_r/(quantity*1000);
{txt}
{com}.         drop value_r quantity;
{txt}
{com}.         sort spdomain product;
{txt}
{com}.         lab var price_unitt "simple average of calculated prices - transaction weighted";
{txt}
{com}.         lab var price_unitm "median of prices";
{txt}
{com}.         lab var price_unitw "value share weighted mean prices";
{txt}
{com}. * Get an idea of the difference between the price measures;
.         gen ratiotw=price_unitt/price_unitw;
{txt}
{com}.         gen ratiomw=price_unitm/price_unitw;
{txt}
{com}.         sum ratiotw ratiomw;

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}ratiotw {c |}{res}       184    1.219561    .3580905   .9057599   3.137953
{txt}{space 5}ratiomw {c |}{res}       184    1.054696    .2695414   .4358797   2.686314
{txt}
{com}.         sort product;
{txt}
{com}.         merge product using "$path/work/codes_food_basket_flex.dta";
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          2        1.08        1.08
{txt}          3 {c |}{res}        184       98.92      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        186      100.00
{txt}
{com}.         count if _merge~=3;
{res}    2
{txt}
{com}.         drop if _merge~=3;
{txt}(2 observations deleted)

{com}.         drop _merge;
{txt}
{com}.         sort product spdomain;
{txt}
{com}. save "$path/work/price_unit_flex.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/price_unit_flex.dta saved

{com}. ****************************************************************************************
> * 110_price_unit_flex.do                (end)
> ****************************************************************************************;
. cap log close;
{txt}
{com}. 
{txt}end of do-file

{com}. do "$path/new/120_povline_food_flex_original.do"/* Flexible basket: Poverty line */
{txt}
{com}. *global path "C:/user/gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/120_povline_food_flex.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/120_povline_food_flex.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:27
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 120_povline_food_flex.do      (start)
> *
> * Use the file with the food basket (food_basket_flex), which is in shares. 
> * Then merge it with the prices file, and then with the calories file.
> * Along the way, drop those observations where we have no price information
> * or no calorie information.
> **************************************************************************;
. /*
> This file uses:
>         work/food_basket_flex.dta
>         work/price_unit_flex.dta
>         work/calperg.dta
>         work/calpp.dta
> 
> This file creates:
>         work/povline_flex.dta
> */
> 
> 
> * start with the quantity information;
. use "$path/work/food_basket_flex.dta";
{txt}
{com}.         sort product spdomain;
{txt}
{com}.         * merge in price information;
.         merge product spdomain using "$path/work/price_unit_flex.dta";
{txt}(label lspdomain already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          6        3.16        3.16
{txt}          2 {c |}{res}         63       33.16       36.32
{txt}          3 {c |}{res}        121       63.68      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        190      100.00
{txt}
{com}.         list product spdomain if _merge==1;
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c TRC}
     {c |} {res}product        spdomain {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
122. {c |} {res}    157   Central Urban {txt}{c |}
123. {c |} {res}    157   Central Rural {txt}{c |}
124. {c |} {res}    157         Eastern {txt}{c |}
125. {c |} {res}    161   Central Urban {txt}{c |}
126. {c |} {res}    161         Eastern {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
127. {c |} {res}    161        Northern {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c BRC}

{com}.         drop if _merge ~=3;
{txt}(69 observations deleted)

{com}.         drop _merge;
{txt}
{com}.         sort product;
{txt}
{com}.         * merge in information on calories per gram;
.         merge product using "$path/work/calperg.dta";
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}         25       17.12       17.12
{txt}          3 {c |}{res}        121       82.88      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        146      100.00
{txt}
{com}.         * This tells where we are lacking calorie info or are lacking quantity info due to 
>         * missing price info above;
.         list product spdomain if _merge==1;
{txt}
{com}.         drop if _merge~=3;
{txt}(25 observations deleted)

{com}.         drop _merge;
{txt}
{com}.         sort spdomain f_share_w;
{txt}
{com}.                 * CA modified to handle bootstrap counting;
.         * determine if any quantity has fewer than 10 price observations;
.         by spdomain: count if round(bswt)<10;

{txt}{hline}
-> spdomain = Central Urban
{res}    0
{txt}{hline}
-> spdomain = Central Rural
{res}    0
{txt}{hline}
-> spdomain = Eastern
{res}    0
{txt}{hline}
-> spdomain = Northern
{res}    0
{txt}{hline}
-> spdomain = Western
{res}    0
{txt}
{com}.         drop if round(bswt) < 10;
{txt}(0 observations deleted)

{com}.         by spdomain: egen baskshr=sum(f_share_w);
{txt}
{com}.         by spdomain: gen cumshr1=sum(f_share_w);
{txt}
{com}.         * bundle was cut at 92.5 percent- cut back to 90 percent if necessary;
.         drop if cumshr1<=baskshr-.9;
{txt}(6 observations deleted)

{com}.         * reobtain the share represented from the average basket- should be slightly more than 90;
.         drop baskshr;
{txt}
{com}.         by spdomain: egen baskshr=sum(f_share_w);
{txt}
{com}.         by spdomain: sum baskshr;

{txt}{hline}
-> spdomain = Central Urban

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}baskshr {c |}{res}        20    .8686488           0   .8686488   .8686488

{txt}{hline}
-> spdomain = Central Rural

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}baskshr {c |}{res}        21    .9048939           0   .9048939   .9048939

{txt}{hline}
-> spdomain = Eastern

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}baskshr {c |}{res}        27    .9076297           0   .9076297   .9076297

{txt}{hline}
-> spdomain = Northern

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}baskshr {c |}{res}        25    .9019189           0   .9019189   .9019189

{txt}{hline}
-> spdomain = Western

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 5}baskshr {c |}{res}        22    .9024827           0   .9024827   .9024827

{txt}
{com}.         * obtain quantities and calories provided by these quantities;
.         gen quan=f_share_w/price_unitw;
{txt}
{com}.                         /* how many g in 1 MT exp on food item */
>         gen cal_ir=quan*calperg;
{txt}
{com}.                                 /* how many cal in 1 MT exp on food item */
>         by spdomain: egen calreg=sum(cal_ir);
{txt}
{com}.         /* how many cal in 1 MT exp in food basket*/
> 
>         * merge in calorie requirements;
.         sort spdomain;
{txt}
{com}.         merge spdomain using "$path/work/calpp.dta";
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}        115      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        115      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         * get the expansion factor to hit 95% of calorie requirements;
.         gen ratio=.95*calpp/calreg;
{txt}
{com}.                         replace quan=quan*ratio;
{txt}(115 real changes made)

{com}.         replace cal_ir=quan*calperg;
{txt}(109 real changes made)

{com}.         * do a consistency check;
.         sort spdomain;
{txt}
{com}.         by spdomain: egen chkcal=sum(cal_ir);
{txt}
{com}.         replace chkcal=chkcal/.95-calpp ;
{txt}(115 real changes made)

{com}.                         * these values should be about zero;
.         by spdomain: sum chkcal;

{txt}{hline}
-> spdomain = Central Urban

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}chkcal {c |}{res}        20   -.0001542           0  -.0001542  -.0001542

{txt}{hline}
-> spdomain = Central Rural

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}chkcal {c |}{res}        21    .0000771           0   .0000771   .0000771

{txt}{hline}
-> spdomain = Eastern

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}chkcal {c |}{res}        27   -.0000514           0  -.0000514  -.0000514

{txt}{hline}
-> spdomain = Northern

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}chkcal {c |}{res}        25   -.0000257           0  -.0000257  -.0000257

{txt}{hline}
-> spdomain = Western

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 6}chkcal {c |}{res}        22    .0000385           0   .0000385   .0000385

{txt}
{com}.         * obtain the value of each good in the bundle;
.         gen val_ir=quan*price_unitw;
{txt}
{com}.         * the sum of the value of the goods in the bundle is assumed to represent 90% of expenditure;
.         by spdomain: egen povline_f_flex90=sum(val_ir);
{txt}
{com}.         replace povline_f_flex=povline_f_flex90/.9;
{txt}(115 real changes made)

{com}.         collapse (mean) povline_f_flex, by (spdomain);
{txt}
{com}.                 lab var povline_f_flex "Food poverty line. Flexible basket";
{txt}
{com}.         sort spdomain;
{txt}
{com}.         keep spdomain povline_f_flex;
{txt}
{com}. save "$path/work/povline_food_flex.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povline_food_flex.dta saved

{com}. /*
> * To be used in 140_iterate.do;
> gen cutoff = 1.5 * povline_f_flex;
> keep spdomain cutoff;
> save "$path/work/povlines_first_iterate.dta", replace;
> */
> 
> **************************************************************************
> * 120_povline_food_flex.do      (end)
> **************************************************************************;
. log close;
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/120_povline_food_flex.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:47:27
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. do "$path/new/130_povmeas_flex.do"
{txt}
{com}. *global path "C:/user/gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/130_povmeas_flex.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/130_povmeas_flex.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:27
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 130_povmeas_flex.do           (start)
> *
> * Purpose:
> * Initial poverty measures calculation for flexible basket. (Before any iteration)
> **************************************************************************;
. *CA modified to add work/hhdata.dta for bootstrap;
. /*
> This file uses:
>         in/foodshr96.dta
>         work/povline_f_flex.dta
>         work/consump_nom.dta
>         work/hhdata.dta
>         work/temp_index_reg_tpi.dta
> 
> This file creates:
>         work/foodshr96.dta
>         work/povmeas.dta
>         work/povlines.dta
>         work/cons_real.dta
> */
> 
> 
> 
> **************************************************************************;
. * Bring in data file with nominal consumption per capita, and deflate it
> * by temporal price index.
> **************************************************************************;
. use "$path/work/hhdata.dta", clear;
{txt}
{com}.         keep hhid strata reg_tpi spdomain news rural survmon survquar;
{txt}
{com}.         tab reg_tpi, miss;

    {txt}Regions {c |}
   used for {c |}
   temporal {c |}
price index {c |}
calculation {c |}
          s {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
    Central {c |}{res}      1,024       32.79       32.79
{txt}    Eastern {c |}{res}        697       22.32       55.11
{txt}   Northern {c |}{res}        695       22.25       77.36
{txt}    Western {c |}{res}        703       22.51       99.87
{txt}          . {c |}{res}          4        0.13      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,123      100.00
{txt}
{com}.         tab survquar, miss;

   {txt}Sequential Survey {c |}
 Quarter (May-Nov'05 {c |}
      & May-Nov '06) {c |}      Freq.     Percent        Cum.
{hline 21}{c +}{hline 35}
   May '05 - Jul-'05 {c |}{res}      1,057       33.85       33.85
{txt}          Aug-Oct 05 {c |}{res}        941       30.13       63.98
{txt}Nov '05 & May-Jun 06 {c |}{res}         60        1.92       65.90
{txt}       Jul-Sept 2006 {c |}{res}        818       26.19       92.09
{txt}         Oct-Nov '06 {c |}{res}        243        7.78       99.87
{txt}                   . {c |}{res}          4        0.13      100.00
{txt}{hline 21}{c +}{hline 35}
               Total {c |}{res}      3,123      100.00
{txt}
{com}.         keep hhid spdomain reg_tpi survquar;
{txt}
{com}.         sort hhid;
{txt}
{com}.         tempfile spdomainreg_tpi;
{txt}
{com}. save `spdomainreg_tpi', replace;
{txt}(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved

{com}. use "$path/work/conpc.dta", clear;
{txt}
{com}. *use "$path/work/consump_nom.dta", clear;
. *CA modified to merge in work/hhdata.dta for bootstrap;
.     sort hhid;
{txt}
{com}.     merge hhid using "$path/work/hhdata.dta";
{txt}
{com}.     tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.     drop _m;
{txt}
{com}.         keep hhid hhweight hhsize cons_pc_nom ;
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using `spdomainreg_tpi';
{txt}(label lsurvquar already defined)
(label lregion already defined)
(label lspdomain already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         sort reg_tpi survquar;
{txt}
{com}.         merge reg_tpi survquar using "$path/work/temp_index_reg_tpi.dta";
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
survquar
do not uniquely identify observations in
the master data
{p_end}
(label lsurvquar already defined)
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         15        0.48        0.48
{txt}          3 {c |}{res}      3,109       99.52      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/conpc.dta";
{txt}
{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         gen food_pc_tpi  = food_pc_nom /tpi_trim;
{txt}(15 missing values generated)

{com}.         lab var food_pc_tpi "Temp-adjusted per capita food consumption/day";
{txt}
{com}.                 gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
{txt}(16 missing values generated)

{com}.         lab var cons_pc_tpi "Temp adjusted total consumption/day";
{txt}
{com}.         gen one=1;
{txt}
{com}. * TPI deflated per capita consumption ;
.         tempfile contpi;
{txt}
{com}. save `contpi', replace;
{txt}(note: file /tmp/St02564.000002 not found)
file /tmp/St02564.000002 saved

{com}. **************************************************************************
> * Calculate non-food expenditure for HH around the food poverty line
> *
> * Develop a discrete triangular weighted distribution. This gives a
> * weight of  1 to HH at +/- 18-20% from food poverty line, and
> * weight of  2 to HH at +/- 16-18% from food poverty line, and ...
> * weight of 10 to HH at +/-  0- 2% from food poverty line.
> * This weight is called triwt below.
> **************************************************************************;
. use `contpi';
{txt}
{com}.         sort spdomain;
{txt}
{com}.         merge spdomain using "$path/work/povline_food_flex.dta";
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}. gen     triwt = 0 ;
{txt}
{com}. replace triwt = 11 - round(50*abs(cons_pc_tpi/povline_f_flex-1)+0.5)
>                 if abs(cons_pc_tpi/povline_f_flex-1)<=0.2;
{txt}(225 real changes made)

{com}.                                         * Nearness to poverty line and population weights ;
.         gen tripopwt=triwt*hhweight*hhsize;
{txt}(5 missing values generated)

{com}.         preserve;
{txt}
{com}.                 collapse (mean) nf_pc_nom [aw=tripopwt] ,
>                         by(spdomain);
{txt}
{com}.                                         rename nf_pc_nom povline_na_flex;
{txt}
{com}.                 lab var povline_na_flex "Nonfood poverty line. Flexible bundle";
{txt}
{com}.                                 tempfile znf;
{txt}
{com}.                 sort spdomain;
{txt}
{com}.                 save `znf', replace;
{txt}(note: file /tmp/St02564.000004 not found)
file /tmp/St02564.000004 saved

{com}.                 tab spdomain;

      {txt}Spatial {c |}
domains: each {c |}
     with own {c |}
 poverty line {c |}
 (they are 5) {c |}      Freq.     Percent        Cum.
{hline 14}{c +}{hline 35}
Central Urban {c |}{res}          1       20.00       20.00
{txt}Central Rural {c |}{res}          1       20.00       40.00
{txt}      Eastern {c |}{res}          1       20.00       60.00
{txt}     Northern {c |}{res}          1       20.00       80.00
{txt}      Western {c |}{res}          1       20.00      100.00
{txt}{hline 14}{c +}{hline 35}
        Total {c |}{res}          5      100.00
{txt}
{com}.         restore;
{txt}
{com}.         sort spdomain;
{txt}
{com}.         merge spdomain using `znf';
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}. **************************************************************************;
. * Poverty line is the sum of the food and non-food poverty lines
> **************************************************************************;
.         gen povline_flex=povline_f_flex + povline_na_flex;
{txt}(5 missing values generated)

{com}.         lab var povline_flex "Poverty line. Flexible bundle";
{txt}
{com}.         sort spdomain;
{txt}
{com}. save "$path/work/povlines.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines.dta saved

{com}. **************************************************************************;
. * Create spatial price index, based on the total poverty line, with
> * adjustment so that mean (and total) nominal consumption equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first: we just use the first stratum.
> **************************************************************************;
. use `contpi';
{txt}
{com}.         sort spdomain;
{txt}
{com}.         merge spdomain using "$path/work/povlines.dta";
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines.dta
{p_end}
(label lsurvquar already defined)
(label lregion already defined)
(label lspdomain already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         * Real consumption pc, temporally deflated ;
.         gen cr= cons_pc_tpi ;
{txt}(16 missing values generated)

{com}.         * Poverty line;
.         gen linpob=povline_flex;
{txt}(5 missing values generated)

{com}.         *qui sum linpob if spdomain==1, meanonly;
.         sum linpob if spdomain==3, meanonly;
{txt}
{com}.         global spi_base=r(mean);
{txt}
{com}.         * Spatial price index ;
.         gen spi=linpob/$spi_base;
{txt}(5 missing values generated)

{com}.         * Real consumption pc, temporally and spatially deflated ;
.         gen cr2=cr/spi;
{txt}(16 missing values generated)

{com}.         qui sum cr [aw=hhweight*hhsize];
{txt}
{com}.         global sumcr=r(sum);
{txt}
{com}.         qui sum cr2 [aw=hhweight*hhsize];
{txt}
{com}.         global sumcr2=r(sum);
{txt}
{com}.         replace spi=spi*$sumcr2/$sumcr;
{txt}(3119 real changes made)

{com}.         gen linpobr=linpob/spi;
{txt}(5 missing values generated)

{com}.         replace cr2=cr/spi;
{txt}(3108 real changes made)

{com}.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 9}cr2 {c |}{res}    3108  28069559.9    1060.929   964.5924   121.2709   20278.26
{txt}{space 6}linpob {c |}{res}    3119  28164219.1    439.7007   65.93853   314.1105   553.3799
{txt}{space 5}linpobr {c |}{res}    3119  28164219.1    450.0774   .0000115   450.0774   450.0775
{txt}
{com}.         lab var cr      "Temporally-adjusted cons pc";
{txt}
{com}.         lab var cr2     "Spatially & temporally adjusted cons pc";
{txt}
{com}.         lab var linpob  "Poverty line";
{txt}
{com}.         lab var linpobr "Real poverty line";
{txt}
{com}.         lab var spi     "Spatial price index";
{txt}
{com}. **************************************************************************
> * calculate poverty measures with the flexible food bundle
> **************************************************************************;
.         gen h = 100     if cr <=(linpob);
{txt}(2728 missing values generated)

{com}.         replace  h = 0 if cr > (linpob);
{txt}(2728 real changes made)

{com}.                         gen             pg      = ((linpob - cr )/linpob) *100;
{txt}(16 missing values generated)

{com}.         replace         pg      = 0             if h==0;
{txt}(2728 real changes made)

{com}.         gen             spg     = ((( linpob - cr )/ linpob )^2)*100;
{txt}(16 missing values generated)

{com}.         replace         spg     = 0             if h==0;
{txt}(2728 real changes made)

{com}.         gen h_flex=h;
{txt}
{com}.         gen pg_flex=pg;
{txt}(5 missing values generated)

{com}.         gen spg_flex=spg;
{txt}(5 missing values generated)

{com}.         lab var h_flex   "Poverty headcount. Flex bundle";
{txt}
{com}.         lab var pg_flex  "Poverty gap. Flex bundle";
{txt}
{com}.         lab var spg_flex "Squared poverty gap. Flex bundle";
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/hhdata.dta";
{txt}(label lspdomain already defined)
(label lregion already defined)
(label lsurvquar already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop if _merge~=3;
{txt}(1 observation deleted)

{com}.         drop _merge;
{txt}
{com}.         gen popwt=hhsize*hhweight;
{txt}(4 missing values generated)

{com}.                 * Stata 10.1 syntax ;
.         svyset , clear;
{txt}
{com}.         svyset [pweight=popwt] , str(strata) psu(psu);

      {txt}pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}

{com}.         svy: mean h_flex pg_flex spg_flex;
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 6}h_flex {c |}{col 14}{res}{space 2}  15.2935{col 26}{space 2} .9731112{col 37}{space 5} 13.37884{col 51}{space 3} 17.20817
{txt}{space 5}pg_flex {c |}{col 14}{res}{space 2} 3.344332{col 26}{space 2}  .267422{col 37}{space 5}  2.81816{col 51}{space 3} 3.870504
{txt}{space 4}spg_flex {c |}{col 14}{res}{space 2} 1.133443{col 26}{space 2}  .114167{col 37}{space 5} .9088111{col 51}{space 3} 1.358075
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_flex pg_flex spg_flex , over(rural);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex       {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2}  3.49787{col 26}{space 2} .9220902{col 37}{space 5} 1.683591{col 51}{space 3} 5.312149
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 17.75513{col 26}{space 2}     1.15{col 37}{space 5} 15.49242{col 51}{space 3} 20.01783
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6972157{col 26}{space 2}  .221734{col 37}{space 5} .2609381{col 51}{space 3} 1.133493
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 3.896757{col 26}{space 2} .3170604{col 37}{space 5} 3.272918{col 51}{space 3} 4.520597
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex     {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .2591101{col 26}{space 2} .1154087{col 37}{space 5}  .032035{col 51}{space 3} .4861851
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 1.315907{col 26}{space 2}  .134715{col 37}{space 5} 1.050845{col 51}{space 3} 1.580968
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_flex pg_flex spg_flex , over(news);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

      {txt}Central: news = {res}Central
      {txt}Eastern: news = {res}Eastern
     {txt}Northern: news = {res}Northern
      {txt}Western: news = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex       {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 8.300454{col 26}{space 2} 1.307511{col 37}{space 5} 5.727831{col 51}{space 3} 10.87308
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 19.46877{col 26}{space 2} 1.956764{col 37}{space 5} 15.61869{col 51}{space 3} 23.31884
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 20.48259{col 26}{space 2} 2.725485{col 37}{space 5}    15.12{col 51}{space 3} 25.84518
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.40297{col 26}{space 2} 1.984944{col 37}{space 5} 12.49745{col 51}{space 3} 20.30849
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex      {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 1.718851{col 26}{space 2} .3296987{col 37}{space 5} 1.070145{col 51}{space 3} 2.367557
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2}   4.0511{col 26}{space 2}  .522677{col 37}{space 5} 3.022696{col 51}{space 3} 5.079505
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 5.077992{col 26}{space 2} .8763631{col 37}{space 5} 3.353685{col 51}{space 3}   6.8023
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.508019{col 26}{space 2} .5252969{col 37}{space 5} 2.474459{col 51}{space 3} 4.541578
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex     {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2}  .544989{col 26}{space 2} .1404603{col 37}{space 5} .2686232{col 51}{space 3} .8213547
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.349988{col 26}{space 2} .2284443{col 37}{space 5} .9005072{col 51}{space 3} 1.799468
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.749897{col 26}{space 2} .3554885{col 37}{space 5} 1.050448{col 51}{space 3} 2.449346
{txt}{space 5}Western {c |}{col 14}{res}{space 2}  1.23619{col 26}{space 2} .2350781{col 37}{space 5} .7736573{col 51}{space 3} 1.698724
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_flex pg_flex spg_flex , over(reg_tpi);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

      {txt}Central: reg_tpi = {res}Central
      {txt}Eastern: reg_tpi = {res}Eastern
     {txt}Northern: reg_tpi = {res}Northern
      {txt}Western: reg_tpi = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex       {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 8.300454{col 26}{space 2} 1.307511{col 37}{space 5} 5.727831{col 51}{space 3} 10.87308
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 19.46877{col 26}{space 2} 1.956764{col 37}{space 5} 15.61869{col 51}{space 3} 23.31884
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 20.48259{col 26}{space 2} 2.725485{col 37}{space 5}    15.12{col 51}{space 3} 25.84518
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.40297{col 26}{space 2} 1.984944{col 37}{space 5} 12.49745{col 51}{space 3} 20.30849
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex      {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 1.718851{col 26}{space 2} .3296987{col 37}{space 5} 1.070145{col 51}{space 3} 2.367557
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2}   4.0511{col 26}{space 2}  .522677{col 37}{space 5} 3.022696{col 51}{space 3} 5.079505
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 5.077992{col 26}{space 2} .8763631{col 37}{space 5} 3.353685{col 51}{space 3}   6.8023
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.508019{col 26}{space 2} .5252969{col 37}{space 5} 2.474459{col 51}{space 3} 4.541578
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex     {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2}  .544989{col 26}{space 2} .1404603{col 37}{space 5} .2686232{col 51}{space 3} .8213547
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.349988{col 26}{space 2} .2284443{col 37}{space 5} .9005072{col 51}{space 3} 1.799468
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.749897{col 26}{space 2} .3554885{col 37}{space 5} 1.050448{col 51}{space 3} 2.449346
{txt}{space 5}Western {c |}{col 14}{res}{space 2}  1.23619{col 26}{space 2} .2350781{col 37}{space 5} .7736573{col 51}{space 3} 1.698724
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_flex pg_flex spg_flex , over(strata);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex       {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.067417{col 26}{space 2} 1.009692{col 37}{space 5} .0807763{col 51}{space 3} 4.054058
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.83287{col 26}{space 2} 2.005974{col 37}{space 5} 7.885974{col 51}{space 3} 15.77977
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 20.65156{col 26}{space 2} 2.096198{col 37}{space 5} 16.52714{col 51}{space 3} 24.77598
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 9.623426{col 26}{space 2} 4.111047{col 37}{space 5} 1.534644{col 51}{space 3} 17.71221
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 22.25124{col 26}{space 2} 3.087229{col 37}{space 5} 16.17689{col 51}{space 3} 28.32558
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}  3.43429{col 26}{space 2} 1.887055{col 37}{space 5}-.2786256{col 51}{space 3} 7.147206
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.24875{col 26}{space 2} 2.104325{col 37}{space 5} 13.10834{col 51}{space 3} 21.38916
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4322447{col 26}{space 2} .2277505{col 37}{space 5}-.0158709{col 51}{space 3} .8803603
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.448003{col 26}{space 2}  .504024{col 37}{space 5}   1.4563{col 51}{space 3} 3.439707
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .6200867{col 26}{space 2} .3669826{col 37}{space 5} -.101978{col 51}{space 3} 1.342151
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.322212{col 26}{space 2} .5621175{col 37}{space 5} 3.216205{col 51}{space 3} 5.428218
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.161993{col 26}{space 2} 1.117685{col 37}{space 5} -.037132{col 51}{space 3} 4.361118
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.552926{col 26}{space 2} 1.000756{col 37}{space 5} 3.583867{col 51}{space 3} 7.521986
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .4921216{col 26}{space 2} .3535844{col 37}{space 5}-.2035812{col 51}{space 3} 1.187824
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.704706{col 26}{space 2} .5561841{col 37}{space 5} 2.610374{col 51}{space 3} 4.799038
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1836988{col 26}{space 2} .1344806{col 37}{space 5}-.0809014{col 51}{space 3}  .448299
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .7497412{col 26}{space 2}  .206323{col 37}{space 5} .3437857{col 51}{space 3} 1.155697
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1175462{col 26}{space 2} .0900193{col 37}{space 5}-.0595733{col 51}{space 3} .2946657
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.447373{col 26}{space 2}  .246093{col 37}{space 5} .9631672{col 51}{space 3} 1.931578
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} .7994442{col 26}{space 2} .5211737{col 37}{space 5}-.2260026{col 51}{space 3} 1.824891
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 1.904699{col 26}{space 2} .4036793{col 37}{space 5} 1.110431{col 51}{space 3} 2.698967
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}  .152026{col 26}{space 2} .1384592{col 37}{space 5}-.1204025{col 51}{space 3} .4244545
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.306896{col 26}{space 2} .2489831{col 37}{space 5}  .817004{col 51}{space 3} 1.796788
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_flex pg_flex spg_flex , over(spdomain);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex       {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.067417{col 26}{space 2} 1.009692{col 37}{space 5} .0807763{col 51}{space 3} 4.054058
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.83287{col 26}{space 2} 2.005974{col 37}{space 5} 7.885974{col 51}{space 3} 15.77977
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 19.46877{col 26}{space 2} 1.956764{col 37}{space 5} 15.61869{col 51}{space 3} 23.31884
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 20.48259{col 26}{space 2} 2.725485{col 37}{space 5}    15.12{col 51}{space 3} 25.84518
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.40297{col 26}{space 2} 1.984944{col 37}{space 5} 12.49745{col 51}{space 3} 20.30849
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4322447{col 26}{space 2} .2277505{col 37}{space 5}-.0158709{col 51}{space 3} .8803603
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.448003{col 26}{space 2}  .504024{col 37}{space 5}   1.4563{col 51}{space 3} 3.439707
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2}   4.0511{col 26}{space 2}  .522677{col 37}{space 5} 3.022696{col 51}{space 3} 5.079505
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 5.077992{col 26}{space 2} .8763631{col 37}{space 5} 3.353685{col 51}{space 3}   6.8023
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.508019{col 26}{space 2} .5252969{col 37}{space 5} 2.474459{col 51}{space 3} 4.541578
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1836988{col 26}{space 2} .1344806{col 37}{space 5}-.0809014{col 51}{space 3}  .448299
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .7497412{col 26}{space 2}  .206323{col 37}{space 5} .3437857{col 51}{space 3} 1.155697
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.349988{col 26}{space 2} .2284443{col 37}{space 5} .9005072{col 51}{space 3} 1.799468
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.749897{col 26}{space 2} .3554885{col 37}{space 5} 1.050448{col 51}{space 3} 2.449346
{txt}{space 5}Western {c |}{col 14}{res}{space 2}  1.23619{col 26}{space 2} .2350781{col 37}{space 5} .7736573{col 51}{space 3} 1.698724
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         compress;
{txt}hhsize was {res}long{txt} now {res}byte
{txt}survquar was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}one was {res}float{txt} now {res}byte
{txt}triwt was {res}float{txt} now {res}byte
{txt}h was {res}float{txt} now {res}byte
{txt}h_flex was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}bswt was {res}float{txt} now {res}byte
{txt}
{com}.         sort hhid;
{txt}
{com}. save "$path/work/cons_real.dta" , replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_real.dta saved

{com}.         collapse  (mean) h_flex pg_flex spg_flex [aw=hhweight*hhsize];
{txt}
{com}. save "$path/work/povmeas.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povmeas.dta saved

{com}. *** HARUNA, the file Povmeas.dta gives the headcount poverty rates using flexible food bundle without inflicting reveales preferences
> *** therefore specifications in line 226 of this do file have been changed repeatedly to generate these counts for particular
> *** classifications of interest including strata spdomain region urban/rural (urban) and national (done by removing the by command 
> **************************************************************************
> * 130_povmeas_flex.do           (end)
> **************************************************************************;
. log close;
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/130_povmeas_flex.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:47:27
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. do "$path/new/140_iterate_bjorn.do" $it_n $bottom
{txt}
{com}. *global path "C:/user/gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/140_iterate.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/140_iterate.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:35
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. *global povline_initial "$path/in/povlines_first_iof.dta";
. **************************************************************************
> * 140_iterate.do        (start)
> *
> * Purpose: Create flexible food basket and poverty line with iterative procedure
> *
> * This program will take the results from the first pass at the
> * poverty lines and applies the corresponding spatial deflator to
> * re-select the relatively poor, their consumption bundles, and
> * their prices.
> *
> * Welfare indicator is here always temporally and spatially adjusted per capita
> * expenditure. Here called cr_it< >.
> *
> * We will iterate this process 5 times which here assures convergence.
> *
> * CA, Mar 2010: Relatively poor are those below last iterated poverty line
> * MAH, Apr 2010: Cleaning
> * URB, feb 2012: Commented out "drop if unit~=2"
> **************************************************************************;
. /*
> This file uses:
>             in/povlines_first_new.dta
>         work/hhdata.dta
>         work/consump_nom.dta
>         work/own.dta
>         work/daily.dta
>         work/temp_index_reg_tpi.dta
>         work/cons_cod.dta
>         work/food_cat.dta
>         work/cons_real.dta
>         work/products.dta
>         work/match96_02.dta
>         new/conversions.do
>         
> This file creates (where `pass' is the number of the iteration):
>         work/codes_food_basket_flex_it`pass'.dta
>         work/price_unit_flex_it`pass'.dta
>         work/quan_flex_it`pass'.dta
>         work/match_cod_flex_it`pass'.csv
>         work/relpoor_it`pass'.dta
>         work/povlines_it`pass'.dta
>         work/foodshares_it`pass'.dta
>         work/nat_pov_flex.csv
>         work/rur_pov_flex.csv
>         work/strata_pov_flex.csv
>         work/spdomain_pov_flex.csv
>         work/reg_tpi_pov_flex.csv
> */
> 
> **************************************************************************;
. * Make a key file that will be used over and over, without change
> * in every iteration. This will include the TEMPORALLY deflated consumption
> * and various HH data such as hhweight, spdomain, etc.
> **************************************************************************;
. use "$path/work/conpc.dta";
{txt}
{com}.         sort hhid;
{txt}
{com}.         merg hhid using "$path/work/hhdata.dta";
{txt}
{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         sort reg_tpi survquar;
{txt}
{com}.         merge reg_tpi survquar using "$path/work/temp_index_reg_tpi.dta";
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
survquar
do not uniquely identify observations in
the master data
{p_end}
(label lsurvquar already defined)
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         15        0.48        0.48
{txt}          3 {c |}{res}      3,109       99.52      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.                 gen food_pc_tpi = food_pc_nom /tpi_trim;
{txt}(15 missing values generated)

{com}.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
{txt}(16 missing values generated)

{com}.         lab var food_pc_tpi "Temp-adjusted per capita food consumption/day";
{txt}
{com}.         lab var cons_pc_tpi "Temp adjusted total consumption/day";
{txt}
{com}.         tempfile contpi;
{txt}
{com}.         sort hhid;
{txt}
{com}. save `contpi', replace;
{txt}(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved

{com}. save contpi_, replace;
{txt}file contpi_.dta saved

{com}. *use "$path/in/povlines_first_iterate.dta", clear;
. *save "$path/work/povlines_first.dta", replace;
. **************************************************************************;
. * Now set some information pertaining to the iterations. For now we'll
> * manually set the number of iterations. Also specify the percentile
> * cutpoint that we will use for defining the relatively poor.
> **************************************************************************;
. local lastpass=0;
{txt}
{com}. local pass=1;
{txt}
{com}. * Use these two lines to manually specify the number of iterations
> * and the cutpoint here in the do file.;
.   *local maxit=5;
.   *local cutpt=50;
. * Use these few lines if you want to specify the number of iterations
> * and percentile cutpoint by passing them as parameters on the command
> * line, e.g.:   wstata do new/iterate1.do 5 50;
. if "`1'"=="" | "`2'"=="" {c -(}      ;
.         di in red "Error: you need to specify number of iterations as first parameter";
.         di in red "       and percentile cutpoint as second parameter on command line.";
. {c )-};
{txt}
{com}. local maxit `1';
{txt}
{com}. local cutpt `2';
{txt}
{com}. tempfile cutoff;
{txt}
{com}. di "**********************************************************************";
{res}**********************************************************************
{txt}
{com}. while `pass' <= `maxit' {c -(};
{txt}  2{com}.         **************************************************************************;
. **************************************************************************;
. * Pick out the bottom X percent in real consumption per capita 
> * (temporally & spatially adjusted), as ranked by the previous iteration.
> * The percentile to use is defined by "cutpt". This produces a file that
> * has the hhid, and a dummy variable indicating if they were below the
> * cutpoint on the last iteration.
> **************************************************************************;
. **************************************************************************;
. /*
> * Comment out if IOF 2008/09. (This code included instead of below code in order to replicate published figures 2002/03). ( START ) ;
> 
>         if "`pass'"=="1" {c -(}      ;
>               use `contpi', clear;
>               sort spdomain;
>               merge spdomain using "$path/work/povlines_first.dta";
>               tab _m;
>               drop _m;
> *              gen relpoor`pass'= cons_pc_tpi<=cutoff;
>                gen relpoor`pass'= cons_pc_tpi if cons_pc_tpi<=cutoff;
>               rename cons_pc_tpi cr_it0;
>               sort hhid;
>          save "$path/work/relpoor_it`pass'.dta", replace;
> *        use "$path/work/cons_real.dta", clear;
> *              gen cr_it0=cr2;
>         {c )-};
>         
> 
> * Comment out if IOF 2008/09. (This code included instead of below code in order to replicate published figures 2002/03). ( END ) ;
> */
> 
> 
> 
> * Comment out if IAF 2002/03. (This code below excluded in order to replicate published figures 2002/03). ( START ) ;
.         if "`pass'"=="1" {c -(} ;
{txt}  3{com}. * Find real income at cut point initially;
.                 use "$path/work/cons_real.dta", clear;
{txt}  4{com}.                                     gen cr_it0=cr2;
{txt}  5{com}.                         cap drop one;
{txt}  6{com}.             gen one=1;
{txt}  7{com}.                                     collapse (p`cutpt') one cr_it`lastpass' [aw=popwt] ;
{txt}  8{com}.                                     rename cr_it`lastpass' cutoff;
{txt}  9{com}.                                     sort one;
{txt} 10{com}.             save `cutoff', replace;
{txt} 11{com}.             save cutoff, replace;
{txt} 12{com}.  * Find relatively poor initially;
.             use "$path/work/cons_real.dta", clear;
{txt} 13{com}.                                                 gen cr_it`lastpass'=cr2;
{txt} 14{com}.             cap drop one;
{txt} 15{com}.             cap drop cutoff;
{txt} 16{com}.             gen one=1;
{txt} 17{com}.                                     sort one;
{txt} 18{com}.             merge one using `cutoff';
{txt} 19{com}.             tab _merge;
{txt} 20{com}.             drop _merge;
{txt} 21{com}.                                     drop one;
{txt} 22{com}.                            gen relpoor`pass'=cr_it`lastpass'<=cutoff;
{txt} 23{com}.             *lab var relpoor`pass' "=1 if in bottom of PCE";
.                                     tab relpoor`pass' [aw=popwt];
{txt} 24{com}.                                     keep hhid cr_it`lastpass' relpoor`pass' popwt;
{txt} 25{com}.             sort hhid;
{txt} 26{com}.         save "$path/work/relpoor_it`pass'.dta", replace;
{txt} 27{com}.         {c )-};
{txt} 28{com}. * Comment out if IAF 2002/03. (This code below excluded in order to replicate published figures 2002/03). ( END ) ;
.                 if `pass'>1 {c -(}   ;
{txt} 29{com}. * Find real income at cut point in iteration number `pass' ;
.                 use "$path/work/cons_real_it`lastpass'.dta" , clear;
{txt} 30{com}.                                                 cap drop one;
{txt} 31{com}.                 gen one=1;
{txt} 32{com}.                                                                 *CA modified from hhweight*hhsize to popwt;
.                 collapse (p`cutpt') one cr_it`lastpass' [aw=popwt] ;
{txt} 33{com}.                         rename cr_it`lastpass' cutoff;
{txt} 34{com}.                                                                         sort one;
{txt} 35{com}.         save `cutoff', replace;
{txt} 36{com}.         * Find relatively poor in iteration number `pass' ;
.                 use "$path/work/cons_real_it`lastpass'.dta", clear;
{txt} 37{com}.                                                 cap drop one;
{txt} 38{com}.                 gen one=1;
{txt} 39{com}.                                                 sort one;
{txt} 40{com}.                 merge one using `cutoff';
{txt} 41{com}.                 tab _merge;
{txt} 42{com}.                 drop _merge;
{txt} 43{com}.                                                 drop one;
{txt} 44{com}.                 gen relpoor`pass'=cr_it`lastpass'<=cutoff;
{txt} 45{com}.                 *lab var relpoor`pass' "=1 if in bottom of PCE";
.                                                 tab relpoor`pass' [aw=popwt];
{txt} 46{com}. *CA modified to popwt above and to keep popwt below;
.                 keep hhid cr_it`lastpass' relpoor`pass' popwt;
{txt} 47{com}.                 sort hhid;
{txt} 48{com}.         save "$path/work/relpoor_it`pass'.dta", replace;
{txt} 49{com}.         {c )-};
{txt} 50{com}.         **************************************************************************;
. * Get the consumption file, and select only those codes that are food,
> * using our definition of "food", which includes alcoholic beverages.
> **************************************************************************;
.         use "$path/work/cons_cod.dta", clear;
{txt} 51{com}. *CA modified to merge in work/hhdata.dta for bootstrap;
.     sort hhid;
{txt} 52{com}.     merge hhid using "$path/work/hhdata.dta";
{txt} 53{com}.     tab _m;
{txt} 54{com}.     drop _m;
{txt} 55{com}.         /*
>                 sort product;
>                 merge product using "$path/work/food_cat.dta";
>                 tab _merge;
>                 keep if _merge==3;
>                 drop _merge;
> */
> 
>                                 * Only food transactions ;
.                 keep if food_cat==1;
{txt} 56{com}.                 sort hhid;
{txt} 57{com}. **************************************************************************;
. * Merge with file that has temporally AND spatially adjusted consumption
> * per capita from the previous iteration, and also identifies those below 
> * the cutoff. Then select only those who are below the cutoff.
> **************************************************************************;
.                 merge hhid using "$path/work/relpoor_it`pass'.dta";
{txt} 58{com}.                 tab _merge;
{txt} 59{com}.                 drop _merge;
{txt} 60{com}.                                 * Keep only transactions by the poor ;
.                 keep if relpoor`pass';
{txt} 61{com}. **************************************************************************;
. * Calculate HH level food shares. Since we're only doing shares here, we can
> * work with the expenditures without doing temporal adjustment.
> **************************************************************************;
.                 gen  food_expenditure = cod_hh_nom;
{txt} 62{com}.                 *gen  food_expenditure= own_valued + daily_valued + monthly_valued + educ_valued;
.                 egen tot_food_expen= sum (food_expen), by (hhid) ;
{txt} 63{com}.                 count if food_expenditure==.;
{txt} 64{com}.                 count if tot_food_expen==.;
{txt} 65{com}.                 gen food_share= food_expenditure/tot_food_expen;
{txt} 66{com}.                 count if food_share==.;
{txt} 67{com}.                 drop if food_share==.;
{txt} 68{com}.                 sort hhid product;
{txt} 69{com}.                 tempfile foodshares;
{txt} 70{com}.         save `foodshares', replace;
{txt} 71{com}. ********************************************************************************;
. * Now find the total (economy wise, e.g. not by HH) shares by each product in
> * order to select the most important goods in each domain's basket.
> ********************************************************************************;
.                 collapse (mean) hhweight spdomain, by (hhid);
{txt} 72{com}.                 sort hhid ;
{txt} 73{com}.                  collapse (sum) hhweight , by(spdomain);
{txt} 74{com}.                 rename hhweight tothhweight;
{txt} 75{com}.                 tempfile tothhweight;
{txt} 76{com}.                 sort spdomain;
{txt} 77{com}.         save `tothhweight', replace;
{txt} 78{com}.         use `foodshares', clear;
{txt} 79{com}.                 sort spdomain;
{txt} 80{com}.                 merge spdomain using `tothhweight';
{txt} 81{com}.                 tab _merge;
{txt} 82{com}.                 drop _merge;
{txt} 83{com}.                 sort spdomain product;
{txt} 84{com}.                 gen f_share_w`pass'=(food_share*hhweight)/tothhweight;
{txt} 85{com}.                 collapse (sum) f_share_w`pass', by(spdomain product );
{txt} 86{com}.                                sort spdomain f_share_w`pass';
{txt} 87{com}.                 by spdomain: gen cumshr`pass'= sum(f_share_w`pass');
{txt} 88{com}.                 count if cumshr`pass'<=.075;
{txt} 89{com}.                 drop if cumshr`pass'<=.075;
{txt} 90{com}.                 lab var f_share_w`pass' "average food share for the 13 spatial domains";
{txt} 91{com}.         save `foodshares', replace;
{txt} 92{com}.                                                 * Number of spatials domains a food product appears ;
.                 gen numreg=1;
{txt} 93{com}.                 collapse (sum) numreg cumshr`pass', by (product );
{txt} 94{com}.                 keep product numreg ;
{txt} 95{com}.                 display _N;
{txt} 96{com}.                 sort product;
{txt} 97{com}.                                 * Include food product labels ;
. *                merge product using "$path/work/products.dta";
. *                tab _merge;
. *                keep if _merge==3;
.                 keep product  numreg;
{txt} 98{com}.                   sort product;
{txt} 99{com}.                      display _N;
{txt}100{com}.           save "$path/work/codes_food_basket_flex_it`pass'.dta", replace;
{txt}101{com}. **************************************************************************;
. **************************************************************************;
. * That is pretty much the part equivalent to "100_food_basket_flex.do",
> * which figures out the food shares for the relevant reference group. Now
> * we figure out the prices with a code stream that is adapted from
> * "110_price_unit_flex.do".
> **************************************************************************;
. **************************************************************************;
. **************************************************************************************
> * Create sorted data set with daily + own expenditure and the matched codes
> **************************************************************************************;
. use "$path/in/cons_cod_trans.dta", clear;
{txt}102{com}. *save "$path/work/cons_cod_trans.dta", replace;
. *drop value   ;
. *drop quantity;
. keep hhid product food_cat valuez quantity unit;
{txt}103{com}. rename valuez    value;
{txt}104{com}. *rename quantityz quantity;
. *drop count;
. drop if quantity==0 ;
{txt}105{com}.         tempfile dd_acsort;
{txt}106{com}.         save    `dd_acsort', replace;
{txt}107{com}. /*
>         use "$path/work/daily.dta", clear;
>                 drop days;
>                 sort product;
>                 tempfile dd_acsort;
>         save `dd_acsort', replace;
>         
>         use "$path/work/own.dta", clear;
>                 keep hhid product valued quantityd unit;
>                 rename valued value;
>                 rename quantityd quantity;
>         
>                 *CHECK THE ZEROS IN quantity FOR NOW DELETE;
>                 drop if quantity==0;
>         
>                 append using `dd_acsort';
> */
> 
>                 *CA modified to insert work/hhdata.dta for bootstrap;
.                 sort hhid;
{txt}108{com}.                 merge hhid using "$path/work/hhdata.dta";
{txt}109{com}.                 tab _m;
{txt}110{com}.                  drop if _m==2;
{txt}111{com}.                 drop _m;
{txt}112{com}.                                 sort product;
{txt}113{com}.                 gen count=1;
{txt}114{com}.         save `dd_acsort', replace;
{txt}115{com}.         **************************************************************************;
. * Merge the basket codes with the dd  and own data sets.
> * Drop all codes not a part of the flexible food basket
> **************************************************************************;
.                 merge product using "$path/work/codes_food_basket_flex_it`pass'.dta";
{txt}116{com}.                         tab _merge;
{txt}117{com}.                 drop if _merge~=3;
{txt}118{com}.                 drop _merge;
{txt}119{com}. **************************************************************************************
> * Drop observations where product code, quantity or value information is unavailable
> **************************************************************************************;
.                 drop if product==. | value==. | quantity==.  ;
{txt}120{com}.         **************************************************************************************
> * Convert non-KG quantities (units, liters) into kilograms
> **************************************************************************************;
. *do "$path/new/110a_conversions.do"
> 
> ********************************************************************
> * There remain a few difficult to interpret observations such as liters
> * of fish and liters of pasta. These are dropped.
> ********************************************************************;
. *                $MZ drop if unit~=2;
.         **************************************************************************;
. * Bring in the spdomain and reg_tpi variables, and also the information on
> * relatively poor households.
> **************************************************************************;
.                 preserve;
{txt}121{com}.                                                 * Temporally adjusted expenditure ;
.                         use `contpi', clear;
{txt}122{com}.                                 keep hhid hhweight spdomain reg_tpi survquar tpi_trim cons_pc_tpi ;
{txt}123{com}.                                 sort hhid;
{txt}124{com}.                                 tempfile hhd2;
{txt}125{com}.                         save `hhd2', replace;
{txt}126{com}.                 restore;
{txt}127{com}.                                 compress;
{txt}128{com}.                 sort hhid;
{txt}129{com}.                 merge hhid using `hhd2';
{txt}130{com}.                 tab _merge;
{txt}131{com}.                 drop _merge;
{txt}132{com}.                 sort hhid;
{txt}133{com}.                 merge hhid using "$path/work/relpoor_it`pass'.dta";
{txt}134{com}.                 tab _merge;
{txt}135{com}.                 drop _merge;
{txt}136{com}.                                                 * Keep nominal food transactions by poor people ;
.                 keep if relpoor`pass';
{txt}137{com}.                 drop if product==.;
{txt}138{com}.                                                                 * Temporally deflate transaction values ;
.                 gen value_r=value/tpi_trim;
{txt}139{com}. **************************************************************************;
. * Toss out the bottom 5% and top 5% of the HH-LEVEL prices per kg in
> * each spdomain & product combination. This should eliminate outliers
> * that may have an undue influence on the price calculation. 
> **************************************************************************;
.                 gen hhppkg=value_r/quantity;
{txt}140{com}.                 egen lower5=pctile(hhppkg), p(5)  by(spdomain product);
{txt}141{com}.                 egen upper5=pctile(hhppkg), p(95) by(spdomain product);
{txt}142{com}.                 keep if hhppkg>=lower5 & hhppkg<=upper5;
{txt}143{com}. *********************************************************************
> * Note that we do prices in three ways. First, by summing quantity and value 
> * This average price price_uw is thus quantity/value weighted. Second, we
> * calculate the price and take simple means for a transaction weighted
> * price, price_ut. Last we take the median, price_um. But in the end
> * we only use price_unitw
> *********************************************************************;
.                 gen price_ut`pass'=value_r/(quantity*1000);
{txt}144{com}.                 gen price_um`pass'=price_ut;
{txt}145{com}.                 collapse (sum) 
>                         quantity value_r count bswt (mean) price_ut (median) price_um [aw=hhweight], 
>                         by(spdomain product);
{txt}146{com}.                 *Generate weighted price per gram ;
.                 gen price_uw`pass'=value_r/(quantity*1000);
{txt}147{com}.                 drop value_r quantity;
{txt}148{com}.                 sort spdomain product;
{txt}149{com}.                 lab var price_ut`pass' "Average of calculated prices - transaction weighted";
{txt}150{com}.                 lab var price_um`pass' "Median of prices";
{txt}151{com}.                 lab var price_uw`pass' "Value share weighted mean prices";
{txt}152{com}. * Get an idea of the difference between the price measures;
.                 gen ratiotw`pass'=price_ut`pass'/price_uw`pass';
{txt}153{com}.                 gen ratiomw`pass'=price_um`pass'/price_uw`pass';
{txt}154{com}.                 sum ratiotw`pass' ratiomw`pass';
{txt}155{com}.                 sort product;
{txt}156{com}.                 merge product using "$path/work/codes_food_basket_flex_it`pass'.dta";
{txt}157{com}.                 tab _m;
{txt}158{com}.                 count if _merge~=3;
{txt}159{com}.                 drop if _merge~=3;
{txt}160{com}.                 drop _merge;
{txt}161{com}.                 sort product spdomain;
{txt}162{com}.         save "$path/work/price_unit_flex_it`pass'.dta", replace;
{txt}163{com}. **************************************************************************;
. **************************************************************************;
. * That concludes the prices part. Now we move to calculating the food
> * poverty lines, which draws code from "120_povline_flex.do" with very few
> * changes:
> * - The changes facilitate accumulating vectors
> *   of intermediate results across iterations, rather than generating a
> *   bunch of new files.
> **************************************************************************;
. **************************************************************************;
. **************************************************************************;
. * Use the file with the food basket (`foodshares'), which is in shares. 
> * Then merge it with the prices file, and then with the calories file.
> * Along the way, drop those observations where we have no price information
> * or no calorie information, but list them out.
> **************************************************************************;
.         use `foodshares', clear;
{txt}164{com}.                 sort product spdomain;
{txt}165{com}.                 merge product spdomain using "$path/work/price_unit_flex_it`pass'.dta";
{txt}166{com}.                         tab _merge;
{txt}167{com}.                 list product spdomain  if _merge==1;
{txt}168{com}.                         drop if _merge ~=3;
{txt}169{com}.                 drop _merge;
{txt}170{com}.                 sort product;
{txt}171{com}.                         merge product using "$path/work/calperg.dta";
{txt}172{com}.                 tab _merge;
{txt}173{com}.                                                 * This tells where we are lacking calorie info or are lacking quantity info due to 
>                 * missing price info above;
.                 list product spdomain  if _merge==1;
{txt}174{com}.                         drop if _merge~=3;
{txt}175{com}.                 drop _merge;
{txt}176{com}.                 sort spdomain f_share_w`pass';
{txt}177{com}.                                 *CA modified to change count bswt;
.                 by spdomain: count if round(bswt)<10;
{txt}178{com}.                                 sum bswt;
{txt}179{com}.                                                 drop if round(bswt) < 10;
{txt}180{com}.                                                                 * Total food share in spatial domain ;
.                 by spdomain: egen baskshr=sum(f_share_w`pass');
{txt}181{com}.                                 * Cumulated food share in spatial domain ;
.                 by spdomain: gen  cumshr =sum(f_share_w`pass');
{txt}182{com}.                 drop if cumshr<=baskshr-.9;
{txt}183{com}.                         drop baskshr;
{txt}184{com}.                 by spdomain: egen baskshr=sum(f_share_w`pass');
{txt}185{com}.                 tabstat baskshr , by(spdomain) st(n mean sd min max);
{txt}186{com}.                                                                 * How many grams in 1 MT exp on food item ;
.                                 gen quan`pass'=f_share_w`pass'/price_uw`pass';
{txt}187{com}.                                 * How many calories in 1 MT exp on food item ;
.                 gen cal_ir`pass'=quan`pass'*calperg;
{txt}188{com}.                                 * how many calories in 1 MT exp in food basket ;
.                 by spdomain: egen calreg=sum(cal_ir);
{txt}189{com}.                         sort spdomain;
{txt}190{com}.                 merge spdomain using "$path/work/calpp.dta";
{txt}191{com}.                 tab _merge;
{txt}192{com}.                 drop _merge;
{txt}193{com}.                                                         * get the expansion factor to hit 95% of calorie requirements ;
.                 gen ratio=.95*calpp/calreg;
{txt}194{com}.                         replace quan`pass'=quan`pass'*ratio;
{txt}195{com}.                 replace cal_ir`pass'=quan`pass'*calperg;
{txt}196{com}.                         sort spdomain product;
{txt}197{com}.                 by spdomain: egen chkcal=sum(cal_ir`pass');
{txt}198{com}.                 replace chkcal=chkcal/.95-calpp ;
{txt}199{com}.                                                 tabstat chkcal , by(spdomain) st(n mean sd min max);
{txt}200{com}.                         gen val_ir`pass'=quan`pass'*price_uw`pass';
{txt}201{com}.                         by spdomain: egen povline_f_flex90_`pass'=sum(val_ir`pass');
{txt}202{com}.                 replace povline_f=povline_f_flex90_`pass'/.9;
{txt}203{com}.                 *drop product96;
. keep product spdomain quan`pass'  price_uw`pass' val_ir`pass' povline_f_flex90_`pass' calpp calperg;
{txt}204{com}.                     save "$path/work/quan_flex_it`pass'.dta", replace;
{txt}205{com}.                         collapse (mean) povline_f_flex90_`pass', by (spdomain);
{txt}206{com}.                                                 keep spdomain povline_f_flex90_`pass';
{txt}207{com}.                 sort spdomain;
{txt}208{com}.                 save "$path/work/povline_food_flex_it`pass'.dta", replace;
{txt}209{com}.         **************************************************************************;
. **************************************************************************;
. * Now comes the part that draws the non-food and total poverty lines,
> * and generates estimates of poverty measures. This is drawn from 
> * "130_povmeas_flex.do" with a few changes.
> **************************************************************************;
. **************************************************************************;
. **************************************************************************
> * Calculate non-food expenditure for HH around the food poverty line
> *
> * Develop a discrete triangular weighted distribution. This gives a
> * weight of  1 to HH at +/- 18-20% from food poverty line, and
> * weight of  2 to HH at +/- 16-18% from food poverty line, and ...
> * weight of 10 to HH at +/-  0- 2% from food poverty line.
> * This weight is called triwt below.
> **************************************************************************;
.         use `contpi', clear;
{txt}210{com}.                 sort spdomain;
{txt}211{com}.                 merge spdomain using "$path/work/povline_food_flex_it`pass'.dta";
{txt}212{com}.                 tab _merge;
{txt}213{com}.                 drop _merge;
{txt}214{com}.                 gen triwt=0;
{txt}215{com}.                 replace triwt = 11 - round(50*abs(cons_pc_tpi/povline_f_flex90_`pass'-1)+0.5) if abs(cons_pc_tpi/povline_f_flex90_`pass'-1) <= 0.2;
{txt}216{com}.                                 ***since the poor were very few in Kampala and Central urban for Uganda we added 1 to weights****;
.                                 * Nearness to poverty line and population weights ;
.                 gen tripopwt=(0.001+triwt)*hhweight*hhsize;
{txt}217{com}.                                                 preserve;
{txt}218{com}.                         collapse (mean) nf_pc_nom [aw=tripopwt] , by(spdomain);
{txt}219{com}.                         rename nf_pc_nom povline_nf_flex`pass';
{txt}220{com}.                         lab var povline_nf_flex`pass' "Nonfood poverty line. Flexible bundle";
{txt}221{com}.                         tempfile znf;
{txt}222{com}.                         sort spdomain;
{txt}223{com}.                         save `znf', replace;
{txt}224{com}.                                                                 restore;
{txt}225{com}.                                 sort spdomain;
{txt}226{com}.                 merge spdomain using `znf';
{txt}227{com}.                 tab _merge;
{txt}228{com}.                 drop _merge;
{txt}229{com}. **************************************************************************
> * Poverty line is the sum of the food and non-food poverty lines
> **************************************************************************;
.                 gen povline_flex`pass'=povline_f_flex90_`pass' + povline_nf_flex`pass';
{txt}230{com}. keep spdomain povline_flex`pass';
{txt}231{com}.                 sort spdomain;
{txt}232{com}.         save "$path/work/povlines_it`pass'.dta", replace;
{txt}233{com}. **************************************************************************;
. * Create spatial price index, based on the total poverty line, with
> * adjustment so that mean (and total) nominal consumption equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first: we just use the first stratum.
> **************************************************************************;
.         use `contpi', clear;
{txt}234{com}.                 sort spdomain;
{txt}235{com}.                 merge spdomain using "$path/work/povlines_it`pass'.dta";
{txt}236{com}.                 tab _merge;
{txt}237{com}.                 drop _merge;
{txt}238{com}.                 gen cr= cons_pc_tpi ;
{txt}239{com}.                 gen linpob`pass'=povline_flex`pass';
{txt}240{com}.                 qui sum linpob`pass' if spdomain==1, meanonly;
{txt}241{com}.                 global spi_base=r(mean);
{txt}242{com}.                 gen spi`pass'=linpob`pass'/$spi_base;
{txt}243{com}.                 gen cr_it`pass'=cr/spi`pass';
{txt}244{com}.                 qui sum cr [aw=hhweight*hhsize];
{txt}245{com}.                 global sumcr=r(sum);
{txt}246{com}.                 qui sum cr_it`pass' [aw=hhweight*hhsize];
{txt}247{com}.                 global sumcr2=r(sum);
{txt}248{com}.                 replace spi`pass'=spi`pass'*$sumcr2/$sumcr;
{txt}249{com}.                 gen linpobr`pass'=linpob`pass'/spi`pass';
{txt}250{com}.                 replace cr_it`pass'=cr/spi`pass';
{txt}251{com}.                 su cr cr_it`pass' linpob`pass' linpobr`pass' [aw=hhweight*hhsize];
{txt}252{com}.                 lab var cr "Temporally-adjusted cons pc";
{txt}253{com}.                 lab var cr_it`pass' "Spatially & temporally adjusted cons pc";
{txt}254{com}.                 lab var linpob`pass' "Poverty line";
{txt}255{com}.                 lab var linpobr`pass' "Real poverty line";
{txt}256{com}.                 lab var spi`pass' "Spatial price index";
{txt}257{com}.                 gen linpob=linpob`pass';
{txt}258{com}. **************************************************************************
> * calculate poverty measures with the flexible food bundle
> **************************************************************************;
.                 gen h=100 if cr_it`pass'<=linpobr`pass' & linpobr`pass'~=. & cr_it`pass'~=.;
{txt}259{com}.                 replace  h   = 0 if cr_it`pass' > linpobr`pass' & linpobr`pass'~=. & cr_it`pass'~=.;
{txt}260{com}.                 gen      pg  = ((linpobr`pass' - cr_it`pass' )/linpobr`pass') *100;
{txt}261{com}.                 replace  pg  = 0             if h==0;
{txt}262{com}.                 gen      spg = ((( linpobr`pass' - cr_it`pass' )/ linpobr`pass' )^2)*100;
{txt}263{com}.                 replace  spg = 0             if h==0;
{txt}264{com}.                 gen h_flex`pass'  =h;
{txt}265{com}.                 gen pg_flex`pass' =pg;
{txt}266{com}.                 gen spg_flex`pass'=spg;
{txt}267{com}.                                 lab var h_flex`pass'   "Poverty headcount. Flexible bundle";
{txt}268{com}.                 lab var pg_flex`pass'  "Poverty gap. Flexible bundle";
{txt}269{com}.                 lab var spg_flex`pass' "Squared poverty gap. Flexible bundle";
{txt}270{com}.                 gen popwt=hhsize*hhweight;
{txt}271{com}.                         * Stata 10.1 syntax ;
.                         svyset , clear;
{txt}272{com}.                         svyset [pweight=popwt] , str(strata) psu(psu);
{txt}273{com}.                 svy: mean h_flex`pass' pg_flex`pass' spg_flex`pass';
{txt}274{com}.                 svy: mean h_flex`pass' pg_flex`pass' spg_flex`pass' , over(rural);
{txt}275{com}.                 svy: mean h_flex`pass' pg_flex`pass' spg_flex`pass' , over(strata);
{txt}276{com}.                 svy: mean h_flex`pass' pg_flex`pass' spg_flex`pass' , over(strata rural);
{txt}277{com}.                 svy: mean h_flex`pass' pg_flex`pass' spg_flex`pass' , over(spdomain);
{txt}278{com}. *preserve;
. keep hhid popwt cr_it`pass' h_flex`pass' pg_flex`pass' spg_flex`pass' rural news reg_tpi strata spdomain;
{txt}279{com}.                 compress;
{txt}280{com}.                 sort hhid;
{txt}281{com}.         save "$path/work/cons_real_it`pass'.dta" , replace;
{txt}282{com}. *restore;
.                                 * New cutoff point (percentile) to use in next iteration is equal to the poverty ;
.                 * rate in this iteration ;
.                                                 sum h_flex`pass' [aw=popwt] ;
{txt}283{com}.                                 * Comment out next line for IAF 2002/03 in order to replicate official figures ( START );
.                 * URB: In this case, we just use the poorest 50% as there are too few actually poor to calculate the bundle and prices..;
.                 local cutpt= $tpi_bottom;
{txt}284{com}. *               local cutpt= round(r(mean));
.                 * Comment out next line for IAF 2002/03 in order to replicate official figures ( END );
. *       save foodshares tempfile to disk;
.         use `foodshares', clear;
{txt}285{com}.         save "$path/work/foodshares_it`pass'.dta", replace;
{txt}286{com}.         local lastpass = `pass';
{txt}287{com}.         local pass = `pass' + 1;
{txt}288{com}.         {c )-};
{txt}(15 missing values generated)
(note: file /tmp/St02564.000002 not found)
file /tmp/St02564.000002 saved
file cutoff.dta saved
(15 missing values generated)
{p 0 4 2}
variable{txt} one
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,123      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,123      100.00

   {txt}relpoor1 {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res}  1,564.177       50.15       50.15
{txt}          1 {c |}{res}  1,554.823       49.85      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/relpoor_it1.dta saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        1.99        1.99
{txt}          2 {c |}{res}          1        0.00        1.99
{txt}          3 {c |}{res}     42,120       98.01      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     42,976      100.00
{txt}(3978 observations deleted)
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          3        0.01        0.01
{txt}          3 {c |}{res}     38,998       99.99      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,001      100.00
{txt}(25598 observations deleted)
(2 missing values generated)
{res}    2
    0
{txt}(2 missing values generated)
{res}    2
{txt}(2 observations deleted)
(note: file /tmp/St02564.000003 not found)
file /tmp/St02564.000003 saved
(note: file /tmp/St02564.000004 not found)
file /tmp/St02564.000004 saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     13,401      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     13,401      100.00
  125
{txt}(125 observations deleted)
file /tmp/St02564.000003 saved
39
39
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/codes_food_basket_flex_it1.dta saved
(3 observations deleted)
(note: file /tmp/St02564.000005 not found)
file /tmp/St02564.000005 saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        2.15        2.15
{txt}          2 {c |}{res}          3        0.01        2.15
{txt}          3 {c |}{res}     38,995       97.85      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,853      100.00
{txt}(3 observations deleted)
file /tmp/St02564.000005 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}      4,929       12.37       12.37
{txt}          3 {c |}{res}     34,921       87.63      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,850      100.00
{txt}(4929 observations deleted)
(3005 observations deleted)
(note: file /tmp/St02564.000007 not found)
file /tmp/St02564.000007 saved
product was {res}float{txt} now {res}int
{txt}unit was {res}float{txt} now {res}byte
{txt}food_cat was {res}float{txt} now {res}byte
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}bswt was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}count was {res}float{txt} now {res}byte
{txt}numreg was {res}double{txt} now {res}byte
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}
survquar was {res}byte{txt} now {res}float
{txt}spdomain was {res}byte{txt} now {res}float
{txt}(label lspdomain already defined)
(label lregion already defined)
(label lsurvquar already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        103        0.32        0.32
{txt}          3 {c |}{res}     31,916       99.68      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.00        0.00
{txt}          3 {c |}{res}     32,018      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}(20586 observations deleted)
(13 observations deleted)
(831 observations deleted)

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 4}ratiotw1 {c |}{res}       175    1.247308    .4276395    .816168   3.337594
{txt}{space 4}ratiomw1 {c |}{res}       175    1.107115    .3966994   .6103029   4.164927
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          3        1.69        1.69
{txt}          3 {c |}{res}        175       98.31      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        178      100.00
    3
{txt}(3 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/price_unit_flex_it1.dta saved
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          7        3.85        3.85
{txt}          2 {c |}{res}         55       30.22       34.07
{txt}          3 {c |}{res}        120       65.93      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        182      100.00
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c TRC}
     {c |} {res}product        spdomain {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
121. {c |} {res}    157   Central Urban {txt}{c |}
122. {c |} {res}    157   Central Rural {txt}{c |}
123. {c |} {res}    157         Eastern {txt}{c |}
124. {c |} {res}    160   Central Urban {txt}{c |}
125. {c |} {res}    161   Central Urban {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
126. {c |} {res}    161         Eastern {txt}{c |}
127. {c |} {res}    161        Northern {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c BRC}
(62 observations deleted)
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}         26       17.81       17.81
{txt}          3 {c |}{res}        120       82.19      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        146      100.00
{txt}(26 observations deleted)

{hline}
-> spdomain = Central Urban
{res}    3
{txt}{hline}
-> spdomain = Central Rural
{res}    0
{txt}{hline}
-> spdomain = Eastern
{res}    0
{txt}{hline}
-> spdomain = Northern
{res}    0
{txt}{hline}
-> spdomain = Western
{res}    0

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}bswt {c |}{res}       120    79.36667    68.25766          3        322
{txt}(3 observations deleted)
(4 observations deleted)

Summary for variables: baskshr
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .8147091         0  .8147091  .8147091
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       21  .9059013         0  .9059013  .9059013
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27  .9085176         0  .9085176  .9085176
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24  .8925704         0  .8925704  .8925704
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23   .904429         0   .904429   .904429
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      113  .8888692  .0329241  .8147091  .9085176
{txt}{hline 14}{c BT}{hline 50}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}        113      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        113      100.00
{txt}(113 real changes made)
(108 real changes made)
(113 real changes made)

Summary for variables: chkcal
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .0001028         0  .0001028  .0001028
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       21 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24  .0001028         0  .0001028  .0001028
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .0000385         0  .0000385  .0000385
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      113  .0000242  .0000693 -.0000514  .0001028
{txt}{hline 14}{c BT}{hline 50}
(113 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/quan_flex_it1.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povline_food_flex_it1.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(235 real changes made)
(5 missing values generated)
(note: file /tmp/St02564.000009 not found)
file /tmp/St02564.000009 saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(5 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it1.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it1.dta
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(16 missing values generated)
(5 missing values generated)
(5 missing values generated)
(16 missing values generated)
(3119 real changes made)
(5 missing values generated)
(3108 real changes made)

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 6}cr_it1 {c |}{res}    3108  28069559.9    1060.929   976.2463   122.3149   20035.97
{txt}{space 5}linpob1 {c |}{res}    3119  28164219.1    440.2566   66.83536   312.2208   546.7244
{txt}{space 4}linpobr1 {c |}{res}    3119  28164219.1    448.4924   .0000123   448.4924   448.4924
{txt}(5 missing values generated)
(2723 missing values generated)
(2707 real changes made)
(16 missing values generated)
(2707 real changes made)
(16 missing values generated)
(2707 real changes made)
(16 missing values generated)
(16 missing values generated)
(16 missing values generated)
(5 missing values generated)

      pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 5}h_flex1 {c |}{col 14}{res}{space 2} 15.84921{col 26}{space 2} .9766671{col 37}{space 5} 13.92755{col 51}{space 3} 17.77087
{txt}{space 4}pg_flex1 {c |}{col 14}{res}{space 2} 3.427597{col 26}{space 2} .2701458{col 37}{space 5} 2.896066{col 51}{space 3} 3.959128
{txt}{space 3}spg_flex1 {c |}{col 14}{res}{space 2} 1.161953{col 26}{space 2} .1156949{col 37}{space 5} .9343154{col 51}{space 3} 1.389591
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex1      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} 3.616503{col 26}{space 2} .9297338{col 37}{space 5} 1.787185{col 51}{space 3} 5.445822
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 18.38507{col 26}{space 2} 1.151796{col 37}{space 5} 16.11883{col 51}{space 3} 20.65131
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex1     {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6989874{col 26}{space 2} .2201137{col 37}{space 5} .2658979{col 51}{space 3} 1.132077
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 3.993241{col 26}{space 2}  .320007{col 37}{space 5} 3.363604{col 51}{space 3} 4.622878
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex1    {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2}   .25927{col 26}{space 2} .1152051{col 37}{space 5} .0325957{col 51}{space 3} .4859444
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 1.349081{col 26}{space 2} .1364374{col 37}{space 5}  1.08063{col 51}{space 3} 1.617531
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex1      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.56001{col 26}{space 2}  1.98039{col 37}{space 5} 7.663449{col 51}{space 3} 15.45657
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.18469{col 26}{space 2}  2.07589{col 37}{space 5} 18.10023{col 51}{space 3} 26.26916
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 9.623426{col 26}{space 2} 4.111047{col 37}{space 5} 1.534644{col 51}{space 3} 17.71221
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.82511{col 26}{space 2} 3.037433{col 37}{space 5} 15.84874{col 51}{space 3} 27.80148
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 18.36522{col 26}{space 2} 2.152594{col 37}{space 5} 14.12984{col 51}{space 3} 22.60061
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex1     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.168492{col 26}{space 2} .4705546{col 37}{space 5} 1.242642{col 51}{space 3} 3.094342
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7351377{col 26}{space 2} .4048669{col 37}{space 5} -.061467{col 51}{space 3} 1.531742
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.841435{col 26}{space 2} .5935124{col 37}{space 5} 3.673656{col 51}{space 3} 6.009213
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.116834{col 26}{space 2}  1.10298{col 37}{space 5}-.0533588{col 51}{space 3} 4.287027
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.453815{col 26}{space 2} .9897749{col 37}{space 5} 3.506361{col 51}{space 3} 7.401268
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5238783{col 26}{space 2} .3645131{col 37}{space 5}-.1933275{col 51}{space 3} 1.241084
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.823314{col 26}{space 2} .5658797{col 37}{space 5} 2.709905{col 51}{space 3} 4.936723
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex1    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6519446{col 26}{space 2} .1911633{col 37}{space 5} .2758171{col 51}{space 3} 1.028072
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1503185{col 26}{space 2} .1068702{col 37}{space 5}-.0599564{col 51}{space 3} .3605933
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.632452{col 26}{space 2} .2637344{col 37}{space 5} 1.113536{col 51}{space 3} 2.151369
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} .7831744{col 26}{space 2} .5147763{col 37}{space 5}-.2296851{col 51}{space 3} 1.796034
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 1.861008{col 26}{space 2} .3967043{col 37}{space 5} 1.080463{col 51}{space 3} 2.641552
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .1580154{col 26}{space 2}  .142028{col 37}{space 5}-.1214349{col 51}{space 3} .4374657
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.348266{col 26}{space 2} .2536975{col 37}{space 5} .8490981{col 51}{space 3} 1.847434
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

         {txt}Over: strata rural
    _subpop_1: {res}central urban Urban
    {txt}_subpop_2: {res}central rural Rural
    {txt}_subpop_3: {res}Eastern urban Urban
    {txt}_subpop_4: {res}Eastern rural Rural
    {txt}_subpop_5: {res}Northern urban Urban
    {txt}_subpop_6: {res}Northern rural Rural
    {txt}_subpop_7: {res}Western Urban Urban
    {txt}_subpop_8: {res}Western rural Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex1      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.56001{col 26}{space 2}  1.98039{col 37}{space 5} 7.663449{col 51}{space 3} 15.45657
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.18469{col 26}{space 2}  2.07589{col 37}{space 5} 18.10023{col 51}{space 3} 26.26916
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 9.623426{col 26}{space 2} 4.111047{col 37}{space 5} 1.534644{col 51}{space 3} 17.71221
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.82511{col 26}{space 2} 3.037433{col 37}{space 5} 15.84874{col 51}{space 3} 27.80148
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 18.36522{col 26}{space 2} 2.152594{col 37}{space 5} 14.12984{col 51}{space 3} 22.60061
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex1     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.168492{col 26}{space 2} .4705546{col 37}{space 5} 1.242642{col 51}{space 3} 3.094342
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7351377{col 26}{space 2} .4048669{col 37}{space 5} -.061467{col 51}{space 3} 1.531742
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.841435{col 26}{space 2} .5935124{col 37}{space 5} 3.673656{col 51}{space 3} 6.009213
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.116834{col 26}{space 2}  1.10298{col 37}{space 5}-.0533588{col 51}{space 3} 4.287027
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.453815{col 26}{space 2} .9897749{col 37}{space 5} 3.506361{col 51}{space 3} 7.401268
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5238783{col 26}{space 2} .3645131{col 37}{space 5}-.1933275{col 51}{space 3} 1.241084
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.823314{col 26}{space 2} .5658797{col 37}{space 5} 2.709905{col 51}{space 3} 4.936723
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex1    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6519446{col 26}{space 2} .1911633{col 37}{space 5} .2758171{col 51}{space 3} 1.028072
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1503185{col 26}{space 2} .1068702{col 37}{space 5}-.0599564{col 51}{space 3} .3605933
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.632452{col 26}{space 2} .2637344{col 37}{space 5} 1.113536{col 51}{space 3} 2.151369
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} .7831744{col 26}{space 2} .5147763{col 37}{space 5}-.2296851{col 51}{space 3} 1.796034
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 1.861008{col 26}{space 2} .3967043{col 37}{space 5} 1.080463{col 51}{space 3} 2.641552
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .1580154{col 26}{space 2}  .142028{col 37}{space 5}-.1214349{col 51}{space 3} .4374657
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.348266{col 26}{space 2} .2536975{col 37}{space 5} .8490981{col 51}{space 3} 1.847434
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex1      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.56001{col 26}{space 2}  1.98039{col 37}{space 5} 7.663449{col 51}{space 3} 15.45657
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 20.88803{col 26}{space 2} 1.938437{col 37}{space 5} 17.07402{col 51}{space 3} 24.70205
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 20.11614{col 26}{space 2} 2.680788{col 37}{space 5}  14.8415{col 51}{space 3} 25.39078
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 17.50719{col 26}{space 2} 2.032732{col 37}{space 5} 13.50764{col 51}{space 3} 21.50673
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex1     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.168492{col 26}{space 2} .4705546{col 37}{space 5} 1.242642{col 51}{space 3} 3.094342
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 4.540354{col 26}{space 2} .5520834{col 37}{space 5}  3.45409{col 51}{space 3} 5.626618
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 4.986437{col 26}{space 2} .8666725{col 37}{space 5} 3.281197{col 51}{space 3} 6.691678
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.621309{col 26}{space 2} .5344721{col 37}{space 5} 2.569697{col 51}{space 3} 4.672921
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex1    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6519446{col 26}{space 2} .1911633{col 37}{space 5} .2758171{col 51}{space 3} 1.028072
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2}  1.52378{col 26}{space 2} .2448531{col 37}{space 5} 1.042013{col 51}{space 3} 2.005546
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.710046{col 26}{space 2} .3494219{col 37}{space 5} 1.022534{col 51}{space 3} 2.397559
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.275394{col 26}{space 2} .2395396{col 37}{space 5} .8040829{col 51}{space 3} 1.746706
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}h_flex1 was {res}float{txt} now {res}byte
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_real_it1.dta saved

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 5}h_flex1 {c |}{res}    3108  28069559.9    15.84921   36.52606          0        100
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/foodshares_it1.dta saved
file /tmp/St02564.000002 saved
{p 0 4 2}
variable{txt} one
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00

   {txt}relpoor2 {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 1,562.8925       50.11       50.11
{txt}          1 {c |}{res} 1,556.1075       49.89      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/relpoor_it2.dta saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        1.99        1.99
{txt}          2 {c |}{res}          1        0.00        1.99
{txt}          3 {c |}{res}     42,120       98.01      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     42,976      100.00
{txt}(3978 observations deleted)
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          4        0.01        0.01
{txt}          3 {c |}{res}     38,998       99.99      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,002      100.00
{txt}(25589 observations deleted)
(2 missing values generated)
{res}    2
    0
{txt}(2 missing values generated)
{res}    2
{txt}(2 observations deleted)
(note: file /tmp/St02564.00000a not found)
file /tmp/St02564.00000a saved
(note: file /tmp/St02564.00000b not found)
file /tmp/St02564.00000b saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     13,411      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     13,411      100.00
  125
{txt}(125 observations deleted)
file /tmp/St02564.00000a saved
39
39
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/codes_food_basket_flex_it2.dta saved
(3 observations deleted)
(note: file /tmp/St02564.00000c not found)
file /tmp/St02564.00000c saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        2.15        2.15
{txt}          2 {c |}{res}          3        0.01        2.15
{txt}          3 {c |}{res}     38,995       97.85      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,853      100.00
{txt}(3 observations deleted)
file /tmp/St02564.00000c saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}      4,929       12.37       12.37
{txt}          3 {c |}{res}     34,921       87.63      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,850      100.00
{txt}(4929 observations deleted)
(3005 observations deleted)
(note: file /tmp/St02564.00000e not found)
file /tmp/St02564.00000e saved
product was {res}float{txt} now {res}int
{txt}unit was {res}float{txt} now {res}byte
{txt}food_cat was {res}float{txt} now {res}byte
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}bswt was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}count was {res}float{txt} now {res}byte
{txt}numreg was {res}double{txt} now {res}byte
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}
survquar was {res}byte{txt} now {res}float
{txt}spdomain was {res}byte{txt} now {res}float
{txt}(label lspdomain already defined)
(label lregion already defined)
(label lsurvquar already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        103        0.32        0.32
{txt}          3 {c |}{res}     31,916       99.68      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     32,019      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}(20565 observations deleted)
(12 observations deleted)
(818 observations deleted)

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 4}ratiotw2 {c |}{res}       175    1.246757    .4257854   .7769808   3.337594
{txt}{space 4}ratiomw2 {c |}{res}       175    1.107483     .401684   .6105599   4.164927
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          3        1.69        1.69
{txt}          3 {c |}{res}        175       98.31      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        178      100.00
    3
{txt}(3 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/price_unit_flex_it2.dta saved
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          7        3.85        3.85
{txt}          2 {c |}{res}         55       30.22       34.07
{txt}          3 {c |}{res}        120       65.93      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        182      100.00
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c TRC}
     {c |} {res}product        spdomain {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
121. {c |} {res}    157   Central Urban {txt}{c |}
122. {c |} {res}    157   Central Rural {txt}{c |}
123. {c |} {res}    157         Eastern {txt}{c |}
124. {c |} {res}    160   Central Urban {txt}{c |}
125. {c |} {res}    161   Central Urban {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
126. {c |} {res}    161         Eastern {txt}{c |}
127. {c |} {res}    161        Northern {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c BRC}
(62 observations deleted)
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}         26       17.81       17.81
{txt}          3 {c |}{res}        120       82.19      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        146      100.00
{txt}(26 observations deleted)

{hline}
-> spdomain = Central Urban
{res}    3
{txt}{hline}
-> spdomain = Central Rural
{res}    0
{txt}{hline}
-> spdomain = Eastern
{res}    0
{txt}{hline}
-> spdomain = Northern
{res}    0
{txt}{hline}
-> spdomain = Western
{res}    0

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}bswt {c |}{res}       120        79.6    69.60602          3        337
{txt}(3 observations deleted)
(4 observations deleted)

Summary for variables: baskshr
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .8147091         0  .8147091  .8147091
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       21  .9067186         0  .9067186  .9067186
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27  .9088988         0  .9088988  .9088988
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24  .8927878         0  .8927878  .8927878
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .9046368         0  .9046368  .9046368
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      113  .8892006  .0330843  .8147091  .9088988
{txt}{hline 14}{c BT}{hline 50}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}        113      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        113      100.00
{txt}(113 real changes made)
(108 real changes made)
(113 real changes made)

Summary for variables: chkcal
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .0001028         0  .0001028  .0001028
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       21  .0000771         0  .0000771  .0000771
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27  .0000771         0  .0000771  .0000771
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24  .0002313         0  .0002313  .0002313
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .0000385         0  .0000385  .0000385
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      113  .0001061  .0000682  .0000385  .0002313
{txt}{hline 14}{c BT}{hline 50}
(113 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/quan_flex_it2.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povline_food_flex_it2.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(236 real changes made)
(5 missing values generated)
(note: file /tmp/St02564.00000g not found)
file /tmp/St02564.00000g saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(5 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it2.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it2.dta
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(16 missing values generated)
(5 missing values generated)
(5 missing values generated)
(16 missing values generated)
(3119 real changes made)
(5 missing values generated)
(3108 real changes made)

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 6}cr_it2 {c |}{res}    3108  28069559.9    1060.929   977.2243   122.1025   20050.84
{txt}{space 5}linpob2 {c |}{res}    3119  28164219.1    439.7347   67.14265   311.7988   546.7244
{txt}{space 4}linpobr2 {c |}{res}    3119  28164219.1    447.7136          0   447.7136   447.7136
{txt}(5 missing values generated)
(2723 missing values generated)
(2707 real changes made)
(16 missing values generated)
(2707 real changes made)
(16 missing values generated)
(2707 real changes made)
(16 missing values generated)
(16 missing values generated)
(16 missing values generated)
(5 missing values generated)

      pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 5}h_flex2 {c |}{col 14}{res}{space 2} 15.89283{col 26}{space 2} .9814454{col 37}{space 5} 13.96176{col 51}{space 3} 17.82389
{txt}{space 4}pg_flex2 {c |}{col 14}{res}{space 2} 3.417863{col 26}{space 2} .2695117{col 37}{space 5} 2.887579{col 51}{space 3} 3.948147
{txt}{space 3}spg_flex2 {c |}{col 14}{res}{space 2} 1.159023{col 26}{space 2} .1154295{col 37}{space 5} .9319068{col 51}{space 3} 1.386139
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex2      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} 3.616503{col 26}{space 2} .9297338{col 37}{space 5} 1.787185{col 51}{space 3} 5.445822
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 18.43772{col 26}{space 2} 1.157794{col 37}{space 5} 16.15968{col 51}{space 3} 20.71577
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex2     {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6981809{col 26}{space 2} .2198444{col 37}{space 5} .2656212{col 51}{space 3} 1.130741
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 3.981657{col 26}{space 2} .3192471{col 37}{space 5} 3.353515{col 51}{space 3} 4.609798
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex2    {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .2590728{col 26}{space 2} .1150988{col 37}{space 5} .0326076{col 51}{space 3}  .485538
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 1.345583{col 26}{space 2} .1361188{col 37}{space 5}  1.07776{col 51}{space 3} 1.613407
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex2      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 9.623426{col 26}{space 2} 4.111047{col 37}{space 5} 1.534644{col 51}{space 3} 17.71221
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.82511{col 26}{space 2} 3.037433{col 37}{space 5} 15.84874{col 51}{space 3} 27.80148
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.97278{col 26}{space 2} 2.165507{col 37}{space 5} 13.71199{col 51}{space 3} 22.23357
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex2     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2}  2.10521{col 26}{space 2} .4630464{col 37}{space 5} 1.194133{col 51}{space 3} 3.016287
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7495527{col 26}{space 2} .4097461{col 37}{space 5}-.0566523{col 51}{space 3} 1.555758
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.908455{col 26}{space 2} .5974235{col 37}{space 5} 3.732981{col 51}{space 3} 6.083928
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.106674{col 26}{space 2} 1.099692{col 37}{space 5}-.0570482{col 51}{space 3} 4.270397
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.431657{col 26}{space 2} .9873339{col 37}{space 5} 3.489006{col 51}{space 3} 7.374308
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5143774{col 26}{space 2} .3613373{col 37}{space 5}-.1965798{col 51}{space 3} 1.225335
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.787678{col 26}{space 2}  .562877{col 37}{space 5} 2.680177{col 51}{space 3} 4.895179
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex2    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6316941{col 26}{space 2}  .187807{col 37}{space 5} .2621703{col 51}{space 3} 1.001218
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1548432{col 26}{space 2} .1090982{col 37}{space 5}-.0598154{col 51}{space 3} .3695018
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.657232{col 26}{space 2}     .266{col 37}{space 5} 1.133858{col 51}{space 3} 2.180607
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} .7795757{col 26}{space 2} .5133542{col 37}{space 5}-.2304857{col 51}{space 3} 1.789637
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 1.851306{col 26}{space 2}  .395147{col 37}{space 5} 1.073826{col 51}{space 3} 2.628786
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}   .15622{col 26}{space 2}  .140974{col 37}{space 5}-.1211564{col 51}{space 3} .4335964
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.336049{col 26}{space 2} .2523135{col 37}{space 5} .8396042{col 51}{space 3} 1.832494
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

         {txt}Over: strata rural
    _subpop_1: {res}central urban Urban
    {txt}_subpop_2: {res}central rural Rural
    {txt}_subpop_3: {res}Eastern urban Urban
    {txt}_subpop_4: {res}Eastern rural Rural
    {txt}_subpop_5: {res}Northern urban Urban
    {txt}_subpop_6: {res}Northern rural Rural
    {txt}_subpop_7: {res}Western Urban Urban
    {txt}_subpop_8: {res}Western rural Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex2      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 9.623426{col 26}{space 2} 4.111047{col 37}{space 5} 1.534644{col 51}{space 3} 17.71221
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.82511{col 26}{space 2} 3.037433{col 37}{space 5} 15.84874{col 51}{space 3} 27.80148
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.97278{col 26}{space 2} 2.165507{col 37}{space 5} 13.71199{col 51}{space 3} 22.23357
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex2     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2}  2.10521{col 26}{space 2} .4630464{col 37}{space 5} 1.194133{col 51}{space 3} 3.016287
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7495527{col 26}{space 2} .4097461{col 37}{space 5}-.0566523{col 51}{space 3} 1.555758
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.908455{col 26}{space 2} .5974235{col 37}{space 5} 3.732981{col 51}{space 3} 6.083928
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.106674{col 26}{space 2} 1.099692{col 37}{space 5}-.0570482{col 51}{space 3} 4.270397
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.431657{col 26}{space 2} .9873339{col 37}{space 5} 3.489006{col 51}{space 3} 7.374308
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5143774{col 26}{space 2} .3613373{col 37}{space 5}-.1965798{col 51}{space 3} 1.225335
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.787678{col 26}{space 2}  .562877{col 37}{space 5} 2.680177{col 51}{space 3} 4.895179
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex2    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6316941{col 26}{space 2}  .187807{col 37}{space 5} .2621703{col 51}{space 3} 1.001218
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1548432{col 26}{space 2} .1090982{col 37}{space 5}-.0598154{col 51}{space 3} .3695018
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.657232{col 26}{space 2}     .266{col 37}{space 5} 1.133858{col 51}{space 3} 2.180607
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} .7795757{col 26}{space 2} .5133542{col 37}{space 5}-.2304857{col 51}{space 3} 1.789637
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 1.851306{col 26}{space 2}  .395147{col 37}{space 5} 1.073826{col 51}{space 3} 2.628786
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}   .15622{col 26}{space 2}  .140974{col 37}{space 5}-.1211564{col 51}{space 3} .4335964
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.336049{col 26}{space 2} .2523135{col 37}{space 5} .8396042{col 51}{space 3} 1.832494
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex2      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 21.57247{col 26}{space 2} 1.974915{col 37}{space 5} 17.68668{col 51}{space 3} 25.45825
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 20.11614{col 26}{space 2} 2.680788{col 37}{space 5}  14.8415{col 51}{space 3} 25.39078
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 17.13877{col 26}{space 2} 2.044267{col 37}{space 5} 13.11653{col 51}{space 3} 21.16101
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex2     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2}  2.10521{col 26}{space 2} .4630464{col 37}{space 5} 1.194133{col 51}{space 3} 3.016287
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 4.603517{col 26}{space 2} .5557552{col 37}{space 5} 3.510028{col 51}{space 3} 5.697005
{txt}{space 4}Northern {c |}{col 14}{res}{space 2}  4.96596{col 26}{space 2} .8645184{col 37}{space 5} 3.264958{col 51}{space 3} 6.666962
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.587274{col 26}{space 2} .5316292{col 37}{space 5} 2.541255{col 51}{space 3} 4.633293
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex2    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6316941{col 26}{space 2}  .187807{col 37}{space 5} .2621703{col 51}{space 3} 1.001218
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.547075{col 26}{space 2}  .246964{col 37}{space 5} 1.061155{col 51}{space 3} 2.032994
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.701199{col 26}{space 2} .3480676{col 37}{space 5} 1.016351{col 51}{space 3} 2.386048
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.263815{col 26}{space 2} .2382299{col 37}{space 5}  .795081{col 51}{space 3}  1.73255
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}h_flex2 was {res}float{txt} now {res}byte
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_real_it2.dta saved

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 5}h_flex2 {c |}{res}    3108  28069559.9    15.89283    36.5668          0        100
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/foodshares_it2.dta saved
file /tmp/St02564.000002 saved
{p 0 4 2}
variable{txt} one
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00

   {txt}relpoor3 {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 1,564.2118       50.15       50.15
{txt}          1 {c |}{res} 1,554.7882       49.85      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/relpoor_it3.dta saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        1.99        1.99
{txt}          2 {c |}{res}          1        0.00        1.99
{txt}          3 {c |}{res}     42,120       98.01      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     42,976      100.00
{txt}(3978 observations deleted)
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          4        0.01        0.01
{txt}          3 {c |}{res}     38,998       99.99      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,002      100.00
{txt}(25631 observations deleted)
(2 missing values generated)
{res}    2
    0
{txt}(2 missing values generated)
{res}    2
{txt}(2 observations deleted)
(note: file /tmp/St02564.00000h not found)
file /tmp/St02564.00000h saved
(note: file /tmp/St02564.00000i not found)
file /tmp/St02564.00000i saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     13,369      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     13,369      100.00
  125
{txt}(125 observations deleted)
file /tmp/St02564.00000h saved
39
39
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/codes_food_basket_flex_it3.dta saved
(3 observations deleted)
(note: file /tmp/St02564.00000j not found)
file /tmp/St02564.00000j saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        2.15        2.15
{txt}          2 {c |}{res}          3        0.01        2.15
{txt}          3 {c |}{res}     38,995       97.85      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,853      100.00
{txt}(3 observations deleted)
file /tmp/St02564.00000j saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}      4,929       12.37       12.37
{txt}          3 {c |}{res}     34,921       87.63      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,850      100.00
{txt}(4929 observations deleted)
(3005 observations deleted)
(note: file /tmp/St02564.00000l not found)
file /tmp/St02564.00000l saved
product was {res}float{txt} now {res}int
{txt}unit was {res}float{txt} now {res}byte
{txt}food_cat was {res}float{txt} now {res}byte
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}bswt was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}count was {res}float{txt} now {res}byte
{txt}numreg was {res}double{txt} now {res}byte
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}
survquar was {res}byte{txt} now {res}float
{txt}spdomain was {res}byte{txt} now {res}float
{txt}(label lspdomain already defined)
(label lregion already defined)
(label lsurvquar already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        103        0.32        0.32
{txt}          3 {c |}{res}     31,916       99.68      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     32,019      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}(20599 observations deleted)
(12 observations deleted)
(817 observations deleted)

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 4}ratiotw3 {c |}{res}       175    1.245453    .4263509   .7769808   3.337594
{txt}{space 4}ratiomw3 {c |}{res}       175    1.107208     .400503   .6105599   4.164927
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          3        1.69        1.69
{txt}          3 {c |}{res}        175       98.31      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        178      100.00
    3
{txt}(3 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/price_unit_flex_it3.dta saved
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          7        3.85        3.85
{txt}          2 {c |}{res}         55       30.22       34.07
{txt}          3 {c |}{res}        120       65.93      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        182      100.00
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c TRC}
     {c |} {res}product        spdomain {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
121. {c |} {res}    157   Central Urban {txt}{c |}
122. {c |} {res}    157   Central Rural {txt}{c |}
123. {c |} {res}    157         Eastern {txt}{c |}
124. {c |} {res}    160   Central Urban {txt}{c |}
125. {c |} {res}    161   Central Urban {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
126. {c |} {res}    161         Eastern {txt}{c |}
127. {c |} {res}    161        Northern {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c BRC}
(62 observations deleted)
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}         26       17.81       17.81
{txt}          3 {c |}{res}        120       82.19      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        146      100.00
{txt}(26 observations deleted)

{hline}
-> spdomain = Central Urban
{res}    3
{txt}{hline}
-> spdomain = Central Rural
{res}    1
{txt}{hline}
-> spdomain = Eastern
{res}    0
{txt}{hline}
-> spdomain = Northern
{res}    0
{txt}{hline}
-> spdomain = Western
{res}    0

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}bswt {c |}{res}       120    79.26667     69.6863          3        338
{txt}(4 observations deleted)
(4 observations deleted)

Summary for variables: baskshr
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .8147091         0  .8147091  .8147091
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       20  .9004949         0  .9004949  .9004949
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27  .9084003         0  .9084003  .9084003
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24  .8921682         0  .8921682  .8921682
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .9046451         0  .9046451  .9046451
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      112  .8876816  .0325805  .8147091  .9084003
{txt}{hline 14}{c BT}{hline 50}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}        112      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        112      100.00
{txt}(112 real changes made)
(107 real changes made)
(112 real changes made)

Summary for variables: chkcal
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .0001028         0  .0001028  .0001028
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       20 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24 -.0001542         0 -.0001542 -.0001542
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .0000385         0  .0000385  .0000385
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      112 -.0000302  .0000858 -.0001542  .0001028
{txt}{hline 14}{c BT}{hline 50}
(112 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/quan_flex_it3.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povline_food_flex_it3.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(236 real changes made)
(5 missing values generated)
(note: file /tmp/St02564.00000n not found)
file /tmp/St02564.00000n saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(5 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it3.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it3.dta
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(16 missing values generated)
(5 missing values generated)
(5 missing values generated)
(16 missing values generated)
(3119 real changes made)
(5 missing values generated)
(3108 real changes made)

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 6}cr_it3 {c |}{res}    3108  28069559.9    1060.929    977.442    121.897    20009.3
{txt}{space 5}linpob3 {c |}{res}    3119  28164219.1    439.1663   67.78147   310.1803   546.7244
{txt}{space 4}linpobr3 {c |}{res}    3119  28164219.1    446.9602   .0000208   446.9602   446.9603
{txt}(5 missing values generated)
(2726 missing values generated)
(2710 real changes made)
(16 missing values generated)
(2710 real changes made)
(16 missing values generated)
(2710 real changes made)
(16 missing values generated)
(16 missing values generated)
(16 missing values generated)
(5 missing values generated)

      pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 5}h_flex3 {c |}{col 14}{res}{space 2} 15.88506{col 26}{space 2} .9835488{col 37}{space 5} 13.94986{col 51}{space 3} 17.82026
{txt}{space 4}pg_flex3 {c |}{col 14}{res}{space 2} 3.398433{col 26}{space 2} .2685307{col 37}{space 5} 2.870079{col 51}{space 3} 3.926786
{txt}{space 3}spg_flex3 {c |}{col 14}{res}{space 2} 1.151381{col 26}{space 2} .1148949{col 37}{space 5} .9253166{col 51}{space 3} 1.377444
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex3      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} 3.446155{col 26}{space 2} .9012713{col 37}{space 5} 1.672839{col 51}{space 3} 5.219472
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 18.46366{col 26}{space 2} 1.160692{col 37}{space 5} 16.17991{col 51}{space 3}  20.7474
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex3     {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6933881{col 26}{space 2}  .218629{col 37}{space 5} .2632198{col 51}{space 3} 1.123556
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 3.959192{col 26}{space 2} .3180957{col 37}{space 5} 3.333316{col 51}{space 3} 4.585068
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex3    {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .2571865{col 26}{space 2} .1146384{col 37}{space 5} .0316273{col 51}{space 3} .4827458
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 1.336748{col 26}{space 2} .1354828{col 37}{space 5} 1.070176{col 51}{space 3}  1.60332
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex3      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 8.404917{col 26}{space 2} 3.859064{col 37}{space 5} .8119299{col 51}{space 3}  15.9979
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.62438{col 26}{space 2} 3.027973{col 37}{space 5} 15.66663{col 51}{space 3} 27.58214
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 18.17612{col 26}{space 2}  2.18453{col 37}{space 5}  13.8779{col 51}{space 3} 22.47434
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex3     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179243{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584493
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067666{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970071
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2}  .749595{col 26}{space 2} .4097605{col 37}{space 5}-.0566383{col 51}{space 3} 1.555828
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.908658{col 26}{space 2} .5974349{col 37}{space 5} 3.733161{col 51}{space 3} 6.084154
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.071339{col 26}{space 2} 1.087193{col 37}{space 5}-.0677907{col 51}{space 3} 4.210469
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.346812{col 26}{space 2} .9779424{col 37}{space 5}  3.42264{col 51}{space 3} 7.270985
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5158726{col 26}{space 2} .3618358{col 37}{space 5}-.1960655{col 51}{space 3} 1.227811
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.793234{col 26}{space 2} .5633364{col 37}{space 5} 2.684829{col 51}{space 3} 4.901638
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex3    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199515{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856004
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1548567{col 26}{space 2} .1091048{col 37}{space 5}-.0598149{col 51}{space 3} .3695282
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.657306{col 26}{space 2} .2660066{col 37}{space 5} 1.133918{col 51}{space 3} 2.180693
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} .7658821{col 26}{space 2} .5079229{col 37}{space 5}-.2334929{col 51}{space 3} 1.765257
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 1.814288{col 26}{space 2} .3891753{col 37}{space 5} 1.048558{col 51}{space 3} 2.580019
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .1564997{col 26}{space 2}  .141139{col 37}{space 5}-.1212015{col 51}{space 3} .4342009
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.337962{col 26}{space 2} .2525306{col 37}{space 5} .8410899{col 51}{space 3} 1.834834
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

         {txt}Over: strata rural
    _subpop_1: {res}central urban Urban
    {txt}_subpop_2: {res}central rural Rural
    {txt}_subpop_3: {res}Eastern urban Urban
    {txt}_subpop_4: {res}Eastern rural Rural
    {txt}_subpop_5: {res}Northern urban Urban
    {txt}_subpop_6: {res}Northern rural Rural
    {txt}_subpop_7: {res}Western Urban Urban
    {txt}_subpop_8: {res}Western rural Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex3      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 8.404917{col 26}{space 2} 3.859064{col 37}{space 5} .8119299{col 51}{space 3}  15.9979
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.62438{col 26}{space 2} 3.027973{col 37}{space 5} 15.66663{col 51}{space 3} 27.58214
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 18.17612{col 26}{space 2}  2.18453{col 37}{space 5}  13.8779{col 51}{space 3} 22.47434
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex3     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179243{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584493
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067666{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970071
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2}  .749595{col 26}{space 2} .4097605{col 37}{space 5}-.0566383{col 51}{space 3} 1.555828
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.908658{col 26}{space 2} .5974349{col 37}{space 5} 3.733161{col 51}{space 3} 6.084154
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.071339{col 26}{space 2} 1.087193{col 37}{space 5}-.0677907{col 51}{space 3} 4.210469
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.346812{col 26}{space 2} .9779424{col 37}{space 5}  3.42264{col 51}{space 3} 7.270985
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5158726{col 26}{space 2} .3618358{col 37}{space 5}-.1960655{col 51}{space 3} 1.227811
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.793234{col 26}{space 2} .5633364{col 37}{space 5} 2.684829{col 51}{space 3} 4.901638
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex3    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199515{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856004
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1548567{col 26}{space 2} .1091048{col 37}{space 5}-.0598149{col 51}{space 3} .3695282
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.657306{col 26}{space 2} .2660066{col 37}{space 5} 1.133918{col 51}{space 3} 2.180693
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} .7658821{col 26}{space 2} .5079229{col 37}{space 5}-.2334929{col 51}{space 3} 1.765257
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 1.814288{col 26}{space 2} .3891753{col 37}{space 5} 1.048558{col 51}{space 3} 2.580019
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .1564997{col 26}{space 2}  .141139{col 37}{space 5}-.1212015{col 51}{space 3} .4342009
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.337962{col 26}{space 2} .2525306{col 37}{space 5} .8410899{col 51}{space 3} 1.834834
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex3      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 21.57247{col 26}{space 2} 1.974915{col 37}{space 5} 17.68668{col 51}{space 3} 25.45825
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 19.77286{col 26}{space 2} 2.671408{col 37}{space 5} 14.51668{col 51}{space 3} 25.02905
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 17.32966{col 26}{space 2} 2.062067{col 37}{space 5}  13.2724{col 51}{space 3} 21.38693
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex3     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179243{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584493
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067666{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970071
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 4.603708{col 26}{space 2}  .555766{col 37}{space 5} 3.510198{col 51}{space 3} 5.697217
{txt}{space 4}Northern {c |}{col 14}{res}{space 2}  4.88805{col 26}{space 2} .8562215{col 37}{space 5} 3.203372{col 51}{space 3} 6.572727
{txt}{space 5}Western {c |}{col 14}{res}{space 2}  3.59258{col 26}{space 2} .5320644{col 37}{space 5} 2.545706{col 51}{space 3} 4.639455
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex3    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199515{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856004
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.547143{col 26}{space 2} .2469702{col 37}{space 5} 1.061212{col 51}{space 3} 2.033075
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.667449{col 26}{space 2} .3428755{col 37}{space 5} .9928164{col 51}{space 3} 2.342081
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.265628{col 26}{space 2} .2384353{col 37}{space 5} .7964897{col 51}{space 3} 1.734767
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}h_flex3 was {res}float{txt} now {res}byte
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_real_it3.dta saved

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 5}h_flex3 {c |}{res}    3108  28069559.9    15.88506   36.55955          0        100
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/foodshares_it3.dta saved
file /tmp/St02564.000002 saved
{p 0 4 2}
variable{txt} one
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00

   {txt}relpoor4 {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 1,564.5939       50.16       50.16
{txt}          1 {c |}{res} 1,554.4061       49.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/relpoor_it4.dta saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        1.99        1.99
{txt}          2 {c |}{res}          1        0.00        1.99
{txt}          3 {c |}{res}     42,120       98.01      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     42,976      100.00
{txt}(3978 observations deleted)
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          4        0.01        0.01
{txt}          3 {c |}{res}     38,998       99.99      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,002      100.00
{txt}(25623 observations deleted)
(2 missing values generated)
{res}    2
    0
{txt}(2 missing values generated)
{res}    2
{txt}(2 observations deleted)
(note: file /tmp/St02564.00000o not found)
file /tmp/St02564.00000o saved
(note: file /tmp/St02564.00000p not found)
file /tmp/St02564.00000p saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     13,377      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     13,377      100.00
  125
{txt}(125 observations deleted)
file /tmp/St02564.00000o saved
39
39
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/codes_food_basket_flex_it4.dta saved
(3 observations deleted)
(note: file /tmp/St02564.00000q not found)
file /tmp/St02564.00000q saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        2.15        2.15
{txt}          2 {c |}{res}          3        0.01        2.15
{txt}          3 {c |}{res}     38,995       97.85      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,853      100.00
{txt}(3 observations deleted)
file /tmp/St02564.00000q saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}      4,929       12.37       12.37
{txt}          3 {c |}{res}     34,921       87.63      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,850      100.00
{txt}(4929 observations deleted)
(3005 observations deleted)
(note: file /tmp/St02564.00000s not found)
file /tmp/St02564.00000s saved
product was {res}float{txt} now {res}int
{txt}unit was {res}float{txt} now {res}byte
{txt}food_cat was {res}float{txt} now {res}byte
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}bswt was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}count was {res}float{txt} now {res}byte
{txt}numreg was {res}double{txt} now {res}byte
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}
survquar was {res}byte{txt} now {res}float
{txt}spdomain was {res}byte{txt} now {res}float
{txt}(label lspdomain already defined)
(label lregion already defined)
(label lsurvquar already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        103        0.32        0.32
{txt}          3 {c |}{res}     31,916       99.68      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     32,019      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}(20587 observations deleted)
(12 observations deleted)
(831 observations deleted)

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 4}ratiotw4 {c |}{res}       175    1.245532    .4261914   .7769808   3.337594
{txt}{space 4}ratiomw4 {c |}{res}       175    1.106541     .401926   .4394891   4.164927
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          3        1.69        1.69
{txt}          3 {c |}{res}        175       98.31      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        178      100.00
    3
{txt}(3 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/price_unit_flex_it4.dta saved
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          7        3.85        3.85
{txt}          2 {c |}{res}         55       30.22       34.07
{txt}          3 {c |}{res}        120       65.93      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        182      100.00
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c TRC}
     {c |} {res}product        spdomain {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
121. {c |} {res}    157   Central Urban {txt}{c |}
122. {c |} {res}    157   Central Rural {txt}{c |}
123. {c |} {res}    157         Eastern {txt}{c |}
124. {c |} {res}    160   Central Urban {txt}{c |}
125. {c |} {res}    161   Central Urban {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
126. {c |} {res}    161         Eastern {txt}{c |}
127. {c |} {res}    161        Northern {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c BRC}
(62 observations deleted)
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}         26       17.81       17.81
{txt}          3 {c |}{res}        120       82.19      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        146      100.00
{txt}(26 observations deleted)

{hline}
-> spdomain = Central Urban
{res}    3
{txt}{hline}
-> spdomain = Central Rural
{res}    1
{txt}{hline}
-> spdomain = Eastern
{res}    0
{txt}{hline}
-> spdomain = Northern
{res}    0
{txt}{hline}
-> spdomain = Western
{res}    0

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}bswt {c |}{res}       120    79.26667    69.55812          3        339
{txt}(4 observations deleted)
(4 observations deleted)

Summary for variables: baskshr
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .8147091         0  .8147091  .8147091
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       20  .9004949         0  .9004949  .9004949
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27  .9086618         0  .9086618  .9086618
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24  .8921608         0  .8921608  .8921608
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .9046368         0  .9046368  .9046368
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      112  .8877414    .03262  .8147091  .9086618
{txt}{hline 14}{c BT}{hline 50}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}        112      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        112      100.00
{txt}(112 real changes made)
(107 real changes made)
(112 real changes made)

Summary for variables: chkcal
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .0001028         0  .0001028  .0001028
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       20 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24 -.0001542         0 -.0001542 -.0001542
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .0000385         0  .0000385  .0000385
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      112 -.0000302  .0000858 -.0001542  .0001028
{txt}{hline 14}{c BT}{hline 50}
(112 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/quan_flex_it4.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povline_food_flex_it4.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(236 real changes made)
(5 missing values generated)
(note: file /tmp/St02564.00000u not found)
file /tmp/St02564.00000u saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(5 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it4.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it4.dta
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(16 missing values generated)
(5 missing values generated)
(5 missing values generated)
(16 missing values generated)
(3119 real changes made)
(5 missing values generated)
(3108 real changes made)

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 6}cr_it4 {c |}{res}    3108  28069559.9    1060.929   977.5204   121.9062    20018.6
{txt}{space 5}linpob4 {c |}{res}    3119  28164219.1     439.223   67.80795   310.1624   546.7244
{txt}{space 4}linpobr4 {c |}{res}    3119  28164219.1    446.9937          0   446.9937   446.9937
{txt}(5 missing values generated)
(2727 missing values generated)
(2711 real changes made)
(16 missing values generated)
(2711 real changes made)
(16 missing values generated)
(2711 real changes made)
(16 missing values generated)
(16 missing values generated)
(16 missing values generated)
(5 missing values generated)

      pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 5}h_flex4 {c |}{col 14}{res}{space 2} 15.83399{col 26}{space 2} .9805861{col 37}{space 5} 13.90462{col 51}{space 3} 17.76337
{txt}{space 4}pg_flex4 {c |}{col 14}{res}{space 2} 3.400828{col 26}{space 2} .2685763{col 37}{space 5} 2.872385{col 51}{space 3} 3.929272
{txt}{space 3}spg_flex4 {c |}{col 14}{res}{space 2} 1.152262{col 26}{space 2} .1149257{col 37}{space 5} .9261378{col 51}{space 3} 1.378387
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex4      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} 3.446155{col 26}{space 2} .9012713{col 37}{space 5} 1.672839{col 51}{space 3} 5.219472
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 18.40201{col 26}{space 2} 1.157092{col 37}{space 5} 16.12535{col 51}{space 3} 20.67867
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex4     {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6935682{col 26}{space 2} .2186354{col 37}{space 5} .2633874{col 51}{space 3} 1.123749
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 3.962047{col 26}{space 2} .3181491{col 37}{space 5} 3.336065{col 51}{space 3} 4.588028
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex4    {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .2572576{col 26}{space 2} .1146385{col 37}{space 5} .0316982{col 51}{space 3} .4828171
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 1.337798{col 26}{space 2} .1355201{col 37}{space 5} 1.071152{col 51}{space 3} 1.604443
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex4      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 8.404917{col 26}{space 2} 3.859064{col 37}{space 5} .8119299{col 51}{space 3}  15.9979
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.62438{col 26}{space 2} 3.027973{col 37}{space 5} 15.66663{col 51}{space 3} 27.58214
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.97278{col 26}{space 2} 2.165507{col 37}{space 5} 13.71199{col 51}{space 3} 22.23357
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex4     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067667{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970072
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7531418{col 26}{space 2} .4109651{col 37}{space 5}-.0554615{col 51}{space 3} 1.561745
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.925694{col 26}{space 2} .5983956{col 37}{space 5} 3.748308{col 51}{space 3} 6.103081
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.070973{col 26}{space 2} 1.087055{col 37}{space 5}-.0678861{col 51}{space 3} 4.209832
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.345871{col 26}{space 2} .9778379{col 37}{space 5} 3.421904{col 51}{space 3} 7.269837
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5143775{col 26}{space 2} .3613374{col 37}{space 5}-.1965798{col 51}{space 3} 1.225335
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.787679{col 26}{space 2}  .562877{col 37}{space 5} 2.680178{col 51}{space 3}  4.89518
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex4    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199516{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856005
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1559843{col 26}{space 2} .1096572{col 37}{space 5} -.059774{col 51}{space 3} .3717427
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.663469{col 26}{space 2} .2665669{col 37}{space 5} 1.138979{col 51}{space 3} 2.187958
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2}  .765731{col 26}{space 2} .5078629{col 37}{space 5}-.2335258{col 51}{space 3} 1.764988
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2}  1.81388{col 26}{space 2} .3891091{col 37}{space 5} 1.048279{col 51}{space 3}  2.57948
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}   .15622{col 26}{space 2}  .140974{col 37}{space 5}-.1211564{col 51}{space 3} .4335965
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.336049{col 26}{space 2} .2523135{col 37}{space 5} .8396044{col 51}{space 3} 1.832495
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

         {txt}Over: strata rural
    _subpop_1: {res}central urban Urban
    {txt}_subpop_2: {res}central rural Rural
    {txt}_subpop_3: {res}Eastern urban Urban
    {txt}_subpop_4: {res}Eastern rural Rural
    {txt}_subpop_5: {res}Northern urban Urban
    {txt}_subpop_6: {res}Northern rural Rural
    {txt}_subpop_7: {res}Western Urban Urban
    {txt}_subpop_8: {res}Western rural Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex4      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 8.404917{col 26}{space 2} 3.859064{col 37}{space 5} .8119299{col 51}{space 3}  15.9979
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.62438{col 26}{space 2} 3.027973{col 37}{space 5} 15.66663{col 51}{space 3} 27.58214
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.97278{col 26}{space 2} 2.165507{col 37}{space 5} 13.71199{col 51}{space 3} 22.23357
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex4     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067667{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970072
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7531418{col 26}{space 2} .4109651{col 37}{space 5}-.0554615{col 51}{space 3} 1.561745
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.925694{col 26}{space 2} .5983956{col 37}{space 5} 3.748308{col 51}{space 3} 6.103081
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.070973{col 26}{space 2} 1.087055{col 37}{space 5}-.0678861{col 51}{space 3} 4.209832
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.345871{col 26}{space 2} .9778379{col 37}{space 5} 3.421904{col 51}{space 3} 7.269837
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5143775{col 26}{space 2} .3613374{col 37}{space 5}-.1965798{col 51}{space 3} 1.225335
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.787679{col 26}{space 2}  .562877{col 37}{space 5} 2.680178{col 51}{space 3}  4.89518
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex4    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199516{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856005
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1559843{col 26}{space 2} .1096572{col 37}{space 5} -.059774{col 51}{space 3} .3717427
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.663469{col 26}{space 2} .2665669{col 37}{space 5} 1.138979{col 51}{space 3} 2.187958
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2}  .765731{col 26}{space 2} .5078629{col 37}{space 5}-.2335258{col 51}{space 3} 1.764988
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2}  1.81388{col 26}{space 2} .3891091{col 37}{space 5} 1.048279{col 51}{space 3}  2.57948
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}   .15622{col 26}{space 2}  .140974{col 37}{space 5}-.1211564{col 51}{space 3} .4335965
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.336049{col 26}{space 2} .2523135{col 37}{space 5} .8396044{col 51}{space 3} 1.832495
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex4      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 21.57247{col 26}{space 2} 1.974915{col 37}{space 5} 17.68668{col 51}{space 3} 25.45825
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 19.77286{col 26}{space 2} 2.671408{col 37}{space 5} 14.51668{col 51}{space 3} 25.02905
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 17.13877{col 26}{space 2} 2.044267{col 37}{space 5} 13.11653{col 51}{space 3} 21.16101
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex4     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067667{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970072
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 4.619755{col 26}{space 2} .5566681{col 37}{space 5} 3.524471{col 51}{space 3}  5.71504
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 4.887189{col 26}{space 2} .8561292{col 37}{space 5} 3.202693{col 51}{space 3} 6.571684
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.587274{col 26}{space 2} .5316293{col 37}{space 5} 2.541255{col 51}{space 3} 4.633293
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex4    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199516{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856005
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.552937{col 26}{space 2} .2474923{col 37}{space 5} 1.065978{col 51}{space 3} 2.039896
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.667076{col 26}{space 2} .3428179{col 37}{space 5}  .992557{col 51}{space 3} 2.341595
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.263816{col 26}{space 2} .2382299{col 37}{space 5} .7950811{col 51}{space 3}  1.73255
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}h_flex4 was {res}float{txt} now {res}byte
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_real_it4.dta saved

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 5}h_flex4 {c |}{res}    3108  28069559.9    15.83399   36.51182          0        100
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/foodshares_it4.dta saved
file /tmp/St02564.000002 saved
{p 0 4 2}
variable{txt} one
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00

   {txt}relpoor5 {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          0 {c |}{res} 1,564.5939       50.16       50.16
{txt}          1 {c |}{res} 1,554.4061       49.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,119      100.00
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/relpoor_it5.dta saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        1.99        1.99
{txt}          2 {c |}{res}          1        0.00        1.99
{txt}          3 {c |}{res}     42,120       98.01      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     42,976      100.00
{txt}(3978 observations deleted)
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          4        0.01        0.01
{txt}          3 {c |}{res}     38,998       99.99      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,002      100.00
{txt}(25623 observations deleted)
(2 missing values generated)
{res}    2
    0
{txt}(2 missing values generated)
{res}    2
{txt}(2 observations deleted)
(note: file /tmp/St02564.00000v not found)
file /tmp/St02564.00000v saved
(note: file /tmp/St02564.00000w not found)
file /tmp/St02564.00000w saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     13,377      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     13,377      100.00
  125
{txt}(125 observations deleted)
file /tmp/St02564.00000v saved
39
39
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/codes_food_basket_flex_it5.dta saved
(3 observations deleted)
(note: file /tmp/St02564.00000x not found)
file /tmp/St02564.00000x saved
{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        855        2.15        2.15
{txt}          2 {c |}{res}          3        0.01        2.15
{txt}          3 {c |}{res}     38,995       97.85      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,853      100.00
{txt}(3 observations deleted)
file /tmp/St02564.00000x saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}      4,929       12.37       12.37
{txt}          3 {c |}{res}     34,921       87.63      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     39,850      100.00
{txt}(4929 observations deleted)
(3005 observations deleted)
(note: file /tmp/St02564.000011 not found)
file /tmp/St02564.000011 saved
product was {res}float{txt} now {res}int
{txt}unit was {res}float{txt} now {res}byte
{txt}food_cat was {res}float{txt} now {res}byte
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}bswt was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}count was {res}float{txt} now {res}byte
{txt}numreg was {res}double{txt} now {res}byte
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}
survquar was {res}byte{txt} now {res}float
{txt}spdomain was {res}byte{txt} now {res}float
{txt}(label lspdomain already defined)
(label lregion already defined)
(label lsurvquar already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}        103        0.32        0.32
{txt}          3 {c |}{res}     31,916       99.68      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}{p 0 4 2}
variable{txt} hhid
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}     32,019      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}     32,019      100.00
{txt}(20587 observations deleted)
(12 observations deleted)
(831 observations deleted)

    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 4}ratiotw5 {c |}{res}       175    1.245532    .4261914   .7769808   3.337594
{txt}{space 4}ratiomw5 {c |}{res}       175    1.106541     .401926   .4394891   4.164927
{txt}{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
product was {res}int{txt} now {res}float

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          3        1.69        1.69
{txt}          3 {c |}{res}        175       98.31      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        178      100.00
    3
{txt}(3 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/price_unit_flex_it5.dta saved
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          7        3.85        3.85
{txt}          2 {c |}{res}         55       30.22       34.07
{txt}          3 {c |}{res}        120       65.93      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        182      100.00
{txt}
     {c TLC}{hline 9}{c -}{hline 15}{c TRC}
     {c |} {res}product        spdomain {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
121. {c |} {res}    157   Central Urban {txt}{c |}
122. {c |} {res}    157   Central Rural {txt}{c |}
123. {c |} {res}    157         Eastern {txt}{c |}
124. {c |} {res}    160   Central Urban {txt}{c |}
125. {c |} {res}    161   Central Urban {txt}{c |}
     {c LT}{hline 9}{c -}{hline 15}{c RT}
126. {c |} {res}    161         Eastern {txt}{c |}
127. {c |} {res}    161        Northern {txt}{c |}
     {c BLC}{hline 9}{c -}{hline 15}{c BRC}
(62 observations deleted)
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}         26       17.81       17.81
{txt}          3 {c |}{res}        120       82.19      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        146      100.00
{txt}(26 observations deleted)

{hline}
-> spdomain = Central Urban
{res}    3
{txt}{hline}
-> spdomain = Central Rural
{res}    1
{txt}{hline}
-> spdomain = Eastern
{res}    0
{txt}{hline}
-> spdomain = Northern
{res}    0
{txt}{hline}
-> spdomain = Western
{res}    0

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 8}bswt {c |}{res}       120    79.26667    69.55812          3        339
{txt}(4 observations deleted)
(4 observations deleted)

Summary for variables: baskshr
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .8147091         0  .8147091  .8147091
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       20  .9004949         0  .9004949  .9004949
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27  .9086618         0  .9086618  .9086618
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24  .8921608         0  .8921608  .8921608
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .9046368         0  .9046368  .9046368
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      112  .8877414    .03262  .8147091  .9086618
{txt}{hline 14}{c BT}{hline 50}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}        112      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        112      100.00
{txt}(112 real changes made)
(107 real changes made)
(112 real changes made)

Summary for variables: chkcal
{col 6}by categories of: spdomain (Spatial domains: each with own poverty line (they are 5))

{ralign 13:spdomain} {...}
{c |}         N      mean        sd       min       max
{hline 14}{c +}{hline 50}
{ralign 13:Central Urban} {...}
{c |}{...}
 {res}       18  .0001028         0  .0001028  .0001028
{txt}{ralign 13:Central Rural} {...}
{c |}{...}
 {res}       20 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Eastern} {...}
{c |}{...}
 {res}       27 -.0000514         0 -.0000514 -.0000514
{txt}{ralign 13:Northern} {...}
{c |}{...}
 {res}       24 -.0001542         0 -.0001542 -.0001542
{txt}{ralign 13:Western} {...}
{c |}{...}
 {res}       23  .0000385         0  .0000385  .0000385
{txt}{hline 14}{c +}{hline 50}
{ralign 13:Total} {...}
{c |}{...}
 {res}      112 -.0000302  .0000858 -.0001542  .0001028
{txt}{hline 14}{c BT}{hline 50}
(112 real changes made)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/quan_flex_it5.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povline_food_flex_it5.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(236 real changes made)
(5 missing values generated)
(note: file /tmp/St02564.000013 not found)
file /tmp/St02564.000013 saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(5 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it5.dta saved
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}
{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines_it5.dta
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}      3,124      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}(16 missing values generated)
(5 missing values generated)
(5 missing values generated)
(16 missing values generated)
(3119 real changes made)
(5 missing values generated)
(3108 real changes made)

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 6}cr_it5 {c |}{res}    3108  28069559.9    1060.929   977.5204   121.9062    20018.6
{txt}{space 5}linpob5 {c |}{res}    3119  28164219.1     439.223   67.80795   310.1624   546.7244
{txt}{space 4}linpobr5 {c |}{res}    3119  28164219.1    446.9937          0   446.9937   446.9937
{txt}(5 missing values generated)
(2727 missing values generated)
(2711 real changes made)
(16 missing values generated)
(2711 real changes made)
(16 missing values generated)
(2711 real changes made)
(16 missing values generated)
(16 missing values generated)
(16 missing values generated)
(5 missing values generated)

      pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 5}h_flex5 {c |}{col 14}{res}{space 2} 15.83399{col 26}{space 2} .9805861{col 37}{space 5} 13.90462{col 51}{space 3} 17.76337
{txt}{space 4}pg_flex5 {c |}{col 14}{res}{space 2} 3.400828{col 26}{space 2} .2685763{col 37}{space 5} 2.872385{col 51}{space 3} 3.929272
{txt}{space 3}spg_flex5 {c |}{col 14}{res}{space 2} 1.152262{col 26}{space 2} .1149257{col 37}{space 5} .9261378{col 51}{space 3} 1.378387
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex5      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} 3.446155{col 26}{space 2} .9012713{col 37}{space 5} 1.672839{col 51}{space 3} 5.219472
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 18.40201{col 26}{space 2} 1.157092{col 37}{space 5} 16.12535{col 51}{space 3} 20.67867
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex5     {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6935682{col 26}{space 2} .2186354{col 37}{space 5} .2633874{col 51}{space 3} 1.123749
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 3.962047{col 26}{space 2} .3181491{col 37}{space 5} 3.336065{col 51}{space 3} 4.588028
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex5    {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .2572576{col 26}{space 2} .1146385{col 37}{space 5} .0316982{col 51}{space 3} .4828171
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 1.337798{col 26}{space 2} .1355201{col 37}{space 5} 1.071152{col 51}{space 3} 1.604443
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex5      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 8.404917{col 26}{space 2} 3.859064{col 37}{space 5} .8119299{col 51}{space 3}  15.9979
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.62438{col 26}{space 2} 3.027973{col 37}{space 5} 15.66663{col 51}{space 3} 27.58214
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.97278{col 26}{space 2} 2.165507{col 37}{space 5} 13.71199{col 51}{space 3} 22.23357
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex5     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067667{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970072
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7531418{col 26}{space 2} .4109651{col 37}{space 5}-.0554615{col 51}{space 3} 1.561745
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.925694{col 26}{space 2} .5983956{col 37}{space 5} 3.748308{col 51}{space 3} 6.103081
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.070973{col 26}{space 2} 1.087055{col 37}{space 5}-.0678861{col 51}{space 3} 4.209832
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.345871{col 26}{space 2} .9778379{col 37}{space 5} 3.421904{col 51}{space 3} 7.269837
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5143775{col 26}{space 2} .3613374{col 37}{space 5}-.1965798{col 51}{space 3} 1.225335
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.787679{col 26}{space 2}  .562877{col 37}{space 5} 2.680178{col 51}{space 3}  4.89518
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex5    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199516{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856005
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1559843{col 26}{space 2} .1096572{col 37}{space 5} -.059774{col 51}{space 3} .3717427
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.663469{col 26}{space 2} .2665669{col 37}{space 5} 1.138979{col 51}{space 3} 2.187958
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2}  .765731{col 26}{space 2} .5078629{col 37}{space 5}-.2335258{col 51}{space 3} 1.764988
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2}  1.81388{col 26}{space 2} .3891091{col 37}{space 5} 1.048279{col 51}{space 3}  2.57948
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}   .15622{col 26}{space 2}  .140974{col 37}{space 5}-.1211564{col 51}{space 3} .4335965
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.336049{col 26}{space 2} .2523135{col 37}{space 5} .8396044{col 51}{space 3} 1.832495
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

         {txt}Over: strata rural
    _subpop_1: {res}central urban Urban
    {txt}_subpop_2: {res}central rural Rural
    {txt}_subpop_3: {res}Eastern urban Urban
    {txt}_subpop_4: {res}Eastern rural Rural
    {txt}_subpop_5: {res}Northern urban Urban
    {txt}_subpop_6: {res}Northern rural Rural
    {txt}_subpop_7: {res}Western Urban Urban
    {txt}_subpop_8: {res}Western rural Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex5      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 22.92328{col 26}{space 2} 2.115271{col 37}{space 5} 18.76134{col 51}{space 3} 27.08523
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 8.404917{col 26}{space 2} 3.859064{col 37}{space 5} .8119299{col 51}{space 3}  15.9979
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 21.62438{col 26}{space 2} 3.027973{col 37}{space 5} 15.66663{col 51}{space 3} 27.58214
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.97278{col 26}{space 2} 2.165507{col 37}{space 5} 13.71199{col 51}{space 3} 22.23357
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex5     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067667{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970072
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .7531418{col 26}{space 2} .4109651{col 37}{space 5}-.0554615{col 51}{space 3} 1.561745
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 4.925694{col 26}{space 2} .5983956{col 37}{space 5} 3.748308{col 51}{space 3} 6.103081
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 2.070973{col 26}{space 2} 1.087055{col 37}{space 5}-.0678861{col 51}{space 3} 4.209832
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 5.345871{col 26}{space 2} .9778379{col 37}{space 5} 3.421904{col 51}{space 3} 7.269837
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5143775{col 26}{space 2} .3613374{col 37}{space 5}-.1965798{col 51}{space 3} 1.225335
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.787679{col 26}{space 2}  .562877{col 37}{space 5} 2.680178{col 51}{space 3}  4.89518
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex5    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199516{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856005
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .1559843{col 26}{space 2} .1096572{col 37}{space 5} -.059774{col 51}{space 3} .3717427
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.663469{col 26}{space 2} .2665669{col 37}{space 5} 1.138979{col 51}{space 3} 2.187958
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2}  .765731{col 26}{space 2} .5078629{col 37}{space 5}-.2335258{col 51}{space 3} 1.764988
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2}  1.81388{col 26}{space 2} .3891091{col 37}{space 5} 1.048279{col 51}{space 3}  2.57948
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2}   .15622{col 26}{space 2}  .140974{col 37}{space 5}-.1211564{col 51}{space 3} .4335965
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 1.336049{col 26}{space 2} .2523135{col 37}{space 5} .8396044{col 51}{space 3} 1.832495
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3108
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28069560
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_flex5      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} 2.095422{col 26}{space 2} 1.021369{col 37}{space 5}  .085806{col 51}{space 3} 4.105039
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.42645{col 26}{space 2} 1.964039{col 37}{space 5} 7.562067{col 51}{space 3} 15.29084
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 21.57247{col 26}{space 2} 1.974915{col 37}{space 5} 17.68668{col 51}{space 3} 25.45825
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 19.77286{col 26}{space 2} 2.671408{col 37}{space 5} 14.51668{col 51}{space 3} 25.02905
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 17.13877{col 26}{space 2} 2.044267{col 37}{space 5} 13.11653{col 51}{space 3} 21.16101
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_flex5     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .4179244{col 26}{space 2} .2238927{col 37}{space 5}-.0226007{col 51}{space 3} .8584494
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.067667{col 26}{space 2} .4586388{col 37}{space 5} 1.165262{col 51}{space 3} 2.970072
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 4.619755{col 26}{space 2} .5566681{col 37}{space 5} 3.524471{col 51}{space 3}  5.71504
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 4.887189{col 26}{space 2} .8561292{col 37}{space 5} 3.202693{col 51}{space 3} 6.571684
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.587274{col 26}{space 2} .5316293{col 37}{space 5} 2.541255{col 51}{space 3} 4.633293
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_flex5    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1802621{col 26}{space 2} .1344968{col 37}{space 5}  -.08437{col 51}{space 3} .4448942
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6199516{col 26}{space 2} .1858376{col 37}{space 5} .2543027{col 51}{space 3} .9856005
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.552937{col 26}{space 2} .2474923{col 37}{space 5} 1.065978{col 51}{space 3} 2.039896
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 1.667076{col 26}{space 2} .3428179{col 37}{space 5}  .992557{col 51}{space 3} 2.341595
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.263816{col 26}{space 2} .2382299{col 37}{space 5} .7950811{col 51}{space 3}  1.73255
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}
strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}h_flex5 was {res}float{txt} now {res}byte
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/cons_real_it5.dta saved

    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 5}h_flex5 {c |}{res}    3108  28069559.9    15.83399   36.51182          0        100
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/foodshares_it5.dta saved

{com}. **************************************************************************
> * Send results to one big csv-file
> **************************************************************************;
. use "$path/work/cons_real_it`lastpass'.dta", clear ;
{txt}
{com}.         gen dum=1;
{txt}
{com}.         collapse (mean) dum h_flex`lastpass' pg_flex`lastpass' spg_flex`lastpass' [aw=popwt];
{txt}
{com}. gen geo="National";
{txt}
{com}. gen geono=dum;
{txt}
{com}. tempfile nat;
{txt}
{com}. save `nat';
{txt}file /tmp/St02564.000014 saved

{com}.         use "$path/work/cons_real_it`lastpass'.dta", clear ;
{txt}
{com}.         collapse (mean) h_flex`lastpass' pg_flex`lastpass' spg_flex`lastpass' [aw=popwt], by(rural);
{txt}
{com}. gen geo="Rural/Urban";
{txt}
{com}. gen geono=rural;
{txt}
{com}. tempfile rur;
{txt}
{com}. save `rur';
{txt}file /tmp/St02564.000015 saved

{com}. use "$path/work/cons_real_it`lastpass'.dta", clear ;
{txt}
{com}.         collapse (mean) h_flex`lastpass' pg_flex`lastpass' spg_flex`lastpass' [aw=popwt], by(news);
{txt}
{com}. gen geo="North/Center/South";
{txt}
{com}. gen geono=news;
{txt}
{com}. tempfile new;
{txt}
{com}. save `new';
{txt}file /tmp/St02564.000016 saved

{com}. use "$path/work/cons_real_it`lastpass'.dta", clear ;
{txt}
{com}.         collapse (mean) h_flex`lastpass' pg_flex`lastpass' spg_flex`lastpass' [aw=popwt], by(reg_tpi);
{txt}
{com}. gen geo="TPI - 6 regions";
{txt}
{com}. gen geono=reg_tpi;
{txt}
{com}. tempfile rtp;
{txt}
{com}. save `rtp';
{txt}file /tmp/St02564.000017 saved

{com}. use "$path/work/cons_real_it`lastpass'.dta", clear ;
{txt}
{com}.         collapse (mean) h_flex`lastpass' pg_flex`lastpass' spg_flex`lastpass' [aw=popwt], by(strata);
{txt}
{com}. gen geo="Provinces";
{txt}
{com}. gen geono=strata;
{txt}
{com}. tempfile str;
{txt}
{com}. save `str';
{txt}file /tmp/St02564.000018 saved

{com}. use "$path/work/cons_real_it`lastpass'.dta", clear ;
{txt}
{com}.         collapse (mean) h_flex`lastpass' pg_flex`lastpass' spg_flex`lastpass' [aw=popwt], by(spdomain);
{txt}
{com}. gen geo="Spatial domains";
{txt}
{com}. gen geono=spdomain;
{txt}
{com}. tempfile r13;
{txt}
{com}. save `r13';
{txt}file /tmp/St02564.000019 saved

{com}. clear;
{txt}
{com}. set obs 1;
{txt}obs was 0, now 1

{com}. gen geo=" ";
{txt}
{com}. tempfile one;
{txt}
{com}. save `one';
{txt}file /tmp/St02564.00001a saved

{com}. use          `nat';
{txt}
{com}. append using `one';
{txt}
{com}. append using `rur';
{txt}geo was {res}str8{txt} now {res}str11
{txt}
{com}. append using `one';
{txt}
{com}. append using `new';
{txt}geo was {res}str11{txt} now {res}str18
{txt}
{com}. append using `one';
{txt}
{com}. append using `rtp';
{txt}
{com}. append using `one';
{txt}
{com}. append using `str';
{txt}
{com}. append using `one';
{txt}
{com}. append using `r13';
{txt}
{com}. outsheet geo geono h_flex`lastpass' pg_flex`lastpass' spg_flex`lastpass' dum rural news reg_tpi strata spdomain using "$path/work/poverty_flexBask.csv", replace c;
{txt}
{com}. **************************************************************************
> * Convergence graph (based on 5 iterations)
> **************************************************************************;
. #delimit cr
{txt}delimiter now cr
{com}. 
. clear
{txt}
{com}. set obs 1
{txt}obs was 0, now 1

{com}. gen iteration=.
{txt}(1 missing value generated)

{com}. tempfile converg
{txt}
{com}. save `converg'
{txt}file /tmp/St02564.00001b saved

{com}. 
. forvalues X = 1/`maxit' {c -(}
{txt}  2{com}.         use "$path/work/cons_real_it`X'.dta", clear
{txt}  3{com}.         collapse (mean) h_flex`X' pg_flex`X' spg_flex`X' [aw=popwt], by(strata)
{txt}  4{com}.         rename h_flex`X' h_flex
{txt}  5{com}.         rename pg_flex`X' pg_flex
{txt}  6{com}.         rename spg_flex`X' spg_flex
{txt}  7{com}.         gen iteration=`X'
{txt}  8{com}.         order iteration
{txt}  9{com}.         *sum
.         if `X' != 1     {c -(}
{txt} 10{com}.                 append using `converg'
{txt} 11{com}.                         {c )-}
{txt} 12{com}.         save `converg', replace
{txt} 13{com}.         {c )-}
{txt}file /tmp/St02564.00001b saved
(label lstrata already defined)
file /tmp/St02564.00001b saved
(label lstrata already defined)
file /tmp/St02564.00001b saved
(label lstrata already defined)
file /tmp/St02564.00001b saved
(label lstrata already defined)
file /tmp/St02564.00001b saved

{com}. 
. use `converg', clear
{txt}
{com}. sum

{txt}    Variable {c |}       Obs        Mean    Std. Dev.       Min        Max
{hline 13}{c +}{hline 56}
{space 3}iteration {c |}{res}        40           3     1.43223          1          5
{txt}{space 6}strata {c |}{res}        40         4.5    2.320477          1          8
{txt}{space 6}h_flex {c |}{res}        40    11.73296    7.763625   2.095423   22.92328
{txt}{space 5}pg_flex {c |}{res}        40    2.493503    1.875903   .4179243   5.453815
{txt}{space 4}spg_flex {c |}{res}        40    .8395681    .6521121   .1503185   1.861008
{txt}
{com}. 
. twoway (connected h_flex iteration), by(, title(Convergence graph: Poverty rate. %) subtitle(After iterative procedure)) by(strata)
{res}{txt}
{com}. graph export "$path/work/converge_pov_rate.tif", replace
{txt}(file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/converge_pov_rate.tif written in TIFF format)

{com}. 
. sort strata iteration
{txt}
{com}. 
. for var h_flex pg_flex spg_flex: replace X = round(X,0.01)

{res}->  replace h_flex = round(h_flex,0.01)
{txt}(40 real changes made)

{res}->  replace pg_flex = round(pg_flex,0.01)
{txt}(40 real changes made)

{res}->  replace spg_flex = round(spg_flex,0.01)
{txt}(40 real changes made)

{com}. 
. list strata iteration h_flex pg_flex spg_flex
{txt}
     {c TLC}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c TRC}
     {c |} {res}        strata   iterat~n   h_flex   pg_flex   spg_flex {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
  1. {c |} {res} central urban          1      2.1       .42        .18 {txt}{c |}
  2. {c |} {res} central urban          2      2.1       .42        .18 {txt}{c |}
  3. {c |} {res} central urban          3      2.1       .42        .18 {txt}{c |}
  4. {c |} {res} central urban          4      2.1       .42        .18 {txt}{c |}
  5. {c |} {res} central urban          5      2.1       .42        .18 {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
  6. {c |} {res} central rural          1    11.56      2.17        .65 {txt}{c |}
  7. {c |} {res} central rural          2    11.43      2.11        .63 {txt}{c |}
  8. {c |} {res} central rural          3    11.43      2.07        .62 {txt}{c |}
  9. {c |} {res} central rural          4    11.43      2.07        .62 {txt}{c |}
 10. {c |} {res} central rural          5    11.43      2.07        .62 {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
 11. {c |} {res} Eastern urban          1      4.5       .74        .15 {txt}{c |}
 12. {c |} {res} Eastern urban          2      4.5       .75        .15 {txt}{c |}
 13. {c |} {res} Eastern urban          3      4.5       .75        .15 {txt}{c |}
 14. {c |} {res} Eastern urban          4      4.5       .75        .16 {txt}{c |}
 15. {c |} {res} Eastern urban          5      4.5       .75        .16 {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
 16. {c |} {res} Eastern rural          1    22.18      4.84       1.63 {txt}{c |}
 17. {c |} {res} Eastern rural          2    22.92      4.91       1.66 {txt}{c |}
 18. {c |} {res} Eastern rural          3    22.92      4.91       1.66 {txt}{c |}
 19. {c |} {res} Eastern rural          4    22.92      4.93       1.66 {txt}{c |}
 20. {c |} {res} Eastern rural          5    22.92      4.93       1.66 {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
 21. {c |} {res}Northern urban          1     9.62      2.12        .78 {txt}{c |}
 22. {c |} {res}Northern urban          2     9.62      2.11        .78 {txt}{c |}
 23. {c |} {res}Northern urban          3      8.4      2.07        .77 {txt}{c |}
 24. {c |} {res}Northern urban          4      8.4      2.07        .77 {txt}{c |}
 25. {c |} {res}Northern urban          5      8.4      2.07        .77 {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
 26. {c |} {res}Northern rural          1    21.83      5.45       1.86 {txt}{c |}
 27. {c |} {res}Northern rural          2    21.83      5.43       1.85 {txt}{c |}
 28. {c |} {res}Northern rural          3    21.62      5.35       1.81 {txt}{c |}
 29. {c |} {res}Northern rural          4    21.62      5.35       1.81 {txt}{c |}
 30. {c |} {res}Northern rural          5    21.62      5.35       1.81 {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
 31. {c |} {res} Western Urban          1     4.35       .52        .16 {txt}{c |}
 32. {c |} {res} Western Urban          2     4.35       .51        .16 {txt}{c |}
 33. {c |} {res} Western Urban          3     4.35       .52        .16 {txt}{c |}
 34. {c |} {res} Western Urban          4     4.35       .51        .16 {txt}{c |}
 35. {c |} {res} Western Urban          5     4.35       .51        .16 {txt}{c |}
     {c LT}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c RT}
 36. {c |} {res} Western rural          1    18.37      3.82       1.35 {txt}{c |}
 37. {c |} {res} Western rural          2    17.97      3.79       1.34 {txt}{c |}
 38. {c |} {res} Western rural          3    18.18      3.79       1.34 {txt}{c |}
 39. {c |} {res} Western rural          4    17.97      3.79       1.34 {txt}{c |}
 40. {c |} {res} Western rural          5    17.97      3.79       1.34 {txt}{c |}
     {c BLC}{hline 16}{c -}{hline 10}{c -}{hline 8}{c -}{hline 9}{c -}{hline 10}{c BRC}

{com}.         
. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 140_iterate.do        (end)
> **************************************************************************;
. cap log close;
{txt}
{com}. 
{txt}end of do-file

{com}. do "$path/new/170_pref_r_price_bjorn.do"
{txt}
{com}. *global path "C:/user/gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/170_pref_r_price.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/170_pref_r_price.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:47:57
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 170_pref_r_price.do           (start)
> *
> * This file conducts revealed preference comparisons so that
> * we can check the quality of the regional baskets.
> * It also exports the price and quantity data for work in GAMS
> * Rather than make up for missing prices with shares, we estimate
> * a missing price in this case
> **************************************************************************;
. *global n_spdom "13";
. *global it_n "5";
. /*
> This file uses:
>         work/quan_flex_it$it_n.dta
>         work/povline_food_flex_it$it_n.dta
>         work/price_unit_flex_it$it_n.dta
>                 
> This file creates:
>         work/pref_r_price.dta
>         work/revpref_price_`i'.dta
>         work/product_flex.inc
>         work/price_unit_flex.inc
>         work/quan_flex.inc
> */
> 
> 
> 
> ***************************************************************************;
. * Export price, codes and quantity data to text
> ***************************************************************************;
. use "$path/work/price_unit_flex_it$it_n.dta";
{txt}
{com}. gen reg=spdomain ;
{txt}
{com}. gen crap=1;
{txt}
{com}.  lab def crap
>          1  ".";
{txt}
{com}.  lab val crap crap;
{txt}
{com}. outsheet product crap reg bswt price_uw$it_n using "$path/work/price_unit_flex.inc",  noquote noname replace ;
{txt}
{com}. collapse (min) spdomain, by(product);
{txt}
{com}. outsheet product  using "$path/work/product_flex.inc", noname replace;
{txt}
{com}. use "$path/work/quan_flex_it$it_n.dta", clear;
{txt}
{com}. gen reg=spdomain;
{txt}
{com}. gen crap=1;
{txt}
{com}.  lab def crap
>          1  ".";
{txt}
{com}.  lab val crap crap;
{txt}
{com}. format calperg quan$it_n calpp %14.9e;
{txt}
{com}. outsheet  product crap reg calperg quan$it_n  calpp povline_f_flex90_$it_n using "$path/work/quan_flex.inc", noname noquote replace;
{txt}
{com}. clear;
{txt}
{com}. **************************************************************************;
. * Revealed preference calculations
> * get the basket for the region we want to test
> **************************************************************************;
. tempfile quanreg;
{txt}
{com}. tempfile getmiss;
{txt}
{com}. tempfile codmiss;
{txt}
{com}. gen crap=0;
{txt}
{com}. save "$path/work/pref_r_price.dta", replace;
{txt}(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved

{com}. forvalues i=1/$n_spdom {c -(}                ;
{txt}  2{com}.         clear;
{txt}  3{com}.         gen crap=0;
{txt}  4{com}.         save "$path/work/revpref_price_`i'.dta", replace;
{txt}  5{com}.         clear;
{txt}  6{com}.                 use "$path/work/quan_flex_it$it_n.dta", clear;
{txt}  7{com}.                 keep product spdomain quan$it_n price_uw$it_n val_ir$it_n povline_f_flex90_$it_n calpp;
{txt}  8{com}.         gen share=val_ir$it_n/povline_f_flex90_$it_n;
{txt}  9{com}.         rename price_uw$it_n pquanreg;
{txt} 10{com}.         rename spdomain spdomainq;
{txt} 11{com}.         drop if spdomainq~= `i';
{txt} 12{com}.         sort product;
{txt} 13{com}.                                 *rescale quantities to hit constant calorie target;
.                 gen ratquan=2150/calpp;
{txt} 14{com}.             gen quan_s=quan$it_n*ratquan;
{txt} 15{com}.             lab var quan_s "quantities rescaled to hit 2150 calories pp";
{txt} 16{com}.         save `quanreg', replace;
{txt} 17{com}. **************************************************************************;
. * Now get the prices in other regions so that you can use them 
> * to build  a new poverty line
> **************************************************************************;
.         forvalues j= 1/$n_spdom {c -(}               ;
{txt} 18{com}.                 use "$path/work/price_unit_flex_it$it_n.dta";
{txt} 19{com}.                                 keep product spdomain price_uw$it_n descript count bswt;
{txt} 20{com}.                         sort product;
{txt} 21{com}.                 keep if spdomain==`j';
{txt} 22{com}.                 sort product;
{txt} 23{com}.                 merge product using `quanreg';
{txt} 24{com}.                     *here we have to deal with the fact that not all commodities are consumed in every region;
.                 *so we might have a quantity from region i but no price in region j;
.                 *these will have _merge value=2;
.                 *alternatively the number of observations might be too small;
.                 *deal with these problems by TAKING THE MAX PRICE OBSERVED ELSEWHERE (excluding Maputo)
>                         
>                 tab _m;
.                 drop if _m==1;
{txt} 25{com}.                                 *CA modified to handle the counting of bswt instead of count
>                   replace price_uw$it_n=. if round(bswt)<5;
.                         gen pricemiss=0;
{txt} 26{com}.                   replace spdomain=`j' if _m==2 ;
{txt} 27{com}.                   replace pricemiss=1 if _m==2 | round(bswt)<5;
{txt} 28{com}.                         lab var pricemiss "identify those items with no price observation";
{txt} 29{com}.                   drop _m;
{txt} 30{com}.                         sort product;
{txt} 31{com}. *browse;
.                *this is the tempfile containing observed quans and prices;
.              save `getmiss', replace;
{txt} 32{com}.                         keep if pricemiss==1;
{txt} 33{com}.                         if _N>0 {c -(}
>                             keep product;
{txt} 34{com}.                                             sort product;
{txt} 35{com}.                                             *this file contains the price codes that are missing for the region in question;
.                             save `codmiss', replace;
{txt} 36{com}. *browse;
.                                   use "$path/work/price_unit_flex_it$it_n.dta", clear;
{txt} 37{com}.                         sort product;
{txt} 38{com}. *browse;
.                         merge product using `codmiss';
{txt} 39{com}.                                                 tab _m;
{txt} 40{com}.                         keep if _m==3 ;
{txt} 41{com}.                                 *exclude Maputo province and city from other price calculation;
.                                 drop if spdomain>10;
{txt} 42{com}.                         collapse (max) price_uw$it_n, by(product);
{txt} 43{com}.                   *this file contains the code and the max price;
.                   save `codmiss', replace;
{txt} 44{com}. *browse;
.                         use `getmiss';
{txt} 45{com}.                               merge product using `codmiss';
{txt} 46{com}. *browse;
.                         tab _m;
{txt} 47{com}.                         drop _m;
{txt} 48{com}.                         *end if;
.                  {c )-};
{txt} 49{com}.                                                             else use `getmiss', clear;
{txt} 50{com}.                         gen val_q=quan_s*price_uw$it_n;
{txt} 51{com}.                                                 collapse (sum) val_q pricemiss (mean) spdomainq ratquan, by(spdomain);
{txt} 52{com}.                   gen linf_q=val_q/.9;
{txt} 53{com}.                   drop val_q;
{txt} 54{com}.                         append using "$path/work/revpref_price_`i'.dta";
{txt} 55{com}.                         sort spdomain;
{txt} 56{com}.                 save "$path/work/revpref_price_`i'.dta", replace;
{txt} 57{com}.    *browse;
.         *close j loop;
.         {c )-};
{txt} 58{com}.         *aggregate into a big data set;
.         append using "$path/work/pref_r_price.dta";
{txt} 59{com}.       sort spdomain spdomainq;
{txt} 60{com}.       save "$path/work/pref_r_price.dta", replace;
{txt} 61{com}.  *close i loop;
. {c )-};
{txt}(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_1.dta saved
(94 observations deleted)
(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved
{err}variable descript not found
{txt}{search r(111):r(111);}

end of do-file

{search r(111):r(111);}

{com}. do "$path/new/170_pref_r_price_bjorn.do"
{txt}
{com}. *global path "C:/user/gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/170_pref_r_price.log", replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/170_pref_r_price.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:48:50
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. **************************************************************************
> * 170_pref_r_price.do           (start)
> *
> * This file conducts revealed preference comparisons so that
> * we can check the quality of the regional baskets.
> * It also exports the price and quantity data for work in GAMS
> * Rather than make up for missing prices with shares, we estimate
> * a missing price in this case
> **************************************************************************;
. *global n_spdom "13";
. *global it_n "5";
. /*
> This file uses:
>         work/quan_flex_it$it_n.dta
>         work/povline_food_flex_it$it_n.dta
>         work/price_unit_flex_it$it_n.dta
>                 
> This file creates:
>         work/pref_r_price.dta
>         work/revpref_price_`i'.dta
>         work/product_flex.inc
>         work/price_unit_flex.inc
>         work/quan_flex.inc
> */
> 
> 
> 
> ***************************************************************************;
. * Export price, codes and quantity data to text
> ***************************************************************************;
. use "$path/work/price_unit_flex_it$it_n.dta";
{txt}
{com}. gen reg=spdomain ;
{txt}
{com}. gen crap=1;
{txt}
{com}.  lab def crap
>          1  ".";
{txt}
{com}.  lab val crap crap;
{txt}
{com}. outsheet product crap reg bswt price_uw$it_n using "$path/work/price_unit_flex.inc",  noquote noname replace ;
{txt}
{com}. collapse (min) spdomain, by(product);
{txt}
{com}. outsheet product  using "$path/work/product_flex.inc", noname replace;
{txt}
{com}. use "$path/work/quan_flex_it$it_n.dta", clear;
{txt}
{com}. gen reg=spdomain;
{txt}
{com}. gen crap=1;
{txt}
{com}.  lab def crap
>          1  ".";
{txt}
{com}.  lab val crap crap;
{txt}
{com}. format calperg quan$it_n calpp %14.9e;
{txt}
{com}. outsheet  product crap reg calperg quan$it_n  calpp povline_f_flex90_$it_n using "$path/work/quan_flex.inc", noname noquote replace;
{txt}
{com}. clear;
{txt}
{com}. **************************************************************************;
. * Revealed preference calculations
> * get the basket for the region we want to test
> **************************************************************************;
. tempfile quanreg;
{txt}
{com}. tempfile getmiss;
{txt}
{com}. tempfile codmiss;
{txt}
{com}. gen crap=0;
{txt}
{com}. save "$path/work/pref_r_price.dta", replace;
{txt}(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved

{com}. forvalues i=1/$n_spdom {c -(}                ;
{txt}  2{com}.         clear;
{txt}  3{com}.         gen crap=0;
{txt}  4{com}.         save "$path/work/revpref_price_`i'.dta", replace;
{txt}  5{com}.         clear;
{txt}  6{com}.                 use "$path/work/quan_flex_it$it_n.dta", clear;
{txt}  7{com}.                 keep product spdomain quan$it_n price_uw$it_n val_ir$it_n povline_f_flex90_$it_n calpp;
{txt}  8{com}.         gen share=val_ir$it_n/povline_f_flex90_$it_n;
{txt}  9{com}.         rename price_uw$it_n pquanreg;
{txt} 10{com}.         rename spdomain spdomainq;
{txt} 11{com}.         drop if spdomainq~= `i';
{txt} 12{com}.         sort product;
{txt} 13{com}.                                 *rescale quantities to hit constant calorie target;
.                 gen ratquan=2150/calpp;
{txt} 14{com}.             gen quan_s=quan$it_n*ratquan;
{txt} 15{com}.             lab var quan_s "quantities rescaled to hit 2150 calories pp";
{txt} 16{com}.         save `quanreg', replace;
{txt} 17{com}. **************************************************************************;
. * Now get the prices in other regions so that you can use them 
> * to build  a new poverty line
> **************************************************************************;
.         forvalues j= 1/$n_spdom {c -(}               ;
{txt} 18{com}.                 use "$path/work/price_unit_flex_it$it_n.dta";
{txt} 19{com}.                                 keep product spdomain price_uw$it_n  count bswt;
{txt} 20{com}.                         sort product;
{txt} 21{com}.                 keep if spdomain==`j';
{txt} 22{com}.                 sort product;
{txt} 23{com}.                 merge product using `quanreg';
{txt} 24{com}.                     *here we have to deal with the fact that not all commodities are consumed in every region;
.                 *so we might have a quantity from region i but no price in region j;
.                 *these will have _merge value=2;
.                 *alternatively the number of observations might be too small;
.                 *deal with these problems by TAKING THE MAX PRICE OBSERVED ELSEWHERE (excluding Maputo)
>                         
>                 tab _m;
.                 drop if _m==1;
{txt} 25{com}.                                 *CA modified to handle the counting of bswt instead of count
>                   replace price_uw$it_n=. if round(bswt)<5;
.                         gen pricemiss=0;
{txt} 26{com}.                   replace spdomain=`j' if _m==2 ;
{txt} 27{com}.                   replace pricemiss=1 if _m==2 | round(bswt)<5;
{txt} 28{com}.                         lab var pricemiss "identify those items with no price observation";
{txt} 29{com}.                   drop _m;
{txt} 30{com}.                         sort product;
{txt} 31{com}. *browse;
.                *this is the tempfile containing observed quans and prices;
.              save `getmiss', replace;
{txt} 32{com}.                         keep if pricemiss==1;
{txt} 33{com}.                         if _N>0 {c -(}
>                             keep product;
{txt} 34{com}.                                             sort product;
{txt} 35{com}.                                             *this file contains the price codes that are missing for the region in question;
.                             save `codmiss', replace;
{txt} 36{com}. *browse;
.                                   use "$path/work/price_unit_flex_it$it_n.dta", clear;
{txt} 37{com}.                         sort product;
{txt} 38{com}. *browse;
.                         merge product using `codmiss';
{txt} 39{com}.                                                 tab _m;
{txt} 40{com}.                         keep if _m==3 ;
{txt} 41{com}.                                 *exclude Maputo province and city from other price calculation;
.                                 drop if spdomain>10;
{txt} 42{com}.                         collapse (max) price_uw$it_n, by(product);
{txt} 43{com}.                   *this file contains the code and the max price;
.                   save `codmiss', replace;
{txt} 44{com}. *browse;
.                         use `getmiss';
{txt} 45{com}.                               merge product using `codmiss';
{txt} 46{com}. *browse;
.                         tab _m;
{txt} 47{com}.                         drop _m;
{txt} 48{com}.                         *end if;
.                  {c )-};
{txt} 49{com}.                                                             else use `getmiss', clear;
{txt} 50{com}.                         gen val_q=quan_s*price_uw$it_n;
{txt} 51{com}.                                                 collapse (sum) val_q pricemiss (mean) spdomainq ratquan, by(spdomain);
{txt} 52{com}.                   gen linf_q=val_q/.9;
{txt} 53{com}.                   drop val_q;
{txt} 54{com}.                         append using "$path/work/revpref_price_`i'.dta";
{txt} 55{com}.                         sort spdomain;
{txt} 56{com}.                 save "$path/work/revpref_price_`i'.dta", replace;
{txt} 57{com}.    *browse;
.         *close j loop;
.         {c )-};
{txt} 58{com}.         *aggregate into a big data set;
.         append using "$path/work/pref_r_price.dta";
{txt} 59{com}.       sort spdomain spdomainq;
{txt} 60{com}.       save "$path/work/pref_r_price.dta", replace;
{txt} 61{com}.  *close i loop;
. {c )-};
{txt}(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_1.dta saved
(94 observations deleted)
(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved
(142 observations deleted)
(label lspdomain already defined)
(15 observations deleted)
(0 real changes made)
(0 real changes made)
(note: file /tmp/St02564.000002 not found)
file /tmp/St02564.000002 saved
(18 observations deleted)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_1.dta saved
(140 observations deleted)
(label lspdomain already defined)
(17 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(18 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_1.dta saved
(139 observations deleted)
(label lspdomain already defined)
(18 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(18 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_1.dta saved
(140 observations deleted)
(label lspdomain already defined)
(17 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St02564.000002 saved
(17 observations deleted)
(note: file /tmp/St02564.000003 not found)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        170       97.14       97.14
{txt}          3 {c |}{res}          5        2.86      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(170 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         17       94.44       94.44
{txt}          3 {c |}{res}          1        5.56      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         18      100.00
{txt}(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_1.dta saved
(139 observations deleted)
(label lspdomain already defined)
(18 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(18 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_1.dta saved
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_2.dta saved
(92 observations deleted)
file /tmp/St02564.000001 saved
(142 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(0 real changes made)
(2 real changes made)
file /tmp/St02564.000002 saved
(18 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        165       94.29       94.29
{txt}          3 {c |}{res}         10        5.71      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(165 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         18       90.00       90.00
{txt}          3 {c |}{res}          2       10.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         20      100.00
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_2.dta saved
(140 observations deleted)
(label lspdomain already defined)
(15 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(20 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_2.dta saved
(139 observations deleted)
(label lspdomain already defined)
(16 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(20 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_2.dta saved
(140 observations deleted)
(label lspdomain already defined)
(15 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St02564.000002 saved
(19 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        170       97.14       97.14
{txt}          3 {c |}{res}          5        2.86      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(170 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         19       95.00       95.00
{txt}          3 {c |}{res}          1        5.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         20      100.00
{txt}(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_2.dta saved
(139 observations deleted)
(label lspdomain already defined)
(16 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(20 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_2.dta saved
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_3.dta saved
(85 observations deleted)
file /tmp/St02564.000001 saved
(142 observations deleted)
(label lspdomain already defined)
(8 observations deleted)
(2 real changes made)
(9 real changes made)
file /tmp/St02564.000002 saved
(18 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        133       76.00       76.00
{txt}          3 {c |}{res}         42       24.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(133 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         18       66.67       66.67
{txt}          3 {c |}{res}          9       33.33      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         27      100.00
{txt}(2 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_3.dta saved
(140 observations deleted)
(label lspdomain already defined)
(9 observations deleted)
(1 real change made)
(3 real changes made)
file /tmp/St02564.000002 saved
(24 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        162       92.57       92.57
{txt}          3 {c |}{res}         13        7.43      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(162 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         24       88.89       88.89
{txt}          3 {c |}{res}          3       11.11      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         27      100.00
{txt}(1 missing value generated)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_3.dta saved
(139 observations deleted)
(label lspdomain already defined)
(9 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(27 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_3.dta saved
(140 observations deleted)
(label lspdomain already defined)
(8 observations deleted)
(0 real changes made)
(1 real change made)
file /tmp/St02564.000002 saved
(26 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        170       97.14       97.14
{txt}          3 {c |}{res}          5        2.86      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(170 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         26       96.30       96.30
{txt}          3 {c |}{res}          1        3.70      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         27      100.00
{txt}(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_3.dta saved
(139 observations deleted)
(label lspdomain already defined)
(9 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(27 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_3.dta saved
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_4.dta saved
(88 observations deleted)
file /tmp/St02564.000001 saved
(142 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(3 real changes made)
(12 real changes made)
file /tmp/St02564.000002 saved
(12 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        118       67.43       67.43
{txt}          3 {c |}{res}         57       32.57      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(118 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         12       50.00       50.00
{txt}          3 {c |}{res}         12       50.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         24      100.00
{txt}(3 missing values generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_4.dta saved
(140 observations deleted)
(label lspdomain already defined)
(11 observations deleted)
(0 real changes made)
(6 real changes made)
file /tmp/St02564.000002 saved
(18 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        147       84.00       84.00
{txt}          3 {c |}{res}         28       16.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(147 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         18       75.00       75.00
{txt}          3 {c |}{res}          6       25.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         24      100.00
{txt}(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_4.dta saved
(139 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(24 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_4.dta saved
(140 observations deleted)
(label lspdomain already defined)
(11 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(24 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_4.dta saved
(139 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(24 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_4.dta saved
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved
(note: dataset contains 0 observations)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_5.dta saved
(89 observations deleted)
file /tmp/St02564.000001 saved
(142 observations deleted)
(label lspdomain already defined)
(11 observations deleted)
(1 real change made)
(7 real changes made)
file /tmp/St02564.000002 saved
(16 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        142       81.14       81.14
{txt}          3 {c |}{res}         33       18.86      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(142 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         16       69.57       69.57
{txt}          3 {c |}{res}          7       30.43      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         23      100.00
{txt}(1 missing value generated)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_5.dta saved
(140 observations deleted)
(label lspdomain already defined)
(12 observations deleted)
(0 real changes made)
(2 real changes made)
file /tmp/St02564.000002 saved
(21 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        166       94.86       94.86
{txt}          3 {c |}{res}          9        5.14      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(166 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         21       91.30       91.30
{txt}          3 {c |}{res}          2        8.70      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         23      100.00
{txt}(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_5.dta saved
(139 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(23 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_5.dta saved
(140 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(1 real change made)
(2 real changes made)
file /tmp/St02564.000002 saved
(21 observations deleted)
file /tmp/St02564.000003 saved
{p 0 4 2}
variable{txt} product
does not uniquely identify observations in
the master data
{p_end}
(label lspdomain already defined)

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}        166       94.86       94.86
{txt}          3 {c |}{res}          9        5.14      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}        175      100.00
{txt}(166 observations deleted)
(0 observations deleted)
file /tmp/St02564.000003 saved

     _merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         21       91.30       91.30
{txt}          3 {c |}{res}          2        8.70      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         23      100.00
{txt}(1 missing value generated)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_5.dta saved
(139 observations deleted)
(label lspdomain already defined)
(13 observations deleted)
(0 real changes made)
(0 real changes made)
file /tmp/St02564.000002 saved
(23 observations deleted)
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/revpref_price_5.dta saved
(label lspdomain already defined)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved

{com}. *bring in actual flexible bundle numbers;
. use "$path/work/povline_food_flex_it$it_n.dta", clear;
{txt}
{com}.         merge spdomain using "$path/work/pref_r_price.dta";
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta
{p_end}
(label lspdomain already defined)

{com}.         tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}         25      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}         25      100.00
{txt}
{com}.          drop crap;
{txt}
{com}.         drop _m;
{txt}
{com}.         order spdomainq spdomain;
{txt}
{com}.       sort spdomainq spdomain;
{txt}
{com}.         *rescale expenditures to hit a constant calorie target;
.         gen povline_f5_s=ratquan*povline_f_flex90_$it_n;
{txt}
{com}.       compress;
{txt}spdomainq was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}pricemiss was {res}double{txt} now {res}byte
{txt}
{com}. *browse;
.         *categorize revealed preference performance;
.       gen pref_r=0;
{txt}
{com}.       replace pref_r=1 if float(linf_q)>float(povline_f5_s);
{txt}(14 real changes made)

{com}.       replace pref_r=2 if float(linf_q)<float(povline_f5_s);
{txt}(7 real changes made)

{com}.       lab var pref_r "Fails or passes revealed preference test";
{txt}
{com}.       lab def pref_r
>                         0 "comparison of the same region with itself"
>                         1 "passes revealed preference test"
>                         2 "fails revealed preference test" ;
{txt}
{com}.         lab val pref_r pref_r;
{txt}
{com}.       drop if spdomainq==spdomain;
{txt}(5 observations deleted)

{com}.         tab pref_r;

    {txt}Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
        passes revealed preference test {c |}{res}         13       65.00       65.00
{txt}         fails revealed preference test {c |}{res}          7       35.00      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}         20      100.00
{txt}
{com}.              sort spdomainq ;
{txt}
{com}.       by spdomainq: tab pref_r;

{txt}{hline}
-> spdomainq = 1

    Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
        passes revealed preference test {c |}{res}          4      100.00      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}          4      100.00

{txt}{hline}
-> spdomainq = 2

    Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
        passes revealed preference test {c |}{res}          1       25.00       25.00
{txt}         fails revealed preference test {c |}{res}          3       75.00      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}          4      100.00

{txt}{hline}
-> spdomainq = 3

    Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
        passes revealed preference test {c |}{res}          4      100.00      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}          4      100.00

{txt}{hline}
-> spdomainq = 4

    Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
         fails revealed preference test {c |}{res}          4      100.00      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}          4      100.00

{txt}{hline}
-> spdomainq = 5

    Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
        passes revealed preference test {c |}{res}          4      100.00      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}          4      100.00

{txt}
{com}. save "$path/work/pref_r_price.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/pref_r_price.dta saved

{com}. *drop comparisons with Maputo ;
. drop if spdomain>=11;
{txt}(0 observations deleted)

{com}. drop if spdomainq>=11;
{txt}(0 observations deleted)

{com}. display "this is with maputo dropped";
{res}this is with maputo dropped
{txt}
{com}. tab pref_r;

    {txt}Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
        passes revealed preference test {c |}{res}         13       65.00       65.00
{txt}         fails revealed preference test {c |}{res}          7       35.00      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}         20      100.00
{txt}
{com}. *further drop Nampula rural and urban;
. drop if spdomain==3 | spdomain==4;
{txt}(8 observations deleted)

{com}. display "this is with maputo and nampula dropped (MAH: Actually not - experimenting with 6 spatial domains)";
{res}this is with maputo and nampula dropped (MAH: Actually not - experimenting with 6 spatial domains)
{txt}
{com}. tab pref_r;

    {txt}Fails or passes revealed preference {c |}
                                   test {c |}      Freq.     Percent        Cum.
{hline 40}{c +}{hline 35}
        passes revealed preference test {c |}{res}          7       58.33       58.33
{txt}         fails revealed preference test {c |}{res}          5       41.67      100.00
{txt}{hline 40}{c +}{hline 35}
                                  Total {c |}{res}         12      100.00
{txt}
{com}. **************************************************************************
> * 170_pref_r_price.do           (end)
> **************************************************************************;
. log close;
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/170_pref_r_price.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:48:52
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. shell /usr/GAMS/gams24.1_linux_x64_64_sfx/gams "/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/new/190a_revpref13_r_bjorn.gms" o="/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/new/list.lst"
{txt}
*** Could not write to console: /dev/tty
*** Logging to standard output
--- Job 190a_revpref13_r_bjorn.gms Start 03/10/14 14:49:06 24.1.2 r40979 LEX-LEG x86_64/Linux
GAMS 24.1.2   Copyright (C) 1987-2013 GAMS Development. All rights reserved
Licensee: Computer Services                              G130401:1333CP-GEN
          International Food Policy Research Institute               DC2119
--- Starting compilation
--- 190a_revpref13_r_bjorn.gms(19) 2 Mb
--- .product_flex.inc(36) 3 Mb
--- 190a_revpref13_r_bjorn.gms(64) 3 Mb
--- .price_unit_flex.inc(175) 3 Mb
--- 190a_revpref13_r_bjorn.gms(69) 3 Mb
--- .quan_flex.inc(112) 3 Mb
--- 190a_revpref13_r_bjorn.gms(269) 3 Mb 1 Error
*** Status: Compilation error(s)
--- Job 190a_revpref13_r_bjorn.gms Stop 03/10/14 14:49:06 elapsed 0:00:00.007

{com}. shell /usr/GAMS/gams24.1_linux_x64_64_sfx/gams "/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/new/190a_revpref13_r_bjorn.gms" o="/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/new/list.lst"
{txt}
*** Could not write to console: /dev/tty
*** Logging to standard output
--- Job 190a_revpref13_r_bjorn.gms Start 03/10/14 14:51:58 24.1.2 r40979 LEX-LEG x86_64/Linux
GAMS 24.1.2   Copyright (C) 1987-2013 GAMS Development. All rights reserved
Licensee: Computer Services                              G130401:1333CP-GEN
          International Food Policy Research Institute               DC2119
--- Starting compilation
--- 190a_revpref13_r_bjorn.gms(19) 2 Mb
--- .product_flex.inc(36) 3 Mb
--- 190a_revpref13_r_bjorn.gms(64) 3 Mb
--- .price_unit_flex.inc(175) 3 Mb
--- 190a_revpref13_r_bjorn.gms(69) 3 Mb
--- .quan_flex.inc(112) 3 Mb
--- 190a_revpref13_r_bjorn.gms(269) 3 Mb
--- Starting execution: elapsed 0:00:00.004
--- 190a_revpref13_r_bjorn.gms(516) 4 Mb
--- Generating NLP model revpref
--- 190a_revpref13_r_bjorn.gms(518) 7 Mb
---   163 rows  250 columns  1,173 non-zeroes
---   1,010 nl-code  336 nl-non-zeroes
--- 190a_revpref13_r_bjorn.gms(518) 4 Mb
--- Executing CONOPT: elapsed 0:00:00.038
*** Could not write to console: /dev/tty
*** Logging to standard output
CONOPT 3         24.1.2 r40979 Released Jun 16, 2013 LEG x86_64/Linux         
 
 
    C O N O P T 3   version 3.15K
    Copyright (C)   ARKI Consulting and Development A/S
                    Bagsvaerdvej 246 A
                    DK-2880 Bagsvaerd, Denmark
 
 
   Iter Phase Ninf   Infeasibility   RGmax    NSB   Step InItr MX OK
      0   0        4.0995088422E+02 (Input point)
                                Pre-triangular equations:        0
                                Post-triangular equations:       1
      1   0        4.0995088422E+02 (After pre-processing)
      2   0        1.2081643485E+00 (After scaling)
     10   0     3  3.9334351043E-01               1.0E+00      F  T
     16   1     3  3.6327513439E-02 7.7E+00    86 9.9E-01    3 T  T
 
 ** Feasible solution. Value of objective =   0.583539704793
 
   Iter Phase Ninf     Objective     RGmax    NSB   Step InItr MX OK
     21   4        3.7064585671E-01 4.8E+00   104 8.8E+00      F  T
     26   4        2.2865627141E-01 2.8E-01   101 1.0E+00   21 T  T
     31   4        8.2378679166E-02 1.5E-01    99 1.0E+00   31 T  T
     36   4        3.7705260348E-02 1.7E-02   100 1.0E+00   11 F  T
     40   4        3.7705258717E-02 2.3E-08   100
 
 ** Optimal solution. Reduced gradient less than tolerance.
 
*** Could not write to console: /dev/tty
*** Logging to standard output
--- Restarting execution
--- 190a_revpref13_r_bjorn.gms(518) 2 Mb
--- Reading solution for model revpref
--- 190a_revpref13_r_bjorn.gms(587) 3 Mb
--- Putfile povline_rp /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/povline_rp_inout.csv
--- Putfile res /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/qent.csv
--- Putfile lin /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/povline_food_ent.csv
*** Status: Normal completion
--- Job 190a_revpref13_r_bjorn.gms Stop 03/10/14 14:51:58 elapsed 0:00:00.284

{com}. do "$path/new/210_povmeas_ent_flex.do"
{txt}
{com}. *global path "C:\user\gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/210_povmeas_ent_flex.log" , replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/210_povmeas_ent_flex.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:52:41
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. *********************************************************************************
> * 210_povmeas_ent_flex.do               (start)
> *
> * This file produces poverty measures taking the entropy adjusted poverty 
> * lines as a base. It produces two sets of poverty measures. In one, 
> * Maputo is treated with the logic of the fixed bundle. In the second, the revealed preference logic
> * is maintained. Here, the flexible bundle is viewed as being determined by the 
> * lower constraint on the value of the food bundle dictated by P_t2*Q_t1. In this case,
> * the year t2 food shares are calculated and applied.
> *
> * Fixed poverty lines/etc. are mentioned here and there. But there are NO fixed
> * calculations for Maputo (or other provinces) anymore
> *
> *********************************************************************************;
. /*
> This file uses:
>         work\povline_food_ent.csv
>         work\conpc.dta
>         work\hhdata.dta
>         work/temp_index_reg_tpi.dta
> 
> This file creates:
>         work\povlines_ent.dta
>         work\povmeas_ent_flex.dta
>         work\povlines_ent.dta
>       work\nat_pov_ent_m.csv
>       work\rur_pov_ent_m.csv
>       work\news_pov_ent_m.csv
>       work\reg_tpi_pov_ent_m.csv
>       work\strata_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>         work\povlines_ent.csv
> */
> 
> 
> 
> **************************************************************************;
. * Bring in data file with nominal consumption per capita, and deflate it
> * by temporal price index.
> **************************************************************************;
. use "$path/work/hhdata.dta", clear;
{txt}
{com}.         sort reg_tpi survquar;
{txt}
{com}.         merge reg_tpi survquar using "$path/work/temp_index_reg_tpi.dta";
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
survquar
do not uniquely identify observations in
the master data
{p_end}
(label lsurvquar already defined)
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         14        0.45        0.45
{txt}          3 {c |}{res}      3,109       99.55      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,123      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/conpc.dta";
{txt}
{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         gen food_pc_tpi  = food_pc_nom /tpi_trim;
{txt}(15 missing values generated)

{com}.         lab var food_pc_tpi "Temp-adjusted per capita food consumption/day";
{txt}
{com}.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
{txt}(16 missing values generated)

{com}.         lab var cons_pc_tpi "Temp adjusted total consumption/day";
{txt}
{com}.         gen one=1;
{txt}
{com}.         tempfile contpi;
{txt}
{com}. save `contpi', replace;
{txt}(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved

{com}. **************************************************************************;
. * Calculate the food shares for people near the food poverty line
> **************************************************************************;
. *Bring in entropy estimated flexible lines;
. clear;
{txt}
{com}. insheet using "$path\work\povline_food_ent.csv";
{err}{p 0 4 2}
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/\work\povline_food_ent.csv
not found
{p_end}
{txt}{search r(601):r(601);}

end of do-file

{search r(601):r(601);}

{com}. do "$path/new/210_povmeas_ent_flex.do"
{txt}
{com}. *global path "C:\user\gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/210_povmeas_ent_flex.log" , replace
{txt}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/210_povmeas_ent_flex.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:55:34
{txt}
{com}. clear
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. *********************************************************************************
> * 210_povmeas_ent_flex.do               (start)
> *
> * This file produces poverty measures taking the entropy adjusted poverty 
> * lines as a base. It produces two sets of poverty measures. In one, 
> * Maputo is treated with the logic of the fixed bundle. In the second, the revealed preference logic
> * is maintained. Here, the flexible bundle is viewed as being determined by the 
> * lower constraint on the value of the food bundle dictated by P_t2*Q_t1. In this case,
> * the year t2 food shares are calculated and applied.
> *
> * Fixed poverty lines/etc. are mentioned here and there. But there are NO fixed
> * calculations for Maputo (or other provinces) anymore
> *
> *********************************************************************************;
. /*
> This file uses:
>         work\povline_food_ent.csv
>         work\conpc.dta
>         work\hhdata.dta
>         work/temp_index_reg_tpi.dta
> 
> This file creates:
>         work\povlines_ent.dta
>         work\povmeas_ent_flex.dta
>         work\povlines_ent.dta
>       work\nat_pov_ent_m.csv
>       work\rur_pov_ent_m.csv
>       work\news_pov_ent_m.csv
>       work\reg_tpi_pov_ent_m.csv
>       work\strata_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>       work\spdomain_pov_ent_m.csv
>         work\povlines_ent.csv
> */
> 
> 
> 
> **************************************************************************;
. * Bring in data file with nominal consumption per capita, and deflate it
> * by temporal price index.
> **************************************************************************;
. use "$path/work/hhdata.dta", clear;
{txt}
{com}.         sort reg_tpi survquar;
{txt}
{com}.         merge reg_tpi survquar using "$path/work/temp_index_reg_tpi.dta";
{txt}{p 0 4 2}
variable{txt}s{txt} reg_tpi
survquar
do not uniquely identify observations in
the master data
{p_end}
(label lsurvquar already defined)
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}         14        0.45        0.45
{txt}          3 {c |}{res}      3,109       99.55      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,123      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/conpc.dta";
{txt}
{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}.         gen food_pc_tpi  = food_pc_nom /tpi_trim;
{txt}(15 missing values generated)

{com}.         lab var food_pc_tpi "Temp-adjusted per capita food consumption/day";
{txt}
{com}.         gen cons_pc_tpi = food_pc_tpi + nf_pc_nom;
{txt}(16 missing values generated)

{com}.         lab var cons_pc_tpi "Temp adjusted total consumption/day";
{txt}
{com}.         gen one=1;
{txt}
{com}.         tempfile contpi;
{txt}
{com}. save `contpi', replace;
{txt}(note: file /tmp/St02564.000001 not found)
file /tmp/St02564.000001 saved

{com}. **************************************************************************;
. * Calculate the food shares for people near the food poverty line
> **************************************************************************;
. *Bring in entropy estimated flexible lines;
. clear;
{txt}
{com}. insheet using "$path/work/povline_food_ent.csv";
{txt}(3 vars, 5 obs)

{com}.         rename ent food_povline_ent;
{txt}
{com}.      keep spdomain food_povline_ent;
{txt}
{com}.      sort spdomain;
{txt}
{com}. *Bring in fixed bundle poverty lines for Maputo ;
. *This is the same level for both entropy and fixed bundle analysis;
. *since the Q02*P02<=Q96*P02 constraint is binding;
. *$no_temp_rev   merge spdomain using "$path/work/povline_food_fix.dta";
. *$no_temp_rev    replace food_povline_ent=food_povline_w if spdomain>10;
.       keep spdomain food_povline_ent;
{txt}
{com}.       sort spdomain;
{txt}
{com}.       tempfile food_povline_ent;
{txt}
{com}. save `food_povline_ent';
{txt}file /tmp/St02564.000002 saved

{com}. clear;
{txt}
{com}. use `contpi';
{txt}
{com}.         sort spdomain;
{txt}
{com}.         merge spdomain using `food_povline_ent';
{txt}{p 0 4 2}
variable{txt} spdomain
does not uniquely identify observations in
the master data
{p_end}

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}. gen     triwt = 0 ;
{txt}
{com}. replace triwt = 11 - round(50*abs(cons_pc_tpi/food_povline_ent-1)+0.5)
>                 if abs(cons_pc_tpi/food_povline_ent-1)<=0.2;
{txt}(238 real changes made)

{com}.         gen tripopwt=triwt*hhweight*hhsize;
{txt}(5 missing values generated)

{com}.         collapse (mean) nf_pc_nom food_povline_ent [aw=tripopwt] ,
>         by(reg_tpi);
{txt}
{com}.         rename nf_pc_nom povline_nf;
{txt}
{com}.         lab var povline_nf "Nonfood poverty line";
{txt}
{com}.         sort reg_tpi;
{txt}
{com}. *       merge spdomain using "$foodshr_pastSurvey", keep(spdomain $fdshr_t1);
. *       tab _m;
. *       drop _m;
. *       gen fdshr_t1 = $fdshr_t1;
. *       drop $fdshr_t1;
. *       lab var fdshr_t1 "year t1 (e.g. 1996) poverty line food share";
.      *calculate line for all provinces with flexible food shares;
.                         gen povline_ent_m=food_povline_ent + povline_nf;
{txt}
{com}.         gen fdshr=food_povline_ent/povline_ent;
{txt}
{com}.         lab var fdshr "year t2 (e.g. 2002) poverty line food share";
{txt}
{com}.       *redo for maputo inserting the fixed food share;
.  *     gen povline_ent=povline_ent_m;
. *MAH;
. *$no_temp_rev   replace povline_ent=food_povline_ent/fdshr_t1 if spdomain >=11;
. *       lab var povline_ent   "poverty lines with Maputo regions calculated using fixed bundle non-food shares";
.     lab var povline_ent   "poverty lines with all regions calculated using flexible bundle non-food shares";
{txt}
{com}. *    lab var povline_ent_m "poverty lines with Maputo regions calculated using flexible bundle non-food shares";
.         sort reg_tpi;
{txt}
{com}. tempfile povlines_ent;
{txt}
{com}. save `povlines_ent', replace;
{txt}(note: file /tmp/St02564.000003 not found)
file /tmp/St02564.000003 saved

{com}. clear;
{txt}
{com}. **************************************************************************;
. * Calculate poverty measures with all regions using flexible year t2 food shares
> **************************************************************************;
. use `contpi';
{txt}
{com}.         sort reg_tpi;
{txt}
{com}.         merge reg_tpi using `povlines_ent';
{txt}{p 0 4 2}
variable{txt} reg_tpi
does not uniquely identify observations in
the master data
{p_end}
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}. **************************************************************************;
. * Create spatial price index, based on the total poverty line, with
> * adjustment so that mean (and total) nominal consumption equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first. The middle of the 13
> * codes is code 7 -- that's arbirtary enough.
> **************************************************************************;
.         gen cr= cons_pc_tpi ;
{txt}(16 missing values generated)

{com}.         gen linpob=povline_ent;
{txt}(5 missing values generated)

{com}. *MAH;
.  *Now only 6 regions, so base is chosen as the 1;
.         *qui sum linpob if spdomain==7, meanonly;
.         qui sum linpob if spdomain==1, meanonly;
{txt}
{com}.         global spi_base=r(mean);
{txt}
{com}.         gen spi=linpob/$spi_base;
{txt}(5 missing values generated)

{com}.         gen cr2=cr/spi;
{txt}(16 missing values generated)

{com}.         qui sum cr [aw=hhweight*hhsize];
{txt}
{com}.         global sumcr=r(sum);
{txt}
{com}.         qui sum cr2 [aw=hhweight*hhsize];
{txt}
{com}.         global sumcr2=r(sum);
{txt}
{com}.         replace spi=spi*$sumcr2/$sumcr;
{txt}(3119 real changes made)

{com}.         gen linpobr=linpob/spi;
{txt}(5 missing values generated)

{com}.         replace cr2=cr/spi;
{txt}(3108 real changes made)

{com}.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 9}cr2 {c |}{res}    3108  28069559.9    1060.929   1057.035   124.7579   23579.28
{txt}{space 6}linpob {c |}{res}    3119  28164219.1    430.9366   31.21727   369.5095   465.1193
{txt}{space 5}linpobr {c |}{res}    3119  28164219.1    431.5098   .0000263   431.5098   431.5099
{txt}
{com}.         lab var cr      "Temporally-adjusted cons pc";
{txt}
{com}.         lab var cr2     "Spatially & temporally adjusted cons pc";
{txt}
{com}.         lab var linpob  "Poverty line";
{txt}
{com}.         lab var linpobr "Real poverty line";
{txt}
{com}.         lab var spi     "Spatial price index";
{txt}
{com}.         *calculate poverty measures;
.         gen h = 100     if cr2 <=(linpobr);
{txt}(2686 missing values generated)

{com}.         replace  h = 0  if cr2 > (linpobr);
{txt}(2686 real changes made)

{com}.         gen             pg      = ((linpobr - cr2 )/linpobr) *100;
{txt}(16 missing values generated)

{com}.         replace         pg      = 0             if h==0;
{txt}(2686 real changes made)

{com}.         gen             spg     = ((( linpobr - cr2 )/ linpobr )^2)*100;
{txt}(16 missing values generated)

{com}.         replace         spg     = 0             if h==0;
{txt}(2686 real changes made)

{com}.         gen h_ent  =h;
{txt}
{com}.         gen pg_ent =pg;
{txt}(5 missing values generated)

{com}.         gen spg_ent=spg;
{txt}(5 missing values generated)

{com}.         lab var h_ent   "Poverty headcount entropy bundle with Maputo food share fixed";
{txt}
{com}.         lab var pg_ent  "Poverty gap entropy bundle with Maputo food share fixed";
{txt}
{com}.         lab var spg_ent "Squared poverty gap entropy bundle with Maputo food share fixed";
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/hhdata.dta";
{txt}(label lnews already defined)
(label lspdomain already defined)
(label lregion already defined)
(label lrural already defined)
(label lstrata already defined)
(label lsurvmon already defined)
(label lsurvquar already defined)
(label SUBSTRAT already defined)
(label INIDPCMP already defined)
(label RESPCODE already defined)
(label districtc05 already defined)
(label districtc09 already defined)
(label stratum already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop if _merge~=3;
{txt}(1 observation deleted)

{com}.         drop _merge;
{txt}
{com}.         gen popwt=hhsize*hhweight;
{txt}(4 missing values generated)

{com}.         lab var popwt "Population weights = hhsize X hhweight";
{txt}
{com}.                 * Stata 10.1 syntax ;
.         svyset , clear;
{txt}
{com}.         svyset [pweight=popwt] , str(strata) psu(psu);

      {txt}pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}

{com}. *MAH: Below at various places the original reg13 has been changed into spdomain or spdomain ;
.                 svy: mean h_ent pg_ent spg_ent;
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 7}h_ent {c |}{col 14}{res}{space 2} 16.36014{col 26}{space 2} .9930438{col 37}{space 5} 14.40625{col 51}{space 3} 18.31402
{txt}{space 6}pg_ent {c |}{col 14}{res}{space 2} 3.723273{col 26}{space 2} .2920829{col 37}{space 5} 3.148579{col 51}{space 3} 4.297967
{txt}{space 5}spg_ent {c |}{col 14}{res}{space 2} 1.316012{col 26}{space 2} .1308725{col 37}{space 5} 1.058511{col 51}{space 3} 1.573513
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent pg_ent spg_ent , over(rural);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent        {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} 2.643933{col 26}{space 2} .6841143{col 37}{space 5} 1.297889{col 51}{space 3} 3.989977
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 19.22257{col 26}{space 2} 1.177857{col 37}{space 5} 16.90505{col 51}{space 3} 21.54009
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent       {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6989037{col 26}{space 2} .2444724{col 37}{space 5} .2178867{col 51}{space 3} 1.179921
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 4.354427{col 26}{space 2} .3459018{col 37}{space 5} 3.673841{col 51}{space 3} 5.035014
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .2859285{col 26}{space 2} .1227554{col 37}{space 5} .0443984{col 51}{space 3} .5274587
{txt}{space 7}Rural {c |}{col 14}{res}{space 2}  1.53098{col 26}{space 2}  .154826{col 37}{space 5} 1.226349{col 51}{space 3} 1.835611
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent pg_ent spg_ent , over(strata);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent        {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .3949241{col 26}{space 2} .2837125{col 37}{space 5}-.1633007{col 51}{space 3} .9531489
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.47244{col 26}{space 2} 1.969776{col 37}{space 5} 7.596763{col 51}{space 3} 15.34811
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2}  19.3941{col 26}{space 2} 2.087186{col 37}{space 5} 15.28741{col 51}{space 3} 23.50079
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 10.83068{col 26}{space 2} 4.242503{col 37}{space 5}  2.48325{col 51}{space 3} 19.17811
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 32.52435{col 26}{space 2} 3.238256{col 37}{space 5} 26.15285{col 51}{space 3} 38.89586
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.50833{col 26}{space 2} 2.197115{col 37}{space 5} 13.18535{col 51}{space 3} 21.83131
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent       {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1942915{col 26}{space 2} .1629339{col 37}{space 5}-.1262927{col 51}{space 3} .5148758
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.236628{col 26}{space 2} .4778657{col 37}{space 5} 1.296393{col 51}{space 3} 3.176863
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .5360828{col 26}{space 2} .3407539{col 37}{space 5} -.134375{col 51}{space 3} 1.206541
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 3.985432{col 26}{space 2} .5405959{col 37}{space 5} 2.921771{col 51}{space 3} 5.049094
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 3.367906{col 26}{space 2} 1.534385{col 37}{space 5} .3488935{col 51}{space 3} 6.386918
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 8.876136{col 26}{space 2} 1.296284{col 37}{space 5} 6.325605{col 51}{space 3} 11.42667
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5025887{col 26}{space 2} .3574236{col 37}{space 5}-.2006681{col 51}{space 3} 1.205845
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.744954{col 26}{space 2} .5593751{col 37}{space 5} 2.644343{col 51}{space 3} 4.845564
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1115351{col 26}{space 2} .1044452{col 37}{space 5}-.0939683{col 51}{space 3} .3170384
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6749598{col 26}{space 2} .1944341{col 37}{space 5} .2923967{col 51}{space 3} 1.057523
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .0973691{col 26}{space 2} .0787008{col 37}{space 5}-.0574803{col 51}{space 3} .2522186
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.328966{col 26}{space 2} .2340691{col 37}{space 5} .8684178{col 51}{space 3} 1.789513
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2}   1.3518{col 26}{space 2} .7282591{col 37}{space 5}-.0811021{col 51}{space 3} 2.784702
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 3.378728{col 26}{space 2} .6077547{col 37}{space 5} 2.182927{col 51}{space 3} 4.574529
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .1540516{col 26}{space 2} .1396833{col 37}{space 5}-.1207854{col 51}{space 3} .4288885
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2}  1.32109{col 26}{space 2}   .25061{col 37}{space 5} .8279969{col 51}{space 3} 1.814183
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent pg_ent spg_ent , over(spdomain);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent        {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .3949241{col 26}{space 2} .2837125{col 37}{space 5}-.1633007{col 51}{space 3} .9531489
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.47244{col 26}{space 2} 1.969776{col 37}{space 5} 7.596763{col 51}{space 3} 15.34811
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 18.30339{col 26}{space 2} 1.944697{col 37}{space 5} 14.47706{col 51}{space 3} 22.12972
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 29.48594{col 26}{space 2} 2.868099{col 37}{space 5} 23.84275{col 51}{space 3} 35.12913
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.70276{col 26}{space 2} 2.070958{col 37}{space 5}   12.628{col 51}{space 3} 20.77752
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent       {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1942915{col 26}{space 2} .1629339{col 37}{space 5}-.1262927{col 51}{space 3} .5148758
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.236628{col 26}{space 2} .4778657{col 37}{space 5} 1.296393{col 51}{space 3} 3.176863
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 3.732832{col 26}{space 2} .5025177{col 37}{space 5} 2.744092{col 51}{space 3} 4.721571
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 8.104654{col 26}{space 2} 1.138754{col 37}{space 5} 5.864073{col 51}{space 3} 10.34523
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.546443{col 26}{space 2} .5283158{col 37}{space 5} 2.506944{col 51}{space 3} 4.585943
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1115351{col 26}{space 2} .1044452{col 37}{space 5}-.0939683{col 51}{space 3} .3170384
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6749598{col 26}{space 2} .1944341{col 37}{space 5} .2923967{col 51}{space 3} 1.057523
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.238774{col 26}{space 2} .2172529{col 37}{space 5} .8113134{col 51}{space 3} 1.666235
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 3.094836{col 26}{space 2} .5337637{col 37}{space 5} 2.044618{col 51}{space 3} 4.145055
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.249639{col 26}{space 2} .2366178{col 37}{space 5}  .784077{col 51}{space 3} 1.715202
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent pg_ent spg_ent , over(spdomain);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent        {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .3949241{col 26}{space 2} .2837125{col 37}{space 5}-.1633007{col 51}{space 3} .9531489
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.47244{col 26}{space 2} 1.969776{col 37}{space 5} 7.596763{col 51}{space 3} 15.34811
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 18.30339{col 26}{space 2} 1.944697{col 37}{space 5} 14.47706{col 51}{space 3} 22.12972
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 29.48594{col 26}{space 2} 2.868099{col 37}{space 5} 23.84275{col 51}{space 3} 35.12913
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.70276{col 26}{space 2} 2.070958{col 37}{space 5}   12.628{col 51}{space 3} 20.77752
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent       {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1942915{col 26}{space 2} .1629339{col 37}{space 5}-.1262927{col 51}{space 3} .5148758
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.236628{col 26}{space 2} .4778657{col 37}{space 5} 1.296393{col 51}{space 3} 3.176863
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 3.732832{col 26}{space 2} .5025177{col 37}{space 5} 2.744092{col 51}{space 3} 4.721571
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 8.104654{col 26}{space 2} 1.138754{col 37}{space 5} 5.864073{col 51}{space 3} 10.34523
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.546443{col 26}{space 2} .5283158{col 37}{space 5} 2.506944{col 51}{space 3} 4.585943
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1115351{col 26}{space 2} .1044452{col 37}{space 5}-.0939683{col 51}{space 3} .3170384
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6749598{col 26}{space 2} .1944341{col 37}{space 5} .2923967{col 51}{space 3} 1.057523
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.238774{col 26}{space 2} .2172529{col 37}{space 5} .8113134{col 51}{space 3} 1.666235
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 3.094836{col 26}{space 2} .5337637{col 37}{space 5} 2.044618{col 51}{space 3} 4.145055
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.249639{col 26}{space 2} .2366178{col 37}{space 5}  .784077{col 51}{space 3} 1.715202
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.                 compress;
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}bswt was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}one was {res}float{txt} now {res}byte
{txt}h was {res}float{txt} now {res}byte
{txt}h_ent was {res}float{txt} now {res}byte
{txt}
{com}.       gen dum=1;
{txt}
{com}.         sort hhid;
{txt}
{com}.         *set aside the spatial price index;
.       tempfile spi;
{txt}
{com}. *      use "$path/work/povmeas_ent.dta", clear;
.       collapse (mean) spi, by(reg_tpi);
{txt}
{com}.       sort reg_tpi;
{txt}
{com}. save `spi', replace;
{txt}(note: file /tmp/St02564.000004 not found)
file /tmp/St02564.000004 saved

{com}. clear;
{txt}
{com}. **************************************************************************;
. * Calculate poverty measures with Maputo regions on flexible food shares
> **************************************************************************;
. use `contpi';
{txt}
{com}.         sort reg_tpi;
{txt}
{com}.         merge reg_tpi using `povlines_ent';
{txt}{p 0 4 2}
variable{txt} reg_tpi
does not uniquely identify observations in
the master data
{p_end}
(label lregion already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          5        0.16        0.16
{txt}          3 {c |}{res}      3,119       99.84      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop _merge;
{txt}
{com}. **************************************************************************;
. * Create spatial price index, based on the total poverty line, with
> * adjustment so that mean (and total) nominal consumption equals
> * mean (and total) spatially deflated consumption.
> *
> * Choose arbitrary strata to be the base at first. The middle of the 13
> * codes is code 7 -- that's arbirtary enough.
> **************************************************************************;
.         gen cr= cons_pc_tpi ;
{txt}(16 missing values generated)

{com}.         gen linpob=povline_ent_m;
{txt}(5 missing values generated)

{com}.         qui sum linpob if spdomain==1, meanonly;
{txt}
{com}.         global spi_base=r(mean);
{txt}
{com}.         gen spi=linpob/$spi_base;
{txt}(5 missing values generated)

{com}.         gen cr2=cr/spi;
{txt}(16 missing values generated)

{com}.         qui sum cr [aw=hhweight*hhsize];
{txt}
{com}.         global sumcr=r(sum);
{txt}
{com}.         qui sum cr2 [aw=hhweight*hhsize];
{txt}
{com}.         global sumcr2=r(sum);
{txt}
{com}.         replace spi=spi*$sumcr2/$sumcr;
{txt}(3119 real changes made)

{com}.         gen linpobr=linpob/spi;
{txt}(5 missing values generated)

{com}.         replace cr2=cr/spi;
{txt}(3108 real changes made)

{com}.         sum cr cr2 linpob linpobr [aw=hhweight*hhsize];

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}cr {c |}{res}    3108  28069559.9    1060.929    1055.93   106.8324   23434.67
{txt}{space 9}cr2 {c |}{res}    3108  28069559.9    1060.929   1057.035   124.7579   23579.28
{txt}{space 6}linpob {c |}{res}    3119  28164219.1    430.9366   31.21727   369.5095   465.1193
{txt}{space 5}linpobr {c |}{res}    3119  28164219.1    431.5098   .0000263   431.5098   431.5099
{txt}
{com}.         lab var cr      "Temporally-adjusted cons pc";
{txt}
{com}.         lab var cr2     "Spatially & temporally adjusted cons pc";
{txt}
{com}.         lab var linpob  "Poverty line";
{txt}
{com}.         lab var linpobr "Real poverty line";
{txt}
{com}.         lab var spi     "Spatial price index";
{txt}
{com}.         *calculate poverty measures;
.         gen h = 100     if cr2 <=(linpobr);
{txt}(2686 missing values generated)

{com}.         replace  h = 0 if cr2 > (linpobr);
{txt}(2686 real changes made)

{com}.         gen             pg      = ((linpobr - cr2 )/linpobr) *100;
{txt}(16 missing values generated)

{com}.         replace         pg      = 0             if h==0;
{txt}(2686 real changes made)

{com}.         gen             spg     = ((( linpobr - cr2 )/ linpobr )^2)*100;
{txt}(16 missing values generated)

{com}.         replace         spg     = 0             if h==0;
{txt}(2686 real changes made)

{com}.         gen h_ent_m  =h;
{txt}
{com}.         gen pg_ent_m =pg;
{txt}(5 missing values generated)

{com}.         gen spg_ent_m=spg;
{txt}(5 missing values generated)

{com}.         lab var h_ent_m   "Poverty headcount entropy bundle. Food share flexible. Flexible bundle";
{txt}
{com}.         lab var pg_ent_m  "Poverty gap entropy bundle. Food share flexible. Flexible bundle";
{txt}
{com}.         lab var spg_ent_m "Squared poverty gap entropy. Food share flexible. Flexible bundle";
{txt}
{com}.         sort hhid;
{txt}
{com}.         merge hhid using "$path/work/hhdata.dta";
{txt}(label lnews already defined)
(label lspdomain already defined)
(label lregion already defined)
(label lrural already defined)
(label lstrata already defined)
(label lsurvmon already defined)
(label lsurvquar already defined)
(label SUBSTRAT already defined)
(label INIDPCMP already defined)
(label RESPCODE already defined)
(label districtc05 already defined)
(label districtc09 already defined)
(label stratum already defined)

{com}.         tab _merge;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          1 {c |}{res}          1        0.03        0.03
{txt}          3 {c |}{res}      3,123       99.97      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}      3,124      100.00
{txt}
{com}.         drop if _merge~=3;
{txt}(1 observation deleted)

{com}.         drop _merge;
{txt}
{com}.         gen popwt=hhsize*hhweight;
{txt}(4 missing values generated)

{com}.         lab var popwt "Population weights = hhsize X hhweight";
{txt}
{com}.                 * Stata 10.1 syntax ;
.         svyset , clear;
{txt}
{com}.         svyset [pweight=popwt] , str(strata) psu(psu);

      {txt}pweight:{col 16}{res}popwt
          {txt}VCE:{col 16}{res}linearized
  {txt}Single unit:{col 16}{res}missing
     {txt}Strata 1:{col 16}{res}strata
         {txt}SU 1:{col 16}{res}psu
        {txt}FPC 1:{col 16}<zero>
{p2colreset}{...}

{com}.                 svy: mean h_ent_m pg_ent_m spg_ent_m;
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{space 5}h_ent_m {c |}{col 14}{res}{space 2} 16.36014{col 26}{space 2} .9930438{col 37}{space 5} 14.40625{col 51}{space 3} 18.31402
{txt}{space 4}pg_ent_m {c |}{col 14}{res}{space 2} 3.723273{col 26}{space 2} .2920829{col 37}{space 5} 3.148579{col 51}{space 3} 4.297967
{txt}{space 3}spg_ent_m {c |}{col 14}{res}{space 2} 1.316012{col 26}{space 2} .1308725{col 37}{space 5} 1.058511{col 51}{space 3} 1.573513
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(rural);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

        {txt}Urban: rural = {res}Urban
        {txt}Rural: rural = {res}Rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent_m      {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} 2.643933{col 26}{space 2} .6841143{col 37}{space 5} 1.297889{col 51}{space 3} 3.989977
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 19.22257{col 26}{space 2} 1.177857{col 37}{space 5} 16.90505{col 51}{space 3} 21.54009
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent_m     {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .6989037{col 26}{space 2} .2444724{col 37}{space 5} .2178867{col 51}{space 3} 1.179921
{txt}{space 7}Rural {c |}{col 14}{res}{space 2} 4.354427{col 26}{space 2} .3459018{col 37}{space 5} 3.673841{col 51}{space 3} 5.035014
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent_m    {txt}{c |}
{space 7}Urban {c |}{col 14}{res}{space 2} .2859285{col 26}{space 2} .1227554{col 37}{space 5} .0443984{col 51}{space 3} .5274587
{txt}{space 7}Rural {c |}{col 14}{res}{space 2}  1.53098{col 26}{space 2}  .154826{col 37}{space 5} 1.226349{col 51}{space 3} 1.835611
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(news);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

      {txt}Central: news = {res}Central
      {txt}Eastern: news = {res}Eastern
     {txt}Northern: news = {res}Northern
      {txt}Western: news = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent_m      {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 7.465414{col 26}{space 2} 1.240227{col 37}{space 5} 5.025179{col 51}{space 3}  9.90565
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 18.30339{col 26}{space 2} 1.944697{col 37}{space 5} 14.47706{col 51}{space 3} 22.12972
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 29.48594{col 26}{space 2} 2.868099{col 37}{space 5} 23.84275{col 51}{space 3} 35.12913
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.70276{col 26}{space 2} 2.070958{col 37}{space 5}   12.628{col 51}{space 3} 20.77752
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent_m     {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 1.497862{col 26}{space 2} .3087289{col 37}{space 5} .8904156{col 51}{space 3} 2.105308
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 3.732832{col 26}{space 2} .5025177{col 37}{space 5} 2.744092{col 51}{space 3} 4.721571
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 8.104654{col 26}{space 2} 1.138754{col 37}{space 5} 5.864073{col 51}{space 3} 10.34523
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.546443{col 26}{space 2} .5283158{col 37}{space 5} 2.506944{col 51}{space 3} 4.585943
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent_m    {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} .4711544{col 26}{space 2} .1298242{col 37}{space 5} .2157161{col 51}{space 3} .7265928
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.238774{col 26}{space 2} .2172529{col 37}{space 5} .8113134{col 51}{space 3} 1.666235
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 3.094836{col 26}{space 2} .5337637{col 37}{space 5} 2.044618{col 51}{space 3} 4.145055
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.249639{col 26}{space 2} .2366178{col 37}{space 5}  .784077{col 51}{space 3} 1.715202
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(reg_tpi);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

      {txt}Central: reg_tpi = {res}Central
      {txt}Eastern: reg_tpi = {res}Eastern
     {txt}Northern: reg_tpi = {res}Northern
      {txt}Western: reg_tpi = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent_m      {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 7.465414{col 26}{space 2} 1.240227{col 37}{space 5} 5.025179{col 51}{space 3}  9.90565
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 18.30339{col 26}{space 2} 1.944697{col 37}{space 5} 14.47706{col 51}{space 3} 22.12972
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 29.48594{col 26}{space 2} 2.868099{col 37}{space 5} 23.84275{col 51}{space 3} 35.12913
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.70276{col 26}{space 2} 2.070958{col 37}{space 5}   12.628{col 51}{space 3} 20.77752
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent_m     {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} 1.497862{col 26}{space 2} .3087289{col 37}{space 5} .8904156{col 51}{space 3} 2.105308
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 3.732832{col 26}{space 2} .5025177{col 37}{space 5} 2.744092{col 51}{space 3} 4.721571
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 8.104654{col 26}{space 2} 1.138754{col 37}{space 5} 5.864073{col 51}{space 3} 10.34523
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.546443{col 26}{space 2} .5283158{col 37}{space 5} 2.506944{col 51}{space 3} 4.585943
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent_m    {txt}{c |}
{space 5}Central {c |}{col 14}{res}{space 2} .4711544{col 26}{space 2} .1298242{col 37}{space 5} .2157161{col 51}{space 3} .7265928
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.238774{col 26}{space 2} .2172529{col 37}{space 5} .8113134{col 51}{space 3} 1.666235
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 3.094836{col 26}{space 2} .5337637{col 37}{space 5} 2.044618{col 51}{space 3} 4.145055
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.249639{col 26}{space 2} .2366178{col 37}{space 5}  .784077{col 51}{space 3} 1.715202
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(strata);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: strata = {res}central urban
    {txt}_subpop_2: strata = {res}central rural
    {txt}_subpop_3: strata = {res}Eastern urban
    {txt}_subpop_4: strata = {res}Eastern rural
    {txt}_subpop_5: strata = {res}Northern urban
    {txt}_subpop_6: strata = {res}Northern rural
    {txt}_subpop_7: strata = {res}Western Urban
    {txt}_subpop_8: strata = {res}Western rural

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent_m      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .3949241{col 26}{space 2} .2837125{col 37}{space 5}-.1633007{col 51}{space 3} .9531489
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.47244{col 26}{space 2} 1.969776{col 37}{space 5} 7.596763{col 51}{space 3} 15.34811
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} 4.500134{col 26}{space 2} 1.885657{col 37}{space 5} .7899681{col 51}{space 3}   8.2103
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2}  19.3941{col 26}{space 2} 2.087186{col 37}{space 5} 15.28741{col 51}{space 3} 23.50079
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 10.83068{col 26}{space 2} 4.242503{col 37}{space 5}  2.48325{col 51}{space 3} 19.17811
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 32.52435{col 26}{space 2} 3.238256{col 37}{space 5} 26.15285{col 51}{space 3} 38.89586
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} 4.350483{col 26}{space 2} 1.955302{col 37}{space 5} .5032859{col 51}{space 3} 8.197679
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 17.50833{col 26}{space 2} 2.197115{col 37}{space 5} 13.18535{col 51}{space 3} 21.83131
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent_m     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1942915{col 26}{space 2} .1629339{col 37}{space 5}-.1262927{col 51}{space 3} .5148758
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.236628{col 26}{space 2} .4778657{col 37}{space 5} 1.296393{col 51}{space 3} 3.176863
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .5360828{col 26}{space 2} .3407539{col 37}{space 5} -.134375{col 51}{space 3} 1.206541
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 3.985432{col 26}{space 2} .5405959{col 37}{space 5} 2.921771{col 51}{space 3} 5.049094
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2} 3.367906{col 26}{space 2} 1.534385{col 37}{space 5} .3488935{col 51}{space 3} 6.386918
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 8.876136{col 26}{space 2} 1.296284{col 37}{space 5} 6.325605{col 51}{space 3} 11.42667
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .5025887{col 26}{space 2} .3574236{col 37}{space 5}-.2006681{col 51}{space 3} 1.205845
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2} 3.744954{col 26}{space 2} .5593751{col 37}{space 5} 2.644343{col 51}{space 3} 4.845564
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent_m    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1115351{col 26}{space 2} .1044452{col 37}{space 5}-.0939683{col 51}{space 3} .3170384
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6749598{col 26}{space 2} .1944341{col 37}{space 5} .2923967{col 51}{space 3} 1.057523
{txt}{space 3}_subpop_3 {c |}{col 14}{res}{space 2} .0973691{col 26}{space 2} .0787008{col 37}{space 5}-.0574803{col 51}{space 3} .2522186
{txt}{space 3}_subpop_4 {c |}{col 14}{res}{space 2} 1.328966{col 26}{space 2} .2340691{col 37}{space 5} .8684178{col 51}{space 3} 1.789513
{txt}{space 3}_subpop_5 {c |}{col 14}{res}{space 2}   1.3518{col 26}{space 2} .7282591{col 37}{space 5}-.0811021{col 51}{space 3} 2.784702
{txt}{space 3}_subpop_6 {c |}{col 14}{res}{space 2} 3.378728{col 26}{space 2} .6077547{col 37}{space 5} 2.182927{col 51}{space 3} 4.574529
{txt}{space 3}_subpop_7 {c |}{col 14}{res}{space 2} .1540516{col 26}{space 2} .1396833{col 37}{space 5}-.1207854{col 51}{space 3} .4288885
{txt}{space 3}_subpop_8 {c |}{col 14}{res}{space 2}  1.32109{col 26}{space 2}   .25061{col 37}{space 5} .8279969{col 51}{space 3} 1.814183
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         svy: mean h_ent_m pg_ent_m spg_ent_m , over(spdomain);
{txt}(running mean on estimation sample)
{res}
{txt}Survey: Mean estimation

{col 1}Number of strata{col 18}= {res}      8{txt}{col 35}Number of obs{col 52}= {res}     3119
{txt}{col 1}Number of PSUs{col 18}= {res}    321{txt}{col 35}Population size{col 52}={res}  28164219
{txt}{col 35}Design df{col 52}= {res}      313

    {txt}_subpop_1: spdomain = {res}Central Urban
    {txt}_subpop_2: spdomain = {res}Central Rural
      {txt}Eastern: spdomain = {res}Eastern
     {txt}Northern: spdomain = {res}Northern
      {txt}Western: spdomain = {res}Western

{txt}{hline 13}{c TT}{hline 11}{hline 11}{hline 14}{hline 12}
{col 14}{c |}{col 26}  Linearized
{col 1}        Over{col 14}{c |}       Mean{col 26}   Std. Err.{col 38}     [95% Con{col 51}f. Interval]
{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}h_ent_m      {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .3949241{col 26}{space 2} .2837125{col 37}{space 5}-.1633007{col 51}{space 3} .9531489
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 11.47244{col 26}{space 2} 1.969776{col 37}{space 5} 7.596763{col 51}{space 3} 15.34811
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 18.30339{col 26}{space 2} 1.944697{col 37}{space 5} 14.47706{col 51}{space 3} 22.12972
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 29.48594{col 26}{space 2} 2.868099{col 37}{space 5} 23.84275{col 51}{space 3} 35.12913
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 16.70276{col 26}{space 2} 2.070958{col 37}{space 5}   12.628{col 51}{space 3} 20.77752
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}pg_ent_m     {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1942915{col 26}{space 2} .1629339{col 37}{space 5}-.1262927{col 51}{space 3} .5148758
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} 2.236628{col 26}{space 2} .4778657{col 37}{space 5} 1.296393{col 51}{space 3} 3.176863
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 3.732832{col 26}{space 2} .5025177{col 37}{space 5} 2.744092{col 51}{space 3} 4.721571
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 8.104654{col 26}{space 2} 1.138754{col 37}{space 5} 5.864073{col 51}{space 3} 10.34523
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 3.546443{col 26}{space 2} .5283158{col 37}{space 5} 2.506944{col 51}{space 3} 4.585943
{txt}{hline 13}{c +}{hline 11}{hline 11}{hline 14}{hline 12}
{res}spg_ent_m    {txt}{c |}
{space 3}_subpop_1 {c |}{col 14}{res}{space 2} .1115351{col 26}{space 2} .1044452{col 37}{space 5}-.0939683{col 51}{space 3} .3170384
{txt}{space 3}_subpop_2 {c |}{col 14}{res}{space 2} .6749598{col 26}{space 2} .1944341{col 37}{space 5} .2923967{col 51}{space 3} 1.057523
{txt}{space 5}Eastern {c |}{col 14}{res}{space 2} 1.238774{col 26}{space 2} .2172529{col 37}{space 5} .8113134{col 51}{space 3} 1.666235
{txt}{space 4}Northern {c |}{col 14}{res}{space 2} 3.094836{col 26}{space 2} .5337637{col 37}{space 5} 2.044618{col 51}{space 3} 4.145055
{txt}{space 5}Western {c |}{col 14}{res}{space 2} 1.249639{col 26}{space 2} .2366178{col 37}{space 5}  .784077{col 51}{space 3} 1.715202
{txt}{hline 13}{c BT}{hline 11}{hline 11}{hline 14}{hline 12}

{com}.         drop bswt one h pg spg;
{txt}
{com}.         compress;
{txt}survquar was {res}float{txt} now {res}byte
{txt}survmon was {res}float{txt} now {res}byte
{txt}strata was {res}float{txt} now {res}byte
{txt}rural was {res}float{txt} now {res}byte
{txt}spdomain was {res}float{txt} now {res}byte
{txt}news was {res}float{txt} now {res}byte
{txt}hhsize was {res}long{txt} now {res}byte
{txt}h_ent_m was {res}float{txt} now {res}byte
{txt}
{com}. label data "Final data set. Official published poverty rates are calculated from this data set";
{txt}note: label truncated to 80 characters

{com}.         sort hhid;
{txt}
{com}.         save "$path/work/povmeas_ent_flex.dta", replace;
{txt}(note: file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povmeas_ent_flex.dta not found)
file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povmeas_ent_flex.dta saved

{com}. gen dum=1;
{txt}
{com}.         *output the national measures;
.         collapse  (mean) dum h_ent_m pg_ent_m spg_ent_m [aw=hhweight*hhsize];
{txt}
{com}. gen geo="National";
{txt}
{com}. gen geono=dum;
{txt}
{com}. tempfile nat;
{txt}
{com}. save `nat';
{txt}file /tmp/St02564.000005 saved

{com}.         *output the rural/urban measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hhweight*hhsize], by(rural);
{txt}
{com}. gen geo="Rural/Urban";
{txt}
{com}. gen geono=rural;
{txt}
{com}. tempfile rur;
{txt}
{com}. save `rur';
{txt}file /tmp/St02564.000006 saved

{com}.         *output the North South Center measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hhweight*hhsize], by(news);
{txt}
{com}. gen geo="North/Center/South";
{txt}
{com}. gen geono=news;
{txt}
{com}. tempfile new;
{txt}
{com}. save `new';
{txt}file /tmp/St02564.000007 saved

{com}.         *output the North South Center rural/urban measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hhweight*hhsize], by(reg_tpi);
{txt}
{com}. gen geo="TPI - 6 regions";
{txt}
{com}. gen geono=reg_tpi;
{txt}
{com}. tempfile rtp;
{txt}
{com}. save `rtp';
{txt}file /tmp/St02564.000008 saved

{com}.         *output the provincial measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hhweight*hhsize], by(strata);
{txt}
{com}. gen geo="Provinces";
{txt}
{com}. gen geono=strata;
{txt}
{com}. tempfile str;
{txt}
{com}. save `str';
{txt}file /tmp/St02564.000009 saved

{com}.                 *output the dominios espaciais measures;
.         use "$path/work/povmeas_ent_flex.dta", clear;
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}.         collapse  (mean) h_ent_m pg_ent_m spg_ent_m [aw=hhweight*hhsize], by(spdomain);
{txt}
{com}. gen geo="Spatial domains";
{txt}
{com}. gen geono=spdomain;
{txt}
{com}. tempfile r13;
{txt}
{com}. save `r13';
{txt}file /tmp/St02564.00000a saved

{com}. clear;
{txt}
{com}. set obs 1;
{txt}obs was 0, now 1

{com}. gen geo=" ";
{txt}
{com}. tempfile one;
{txt}
{com}. save `one';
{txt}file /tmp/St02564.00000b saved

{com}. use          `nat';
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}. append using `one';
{txt}
{com}. append using `rur';
{txt}geo was {res}str8{txt} now {res}str11
{txt}
{com}. append using `one';
{txt}
{com}. append using `new';
{txt}geo was {res}str11{txt} now {res}str18
{txt}
{com}. append using `one';
{txt}
{com}. append using `rtp';
{txt}
{com}. append using `one';
{txt}
{com}. append using `str';
{txt}
{com}. append using `one';
{txt}
{com}. append using `r13';
{txt}
{com}. outsheet geo geono h_ent_m pg_ent_m spg_ent_m dum rural news reg_tpi strata spdomain using "$path/work/poverty_ent_flexBask.csv", replace c ;
{txt}(note: file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/poverty_ent_flexBask.csv not found)

{com}.         *set aside the spatial price index;
.       tempfile spi_m;
{txt}
{com}.       use "$path/work/povmeas_ent_flex.dta", clear;
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}.       collapse (mean) spi, by(reg_tpi);
{txt}
{com}.       rename spi spi_m;
{txt}
{com}.       sort reg_tpi;
{txt}
{com}. save `spi_m', replace;
{txt}(note: file /tmp/St02564.00000c not found)
file /tmp/St02564.00000c saved

{com}. use `povlines_ent';
{txt}
{com}.        sort reg_tpi;
{txt}
{com}.        merge reg_tpi using `spi';
{txt}(label lregion already defined)

{com}.        tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          2 {c |}{res}          1       20.00       20.00
{txt}          3 {c |}{res}          4       80.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}          5      100.00
{txt}
{com}.  drop _m;
{txt}
{com}.        sort reg_tpi;
{txt}
{com}.        merge reg_tpi using `spi_m';
{txt}(label lregion already defined)

{com}.         tab _m;

     {txt}_merge {c |}      Freq.     Percent        Cum.
{hline 12}{c +}{hline 35}
          3 {c |}{res}          5      100.00      100.00
{txt}{hline 12}{c +}{hline 35}
      Total {c |}{res}          5      100.00
{txt}
{com}.  drop _m;
{txt}
{com}. save "$path/work/povlines.dta", replace;
{txt}file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines.dta saved

{com}. outsheet reg_tpi food_povline_ent povline_ent fdshr using "$path/work/povlines.csv", replace c;
{txt}(note: file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//work/povlines.csv not found)

{com}.  *********************************************************************************
> * 210_povmeas_ent_flex.do               (end)
> *********************************************************************************;
. log close;
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/210_povmeas_ent_flex.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:55:35
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. do "$path/new/220_gen_results.do"
{txt}
{com}. *global path "C:\user\gapp"
. clear all
{txt}
{com}. set mem 999m
{txt}
{com}. 
. cap log close
{txt}
{com}. log using "$path/rep/220_gen_results.log", text replace
{txt}(note: file /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/220_gen_results.log not found)
{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/220_gen_results.log
  {txt}log type:  {res}text
 {txt}opened on:  {res}10 Mar 2014, 14:55:46
{txt}
{com}. set more off
{txt}
{com}. #delimit ;
{txt}delimiter now ;
{com}. *****************************************************************
> * 220_gen_results.do            (start)
> *
> * Do file to generate poverty and inequality results at various
> * levels of aggregation, and save the results for each 
> * bootstrap replication in a file.
> * NOTE: for some reason, -ineqdeco- doesn't generate results
> *       for GE(0), GE(1), GE(2), Gini, etc. when an "if" condition
> *               is used, so I'm using preserve/restore blocks for
> *               sub-groups instead.
> *               Also, saving results presented a few wrinkles, but
> *               doing it via matrices works.
> *****************************************************************;
. /*
>         This file uses:
>                 work/povmeas_ent_flex.dta (the bootstrapped version)
>                 out/bs_results.dta
>         
>         This file creates:
>                 out/bs_results.dta (updated)    
> */
> 
> 
> 
> 
> * Housecleaning;
. cap mat drop rep nat rur urb full;
{txt}
{com}. * Save the poverty lines in data file created for that purpose,;
. * and store in a matrix, for saving to a data file later.;
. use "$path/work/povmeas_ent_flex.dta", clear;
{txt}(Final data set. Official published poverty rates are calculated from this data s)

{com}.         foreach reg of numlist 1/13 {c -(};
{txt}  2{com}.                 qui sum linpob if spdomain==`reg';
{txt}  3{com}.                 global linpob`reg'=r(mean);
{txt}  4{com}.         {c )-};
{txt}
{com}.         mat input rep=(0);
{txt}
{com}.         mat input linpob=($linpob1 $linpob2 $linpob3 $linpob4 $linpob5 $linpob6 
>                 $linpob7 $linpob8 $linpob9 $linpob10 $linpob11 $linpob12 $linpob13);
{txt}
{com}.         mat linpob = rep, linpob;
{txt}
{com}.         mat colnames linpob = rep linpob1 linpob2 linpob3 linpob4 linpob5 linpob6 
>                 linpob7 linpob8 linpob9 linpob10 linpob11 linpob12 linpob13;
{txt}
{com}.         #delimit cr
{txt}delimiter now cr
{com}. 
.         * Change poverty measures from percentage to index terms;
.         gen h   = h_ent_   /100
{txt}
{com}.         gen pg  = pg_ent_m /100
{txt}(4 missing values generated)

{com}.         gen spg = spg_ent_m/100
{txt}(4 missing values generated)

{com}. 
.         * National figures;
.         sum h [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 11}h {c |}{res}    3119  28164219.1    .1636014   .3699728          0          1
{txt}
{com}.         glob p0_nat=r(mean)
{txt}
{com}.         sum pg [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}pg {c |}{res}    3119  28164219.1    .0372327   .1085248          0   .7108805
{txt}
{com}.         glob p1_nat=r(mean)
{txt}
{com}.         sum spg [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 9}spg {c |}{res}    3119  28164219.1    .0131601   .0494596          0    .505351
{txt}
{com}.         glob p2_nat=r(mean)
{txt}
{com}.         ineqdeco cr2 [aw=hhweight*hhsize]
{txt}(4 missing values generated)
{res} 
 
Percentile ratios for distribution of cr2: all valid obs.
{txt}------------------------------------------------------------
p90/p10  p90/p50  p10/p50  p75/p25  p75/p50  p25/p50
------------------------------------------------------------
{res}  5.508    2.629    0.477    2.353    1.562    0.664
              
Generalized Entropy indices GE(a), where a = income difference
 sensitivity parameter, and Gini coefficient

{txt}{hline 10}{c TT}{hline 59}
  All obs {c |}     GE(-1)       GE(0)       GE(1)       GE(2)        Gini
{hline 10}{c +}{hline 59}
        0 {c |}           {res}                                                
{txt}{hline 10}{c BT}{hline 59}
{res}   
Atkinson indices, A(e), where e > 0 is the inequality aversion parameter

{txt}{hline 10}{c TT}{hline 35}
  All obs {c |}     A(0.5)        A(1)        A(2)
{hline 10}{c +}{hline 35}
          {c |}    {res}0.13060     0.23063     0.37389
{txt}{hline 10}{c BT}{hline 35}

{com}.         glob gini_nat=$S_gini
{txt}
{com}.         glob ge0_nat =$S_i0
{txt}
{com}.         glob ge1_nat =$S_i1
{txt}
{com}.         glob ge2_nat =$S_i2
{txt}
{com}.         mat input nat=($p0_nat $p1_nat $p2_nat $gini_nat $ge0_nat $ge1_nat $ge2_nat)
{txt}
{com}. 
.         * Rural figures;
.         preserve
{txt}
{com}.                 keep if rural==1
{txt}(864 observations deleted)

{com}.                 sum h [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 11}h {c |}{res}    2259    23301450    .1922257   .3941367          0          1
{txt}
{com}.                 glob p0_rur=r(mean)
{txt}
{com}.                 sum pg [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}pg {c |}{res}    2259    23301450    .0435443   .1158432          0   .6578453
{txt}
{com}.                 glob p1_rur=r(mean)
{txt}
{com}.                 sum spg [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 9}spg {c |}{res}    2259    23301450    .0153098    .052505          0   .4327604
{txt}
{com}.                 glob p2_rur=r(mean)
{txt}
{com}.                 ineqdeco cr2 [aw=hhweight*hhsize]
{res} 
 
Percentile ratios for distribution of cr2: all valid obs.
{txt}------------------------------------------------------------
p90/p10  p90/p50  p10/p50  p75/p25  p75/p50  p25/p50
------------------------------------------------------------
{res}  4.224    2.143    0.507    2.169    1.489    0.686
              
Generalized Entropy indices GE(a), where a = income difference
 sensitivity parameter, and Gini coefficient

{txt}{hline 10}{c TT}{hline 59}
  All obs {c |}     GE(-1)       GE(0)       GE(1)       GE(2)        Gini
{hline 10}{c +}{hline 59}
        0 {c |}           {res}                                                
{txt}{hline 10}{c BT}{hline 59}
{res}   
Atkinson indices, A(e), where e > 0 is the inequality aversion parameter

{txt}{hline 10}{c TT}{hline 35}
  All obs {c |}     A(0.5)        A(1)        A(2)
{hline 10}{c +}{hline 35}
          {c |}    {res}0.09799     0.17728     0.30142
{txt}{hline 10}{c BT}{hline 35}

{com}.                 glob gini_rur=$S_gini
{txt}
{com}.                 glob ge0_rur =$S_i0
{txt}
{com}.                 glob ge1_rur =$S_i1
{txt}
{com}.                 glob ge2_rur =$S_i2
{txt}
{com}.         restore
{txt}
{com}.         mat input rur=($p0_rur $p1_rur $p2_rur $gini_rur $ge0_rur $ge1_rur $ge2_rur)
{txt}
{com}. 
.         * Urban figures;
.         preserve
{txt}
{com}.                 keep if rural==0
{txt}(2263 observations deleted)

{com}.                 sum h [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 11}h {c |}{res}     860  4862769.14    .0264393   .1605312          0          1
{txt}
{com}.                 glob p0_urb=r(mean)
{txt}
{com}.                 sum pg [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 10}pg {c |}{res}     860  4862769.14     .006989   .0530444          0   .7108805
{txt}
{com}.                 glob p1_urb=r(mean)
{txt}
{com}.                 sum spg [aw=hhweight*hhsize]

{txt}    Variable {c |}     Obs      Weight        Mean   Std. Dev.       Min        Max
{hline 13}{c +}{hline 65}
{space 9}spg {c |}{res}     860  4862769.14    .0028593   .0288498          0    .505351
{txt}
{com}.                 glob p2_urb=r(mean)
{txt}
{com}.                 ineqdeco cr2 [aw=hhweight*hhsize]
{res} 
 
Percentile ratios for distribution of cr2: all valid obs.
{txt}------------------------------------------------------------
p90/p10  p90/p50  p10/p50  p75/p25  p75/p50  p25/p50
------------------------------------------------------------
{res}  5.918    2.471    0.418    2.840    1.722    0.606
              
Generalized Entropy indices GE(a), where a = income difference
 sensitivity parameter, and Gini coefficient

{txt}{hline 10}{c TT}{hline 59}
  All obs {c |}     GE(-1)       GE(0)       GE(1)       GE(2)        Gini
{hline 10}{c +}{hline 59}
        0 {c |}           {res}                                                
{txt}{hline 10}{c BT}{hline 59}
{res}   
Atkinson indices, A(e), where e > 0 is the inequality aversion parameter

{txt}{hline 10}{c TT}{hline 35}
  All obs {c |}     A(0.5)        A(1)        A(2)
{hline 10}{c +}{hline 35}
          {c |}    {res}0.12136     0.22492     0.39471
{txt}{hline 10}{c BT}{hline 35}

{com}.                 glob gini_urb=$S_gini
{txt}
{com}.                 glob ge0_urb =$S_i0
{txt}
{com}.                 glob ge1_urb =$S_i1
{txt}
{com}.                 glob ge2_urb =$S_i2
{txt}
{com}.         restore
{txt}
{com}.         mat input urb=($p0_urb $p1_urb $p2_urb $gini_urb $ge0_urb $ge1_urb $ge2_urb)
{txt}
{com}. 
.         * Assemble the matrix pieces and save this set of estimates in the data file;
.                 #delimit;
{txt}delimiter now ;
{com}.                 mat full= rep, nat, rur, urb;
{txt}
{com}.                 mat colnames full = rep 
>                                         p0_nat  p1_nat  p2_nat  gini_nat  ge0_nat  ge1_nat      ge2_nat
>                                         p0_rur  p1_rur  p2_rur  gini_rur  ge0_rur  ge1_rur      ge2_rur
>                                         p0_urb  p1_urb  p2_urb  gini_urb  ge0_urb  ge1_urb      ge2_urb;
{txt}
{com}.         #delimit cr
{txt}delimiter now cr
{com}.         mat list full

{txt}full[1,22]
          rep     p0_nat     p1_nat     p2_nat   gini_nat    ge0_nat    ge1_nat    ge2_nat
r1  {res}        0  .16360139  .03723273  .01316012          .          .          .          .

    {txt}   p0_rur     p1_rur     p2_rur   gini_rur    ge0_rur    ge1_rur    ge2_rur     p0_urb
r1  {res}.19222568  .04354427   .0153098          .          .          .          .  .02643933

    {txt}   p1_urb     p2_urb   gini_urb    ge0_urb    ge1_urb    ge2_urb
r1  {res}.00698904  .00285929          .          .          .          .
{txt}
{com}. 
. 
. drop _all
{txt}
{com}. 
. svmat full , names(col)
{txt}number of observations will be reset to 1
Press any key to continue, or Break to abort
obs was 0, now 1

{com}.         tempfile rep
{txt}
{com}.         compress
{txt}rep was {res}float{txt} now {res}byte
{txt}gini_nat was {res}float{txt} now {res}byte
{txt}ge0_nat was {res}float{txt} now {res}byte
{txt}ge1_nat was {res}float{txt} now {res}byte
{txt}ge2_nat was {res}float{txt} now {res}byte
{txt}gini_rur was {res}float{txt} now {res}byte
{txt}ge0_rur was {res}float{txt} now {res}byte
{txt}ge1_rur was {res}float{txt} now {res}byte
{txt}ge2_rur was {res}float{txt} now {res}byte
{txt}gini_urb was {res}float{txt} now {res}byte
{txt}ge0_urb was {res}float{txt} now {res}byte
{txt}ge1_urb was {res}float{txt} now {res}byte
{txt}ge2_urb was {res}float{txt} now {res}byte
{txt}
{com}. 
. 
. 
. 
. 
. *****************************************************************
. * 220_gen_results.do            (end)
. *****************************************************************;
. 
. log close
      {txt}name:  {res}<unnamed>
       {txt}log:  {res}/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06//rep/220_gen_results.log
  {txt}log type:  {res}text
 {txt}closed on:  {res}10 Mar 2014, 14:55:46
{txt}{.-}

{com}. 
{txt}end of do-file

{com}. 