GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  *File to estimate quantities consistent with revealed preferences
   2   
      This file uses:
               work\product_flex.inc
               work\price_unit_flex.inc
               work\quan_flex.inc
       
      This file creates:
               work\qent.csv
               work\povline_ali_ent.csv
               work\povline_rp_inout.csv
       
  15   
  16  SETS
  17   cod        200910 codes for products used in basket
  18  /
INCLUDE    /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/product_flex.inc
  20  100
  21  105
  22  106
  23  107
  24  108
  25  109
  26  110
  27  111
  28  112
  29  113
  30  114
  31  115
  32  116
  33  117
  34  119
  35  121
  36  122
  37  123
  38  125
  39  127
  40  132
  41  134
  42  135
  43  136
  44  137
  45  138
  46  139
  47  140
  48  141
  49  143
  50  144
  51  145
  52  146
  53  147
  54  150
  55  154
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


  56  /
  57   
  58   reg        5 spatial domains /1*5/
  59   r(reg)     all included spatial regions /1*5/
  60   
  61   ptit       price table titles
  62  /
  63    count      number of observations making up the price average
  64    price_uw5  average price
  65  /
  66   
  67   qtit       quantity table titles
  68  /
  69    calperg          calories per gram
  70    quan5            quantities in grams
  71    calpp            calories per person by region
  72    povline_a_flex5    value of flexible food bundle
  73  /
  74   
  75   
  76    posquan(cod,reg)  mark positive quantities in each region
  77    posprice(cod,reg) mark the existence of acceptable price info in each region
  78    chkprice(cod,reg) ensure that prices exist once all estimated
  79  ;
  80   
  81  alias(reg,regq);
  82  alias(r,rq);
  83   
  84  SCALAR
  85     caltarg single level of calories to target across regions / 2150 /
  86   ;
  87   
  88  PARAMETERS
  89   
  90    shr(cod,reg)         shares in each basket by region
  91    chkshr(reg)          check that the calculated shares sum to .9
  92    shrmiss(regq,reg)    shares missing in each region pair
  93    povline_ali(reg)       food poverty line
  94    perc_chng(reg)       percent change in line
  95    finmiss(reg)         final missing shares post optimization procedure
  96   ;
  97   
  98  Table  price(cod,reg,ptit)  price and related information
  99                          count   price_uw5
INCLUDE    /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/price_unit_flex.inc
 101  100     .       1       25      .183751
 102  100     .       2       85      .0975617
 103  100     .       3       88      .1084728
 104  100     .       4       13      .0998728
 105  100     .       5       228     .0944435
 106  105     .       1       29      .1477785
 107  105     .       2       101     .1201643
 108  105     .       3       192     .1445653
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 109  105     .       4       84      .0836414
 110  105     .       5       159     .1200921
 111  106     .       1       3       .3885128
 112  106     .       3       26      .1252041
 113  106     .       4       5       .0854652
 114  106     .       5       7       .0817442
 115  107     .       1       23      .0607322
 116  107     .       2       79      .0580823
 117  107     .       3       103     .0602927
 118  107     .       4       95      .0271556
 119  107     .       5       120     .0733958
 120  108     .       1       2       .5078834
 121  108     .       2       23      .2780761
 122  108     .       3       150     .412909
 123  108     .       4       75      .4707699
 124  108     .       5       82      .4007722
 125  109     .       1       3       .5268325
 126  109     .       2       6       .2491928
 127  109     .       3       7       .5305876
 128  109     .       5       63      .1538359
 129  110     .       1       23      1.06354
 130  110     .       2       15      .9047616
 131  110     .       3       68      1.009926
 132  110     .       4       10      1.07391
 133  110     .       5       28      .9574083
 134  111     .       2       2       .1746173
 135  111     .       3       25      .2588804
 136  111     .       4       23      .30182
 137  111     .       5       12      .2588116
 138  112     .       1       3       .3117668
 139  112     .       2       19      .2126896
 140  112     .       3       52      .1754048
 141  112     .       4       37      .1134935
 142  112     .       5       28      .1755183
 143  113     .       1       38      .5616655
 144  113     .       2       106     .5305869
 145  113     .       3       200     .4904967
 146  113     .       4       89      .3404138
 147  113     .       5       162     .4923098
 148  114     .       1       17      .9122462
 149  114     .       2       12      1.077569
 150  114     .       3       26      1.192942
 151  114     .       4       7       1.415191
 152  114     .       5       23      1.010148
 153  115     .       1       2       .5615975
 154  115     .       2       13      .4499322
 155  115     .       3       73      .4875383
 156  115     .       4       17      .3302123
 157  115     .       5       73      .5513065
 158  116     .       1       1       .7554569
 159  116     .       2       1       .0481721
 160  116     .       3       95      .2709334
 161  116     .       4       95      .3023219
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 162  116     .       5       21      .3381379
 163  117     .       1       9       2.4113
 164  117     .       2       18      2.138755
 165  117     .       3       85      2.663086
 166  117     .       4       38      2.400627
 167  117     .       5       72      2.176478
 168  119     .       2       2       1.898333
 169  119     .       3       27      2.712573
 170  119     .       4       22      1.952311
 171  119     .       5       16      2.375589
 172  121     .       2       7       2.71793
 173  121     .       3       35      2.766484
 174  121     .       4       18      2.176819
 175  121     .       5       9       2.591507
 176  122     .       1       16      .3806249
 177  122     .       2       44      .4286192
 178  122     .       3       70      .660553
 179  122     .       4       26      .2936031
 180  122     .       5       22      .7250918
 181  123     .       1       14      1.092988
 182  123     .       2       34      .4706388
 183  123     .       3       120     .7605309
 184  123     .       4       89      1.335038
 185  123     .       5       32      1.831238
 186  125     .       1       15      .0872045
 187  125     .       2       46      .1013107
 188  125     .       3       93      .0615126
 189  125     .       4       23      .0290214
 190  125     .       5       66      .0461501
 191  127     .       1       37      1.76884
 192  127     .       2       78      1.549402
 193  127     .       3       235     1.669559
 194  127     .       4       181     2.084548
 195  127     .       5       64      2.02092
 196  132     .       1       3       .2330394
 197  132     .       2       14      .0808339
 198  132     .       3       40      .0853041
 199  132     .       4       22      .0395371
 200  132     .       5       22      .0717314
 201  134     .       1       10      .5278798
 202  134     .       2       55      .702066
 203  134     .       3       49      .9374316
 204  134     .       4       14      .2980221
 205  134     .       5       54      .2250476
 206  135     .       1       42      .3161775
 207  135     .       2       101     .3494835
 208  135     .       3       222     .2872065
 209  135     .       4       159     .1988528
 210  135     .       5       139     .2490709
 211  136     .       1       39      .0918267
 212  136     .       2       116     .0848172
 213  136     .       3       247     .1029263
 214  136     .       4       110     .0979106
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 215  136     .       5       149     .1404231
 216  137     .       1       11      .3838921
 217  137     .       2       11      .2636259
 218  137     .       3       59      .3286387
 219  137     .       4       24      .3796229
 220  137     .       5       27      .2811364
 221  138     .       1       9       .34019
 222  138     .       2       53      .1938604
 223  138     .       3       165     .2570899
 224  138     .       4       47      .2018096
 225  138     .       5       117     .2335793
 226  139     .       1       12      .2899968
 227  139     .       2       35      .2091859
 228  139     .       3       181     .254248
 229  139     .       4       230     .198578
 230  139     .       5       33      .2841167
 231  140     .       1       8       .5501741
 232  140     .       2       16      1.084393
 233  140     .       3       25      .8560518
 234  140     .       4       12      .3272821
 235  140     .       5       65      .6818734
 236  141     .       1       30      .7991219
 237  141     .       2       103     .7585092
 238  141     .       3       183     .7249936
 239  141     .       4       120     1.146282
 240  141     .       5       229     .8158221
 241  143     .       1       1       1.699778
 242  143     .       2       17      1.23645
 243  143     .       3       68      1.36957
 244  143     .       4       18      .7047974
 245  143     .       5       37      1.835728
 246  144     .       1       31      1.335071
 247  144     .       2       40      1.295553
 248  144     .       3       84      1.230627
 249  144     .       4       1       1.75
 250  144     .       5       60      1.307449
 251  145     .       1       1       .8670973
 252  145     .       2       2       .8577663
 253  145     .       3       31      .758294
 254  145     .       4       27      .5177717
 255  145     .       5       14      .7271287
 256  146     .       1       2       1.692853
 257  146     .       2       2       1.002149
 258  146     .       3       13      1.3489
 259  146     .       4       38      .9193286
 260  146     .       5       6       1.148567
 261  147     .       1       37      1.509419
 262  147     .       2       87      1.595948
 263  147     .       3       237     1.731423
 264  147     .       4       89      1.600621
 265  147     .       5       97      1.690496
 266  150     .       1       43      .4158889
 267  150     .       2       163     .4074605
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 268  150     .       3       339     .4360197
 269  150     .       4       277     .3632688
 270  150     .       5       291     .5406814
 271  154     .       1       1       1.926883
 272  154     .       2       4       .535405
 273  154     .       3       17      .6106396
 274  154     .       4       25      .273227
 275  154     .       5       22      .2598047
 276  ;
 277   
 278  Table   quan(cod,reg,qtit)   quantity and related information
 279                             calperg          quan5           calpp      povline_a_flex5
INCLUDE    /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/quan_flex.inc
 281  100     .       1       6.8900000e-01   1.9095921e+02   2.1955244e+03   412.7157
 282  105     .       1       1.0164000e+00   2.3795955e+02   2.1955244e+03   412.7157
 283  107     .       1       1.3440000e+00   5.0604535e+02   2.1955244e+03   412.7157
 284  110     .       1       3.6100000e+00   3.6520874e+01   2.1955244e+03   412.7157
 285  113     .       1       3.6500000e+00   9.9019333e+01   2.1955244e+03   412.7157
 286  114     .       1       2.6600000e+00   7.1189799e+00   2.1955244e+03   412.7157
 287  122     .       1       6.1610000e-01   4.1191948e+01   2.1955244e+03   412.7157
 288  123     .       1       3.7500000e+00   1.3994786e+01   2.1955244e+03   412.7157
 289  125     .       1       6.0000000e-01   1.0148734e+02   2.1955244e+03   412.7157
 290  127     .       1       8.8400000e+00   7.2117934e+00   2.1955244e+03   412.7157
 291  134     .       1       4.9400000e-01   1.3495904e+01   2.1955244e+03   412.7157
 292  135     .       1       3.6400000e-01   2.1865788e+01   2.1955244e+03   412.7157
 293  136     .       1       1.6380000e-01   1.3555214e+02   2.1955244e+03   412.7157
 294  137     .       1       2.6400000e-01   1.1898093e+01   2.1955244e+03   412.7157
 295  141     .       1       3.1300000e+00   2.8505062e+01   2.1955244e+03   412.7157
 296  144     .       1       5.8800000e+00   1.4345232e+01   2.1955244e+03   412.7157
 297  147     .       1       3.8700000e+00   2.6859934e+01   2.1955244e+03   412.7157
 298  150     .       1       0.0000000e+00   8.1689863e+00   2.1955244e+03   412.7157
 299  100     .       2       6.8900000e-01   3.6606534e+02   2.1336050e+03   306.2409
 300  105     .       2       1.0164000e+00   3.9579422e+02   2.1336050e+03   306.2409
 301  107     .       2       1.3440000e+00   4.9701785e+02   2.1336050e+03   306.2409
 302  108     .       2       3.1400000e+00   2.3406103e+01   2.1336050e+03   306.2409
 303  112     .       2       9.4600000e-01   1.8574183e+01   2.1336050e+03   306.2409
 304  113     .       2       3.6500000e+00   7.7192871e+01   2.1336050e+03   306.2409
 305  117     .       2       1.7982000e+00   2.9442437e+00   2.1336050e+03   306.2409
 306  122     .       2       6.1610000e-01   1.8083361e+01   2.1336050e+03   306.2409
 307  123     .       2       3.7500000e+00   7.4677048e+00   2.1336050e+03   306.2409
 308  125     .       2       6.0000000e-01   1.1843534e+02   2.1336050e+03   306.2409
 309  127     .       2       8.8400000e+00   2.3380656e+00   2.1336050e+03   306.2409
 310  134     .       2       4.9400000e-01   1.4118240e+01   2.1336050e+03   306.2409
 311  135     .       2       3.6400000e-01   7.6078157e+00   2.1336050e+03   306.2409
 312  136     .       2       1.6380000e-01   7.4976646e+01   2.1336050e+03   306.2409
 313  138     .       2       2.0160000e-01   3.0549623e+01   2.1336050e+03   306.2409
 314  140     .       2       1.0300000e+00   5.3102088e+00   2.1336050e+03   306.2409
 315  141     .       2       3.1300000e+00   3.3820999e+01   2.1336050e+03   306.2409
 316  144     .       2       5.8800000e+00   3.0485787e+00   2.1336050e+03   306.2409
 317  147     .       2       3.8700000e+00   9.8192387e+00   2.1336050e+03   306.2409
 318  150     .       2       0.0000000e+00   7.3361239e+00   2.1336050e+03   306.2409
 319  100     .       3       6.8900000e-01   1.9767300e+02   2.1069595e+03   363.3799
 320  105     .       3       1.0164000e+00   3.3068881e+02   2.1069595e+03   363.3799
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 321  106     .       3       3.4300000e+00   3.3928783e+01   2.1069595e+03   363.3799
 322  107     .       3       1.3440000e+00   1.8392348e+02   2.1069595e+03   363.3799
 323  108     .       3       3.1400000e+00   7.4874794e+01   2.1069595e+03   363.3799
 324  110     .       3       3.6100000e+00   6.0655532e+00   2.1069595e+03   363.3799
 325  112     .       3       9.4600000e-01   4.2449345e+01   2.1069595e+03   363.3799
 326  113     .       3       3.6500000e+00   8.5256783e+01   2.1069595e+03   363.3799
 327  115     .       3       3.7800000e+00   2.0224421e+01   2.1069595e+03   363.3799
 328  116     .       3       3.3900000e+00   2.2146095e+01   2.1069595e+03   363.3799
 329  117     .       3       1.7982000e+00   3.6984046e+00   2.1069595e+03   363.3799
 330  119     .       3       1.2210000e+00   1.3367772e+00   2.1069595e+03   363.3799
 331  121     .       3       1.4835000e+00   2.2096522e+00   2.1069595e+03   363.3799
 332  122     .       3       6.1610000e-01   1.3807888e+01   2.1069595e+03   363.3799
 333  123     .       3       3.7500000e+00   1.2522201e+01   2.1069595e+03   363.3799
 334  125     .       3       6.0000000e-01   1.4532356e+02   2.1069595e+03   363.3799
 335  127     .       3       8.8400000e+00   5.6389980e+00   2.1069595e+03   363.3799
 336  132     .       3       4.3310000e-01   4.2027752e+01   2.1069595e+03   363.3799
 337  134     .       3       4.9400000e-01   4.4045339e+00   2.1069595e+03   363.3799
 338  136     .       3       1.6380000e-01   8.4792152e+01   2.1069595e+03   363.3799
 339  138     .       3       2.0160000e-01   3.5193798e+01   2.1069595e+03   363.3799
 340  139     .       3       2.6100000e-01   4.4586105e+01   2.1069595e+03   363.3799
 341  141     .       3       3.1300000e+00   2.0863901e+01   2.1069595e+03   363.3799
 342  143     .       3       5.6700000e+00   3.2268093e+00   2.1069595e+03   363.3799
 343  144     .       3       5.8800000e+00   3.6648760e+00   2.1069595e+03   363.3799
 344  147     .       3       3.8700000e+00   1.1277756e+01   2.1069595e+03   363.3799
 345  150     .       3       0.0000000e+00   7.5588436e+00   2.1069595e+03   363.3799
 346  105     .       4       1.0164000e+00   1.2054311e+02   2.1167817e+03   237.5316
 347  107     .       4       1.3440000e+00   5.7110748e+02   2.1167817e+03   237.5316
 348  108     .       4       3.1400000e+00   5.2606041e+01   2.1167817e+03   237.5316
 349  111     .       4       3.6500000e+00   1.3367949e+01   2.1167817e+03   237.5316
 350  112     .       4       9.4600000e-01   3.4435474e+01   2.1167817e+03   237.5316
 351  113     .       4       3.6500000e+00   5.8750931e+01   2.1167817e+03   237.5316
 352  115     .       4       3.7800000e+00   9.9078388e+00   2.1167817e+03   237.5316
 353  116     .       4       3.3900000e+00   6.9217484e+01   2.1167817e+03   237.5316
 354  117     .       4       1.7982000e+00   2.2824402e+00   2.1167817e+03   237.5316
 355  119     .       4       1.2210000e+00   1.6521668e+00   2.1167817e+03   237.5316
 356  121     .       4       1.4835000e+00   1.2555124e+00   2.1167817e+03   237.5316
 357  123     .       4       3.7500000e+00   5.5681715e+00   2.1167817e+03   237.5316
 358  125     .       4       6.0000000e-01   1.3361833e+02   2.1167817e+03   237.5316
 359  127     .       4       8.8400000e+00   3.7027307e+00   2.1167817e+03   237.5316
 360  132     .       4       4.3310000e-01   9.0386070e+01   2.1167817e+03   237.5316
 361  136     .       4       1.6380000e-01   2.7597885e+01   2.1167817e+03   237.5316
 362  139     .       4       2.6100000e-01   8.0091110e+01   2.1167817e+03   237.5316
 363  141     .       4       3.1300000e+00   2.7021412e+01   2.1167817e+03   237.5316
 364  143     .       4       5.6700000e+00   3.4039514e+00   2.1167817e+03   237.5316
 365  145     .       4       8.1000000e-01   1.0604346e+01   2.1167817e+03   237.5316
 366  146     .       4       5.7300000e+00   7.9531541e+00   2.1167817e+03   237.5316
 367  147     .       4       3.8700000e+00   3.6675017e+00   2.1167817e+03   237.5316
 368  150     .       4       0.0000000e+00   9.6000032e+00   2.1167817e+03   237.5316
 369  154     .       4       8.1000000e-01   1.1348320e+01   2.1167817e+03   237.5316
 370  100     .       5       6.8900000e-01   6.8771906e+02   2.1469001e+03   347.3439
 371  105     .       5       1.0164000e+00   2.9374414e+02   2.1469001e+03   347.3439
 372  107     .       5       1.3440000e+00   3.2156900e+02   2.1469001e+03   347.3439
 373  108     .       5       3.1400000e+00   4.7287464e+01   2.1469001e+03   347.3439
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 8
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 374  109     .       5       6.4680000e-01   8.4473373e+01   2.1469001e+03   347.3439
 375  112     .       5       9.4600000e-01   2.3249117e+01   2.1469001e+03   347.3439
 376  113     .       5       3.6500000e+00   4.9991444e+01   2.1469001e+03   347.3439
 377  115     .       5       3.7800000e+00   1.5988372e+01   2.1469001e+03   347.3439
 378  117     .       5       1.7982000e+00   5.4743280e+00   2.1469001e+03   347.3439
 379  119     .       5       1.2210000e+00   1.1630750e+00   2.1469001e+03   347.3439
 380  122     .       5       6.1610000e-01   4.2478466e+00   2.1469001e+03   347.3439
 381  123     .       5       3.7500000e+00   2.2886448e+00   2.1469001e+03   347.3439
 382  125     .       5       6.0000000e-01   1.3208374e+02   2.1469001e+03   347.3439
 383  134     .       5       4.9400000e-01   1.2436533e+01   2.1469001e+03   347.3439
 384  136     .       5       1.6380000e-01   3.4878334e+01   2.1469001e+03   347.3439
 385  138     .       5       2.0160000e-01   2.0159933e+01   2.1469001e+03   347.3439
 386  140     .       5       1.0300000e+00   1.5735750e+01   2.1469001e+03   347.3439
 387  141     .       5       3.1300000e+00   5.4069389e+01   2.1469001e+03   347.3439
 388  143     .       5       5.6700000e+00   1.5589530e+00   2.1469001e+03   347.3439
 389  144     .       5       5.8800000e+00   4.3722672e+00   2.1469001e+03   347.3439
 390  147     .       5       3.8700000e+00   4.4493876e+00   2.1469001e+03   347.3439
 391  150     .       5       0.0000000e+00   7.5010395e+00   2.1469001e+03   347.3439
 392  154     .       5       8.1000000e-01   1.4939366e+01   2.1469001e+03   347.3439
 393  ;
 394   
 395    shr(cod,reg)$quan(cod,reg,'povline_a_flex5')
 396                        =price(cod,reg,'price_uw5')*quan(cod,reg,'quan5')/
 397                         quan(cod,reg,'povline_a_flex5');
 398   
 399    chkshr(reg)=sum(cod,shr(cod,reg));
 400   
 401  loop(reg,
 402    abort$(abs(chkshr(reg)-.9) gt .0001) "share does not sum to .9", chkshr ;
 403  );
 404   
 405   
 406  *turn on dynamic sets to indicate positive quantities and existence of
 407  *price info for each region
 408   
 409   posprice(cod,reg)$(price(cod,reg,'price_uw5')
 410                        AND price(cod,reg,'count') gt 4) = yes;
 411   
 412   posquan(cod,reg)$quan(cod,reg,'quan5')=yes;
 413   
 414   shrmiss(regq,reg)=sum(cod$(NOT posprice(cod,reg)), shr(cod,regq));
 415   display shrmiss;
 416   
 417    povline_ali(reg)=sum(cod$posquan(cod,reg),price(cod,reg,'price_uw5')*
 418                                             quan(cod,reg,'quan5'))/.9;
 419   
 420    display povline_ali;
 421   
 422   
 423  *boost values so shares sum to one;
 424  shr(cod,reg)=shr(cod,reg)/chkshr(reg);
 425   
 426  *fill out price matrix with maximum observed price outside of Maputo
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/10/14 14:51:58 Page 9
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 427   
 428  loop((cod,reg)$(NOT posprice(cod,reg) AND posquan(cod,reg)),
 429           loop(r,
 430                   price(cod,reg,'price_uw5')=max(price(cod,reg,'price_uw5'),
 431                                                price(cod,r,'price_uw5'));
 432           );
 433  );
 434   
 435  chkprice(cod,reg)$(NOT price(cod,reg,'price_uw5') AND posquan(cod,reg))=yes;
 436   
 437  display 'should be an empty set', chkprice;
 438   
 439   
 440   
 441   
 442  Variables
 443     z                objective value
 444     q(cod,reg)       revised maximum entropy quanties in grams
 445     s(cod,reg)       derived maximum entropy shares
 446     povline(regq,reg)  estimated revealed preference matrix
 447  ;
 448   
 449   
 450  Equations
 451     obj              objective equation
 452     rev(regq,reg)    revealed preference tests
 453     deflin(regq,reg) define revealed preference matrix
 454     defshr(cod,regq) define the endogenous budget shares
 455     cals(regq)       ensure that each bundle hits the calorie
 456   
 457  ;
 458   
 459     obj ..  z=e= sum((cod,rq)$posquan(cod,rq),
 460                     s(cod,rq)*log(s(cod,rq)/shr(cod,rq)));
 461   
 462     deflin(rq,r) .. povline(rq,r) =e= sum(cod$posquan(cod,rq),
 463                            q(cod,rq)*price(cod,r,'price_uw5'));
 464   
 465     rev(rq,r) ..    povline(r,rq)=g=povline(rq,rq);
 466   
 467     defshr(cod,rq)$posquan(cod,rq) ..
 468               povline(rq,rq)*s(cod,rq)=e= q(cod,rq)*price(cod,rq,'price_uw5');
 469   
 470     cals(rq) .. sum(cod$posquan(cod,rq),
 471                      q(cod,rq)*quan(cod,rq,'calperg'))=e=.95*caltarg;
 472   
 473  *set bounds and starting values for variables
 474   
 475    q.lo(cod,reg)=.00001;
 476    q.up(cod,reg)=inf;
 477    q.l(cod,reg)=quan(cod,reg,'quan5');
 478    q.fx(cod,reg)$(NOT posquan(cod,reg))=0;
 479   
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 10
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 480    povline.l(regq,reg)= sum(cod$posquan(cod,regq),
 481                            q.l(cod,regq)*price(cod,reg,'price_uw5'));
 482   
 483   
 484    display povline.l;
 485   
 486  *print the revealed preference matrix prior to optimisation;
 487  file povline_rp/"/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/povline_rp_inout.csv"/;
 488  put povline_rp;
 489  povline_rp.pc=5;
 490  povline_rp.nd=0;
 491  put " ";
 492  loop(reg,
 493        put reg.tl;
 494  );
 495  put /;
 496  loop(regq,
 497       put regq.tl;
 498       loop(reg,
 499           put povline.l(regq,reg);
 500       );
 501       put /;
 502  );
 503  put /; put /; put /;
 504   
 505     s.l(cod,regq)= q.l(cod,regq)*price(cod,regq,'price_uw5')/povline.l(regq,regq);
 506     s.lo(cod,regq)=.0001;
 507     s.fx(cod,regq)$(NOT posquan(cod,regq))=0;
 508   
 509   
 510     model revpref /obj, deflin, rev, defshr, cals/;
 511   
 512     revpref.holdfixed=1;
 513   
 514     option limrow=100;
 515   
 516     option nlp=conopt;
 517   
 518     solve revpref using nlp minimizing z;
 519   
 520     povline.l(regq,reg)$(NOT rq(regq) OR NOT r(reg))=0;
 521     display "this is without adjustment for calorie target or 90%", povline.l;
 522   
 523  put /;
 524  loop(rq,
 525       put rq.tl;
 526       loop(r,
 527           put povline.l(rq,r);
 528       );
 529       put /;
 530  );
 531  put /;
 532   
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 11
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 533   
 534  PARAMETERS
 535     qent(cod,reg)  entropy quantities with all adjustments accounted for
 536     povline_ent(reg) entropy line that hits calorie targets (100% food expen)
 537    ;
 538  *readjust quantities to hit regional calorie target and calculate line;
 539     qent(cod,r)=q.l(cod,r)*quan(cod,r,'calpp')/caltarg;
 540   
 541     povline_ent(r)=sum(cod$posquan(cod,r),price(cod,r,'price_uw5')*
 542                                             qent(cod,r))/.9;
 543   
 544     perc_chng(r)=100*(povline_ent(r)/povline_ali(r)-1);
 545   
 546     display perc_chng, povline_ent, povline_ali;
 547   
 548     file res/"/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/qent.csv"/;
 549   
 550     put res;
 551     res.pc=5;
 552     res.nd=6;
 553   
 554  *recall that the basket reflects 90% of expenditure and 95% of calories";
 555     put "spdomain" ;
 556     put "product" ;
 557     put "quan5";
 558     put "qent";
 559     put "price";
 560     put "calperg";
 561   
 562     put /;
 563   
 564     loop(reg,
 565         loop(cod,
 566             put reg.tl;
 567             put cod.tl;
 568             put quan(cod,reg,'quan5');
 569             put qent(cod,reg);
 570             put price(cod,reg,'price_uw5')
 571             put quan(cod,reg,'calperg');
 572             put /;
 573         );
 574     );
 575   
 576     file lin/"/home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/povline_food_ent.csv"/;
 577   
 578     put lin;
 579     lin.pc=5;
 580  *Flexible, entropy, and fixed food pov lines at 100% expenditure
 581   
 582     put "spdomain";
 583     put "flex";
 584     put "ent";
 585     put /;
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 12
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 586   
 587     loop(reg,
 588           put reg.tl;
 589           put povline_ali(reg);
 590           put povline_ent(reg);
 591           put /;
 592     );
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 13
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/new/190a_revpref13_r_bjorn.gms
     2       19 INCLUDE        1      19  ./home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/product_flex.inc
     3      100 INCLUDE        1      64  ./home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/price_unit_flex.inc
     4      280 INCLUDE        1      69  ./home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/quan_flex.inc


COMPILATION TIME     =        0.003 SECONDS      3 MB  24.1.2 r40979 LEX-LEG
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 14
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    415 PARAMETER shrmiss  shares missing in each region pair

            1           2           4

1                               0.046
2       0.034                   0.013
3       0.210       0.038       0.012
4       0.357       0.186
5       0.156       0.019       0.054


----    420 PARAMETER povline_ali  food poverty line

1 412.716,    2 306.241,    3 363.380,    4 237.532,    5 347.344


----    437 should be an empty set

----    437 SET chkprice  ensure that prices exist once all estimated

                                                      ( EMPTY )


----    484 VARIABLE povline.L  estimated revealed preference matrix

            1           2           3           4           5

1     371.444     333.719     360.887     314.374     372.109
2     332.610     275.617     298.341     236.674     291.114
3     385.763     287.643     327.042     277.948     334.218
4     338.854     228.245     259.553     213.778     273.355
5     446.571     323.550     368.311     273.729     312.610

GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 15
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


---- obj  =E=  objective equation

obj..  z - (1)*s(100,1) - (1)*s(100,2) - (1)*s(100,3) - (1)*s(100,5) - (1)*s(105,1) - (1)*s(105,2) - (1)*s(105,3) - (1)*s(105,4) - (1)*s(105,5) - (1)*s(106,3) - (1)*s(107,1) - (1)*s(107,2) - (1)*s(107,3) - (1)*s(107,4) - (1)*s(107,5) - (1)*s(108,2)
     
      - (1)*s(108,3) - (1)*s(108,4) - (1)*s(108,5) - (1)*s(109,5) - (1)*s(110,1) - (1)*s(110,3) - (1)*s(111,4) - (1)*s(112,2) - (1)*s(112,3) - (1)*s(112,4) - (1)*s(112,5) - (1)*s(113,1) - (1)*s(113,2) - (1)*s(113,3) - (1)*s(113,4) - (1)*s(113,5)
     
      - (1)*s(114,1) - (1)*s(115,3) - (1)*s(115,4) - (1)*s(115,5) - (1)*s(116,3) - (1)*s(116,4) - (1)*s(117,2) - (1)*s(117,3) - (1)*s(117,4) - (1)*s(117,5) - (1)*s(119,3) - (1)*s(119,4) - (1)*s(119,5) - (1)*s(121,3) - (1)*s(121,4) - (1)*s(122,1)
     
      - (1)*s(122,2) - (1)*s(122,3) - (1)*s(122,5) - (1)*s(123,1) - (1)*s(123,2) - (1)*s(123,3) - (1)*s(123,4) - (1)*s(123,5) - (1)*s(125,1) - (1)*s(125,2) - (1)*s(125,3) - (1)*s(125,4) - (1)*s(125,5) - (1)*s(127,1) - (1)*s(127,2) - (1)*s(127,3)
     
      - (1)*s(127,4) - (1)*s(132,3) - (1)*s(132,4) - (1)*s(134,1) - (1)*s(134,2) - (1)*s(134,3) - (1)*s(134,5) - (1)*s(135,1) - (1)*s(135,2) - (1)*s(136,1) - (1)*s(136,2) - (1)*s(136,3) - (1)*s(136,4) - (1)*s(136,5) - (1)*s(137,1) - (1)*s(138,2)
     
      - (1)*s(138,3) - (1)*s(138,5) - (1)*s(139,3) - (1)*s(139,4) - (1)*s(140,2) - (1)*s(140,5) - (1)*s(141,1) - (1)*s(141,2) - (1)*s(141,3) - (1)*s(141,4) - (1)*s(141,5) - (1)*s(143,3) - (1)*s(143,4) - (1)*s(143,5) - (1)*s(144,1) - (1)*s(144,2)
     
      - (1)*s(144,3) - (1)*s(144,5) - (1)*s(145,4) - (1)*s(146,4) - (1)*s(147,1) - (1)*s(147,2) - (1)*s(147,3) - (1)*s(147,4) - (1)*s(147,5) - (1)*s(150,1) - (1)*s(150,2) - (1)*s(150,3) - (1)*s(150,4) - (1)*s(150,5) - (1)*s(154,4) - (1)*s(154,5) =E= 0 ;
     
      (LHS = 0)
     

---- deflin  =E=  define revealed preference matrix

deflin(1,1)..  - 0.183751*q(100,1) - 0.1477785*q(105,1) - 0.0607322*q(107,1) - 1.06354*q(110,1) - 0.5616655*q(113,1) - 0.9122462*q(114,1) - 0.3806249*q(122,1) - 1.092988*q(123,1) - 0.0872045*q(125,1) - 1.76884*q(127,1) - 0.5278798*q(134,1)
     
      - 0.3161775*q(135,1) - 0.0918267*q(136,1) - 0.3838921*q(137,1) - 0.7991219*q(141,1) - 1.335071*q(144,1) - 1.509419*q(147,1) - 0.4158889*q(150,1) + povline(1,1) =E= 0 ; (LHS = 0)
     
deflin(1,2)..  - 0.0975617*q(100,1) - 0.1201643*q(105,1) - 0.0580823*q(107,1) - 0.9047616*q(110,1) - 0.5305869*q(113,1) - 1.077569*q(114,1) - 0.4286192*q(122,1) - 0.4706388*q(123,1) - 0.1013107*q(125,1) - 1.549402*q(127,1) - 0.702066*q(134,1)
     
      - 0.3494835*q(135,1) - 0.0848172*q(136,1) - 0.2636259*q(137,1) - 0.7585092*q(141,1) - 1.295553*q(144,1) - 1.595948*q(147,1) - 0.4074605*q(150,1) + povline(1,2) =E= 0 ; (LHS = 0)
     
deflin(1,3)..  - 0.1084728*q(100,1) - 0.1445653*q(105,1) - 0.0602927*q(107,1) - 1.009926*q(110,1) - 0.4904967*q(113,1) - 1.192942*q(114,1) - 0.660553*q(122,1) - 0.7605309*q(123,1) - 0.0615126*q(125,1) - 1.669559*q(127,1) - 0.9374316*q(134,1)
     
      - 0.2872065*q(135,1) - 0.1029263*q(136,1) - 0.3286387*q(137,1) - 0.7249936*q(141,1) - 1.230627*q(144,1) - 1.731423*q(147,1) - 0.4360197*q(150,1) + povline(1,3) =E= 0 ; (LHS = 0)
     
deflin(1,4)..  - 0.0998728*q(100,1) - 0.0836414*q(105,1) - 0.0271556*q(107,1) - 1.07391*q(110,1) - 0.3404138*q(113,1) - 1.415191*q(114,1) - 0.2936031*q(122,1) - 1.335038*q(123,1) - 0.0290214*q(125,1) - 2.084548*q(127,1) - 0.2980221*q(134,1)
     
      - 0.1988528*q(135,1) - 0.0979106*q(136,1) - 0.3796229*q(137,1) - 1.146282*q(141,1) - 1.75*q(144,1) - 1.600621*q(147,1) - 0.3632688*q(150,1) + povline(1,4) =E= 0 ; (LHS = 0)
     
deflin(1,5)..  - 0.0944435*q(100,1) - 0.1200921*q(105,1) - 0.0733958*q(107,1) - 0.9574083*q(110,1) - 0.4923098*q(113,1) - 1.010148*q(114,1) - 0.7250918*q(122,1) - 1.831238*q(123,1) - 0.0461501*q(125,1) - 2.02092*q(127,1) - 0.2250476*q(134,1)
     
      - 0.2490709*q(135,1) - 0.1404231*q(136,1) - 0.2811364*q(137,1) - 0.8158221*q(141,1) - 1.307449*q(144,1) - 1.690496*q(147,1) - 0.5406814*q(150,1) + povline(1,5) =E= 0 ; (LHS = 0)
     
deflin(2,1)..  - 0.183751*q(100,2) - 0.1477785*q(105,2) - 0.0607322*q(107,2) - 0.5078834*q(108,2) - 0.3117668*q(112,2) - 0.5616655*q(113,2) - 2.4113*q(117,2) - 0.3806249*q(122,2) - 1.092988*q(123,2) - 0.0872045*q(125,2) - 1.76884*q(127,2)
     
      - 0.5278798*q(134,2) - 0.3161775*q(135,2) - 0.0918267*q(136,2) - 0.34019*q(138,2) - 0.5501741*q(140,2) - 0.7991219*q(141,2) - 1.335071*q(144,2) - 1.509419*q(147,2) - 0.4158889*q(150,2) + povline(2,1) =E= 0 ; (LHS = 0)
     
deflin(2,2)..  - 0.0975617*q(100,2) - 0.1201643*q(105,2) - 0.0580823*q(107,2) - 0.2780761*q(108,2) - 0.2126896*q(112,2) - 0.5305869*q(113,2) - 2.138755*q(117,2) - 0.4286192*q(122,2) - 0.4706388*q(123,2) - 0.1013107*q(125,2) - 1.549402*q(127,2)
     
      - 0.702066*q(134,2) - 0.3494835*q(135,2) - 0.0848172*q(136,2) - 0.1938604*q(138,2) - 1.084393*q(140,2) - 0.7585092*q(141,2) - 1.295553*q(144,2) - 1.595948*q(147,2) - 0.4074605*q(150,2) + povline(2,2) =E= 0 ; (LHS = 0)
     
deflin(2,3)..  - 0.1084728*q(100,2) - 0.1445653*q(105,2) - 0.0602927*q(107,2) - 0.412909*q(108,2) - 0.1754048*q(112,2) - 0.4904967*q(113,2) - 2.663086*q(117,2) - 0.660553*q(122,2) - 0.7605309*q(123,2) - 0.0615126*q(125,2) - 1.669559*q(127,2)
     
      - 0.9374316*q(134,2) - 0.2872065*q(135,2) - 0.1029263*q(136,2) - 0.2570899*q(138,2) - 0.8560518*q(140,2) - 0.7249936*q(141,2) - 1.230627*q(144,2) - 1.731423*q(147,2) - 0.4360197*q(150,2) + povline(2,3) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 16
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


     deflin  =E=  define revealed preference matrix

deflin(2,4)..  - 0.0998728*q(100,2) - 0.0836414*q(105,2) - 0.0271556*q(107,2) - 0.4707699*q(108,2) - 0.1134935*q(112,2) - 0.3404138*q(113,2) - 2.400627*q(117,2) - 0.2936031*q(122,2) - 1.335038*q(123,2) - 0.0290214*q(125,2) - 2.084548*q(127,2)
     
      - 0.2980221*q(134,2) - 0.1988528*q(135,2) - 0.0979106*q(136,2) - 0.2018096*q(138,2) - 0.3272821*q(140,2) - 1.146282*q(141,2) - 1.75*q(144,2) - 1.600621*q(147,2) - 0.3632688*q(150,2) + povline(2,4) =E= 0 ; (LHS = 0)
     
deflin(2,5)..  - 0.0944435*q(100,2) - 0.1200921*q(105,2) - 0.0733958*q(107,2) - 0.4007722*q(108,2) - 0.1755183*q(112,2) - 0.4923098*q(113,2) - 2.176478*q(117,2) - 0.7250918*q(122,2) - 1.831238*q(123,2) - 0.0461501*q(125,2) - 2.02092*q(127,2)
     
      - 0.2250476*q(134,2) - 0.2490709*q(135,2) - 0.1404231*q(136,2) - 0.2335793*q(138,2) - 0.6818734*q(140,2) - 0.8158221*q(141,2) - 1.307449*q(144,2) - 1.690496*q(147,2) - 0.5406814*q(150,2) + povline(2,5) =E= 0 ; (LHS = 0)
     
deflin(3,1)..  - 0.183751*q(100,3) - 0.1477785*q(105,3) - 0.3885128*q(106,3) - 0.0607322*q(107,3) - 0.5078834*q(108,3) - 1.06354*q(110,3) - 0.3117668*q(112,3) - 0.5616655*q(113,3) - 0.5615975*q(115,3) - 0.7554569*q(116,3) - 2.4113*q(117,3)
     
      - 0.3806249*q(122,3) - 1.092988*q(123,3) - 0.0872045*q(125,3) - 1.76884*q(127,3) - 0.2330394*q(132,3) - 0.5278798*q(134,3) - 0.0918267*q(136,3) - 0.34019*q(138,3) - 0.2899968*q(139,3) - 0.7991219*q(141,3) - 1.699778*q(143,3) - 1.335071*q(144,3)
     
      - 1.509419*q(147,3) - 0.4158889*q(150,3) + povline(3,1) =E= 0 ; (LHS = 0)
     
deflin(3,2)..  - 0.0975617*q(100,3) - 0.1201643*q(105,3) - 0.0580823*q(107,3) - 0.2780761*q(108,3) - 0.9047616*q(110,3) - 0.2126896*q(112,3) - 0.5305869*q(113,3) - 0.4499322*q(115,3) - 0.0481721*q(116,3) - 2.138755*q(117,3) - 1.898333*q(119,3)
     
      - 2.71793*q(121,3) - 0.4286192*q(122,3) - 0.4706388*q(123,3) - 0.1013107*q(125,3) - 1.549402*q(127,3) - 0.0808339*q(132,3) - 0.702066*q(134,3) - 0.0848172*q(136,3) - 0.1938604*q(138,3) - 0.2091859*q(139,3) - 0.7585092*q(141,3) - 1.23645*q(143,3)
     
      - 1.295553*q(144,3) - 1.595948*q(147,3) - 0.4074605*q(150,3) + povline(3,2) =E= 0 ; (LHS = 0)
     
deflin(3,3)..  - 0.1084728*q(100,3) - 0.1445653*q(105,3) - 0.1252041*q(106,3) - 0.0602927*q(107,3) - 0.412909*q(108,3) - 1.009926*q(110,3) - 0.1754048*q(112,3) - 0.4904967*q(113,3) - 0.4875383*q(115,3) - 0.2709334*q(116,3) - 2.663086*q(117,3)
     
      - 2.712573*q(119,3) - 2.766484*q(121,3) - 0.660553*q(122,3) - 0.7605309*q(123,3) - 0.0615126*q(125,3) - 1.669559*q(127,3) - 0.0853041*q(132,3) - 0.9374316*q(134,3) - 0.1029263*q(136,3) - 0.2570899*q(138,3) - 0.254248*q(139,3) - 0.7249936*q(141,3)
     
      - 1.36957*q(143,3) - 1.230627*q(144,3) - 1.731423*q(147,3) - 0.4360197*q(150,3) + povline(3,3) =E= 0 ; (LHS = 0)
     
deflin(3,4)..  - 0.0998728*q(100,3) - 0.0836414*q(105,3) - 0.0854652*q(106,3) - 0.0271556*q(107,3) - 0.4707699*q(108,3) - 1.07391*q(110,3) - 0.1134935*q(112,3) - 0.3404138*q(113,3) - 0.3302123*q(115,3) - 0.3023219*q(116,3) - 2.400627*q(117,3)
     
      - 1.952311*q(119,3) - 2.176819*q(121,3) - 0.2936031*q(122,3) - 1.335038*q(123,3) - 0.0290214*q(125,3) - 2.084548*q(127,3) - 0.0395371*q(132,3) - 0.2980221*q(134,3) - 0.0979106*q(136,3) - 0.2018096*q(138,3) - 0.198578*q(139,3) - 1.146282*q(141,3)
     
      - 0.7047974*q(143,3) - 1.75*q(144,3) - 1.600621*q(147,3) - 0.3632688*q(150,3) + povline(3,4) =E= 0 ; (LHS = 0)
     
deflin(3,5)..  - 0.0944435*q(100,3) - 0.1200921*q(105,3) - 0.0817442*q(106,3) - 0.0733958*q(107,3) - 0.4007722*q(108,3) - 0.9574083*q(110,3) - 0.1755183*q(112,3) - 0.4923098*q(113,3) - 0.5513065*q(115,3) - 0.3381379*q(116,3) - 2.176478*q(117,3)
     
      - 2.375589*q(119,3) - 2.591507*q(121,3) - 0.7250918*q(122,3) - 1.831238*q(123,3) - 0.0461501*q(125,3) - 2.02092*q(127,3) - 0.0717314*q(132,3) - 0.2250476*q(134,3) - 0.1404231*q(136,3) - 0.2335793*q(138,3) - 0.2841167*q(139,3) - 0.8158221*q(141,3)
     
      - 1.835728*q(143,3) - 1.307449*q(144,3) - 1.690496*q(147,3) - 0.5406814*q(150,3) + povline(3,5) =E= 0 ; (LHS = 0)
     
deflin(4,1)..  - 0.1477785*q(105,4) - 0.0607322*q(107,4) - 0.5078834*q(108,4) - 0.3117668*q(112,4) - 0.5616655*q(113,4) - 0.5615975*q(115,4) - 0.7554569*q(116,4) - 2.4113*q(117,4) - 1.092988*q(123,4) - 0.0872045*q(125,4) - 1.76884*q(127,4)
     
      - 0.2330394*q(132,4) - 0.0918267*q(136,4) - 0.2899968*q(139,4) - 0.7991219*q(141,4) - 1.699778*q(143,4) - 0.8670973*q(145,4) - 1.692853*q(146,4) - 1.509419*q(147,4) - 0.4158889*q(150,4) - 1.926883*q(154,4) + povline(4,1) =E= 0 ; (LHS = 0)
     
deflin(4,2)..  - 0.1201643*q(105,4) - 0.0580823*q(107,4) - 0.2780761*q(108,4) - 0.1746173*q(111,4) - 0.2126896*q(112,4) - 0.5305869*q(113,4) - 0.4499322*q(115,4) - 0.0481721*q(116,4) - 2.138755*q(117,4) - 1.898333*q(119,4) - 2.71793*q(121,4)
     
      - 0.4706388*q(123,4) - 0.1013107*q(125,4) - 1.549402*q(127,4) - 0.0808339*q(132,4) - 0.0848172*q(136,4) - 0.2091859*q(139,4) - 0.7585092*q(141,4) - 1.23645*q(143,4) - 0.8577663*q(145,4) - 1.002149*q(146,4) - 1.595948*q(147,4) - 0.4074605*q(150,4)
     
      - 0.535405*q(154,4) + povline(4,2) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 17
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


     deflin  =E=  define revealed preference matrix

deflin(4,3)..  - 0.1445653*q(105,4) - 0.0602927*q(107,4) - 0.412909*q(108,4) - 0.2588804*q(111,4) - 0.1754048*q(112,4) - 0.4904967*q(113,4) - 0.4875383*q(115,4) - 0.2709334*q(116,4) - 2.663086*q(117,4) - 2.712573*q(119,4) - 2.766484*q(121,4)
     
      - 0.7605309*q(123,4) - 0.0615126*q(125,4) - 1.669559*q(127,4) - 0.0853041*q(132,4) - 0.1029263*q(136,4) - 0.254248*q(139,4) - 0.7249936*q(141,4) - 1.36957*q(143,4) - 0.758294*q(145,4) - 1.3489*q(146,4) - 1.731423*q(147,4) - 0.4360197*q(150,4)
     
      - 0.6106396*q(154,4) + povline(4,3) =E= 0 ; (LHS = 0)
     
deflin(4,4)..  - 0.0836414*q(105,4) - 0.0271556*q(107,4) - 0.4707699*q(108,4) - 0.30182*q(111,4) - 0.1134935*q(112,4) - 0.3404138*q(113,4) - 0.3302123*q(115,4) - 0.3023219*q(116,4) - 2.400627*q(117,4) - 1.952311*q(119,4) - 2.176819*q(121,4)
     
      - 1.335038*q(123,4) - 0.0290214*q(125,4) - 2.084548*q(127,4) - 0.0395371*q(132,4) - 0.0979106*q(136,4) - 0.198578*q(139,4) - 1.146282*q(141,4) - 0.7047974*q(143,4) - 0.5177717*q(145,4) - 0.9193286*q(146,4) - 1.600621*q(147,4) - 0.3632688*q(150,4)
     
      - 0.273227*q(154,4) + povline(4,4) =E= 0 ; (LHS = 0)
     
deflin(4,5)..  - 0.1200921*q(105,4) - 0.0733958*q(107,4) - 0.4007722*q(108,4) - 0.2588116*q(111,4) - 0.1755183*q(112,4) - 0.4923098*q(113,4) - 0.5513065*q(115,4) - 0.3381379*q(116,4) - 2.176478*q(117,4) - 2.375589*q(119,4) - 2.591507*q(121,4)
     
      - 1.831238*q(123,4) - 0.0461501*q(125,4) - 2.02092*q(127,4) - 0.0717314*q(132,4) - 0.1404231*q(136,4) - 0.2841167*q(139,4) - 0.8158221*q(141,4) - 1.835728*q(143,4) - 0.7271287*q(145,4) - 1.148567*q(146,4) - 1.690496*q(147,4) - 0.5406814*q(150,4)
     
      - 0.2598047*q(154,4) + povline(4,5) =E= 0 ; (LHS = 0)
     
deflin(5,1)..  - 0.183751*q(100,5) - 0.1477785*q(105,5) - 0.0607322*q(107,5) - 0.5078834*q(108,5) - 0.5268325*q(109,5) - 0.3117668*q(112,5) - 0.5616655*q(113,5) - 0.5615975*q(115,5) - 2.4113*q(117,5) - 0.3806249*q(122,5) - 1.092988*q(123,5)
     
      - 0.0872045*q(125,5) - 0.5278798*q(134,5) - 0.0918267*q(136,5) - 0.34019*q(138,5) - 0.5501741*q(140,5) - 0.7991219*q(141,5) - 1.699778*q(143,5) - 1.335071*q(144,5) - 1.509419*q(147,5) - 0.4158889*q(150,5) - 1.926883*q(154,5) + povline(5,1) =E= 0 ;
     
      (LHS = 0)
     
deflin(5,2)..  - 0.0975617*q(100,5) - 0.1201643*q(105,5) - 0.0580823*q(107,5) - 0.2780761*q(108,5) - 0.2491928*q(109,5) - 0.2126896*q(112,5) - 0.5305869*q(113,5) - 0.4499322*q(115,5) - 2.138755*q(117,5) - 1.898333*q(119,5) - 0.4286192*q(122,5)
     
      - 0.4706388*q(123,5) - 0.1013107*q(125,5) - 0.702066*q(134,5) - 0.0848172*q(136,5) - 0.1938604*q(138,5) - 1.084393*q(140,5) - 0.7585092*q(141,5) - 1.23645*q(143,5) - 1.295553*q(144,5) - 1.595948*q(147,5) - 0.4074605*q(150,5) - 0.535405*q(154,5)
     
      + povline(5,2) =E= 0 ; (LHS = 0)
     
deflin(5,3)..  - 0.1084728*q(100,5) - 0.1445653*q(105,5) - 0.0602927*q(107,5) - 0.412909*q(108,5) - 0.5305876*q(109,5) - 0.1754048*q(112,5) - 0.4904967*q(113,5) - 0.4875383*q(115,5) - 2.663086*q(117,5) - 2.712573*q(119,5) - 0.660553*q(122,5)
     
      - 0.7605309*q(123,5) - 0.0615126*q(125,5) - 0.9374316*q(134,5) - 0.1029263*q(136,5) - 0.2570899*q(138,5) - 0.8560518*q(140,5) - 0.7249936*q(141,5) - 1.36957*q(143,5) - 1.230627*q(144,5) - 1.731423*q(147,5) - 0.4360197*q(150,5) - 0.6106396*q(154,5)
     
      + povline(5,3) =E= 0 ; (LHS = 0)
     
deflin(5,4)..  - 0.0998728*q(100,5) - 0.0836414*q(105,5) - 0.0271556*q(107,5) - 0.4707699*q(108,5) - 0.1134935*q(112,5) - 0.3404138*q(113,5) - 0.3302123*q(115,5) - 2.400627*q(117,5) - 1.952311*q(119,5) - 0.2936031*q(122,5) - 1.335038*q(123,5)
     
      - 0.0290214*q(125,5) - 0.2980221*q(134,5) - 0.0979106*q(136,5) - 0.2018096*q(138,5) - 0.3272821*q(140,5) - 1.146282*q(141,5) - 0.7047974*q(143,5) - 1.75*q(144,5) - 1.600621*q(147,5) - 0.3632688*q(150,5) - 0.273227*q(154,5) + povline(5,4) =E= 0 ;
     
      (LHS = 0)
     
deflin(5,5)..  - 0.0944435*q(100,5) - 0.1200921*q(105,5) - 0.0733958*q(107,5) - 0.4007722*q(108,5) - 0.1538359*q(109,5) - 0.1755183*q(112,5) - 0.4923098*q(113,5) - 0.5513065*q(115,5) - 2.176478*q(117,5) - 2.375589*q(119,5) - 0.7250918*q(122,5)
     
      - 1.831238*q(123,5) - 0.0461501*q(125,5) - 0.2250476*q(134,5) - 0.1404231*q(136,5) - 0.2335793*q(138,5) - 0.6818734*q(140,5) - 0.8158221*q(141,5) - 1.835728*q(143,5) - 1.307449*q(144,5) - 1.690496*q(147,5) - 0.5406814*q(150,5) - 0.2598047*q(154,5)
     
      + povline(5,5) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 18
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


---- rev  =G=  revealed preference tests

rev(1,2)..  - povline(1,1) + povline(2,1) =G= 0 ; (LHS = -38.8344217942022, INFES = 38.8344217942022 ****)
     
rev(1,3)..  - povline(1,1) + povline(3,1) =G= 0 ; (LHS = 14.318458614068)
     
rev(1,4)..  - povline(1,1) + povline(4,1) =G= 0 ; (LHS = -32.5906372142182, INFES = 32.5906372142182 ****)
     
rev(1,5)..  - povline(1,1) + povline(5,1) =G= 0 ; (LHS = 75.1265928083375)
     
rev(2,1)..  povline(1,2) - povline(2,2) =G= 0 ; (LHS = 58.1025341874683)
     
rev(2,3)..  - povline(2,2) + povline(3,2) =G= 0 ; (LHS = 12.0257290287329)
     
rev(2,4)..  - povline(2,2) + povline(4,2) =G= 0 ; (LHS = -47.3714827480302, INFES = 47.3714827480302 ****)
     
rev(2,5)..  - povline(2,2) + povline(5,2) =G= 0 ; (LHS = 47.9333282799516)
     
rev(3,1)..  povline(1,3) - povline(3,3) =G= 0 ; (LHS = 33.8452128459411)
     
rev(3,2)..  povline(2,3) - povline(3,3) =G= 0 ; (LHS = -28.7012164236029, INFES = 28.7012164236029 ****)
     
rev(3,4)..  - povline(3,3) + povline(4,3) =G= 0 ; (LHS = -67.4885156314547, INFES = 67.4885156314547 ****)
     
rev(3,5)..  - povline(3,3) + povline(5,3) =G= 0 ; (LHS = 41.2692678564684)
     
rev(4,1)..  povline(1,4) - povline(4,4) =G= 0 ; (LHS = 100.595168943635)
     
rev(4,2)..  povline(2,4) - povline(4,4) =G= 0 ; (LHS = 22.8954228129355)
     
rev(4,3)..  povline(3,4) - povline(4,4) =G= 0 ; (LHS = 64.1696985831861)
     
rev(4,5)..  - povline(4,4) + povline(5,4) =G= 0 ; (LHS = 59.950732335255)
     
rev(5,1)..  povline(1,5) - povline(5,5) =G= 0 ; (LHS = 59.4997667334241)
     
rev(5,2)..  povline(2,5) - povline(5,5) =G= 0 ; (LHS = -21.4957219235365, INFES = 21.4957219235365 ****)
     
rev(5,3)..  povline(3,5) - povline(5,5) =G= 0 ; (LHS = 21.6083218291263)
     
rev(5,4)..  povline(4,5) - povline(5,5) =G= 0 ; (LHS = -39.2544737963864, INFES = 39.2544737963864 ****)
     

---- defshr  =E=  define the endogenous budget shares

defshr(100,1)..  - 0.183751*q(100,1) + (371.444172936847)*s(100,1) + (0.0944662707164767)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(100,2)..  - 0.0975617*q(100,2) + (275.616901819749)*s(100,2) + (0.129578253894003)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(100,3)..  - 0.1084728*q(100,3) + (327.041865855373)*s(100,3) + (0.0655639110250256)*povline(3,3) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 19
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


     defshr  =E=  define the endogenous budget shares

defshr(100,5)..  - 0.0944435*q(100,5) + (312.609529823981)*s(100,5) + (0.207769082022808)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(105,1)..  - 0.1477785*q(105,1) + (371.444172936847)*s(105,1) + (0.094671845520252)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(105,2)..  - 0.1201643*q(105,2) + (275.616901819749)*s(105,2) + (0.172559574816823)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(105,3)..  - 0.1445653*q(105,3) + (327.041865855373)*s(105,3) + (0.14617739199615)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(105,4)..  - 0.0836414*q(105,4) + (213.77841999106)*s(105,4) + (0.0471628262627053)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(105,5)..  - 0.1200921*q(105,5) + (312.609529823981)*s(105,5) + (0.112844770455836)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(106,3)..  - 0.1252041*q(106,3) + (327.041865855373)*s(106,3) + (0.0129892322149633)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(107,1)..  - 0.0607322*q(107,1) + (371.444172936847)*s(107,1) + (0.082739882987733)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(107,2)..  - 0.0580823*q(107,2) + (275.616901819749)*s(107,2) + (0.104739367137703)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(107,3)..  - 0.0602927*q(107,3) + (327.041865855373)*s(107,3) + (0.033907717513757)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(107,4)..  - 0.0271556*q(107,4) + (213.77841999106)*s(107,4) + (0.0725459860940903)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(107,5)..  - 0.0733958*q(107,5) + (312.609529823981)*s(107,5) + (0.0754993426575617)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(108,2)..  - 0.2780761*q(108,2) + (275.616901819749)*s(108,2) + (0.0236149444952941)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(108,3)..  - 0.412909*q(108,3) + (327.041865855373)*s(108,3) + (0.0945336959685099)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(108,4)..  - 0.4707699*q(108,4) + (213.77841999106)*s(108,4) + (0.115845840108658)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(108,5)..  - 0.4007722*q(108,5) + (312.609529823981)*s(108,5) + (0.0606235548557067)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(109,5)..  - 0.1538359*q(109,5) + (312.609529823981)*s(109,5) + (0.0415695496193214)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(110,1)..  - 1.06354*q(110,1) + (371.444172936847)*s(110,1) + (0.104568635514882)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(110,3)..  - 1.009926*q(110,3) + (327.041865855373)*s(110,3) + (0.0187308125369251)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(111,4)..  - 0.30182*q(111,4) + (213.77841999106)*s(111,4) + (0.0188733473067522)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(112,2)..  - 0.2126896*q(112,2) + (275.616901819749)*s(112,2) + (0.0143334299403032)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(112,3)..  - 0.1754048*q(112,3) + (327.041865855373)*s(112,3) + (0.0227671734026516)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(112,4)..  - 0.1134935*q(112,4) + (213.77841999106)*s(112,4) + (0.0182815574583367)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(112,5)..  - 0.1755183*q(112,5) + (312.609529823981)*s(112,5) + (0.0130534903866775)*povline(5,5) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 20
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


     defshr  =E=  define the endogenous budget shares

defshr(113,1)..  - 0.5616655*q(113,1) + (371.444172936847)*s(113,1) + (0.149728403973556)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(113,2)..  - 0.5305869*q(113,2) + (275.616901819749)*s(113,2) + (0.148603100374358)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(113,3)..  - 0.4904967*q(113,3) + (327.041865855373)*s(113,3) + (0.127867943159942)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(113,4)..  - 0.3404138*q(113,4) + (213.77841999106)*s(113,4) + (0.0935530708669481)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(113,5)..  - 0.4923098*q(113,5) + (312.609529823981)*s(113,5) + (0.0787284949732944)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(114,1)..  - 0.9122462*q(114,1) + (371.444172936847)*s(114,1) + (0.01748381812078)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(115,3)..  - 0.4875383*q(115,3) + (327.041865855373)*s(115,3) + (0.030149595089409)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(115,4)..  - 0.3302123*q(115,4) + (213.77841999106)*s(115,4) + (0.0153041183404483)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(115,5)..  - 0.5513065*q(115,5) + (312.609529823981)*s(115,5) + (0.0281964961624206)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(116,3)..  - 0.2709334*q(116,3) + (327.041865855373)*s(116,3) + (0.0183466321639885)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(116,4)..  - 0.3023219*q(116,4) + (213.77841999106)*s(116,4) + (0.097886219184213)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(117,2)..  - 2.138755*q(117,2) + (275.616901819749)*s(117,2) + (0.0228469875868196)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(117,3)..  - 2.663086*q(117,3) + (327.041865855373)*s(117,3) + (0.0301159286956588)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(117,4)..  - 2.400627*q(117,4) + (213.77841999106)*s(117,4) + (0.025630686063797)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(117,5)..  - 2.176478*q(117,5) + (312.609529823981)*s(117,5) + (0.0381138555292693)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(119,3)..  - 2.712573*q(119,3) + (327.041865855373)*s(119,3) + (0.0110875888328596)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(119,4)..  - 1.952311*q(119,4) + (213.77841999106)*s(119,4) + (0.0150882554825211)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(119,5)..  - 2.375589*q(119,5) + (312.609529823981)*s(119,5) + (0.00883846432234724)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(121,3)..  - 2.766484*q(121,3) + (327.041865855373)*s(121,3) + (0.0186916969815972)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(121,4)..  - 2.176819*q(121,4) + (213.77841999106)*s(121,4) + (0.0127843738725822)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(122,1)..  - 0.3806249*q(122,1) + (371.444172936847)*s(122,1) + (0.0422100607053294)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(122,2)..  - 0.4286192*q(122,2) + (275.616901819749)*s(122,2) + (0.0281219173205865)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(122,3)..  - 0.660553*q(122,3) + (327.041865855373)*s(122,3) + (0.0278889120761606)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(122,5)..  - 0.7250918*q(122,5) + (312.609529823981)*s(122,5) + (0.00985279859846934)*povline(5,5) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 21
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


     defshr  =E=  define the endogenous budget shares

defshr(123,1)..  - 1.092988*q(123,1) + (371.444172936847)*s(123,1) + (0.041180167236514)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(123,2)..  - 0.4706388*q(123,2) + (275.616901819749)*s(123,2) + (0.0127517274979194)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(123,3)..  - 0.7605309*q(123,3) + (327.041865855373)*s(123,3) + (0.0291201885471216)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(123,4)..  - 1.335038*q(123,4) + (213.77841999106)*s(123,4) + (0.034773016581037)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(123,5)..  - 1.831238*q(123,5) + (312.609529823981)*s(123,5) + (0.0134066716667986)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(125,1)..  - 0.0872045*q(125,1) + (371.444172936847)*s(125,1) + (0.0238263335000135)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(125,2)..  - 0.1013107*q(125,2) + (275.616901819749)*s(125,2) + (0.0435342213083328)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(125,3)..  - 0.0615126*q(125,3) + (327.041865855373)*s(125,3) + (0.027333595328768)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(125,4)..  - 0.0290214*q(125,4) + (213.77841999106)*s(125,4) + (0.0181393005076199)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(125,5)..  - 0.0461501*q(125,5) + (312.609529823981)*s(125,5) + (0.0194993345622133)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(127,1)..  - 1.76884*q(127,1) + (371.444172936847)*s(127,1) + (0.0343430037865336)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(127,2)..  - 1.549402*q(127,2) + (275.616901819749)*s(127,2) + (0.0131436188885845)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(127,3)..  - 1.669559*q(127,3) + (327.041865855373)*s(127,3) + (0.0287872619527111)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(127,4)..  - 2.084548*q(127,4) + (213.77841999106)*s(127,4) + (0.0361052339873519)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(132,3)..  - 0.0853041*q(132,3) + (327.041865855373)*s(132,3) + (0.0109623260312753)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(132,4)..  - 0.0395371*q(132,4) + (213.77841999106)*s(132,4) + (0.0167163883442793)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(134,1)..  - 0.5278798*q(134,1) + (371.444172936847)*s(134,1) + (0.019179773498696)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(134,2)..  - 0.702066*q(134,2) + (275.616901819749)*s(134,2) + (0.0359627302186362)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(134,3)..  - 0.9374316*q(134,3) + (327.041865855373)*s(134,3) + (0.0126251397518542)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(134,5)..  - 0.2250476*q(134,5) + (312.609529823981)*s(134,5) + (0.00895306008600157)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(135,1)..  - 0.3161775*q(135,1) + (371.444172936847)*s(135,1) + (0.0186124071639305)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(135,2)..  - 0.3494835*q(135,2) + (275.616901819749)*s(135,2) + (0.00964674532162684)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(136,1)..  - 0.0918267*q(136,1) + (371.444172936847)*s(136,1) + (0.0335105692888451)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(136,2)..  - 0.0848172*q(136,2) + (275.616901819749)*s(136,2) + (0.0230730014637133)*povline(2,2) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 22
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


     defshr  =E=  define the endogenous budget shares

defshr(136,3)..  - 0.1029263*q(136,3) + (327.041865855373)*s(136,3) + (0.0266857041424081)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(136,4)..  - 0.0979106*q(136,4) + (213.77841999106)*s(136,4) + (0.012639842128097)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(136,5)..  - 0.1404231*q(136,5) + (312.609529823981)*s(136,5) + (0.0156672248151652)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(137,1)..  - 0.3838921*q(137,1) + (371.444172936847)*s(137,1) + (0.0122968247735626)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(138,2)..  - 0.1938604*q(138,2) + (275.616901819749)*s(138,2) + (0.0214876594850571)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(138,3)..  - 0.2570899*q(138,3) + (327.041865855373)*s(138,3) + (0.0276660909598696)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(138,5)..  - 0.2335793*q(138,5) + (312.609529823981)*s(138,5) + (0.0150633380909351)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(139,3)..  - 0.254248*q(139,3) + (327.041865855373)*s(139,3) + (0.0346620087749043)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(139,4)..  - 0.198578*q(139,4) + (213.77841999106)*s(139,4) + (0.0743963419799114)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(140,2)..  - 1.084393*q(140,2) + (275.616901819749)*s(140,2) + (0.0208925984336922)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(140,5)..  - 0.6818734*q(140,5) + (312.609529823981)*s(140,5) + (0.0343232957744172)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(141,1)..  - 0.7991219*q(141,1) + (371.444172936847)*s(141,1) + (0.0613255529759802)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(141,2)..  - 0.7585092*q(141,2) + (275.616901819749)*s(141,2) + (0.0930767987206676)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(141,3)..  - 0.7249936*q(141,3) + (327.041865855373)*s(141,3) + (0.0462515545417138)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(141,4)..  - 1.146282*q(141,4) + (213.77841999106)*s(141,4) + (0.144889078100022)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(141,5)..  - 0.8158221*q(141,5) + (312.609529823981)*s(141,5) + (0.141105751013202)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(143,3)..  - 1.36957*q(143,3) + (327.041865855373)*s(143,3) + (0.0135130748518765)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(143,4)..  - 0.7047974*q(143,4) + (213.77841999106)*s(143,4) + (0.0112223492742939)*povline(4,4) =E= 0 ; (LHS = 0)
     
defshr(143,5)..  - 1.835728*q(143,5) + (312.609529823981)*s(143,5) + (0.00915459510909787)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(144,1)..  - 1.335071*q(144,1) + (371.444172936847)*s(144,1) + (0.0515606506357234)*povline(1,1) =E= 0 ; (LHS = 0)
     
defshr(144,2)..  - 1.295553*q(144,2) + (275.616901819749)*s(144,2) + (0.0143300184221071)*povline(2,2) =E= 0 ; (LHS = 0)
     
defshr(144,3)..  - 1.230627*q(144,3) + (327.041865855373)*s(144,3) + (0.0137905749328329)*povline(3,3) =E= 0 ; (LHS = 0)
     
defshr(144,5)..  - 1.307449*q(144,5) + (312.609529823981)*s(144,5) + (0.0182864430959336)*povline(5,5) =E= 0 ; (LHS = 0)
     
defshr(145,4)..  - 0.5177717*q(145,4) + (213.77841999106)*s(145,4) + (0.0256837442059765)*povline(4,4) =E= 0 ; (LHS = 0)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 23
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE revpref Using NLP From line 518


     defshr  =E=  define the endogenous budget shares

defshr(146,4)..  - 0.9193286*q(146,4) + (213.77841999106)*s(146,4) + (0.0342015907154849)*povline(4,4) =E= 0 ; (LHS = 0)
     
REMAINING 12 ENTRIES SKIPPED


---- cals  =E=  ensure that each bundle hits the calorie

cals(1)..  0.689*q(100,1) + 1.0164*q(105,1) + 1.344*q(107,1) + 3.61*q(110,1) + 3.65*q(113,1) + 2.66*q(114,1) + 0.6161*q(122,1) + 3.75*q(123,1) + 0.6*q(125,1) + 8.84*q(127,1) + 0.494*q(134,1) + 0.364*q(135,1) + 0.1638*q(136,1) + 0.264*q(137,1)
     
      + 3.13*q(141,1) + 5.88*q(144,1) + 3.87*q(147,1) =E= 2042.5 ; (LHS = 2085.7482174448, INFES = 43.2482174447996 ****)
     
cals(2)..  0.689*q(100,2) + 1.0164*q(105,2) + 1.344*q(107,2) + 3.14*q(108,2) + 0.946*q(112,2) + 3.65*q(113,2) + 1.7982*q(117,2) + 0.6161*q(122,2) + 3.75*q(123,2) + 0.6*q(125,2) + 8.84*q(127,2) + 0.494*q(134,2) + 0.364*q(135,2) + 0.1638*q(136,2)
     
      + 0.2016*q(138,2) + 1.03*q(140,2) + 3.13*q(141,2) + 5.88*q(144,2) + 3.87*q(147,2) =E= 2042.5 ; (LHS = 2026.92464173884, INFES = 15.5753582611599 ****)
     
cals(3)..  0.689*q(100,3) + 1.0164*q(105,3) + 3.43*q(106,3) + 1.344*q(107,3) + 3.14*q(108,3) + 3.61*q(110,3) + 0.946*q(112,3) + 3.65*q(113,3) + 3.78*q(115,3) + 3.39*q(116,3) + 1.7982*q(117,3) + 1.221*q(119,3) + 1.4835*q(121,3) + 0.6161*q(122,3)
     
      + 3.75*q(123,3) + 0.6*q(125,3) + 8.84*q(127,3) + 0.4331*q(132,3) + 0.494*q(134,3) + 0.1638*q(136,3) + 0.2016*q(138,3) + 0.261*q(139,3) + 3.13*q(141,3) + 5.67*q(143,3) + 5.88*q(144,3) + 3.87*q(147,3) =E= 2042.5 ;
     
      (LHS = 2001.61142745262, INFES = 40.8885725473801 ****)
     
cals(4)..  1.0164*q(105,4) + 1.344*q(107,4) + 3.14*q(108,4) + 3.65*q(111,4) + 0.946*q(112,4) + 3.65*q(113,4) + 3.78*q(115,4) + 3.39*q(116,4) + 1.7982*q(117,4) + 1.221*q(119,4) + 1.4835*q(121,4) + 3.75*q(123,4) + 0.6*q(125,4) + 8.84*q(127,4)
     
      + 0.4331*q(132,4) + 0.1638*q(136,4) + 0.261*q(139,4) + 3.13*q(141,4) + 5.67*q(143,4) + 0.81*q(145,4) + 5.73*q(146,4) + 3.87*q(147,4) + 0.81*q(154,4) =E= 2042.5 ; (LHS = 2010.94253170084, INFES = 31.5574682991596 ****)
     
cals(5)..  0.689*q(100,5) + 1.0164*q(105,5) + 1.344*q(107,5) + 3.14*q(108,5) + 0.6468*q(109,5) + 0.946*q(112,5) + 3.65*q(113,5) + 3.78*q(115,5) + 1.7982*q(117,5) + 1.221*q(119,5) + 0.6161*q(122,5) + 3.75*q(123,5) + 0.6*q(125,5) + 0.494*q(134,5)
     
      + 0.1638*q(136,5) + 0.2016*q(138,5) + 1.03*q(140,5) + 3.13*q(141,5) + 5.67*q(143,5) + 5.88*q(144,5) + 3.87*q(147,5) + 0.81*q(154,5) =E= 2042.5 ; (LHS = 2039.55520186126, INFES = 2.94479813873977 ****)
     
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 24
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE revpref Using NLP From line 518


---- z  objective value

z
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       obj


---- q  revised maximum entropy quanties in grams

q(100,1)
                (.LO, .L, .UP, .M = 1E-5, 190.95921, +INF, 0)
       -0.1838  deflin(1,1)
       -0.0976  deflin(1,2)
       -0.1085  deflin(1,3)
       -0.0999  deflin(1,4)
       -0.0944  deflin(1,5)
       -0.1838  defshr(100,1)
        0.689   cals(1)

q(100,2)
                (.LO, .L, .UP, .M = 1E-5, 366.06534, +INF, 0)
       -0.1838  deflin(2,1)
       -0.0976  deflin(2,2)
       -0.1085  deflin(2,3)
       -0.0999  deflin(2,4)
       -0.0944  deflin(2,5)
       -0.0976  defshr(100,2)
        0.689   cals(2)

q(100,3)
                (.LO, .L, .UP, .M = 1E-5, 197.673, +INF, 0)
       -0.1838  deflin(3,1)
       -0.0976  deflin(3,2)
       -0.1085  deflin(3,3)
       -0.0999  deflin(3,4)
       -0.0944  deflin(3,5)
       -0.1085  defshr(100,3)
        0.689   cals(3)

REMAINING 109 ENTRIES SKIPPED

---- s  derived maximum entropy shares

s(100,1)
                (.LO, .L, .UP, .M = 0.0001, 0.0944662707164767, +INF, 0)
      (-1)      obj
     (371.4442) defshr(100,1)

s(100,2)
                (.LO, .L, .UP, .M = 0.0001, 0.129578253894003, +INF, 0)
      (-1)      obj
     (275.6169) defshr(100,2)

GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 25
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE revpref Using NLP From line 518


     s  derived maximum entropy shares

s(100,3)
                (.LO, .L, .UP, .M = 0.0001, 0.0655639110250256, +INF, 0)
      (-1)      obj
     (327.0419) defshr(100,3)

REMAINING 109 ENTRIES SKIPPED

---- povline  estimated revealed preference matrix

povline(1,1)
                (.LO, .L, .UP, .M = -INF, 371.444172936847, +INF, 0)
        1       deflin(1,1)
       -1       rev(1,2)
       -1       rev(1,3)
       -1       rev(1,4)
       -1       rev(1,5)
       (0.0945) defshr(100,1)
       (0.0947) defshr(105,1)
       (0.0827) defshr(107,1)
       (0.1046) defshr(110,1)
       (0.1497) defshr(113,1)
       (0.0175) defshr(114,1)
       (0.0422) defshr(122,1)
       (0.0412) defshr(123,1)
       (0.0238) defshr(125,1)
       (0.0343) defshr(127,1)
       (0.0192) defshr(134,1)
       (0.0186) defshr(135,1)
       (0.0335) defshr(136,1)
       (0.0123) defshr(137,1)
       (0.0613) defshr(141,1)
       (0.0516) defshr(144,1)
       (0.1091) defshr(147,1)
       (0.0091) defshr(150,1)

povline(1,2)
                (.LO, .L, .UP, .M = -INF, 333.719436007218, +INF, 0)
        1       deflin(1,2)
        1       rev(2,1)

povline(1,3)
                (.LO, .L, .UP, .M = -INF, 360.887078701314, +INF, 0)
        1       deflin(1,3)
        1       rev(3,1)

REMAINING 22 ENTRIES SKIPPED
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 26
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE revpref Using NLP From line 518


MODEL STATISTICS

BLOCKS OF EQUATIONS           5     SINGLE EQUATIONS          163
BLOCKS OF VARIABLES           4     SINGLE VARIABLES          250
NON ZERO ELEMENTS         1,173     NON LINEAR N-Z            336
DERIVATIVE POOL              10     CONSTANT POOL             128
CODE LENGTH               1,010


GENERATION TIME      =        0.033 SECONDS      4 MB  24.1.2 r40979 LEX-LEG


EXECUTION TIME       =        0.034 SECONDS      4 MB  24.1.2 r40979 LEX-LEG
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 27
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


               S O L V E      S U M M A R Y

     MODEL   revpref             OBJECTIVE  z
     TYPE    NLP                 DIRECTION  MINIMIZE
     SOLVER  CONOPT              FROM LINE  518

**** SOLVER STATUS     1 Normal Completion         
**** MODEL STATUS      2 Locally Optimal           
**** OBJECTIVE VALUE                0.0377

 RESOURCE USAGE, LIMIT          0.061      1000.000
 ITERATION COUNT, LIMIT        40    2000000000
 EVALUATION ERRORS              0             0
CONOPT 3         24.1.2 r40979 Released Jun 16, 2013 LEG x86_64/Linux         
 
 
    C O N O P T 3   version 3.15K
    Copyright (C)   ARKI Consulting and Development A/S
                    Bagsvaerdvej 246 A
                    DK-2880 Bagsvaerd, Denmark
 
 
    The model has 250 variables and 163 constraints
    with 1173 Jacobian elements, 336 of which are nonlinear.
    The Hessian of the Lagrangian has 112 elements on the diagonal,
    112 elements below the diagonal, and 117 nonlinear variables.
 
 ** Optimal solution. Reduced gradient less than tolerance.
 
 
 CONOPT time Total                            0.062 seconds
   of which: Function evaluations             0.006 =  9.7%
             1st Derivative evaluations       0.000 =  0.0%
             2nd Derivative evaluations       0.001 =  1.6%
             Directional 2nd Derivative       0.001 =  1.6%
 

                           LOWER          LEVEL          UPPER         MARGINAL

---- EQU obj                 .              .              .             1.0000      

  obj  objective equation

---- EQU deflin  define revealed preference matrix

           LOWER          LEVEL          UPPER         MARGINAL

1.1          .              .              .            -0.0027      
1.2          .              .              .             EPS         
1.3          .              .              .             EPS         
1.4          .              .              .             EPS         
1.5          .              .              .             EPS         
2.1          .              .              .            -0.0001      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 28
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


     EQU deflin  define revealed preference matrix

           LOWER          LEVEL          UPPER         MARGINAL

2.2          .              .              .            -0.0012      
2.3          .              .              .            -0.0016      
2.4          .              .              .            -0.0005      
2.5          .              .              .       -2.043827E-5      
3.1          .              .              .             EPS         
3.2          .              .              .            -0.0015      
3.3          .              .              .            -0.0015      
3.4          .              .              .             EPS         
3.5          .              .              .             EPS         
4.1          .              .              .             EPS         
4.2          .              .              .            -0.0009      
4.3          .              .              .            -0.0001      
4.4          .              .              .            -0.0035      
4.5          .              .              .             EPS         
5.1          .              .              .             EPS         
5.2          .              .              .             EPS         
5.3          .              .              .             EPS         
5.4          .              .              .             EPS         
5.5          .              .              .            -0.0032      

---- EQU rev  revealed preference tests

           LOWER          LEVEL          UPPER         MARGINAL

1.2          .              .            +INF            0.0001      
1.3          .            21.0206        +INF            EPS         
1.4          .            62.2238        +INF             .          
1.5          .            94.9615        +INF             .          
2.1          .            31.8026        +INF             .          
2.3          .              .            +INF            0.0015      
2.4          .              .            +INF            0.0009      
2.5          .            39.4739        +INF             .          
3.1          .            26.7498        +INF             .          
3.2          .              .            +INF            0.0016      
3.4          .              .            +INF            0.0001      
3.5          .            53.8759        +INF             .          
4.1          .            37.8931        +INF             .          
4.2          .              .            +INF            0.0005      
4.3          .             5.1198        +INF            EPS         
4.5          .            16.1953        +INF            EPS         
5.1          .            39.6196        +INF             .          
5.2          .              .            +INF      2.0438270E-5      
5.3          .             6.7689        +INF            EPS         
5.4          .             9.9681        +INF            EPS         
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 29
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


---- EQU defshr  define the endogenous budget shares

             LOWER          LEVEL          UPPER         MARGINAL

100.1          .              .              .             0.0028      
100.2          .              .              .             0.0037      
100.3          .              .              .             0.0032      
100.5          .              .              .             0.0032      
105.1          .              .              .             0.0029      
105.2          .              .              .             0.0036      
105.3          .              .              .             0.0031      
105.4          .              .              .             0.0040      
105.5          .              .              .             0.0032      
106.3          .              .              .             0.0031      
107.1          .              .              .             0.0032      
107.2          .              .              .             0.0032      
107.3          .              .              .             0.0042      
107.4          .              .              .             0.0018      
107.5          .              .              .             0.0032      
108.2          .              .              .             0.0046      
108.3          .              .              .             0.0029      
108.4          .              .              .             0.0036      
108.5          .              .              .             0.0032      
109.5          .              .              .             0.0032      
110.1          .              .              .             0.0028      
110.3          .              .              .             0.0030      
111.4          .              .              .             0.0031      
112.2          .              .              .             0.0030      
112.3          .              .              .             0.0036      
112.4          .              .              .             0.0047      
112.5          .              .              .             0.0032      
113.1          .              .              .             0.0029      
113.2          .              .              .             0.0031      
113.3          .              .              .             0.0035      
113.4          .              .              .             0.0042      
113.5          .              .              .             0.0032      
114.1          .              .              .             0.0028      
115.3          .              .              .             0.0033      
115.4          .              .              .             0.0040      
115.5          .              .              .             0.0032      
116.3          .              .              .             0.0025      
116.4          .              .              .             0.0028      
117.2          .              .              .             0.0039      
117.3          .              .              .             0.0027      
117.4          .              .              .             0.0043      
117.5          .              .              .             0.0032      
119.3          .              .              .             0.0026      
119.4          .              .              .             0.0044      
119.5          .              .              .             0.0032      
121.3          .              .              .             0.0030      
121.4          .              .              .             0.0047      
122.1          .              .              .             0.0028      
122.2          .              .              .             0.0041      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 30
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


     EQU defshr  define the endogenous budget shares

             LOWER          LEVEL          UPPER         MARGINAL

122.3          .              .              .             0.0025      
122.5          .              .              .             0.0032      
123.1          .              .              .             0.0028      
123.2          .              .              .             0.0055      
123.3          .              .              .             0.0027      
123.4          .              .              .             0.0036      
123.5          .              .              .             0.0032      
125.1          .              .              .             0.0029      
125.2          .              .              .             0.0024      
125.3          .              .              .             0.0045      
125.4          .              .              .             0.0052      
125.5          .              .              .             0.0032      
127.1          .              .              .             0.0028      
127.2          .              .              .             0.0037      
127.3          .              .              .             0.0032      
127.4          .              .              .             0.0039      
132.3          .              .              .             0.0032      
132.4          .              .              .             0.0047      
134.1          .              .              .             0.0028      
134.2          .              .              .             0.0036      
134.3          .              .              .             0.0026      
134.5          .              .              .             0.0032      
135.1          .              .              .             0.0028      
135.2          .              .              .             0.0029      
136.1          .              .              .             0.0028      
136.2          .              .              .             0.0039      
136.3          .              .              .             0.0028      
136.4          .              .              .             0.0042      
136.5          .              .              .             0.0032      
137.1          .              .              .             0.0027      
138.2          .              .              .             0.0041      
138.3          .              .              .             0.0027      
138.5          .              .              .             0.0032      
139.3          .              .              .             0.0028      
139.4          .              .              .             0.0044      
140.2          .              .              .             0.0027      
140.5          .              .              .             0.0032      
141.1          .              .              .             0.0028      
141.2          .              .              .             0.0036      
141.3          .              .              .             0.0033      
141.4          .              .              .             0.0039      
141.5          .              .              .             0.0032      
143.3          .              .              .             0.0031      
143.4          .              .              .             0.0046      
143.5          .              .              .             0.0032      
144.1          .              .              .             0.0028      
144.2          .              .              .             0.0035      
144.3          .              .              .             0.0033      
144.5          .              .              .             0.0032      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 31
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


     EQU defshr  define the endogenous budget shares

             LOWER          LEVEL          UPPER         MARGINAL

145.4          .              .              .             0.0050      
146.4          .              .              .             0.0041      
147.1          .              .              .             0.0028      
147.2          .              .              .             0.0036      
147.3          .              .              .             0.0030      
147.4          .              .              .             0.0043      
147.5          .              .              .             0.0032      
150.1          .              .              .             0.0027      
150.2          .              .              .             0.0035      
150.3          .              .              .             0.0029      
150.4          .              .              .             0.0046      
150.5          .              .              .             0.0032      
154.4          .              .              .             0.0052      
154.5          .              .              .             0.0032      

---- EQU cals  ensure that each bundle hits the calorie

         LOWER          LEVEL          UPPER         MARGINAL

1      2042.5000      2042.5000      2042.5000   2.0038246E-5      
2      2042.5000      2042.5000      2042.5000   -3.252380E-6      
3      2042.5000      2042.5000      2042.5000   5.7189542E-5      
4      2042.5000      2042.5000      2042.5000   -7.709929E-5      
5      2042.5000      2042.5000      2042.5000   3.1238856E-6      

                           LOWER          LEVEL          UPPER         MARGINAL

---- VAR z                 -INF            0.0377        +INF             .          

  z  objective value

---- VAR q  revised maximum entropy quanties in grams

             LOWER          LEVEL          UPPER         MARGINAL

100.1   1.0000000E-5       177.9361        +INF             .          
100.2   1.0000000E-5       395.8385        +INF             .          
100.3   1.0000000E-5       190.5192        +INF            EPS         
100.5   1.0000000E-5       687.2977        +INF            EPS         
105.1   1.0000000E-5       226.6627        +INF             .          
105.2   1.0000000E-5       415.7424        +INF             .          
105.3   1.0000000E-5       312.7037        +INF            EPS         
105.4   1.0000000E-5       148.6831        +INF             .          
105.5   1.0000000E-5       293.8988        +INF             .          
106.3   1.0000000E-5        31.5953        +INF            EPS         
107.1   1.0000000E-5       536.5943        +INF             .          
107.2   1.0000000E-5       460.8788        +INF             .          
107.3   1.0000000E-5       242.9841        +INF             .          
107.4   1.0000000E-5       400.2382        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 32
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


     VAR q  revised maximum entropy quanties in grams

             LOWER          LEVEL          UPPER         MARGINAL

107.5   1.0000000E-5       324.8432        +INF             .          
108.2   1.0000000E-5        32.8181        +INF            EPS         
108.3   1.0000000E-5        66.5479        +INF             .          
108.4   1.0000000E-5        58.1637        +INF             .          
108.5   1.0000000E-5        47.2834        +INF             .          
109.5   1.0000000E-5        84.1675        +INF             .          
110.1   1.0000000E-5        33.9453        +INF             .          
110.3   1.0000000E-5         5.5528        +INF             .          
111.4   1.0000000E-5        13.2300        +INF             .          
112.2   1.0000000E-5        16.2652        +INF             .          
112.3   1.0000000E-5        46.4191        +INF             .          
112.4   1.0000000E-5        50.3331        +INF             .          
112.5   1.0000000E-5        23.1917        +INF             .          
113.1   1.0000000E-5        94.0673        +INF             .          
113.2   1.0000000E-5        70.7058        +INF            EPS         
113.3   1.0000000E-5        91.0936        +INF             .          
113.4   1.0000000E-5        75.9942        +INF             .          
113.5   1.0000000E-5        49.9666        +INF             .          
114.1   1.0000000E-5         6.5947        +INF             .          
115.3   1.0000000E-5        20.2049        +INF             .          
115.4   1.0000000E-5        12.0941        +INF             .          
115.5   1.0000000E-5        15.9717        +INF             .          
116.3   1.0000000E-5        17.1289        +INF             .          
116.4   1.0000000E-5        63.4346        +INF             .          
117.2   1.0000000E-5         3.3630        +INF             .          
117.3   1.0000000E-5         3.0804        +INF             .          
117.4   1.0000000E-5         3.0596        +INF             .          
117.5   1.0000000E-5         5.4366        +INF             .          
119.3   1.0000000E-5         1.0577        +INF             .          
119.4   1.0000000E-5         2.2806        +INF             .          
119.5   1.0000000E-5         1.1547        +INF             .          
121.3   1.0000000E-5         1.9930        +INF             .          
121.4   1.0000000E-5         1.8371        +INF             .          
122.1   1.0000000E-5        37.8118        +INF             .          
122.2   1.0000000E-5        22.0392        +INF            EPS         
122.3   1.0000000E-5        10.7656        +INF             .          
122.5   1.0000000E-5         4.2186        +INF             .          
123.1   1.0000000E-5        13.0112        +INF             .          
123.2   1.0000000E-5        13.5326        +INF             .          
123.3   1.0000000E-5        10.3460        +INF            EPS         
123.4   1.0000000E-5         6.2377        +INF             .          
123.5   1.0000000E-5         2.2756        +INF             .          
125.1   1.0000000E-5        96.6711        +INF             .          
125.2   1.0000000E-5        88.7126        +INF             .          
125.3   1.0000000E-5       209.6929        +INF             .          
125.4   1.0000000E-5       224.8314        +INF            EPS         
125.5   1.0000000E-5       132.7394        +INF             .          
127.1   1.0000000E-5         6.7792        +INF             .          
127.2   1.0000000E-5         2.5525        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 33
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


     VAR q  revised maximum entropy quanties in grams

             LOWER          LEVEL          UPPER         MARGINAL

127.3   1.0000000E-5         5.4032        +INF             .          
127.4   1.0000000E-5         4.4376        +INF             .          
132.3   1.0000000E-5        40.4743        +INF            EPS         
132.4   1.0000000E-5       132.7979        +INF             .          
134.1   1.0000000E-5        12.3291        +INF             .          
134.2   1.0000000E-5        14.9410        +INF             .          
134.3   1.0000000E-5         3.5690        +INF             .          
134.5   1.0000000E-5        12.3672        +INF             .          
135.1   1.0000000E-5        20.0057        +INF             .          
135.2   1.0000000E-5         6.5808        +INF             .          
136.1   1.0000000E-5       124.5736        +INF             .          
136.2   1.0000000E-5        84.9283        +INF             .          
136.3   1.0000000E-5        72.4857        +INF             .          
136.4   1.0000000E-5        36.0578        +INF             .          
136.5   1.0000000E-5        34.6492        +INF             .          
137.1   1.0000000E-5        10.8505        +INF             .          
138.2   1.0000000E-5        36.5426        +INF             .          
138.3   1.0000000E-5        28.7173        +INF             .          
138.5   1.0000000E-5        20.0216        +INF             .          
139.3   1.0000000E-5        37.7082        +INF             .          
139.4   1.0000000E-5       110.7302        +INF            EPS         
140.2   1.0000000E-5         4.2983        +INF             .          
140.5   1.0000000E-5        15.6376        +INF             .          
141.1   1.0000000E-5        26.5923        +INF             .          
141.2   1.0000000E-5        35.7115        +INF             .          
141.3   1.0000000E-5        20.7368        +INF             .          
141.4   1.0000000E-5        32.5899        +INF            EPS         
141.5   1.0000000E-5        53.8543        +INF            EPS         
143.3   1.0000000E-5         2.9936        +INF             .          
143.4   1.0000000E-5         4.9276        +INF             .          
143.5   1.0000000E-5         1.5516        +INF             .          
144.1   1.0000000E-5        13.4286        +INF             .          
144.2   1.0000000E-5         3.1325        +INF             .          
144.3   1.0000000E-5         3.6838        +INF             .          
144.5   1.0000000E-5         4.3577        +INF             .          
145.4   1.0000000E-5        16.8288        +INF             .          
146.4   1.0000000E-5        10.1144        +INF             .          
147.1   1.0000000E-5        24.8203        +INF             .          
147.2   1.0000000E-5        10.1890        +INF             .          
147.3   1.0000000E-5        10.1994        +INF            EPS         
147.4   1.0000000E-5         4.8687        +INF             .          
147.5   1.0000000E-5         4.4250        +INF             .          
150.1   1.0000000E-5         7.4138        +INF             .          
150.2   1.0000000E-5         7.4889        +INF            EPS         
150.3   1.0000000E-5         6.6058        +INF             .          
150.4   1.0000000E-5        13.8030        +INF             .          
150.5   1.0000000E-5         7.4433        +INF             .          
154.4   1.0000000E-5        19.2033        +INF             .          
154.5   1.0000000E-5        14.8695        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 34
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


---- VAR s  derived maximum entropy shares

             LOWER          LEVEL          UPPER         MARGINAL

100.1         0.0001         0.0932        +INF             .          
100.2         0.0001         0.1362        +INF             .          
100.3         0.0001         0.0659        +INF             .          
100.5         0.0001         0.2079        +INF             .          
105.1         0.0001         0.0954        +INF            EPS         
105.2         0.0001         0.1762        +INF             .          
105.3         0.0001         0.1441        +INF             .          
105.4         0.0001         0.0484        +INF             .          
105.5         0.0001         0.1131        +INF             .          
106.3         0.0001         0.0126        +INF             .          
107.1         0.0001         0.0929        +INF             .          
107.2         0.0001         0.0944        +INF             .          
107.3         0.0001         0.0467        +INF             .          
107.4         0.0001         0.0423        +INF      -8.664543E-9      
107.5         0.0001         0.0764        +INF             .          
108.2         0.0001         0.0322        +INF             .          
108.3         0.0001         0.0876        +INF             .          
108.4         0.0001         0.1065        +INF             .          
108.5         0.0001         0.0607        +INF      2.3705897E-9      
109.5         0.0001         0.0415        +INF      -7.058647E-9      
110.1         0.0001         0.1029        +INF            EPS         
110.3         0.0001         0.0179        +INF            EPS         
111.4         0.0001         0.0155        +INF      -5.811953E-9      
112.2         0.0001         0.0122        +INF            EPS         
112.3         0.0001         0.0259        +INF            EPS         
112.4         0.0001         0.0222        +INF      3.9299353E-9      
112.5         0.0001         0.0130        +INF      -2.384771E-9      
113.1         0.0001         0.1506        +INF            EPS         
113.2         0.0001         0.1323        +INF             .          
113.3         0.0001         0.1424        +INF             .          
113.4         0.0001         0.1007        +INF             .          
113.5         0.0001         0.0788        +INF      -1.041408E-9      
114.1         0.0001         0.0171        +INF            EPS         
115.3         0.0001         0.0314        +INF      -3.204527E-9      
115.4         0.0001         0.0155        +INF      5.6333951E-9      
115.5         0.0001         0.0282        +INF      -2.017729E-9      
116.3         0.0001         0.0148        +INF      -6.609726E-9      
116.4         0.0001         0.0746        +INF             .          
117.2         0.0001         0.0254        +INF      -1.565152E-9      
117.3         0.0001         0.0261        +INF            EPS         
117.4         0.0001         0.0286        +INF      1.7948700E-9      
117.5         0.0001         0.0379        +INF            EPS         
119.3         0.0001         0.0091        +INF      -1.918685E-9      
119.4         0.0001         0.0173        +INF      6.7713306E-9      
119.5         0.0001         0.0088        +INF      -2.726702E-9      
121.3         0.0001         0.0176        +INF            EPS         
121.4         0.0001         0.0156        +INF      5.7021285E-9      
122.1         0.0001         0.0410        +INF            EPS         
122.2         0.0001         0.0333        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 35
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


     VAR s  derived maximum entropy shares

             LOWER          LEVEL          UPPER         MARGINAL

122.3         0.0001         0.0227        +INF      -6.866793E-9      
122.5         0.0001         0.0098        +INF      -5.440515E-9      
123.1         0.0001         0.0405        +INF            EPS         
123.2         0.0001         0.0225        +INF             .          
123.3         0.0001         0.0251        +INF             .          
123.4         0.0001         0.0324        +INF      1.3505175E-8      
123.5         0.0001         0.0133        +INF      -3.230242E-9      
125.1         0.0001         0.0240        +INF            EPS         
125.2         0.0001         0.0317        +INF      -1.636227E-9      
125.3         0.0001         0.0411        +INF      7.2005968E-9      
125.4         0.0001         0.0254        +INF             .          
125.5         0.0001         0.0196        +INF            EPS         
127.1         0.0001         0.0342        +INF            EPS         
127.2         0.0001         0.0139        +INF            EPS         
127.3         0.0001         0.0287        +INF      -3.005205E-9      
127.4         0.0001         0.0360        +INF      2.0398528E-9      
132.3         0.0001         0.0110        +INF             .          
132.4         0.0001         0.0204        +INF      3.9845549E-9      
134.1         0.0001         0.0185        +INF            EPS         
134.2         0.0001         0.0370        +INF      -1.685835E-9      
134.3         0.0001         0.0107        +INF      7.3140967E-9      
134.5         0.0001         0.0089        +INF      1.4084975E-9      
135.1         0.0001         0.0180        +INF            EPS         
135.2         0.0001         0.0081        +INF      -1.145681E-9      
136.1         0.0001         0.0326        +INF            EPS         
136.2         0.0001         0.0254        +INF      -1.380069E-9      
136.3         0.0001         0.0238        +INF      -8.579438E-9      
136.4         0.0001         0.0137        +INF      1.1847878E-8      
136.5         0.0001         0.0156        +INF      -3.161963E-9      
137.1         0.0001         0.0119        +INF            EPS         
138.2         0.0001         0.0250        +INF      -1.270608E-9      
138.3         0.0001         0.0235        +INF      -3.048747E-9      
138.5         0.0001         0.0150        +INF      -2.416286E-9      
139.3         0.0001         0.0306        +INF      -5.411785E-9      
139.4         0.0001         0.0856        +INF             .          
140.2         0.0001         0.0164        +INF      -1.921188E-9      
140.5         0.0001         0.0342        +INF      -4.869583E-9      
141.1         0.0001         0.0606        +INF            EPS         
141.2         0.0001         0.0955        +INF             .          
141.3         0.0001         0.0479        +INF             .          
141.4         0.0001         0.1454        +INF             .          
141.5         0.0001         0.1407        +INF             .          
143.3         0.0001         0.0131        +INF      -8.433637E-9      
143.4         0.0001         0.0135        +INF      2.3234414E-8      
143.5         0.0001         0.0091        +INF      -4.985066E-9      
144.1         0.0001         0.0511        +INF            EPS         
144.2         0.0001         0.0143        +INF      2.2538232E-9      
144.3         0.0001         0.0144        +INF            EPS         
144.5         0.0001         0.0183        +INF      2.1458569E-9      
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 36
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


     VAR s  derived maximum entropy shares

             LOWER          LEVEL          UPPER         MARGINAL

145.4         0.0001         0.0339        +INF      6.7925610E-9      
146.4         0.0001         0.0362        +INF      2.3132476E-9      
147.1         0.0001         0.1068        +INF            EPS         
147.2         0.0001         0.0573        +INF      -1.239629E-9      
147.3         0.0001         0.0563        +INF             .          
147.4         0.0001         0.0303        +INF      3.1740832E-9      
147.5         0.0001         0.0240        +INF      -1.194622E-9      
150.1         0.0001         0.0088        +INF            EPS         
150.2         0.0001         0.0108        +INF             .          
150.3         0.0001         0.0092        +INF      -6.360621E-9      
150.4         0.0001         0.0195        +INF      1.2916272E-8      
150.5         0.0001         0.0129        +INF      -3.928987E-9      
154.4         0.0001         0.0204        +INF      -7.210976E-9      
154.5         0.0001         0.0124        +INF            EPS         

---- VAR povline  estimated revealed preference matrix

           LOWER          LEVEL          UPPER         MARGINAL

1.1        -INF          350.9319        +INF             .          
1.2        -INF          315.3953        +INF             .          
1.3        -INF          340.5505        +INF             .          
1.4        -INF          294.8909        +INF             .          
1.5        -INF          351.8055        +INF             .          
2.1        -INF          350.9319        +INF             .          
2.2        -INF          283.5926        +INF             .          
2.3        -INF          313.8006        +INF             .          
2.4        -INF          256.9978        +INF             .          
2.5        -INF          312.1859        +INF             .          
3.1        -INF          371.9525        +INF             .          
3.2        -INF          283.5926        +INF             .          
3.3        -INF          313.8006        +INF             .          
3.4        -INF          262.1176        +INF             .          
3.5        -INF          318.9548        +INF             .          
4.1        -INF          413.1557        +INF             .          
4.2        -INF          283.5926        +INF             .          
4.3        -INF          313.8006        +INF             .          
4.4        -INF          256.9978        +INF             .          
4.5        -INF          322.1540        +INF             .          
5.1        -INF          445.8934        +INF             .          
5.2        -INF          323.0665        +INF             .          
5.3        -INF          367.6766        +INF             .          
5.4        -INF          273.1931        +INF             .          
5.5        -INF          312.1859        +INF             .          
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 37
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE revpref Using NLP From line 518


**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
                             0     ERRORS
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/10/14 14:51:58 Page 38
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    521 this is without adjustment for calorie target or 90%

----    521 VARIABLE povline.L  estimated revealed preference matrix

            1           2           3           4           5

1     350.932     315.395     340.550     294.891     351.805
2     350.932     283.593     313.801     256.998     312.186
3     371.953     283.593     313.801     262.118     318.955
4     413.156     283.593     313.801     256.998     322.154
5     445.893     323.066     367.677     273.193     312.186


----    546 PARAMETER perc_chng  percent change in line

1 -3.522,    2  2.109,    3 -5.970,    4 18.360,    5 -0.279


----    546 PARAMETER povline_ent  entropy line that hits calorie targets (100% food expen)

1 398.181,    2 312.700,    3 341.687,    4 281.141,    5 346.373


----    546 PARAMETER povline_ali  food poverty line

1 412.716,    2 306.241,    3 363.380,    4 237.532,    5 347.344


**** REPORT FILE SUMMARY

povline_rp /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/povline_rp_inout.csv
res /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/qent.csv
lin /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/work/povline_food_ent.csv


EXECUTION TIME       =        0.005 SECONDS      3 MB  24.1.2 r40979 LEX-LEG


USER: Computer Services                              G130401:1333CP-GEN
      International Food Policy Research Institute               DC2119


**** FILE SUMMARY

Input      /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/new/190a_revpref13_r_bjorn.gms
Output     /home/bjvca/data/data/GAP/Haruna/UNPS_2005_06/new/list.lst
