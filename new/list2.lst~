GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


   1  * Filename: 195a_spat_temp_consistent.gms
   2   
   3  * Using stata input files representing CBS poverty lines etc.,
   4  * this gams file adjusts these poverty lines such that they are
   5  * consistent across space and over time (spatial domains and years)
   6   
      This file uses:
               work\product_flex.inc
               in\price_t1.inc
               in\povline_t1_cc.inc
               work\povline_food_fix.inc
               work\price_unit_flex.inc
               work\quan_flex.inc
       
      This file creates:
               work\qent.csv
               work\povline_food_ent.csv
               work\povline_rp_inout.csv
       
  22   
  23  SETS
  24   cod        year t2 (e.g. 2002) codes for products used in basket
  25  /
INCLUDE    /home/bjvca/data/data/GAP/Haruna/work/product_flex.inc
  27  100
  28  105
  29  106
  30  107
  31  108
  32  109
  33  110
  34  111
  35  112
  36  113
  37  114
  38  115
  39  116
  40  117
  41  118
  42  119
  43  121
  44  122
  45  123
  46  125
  47  127
  48  131
  49  132
  50  134
  51  135
  52  136
  53  137
  54  138
  55  140
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


  56  141
  57  144
  58  145
  59  146
  60  147
  61  150
  62  154
  63  /
  64   
  65   reg        4spatial domains /1*4/
  66   r(reg)     dynamic set on spatial regions
  67   
  68   ptit       price table titles
  69  /
  70    count      number of observations making up the price average
  71    price_uw5  average price
  72  /
  73   
  74   qtit       quantity table titles
  75  /
  76    calperg          calories per gram
  77    quan5            quantities in grams
  78    calpp            calories per person by region
  79    povline_f_flex5  value of flexible food bundle
  80  /
  81   
  82   
  83    posquan(cod,reg)  mark positive quantities in each region
  84    posprice(cod,reg) mark the existence of acceptable price info in each region
  85    pmiss_t1(cod,reg) mark year t1 (e.g. 1996) missing prices
  86    chkprice(cod,reg) ensure that prices exist once all estimated
  87  ;
  88   
  89  *****************************************************
  90  *Work first on all regions
  91  *********************************************************
  92   
  93   r(reg)=yes;
  94   
  95  alias(reg,regq);
  96  alias(r,rq);
  97   
  98  SCALAR
  99     caltarg single level of calories to target across regions /2150/
 100   ;
 101   
 102  PARAMETERS
 103    price_t1(cod,reg)     price information and poverty line for year t1 (e.g. 1996)
 104  /
INCLUDE    /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
 106  100     .       1       .138133
 107  105     .       1       .17793
 108  106     .       1       .166463
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 109  107     .       1       .07832
 110  108     .       1       .433464
 111  109     .       1       .397339
 112  110     .       1       1.181096
 113  111     .       1       .408468
 114  112     .       1       .235106
 115  113     .       1       .598802
 116  114     .       1       1.221117
 117  115     .       1       .692399
 118  116     .       1       .431453
 119  117     .       1       2.333451
 120  118     .       1       1.910913
 121  119     .       1       2.368849
 122  121     .       1       3.056498
 123  122     .       1       .659818
 124  123     .       1       2.049778
 125  125     .       1       .210652
 126  127     .       1       1.853102
 127  131     .       1       .269597
 128  132     .       1       .149222
 129  134     .       1       .930507
 130  135     .       1       .627244
 131  136     .       1       .10922
 132  138     .       1       .239623
 133  139     .       1       .291155
****    $170
**** LINE     28 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 134  140     .       1       1.588387
 135  141     .       1       .932375
 136  143     .       1       1.803374
****    $170
**** LINE     31 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 137  144     .       1       1.561716
 138  145     .       1       1.365703
 139  146     .       1       1.383532
 140  147     .       1       1.708801
 141  150     .       1       .524621
 142  154     .       1       .575653
 143  100     .       2       .142498
 144  105     .       2       .160952
 145  106     .       2       .14594
 146  107     .       2       .063223
 147  108     .       2       .43769
 148  109     .       2       .340801
 149  110     .       2       1.011064
 150  111     .       2       .312087
 151  112     .       2       .212625
 152  113     .       2       .525154
 153  114     .       2       1.15942
 154  115     .       2       .505269
 155  116     .       2       .288116
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 156  117     .       2       2.682296
 157  118     .       2       2.059247
 158  119     .       2       2.715838
 159  121     .       2       2.800217
 160  122     .       2       .750924
 161  123     .       2       2.032916
 162  125     .       2       .143277
 163  127     .       2       1.772165
 164  131     .       2       .272936
 165  132     .       2       .106769
 166  134     .       2       .858808
 167  135     .       2       .379173
 168  136     .       2       .109379
 169  138     .       2       .273556
 170  139     .       2       .293454
****    $170
**** LINE     65 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 171  140     .       2       1.625508
 172  141     .       2       .838464
 173  143     .       2       1.73288
****    $170
**** LINE     68 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 174  144     .       2       1.303079
 175  145     .       2       .894289
 176  146     .       2       1.293512
 177  147     .       2       1.681167
 178  150     .       2       .475706
 179  154     .       2       1.026051
 180  100     .       3       .145245
 181  105     .       3       .082027
 182  106     .       3       .098003
 183  107     .       3       .026219
 184  108     .       3       .530015
 185  109     .       3       .905046
 186  110     .       3       1.007408
 187  111     .       3       .267167
 188  112     .       3       .170679
 189  113     .       3       .333295
 190  114     .       3       1.578027
 191  115     .       3       .352225
 192  116     .       3       .294592
 193  117     .       3       2.423799
 194  118     .       3       1.914438
 195  119     .       3       2.045556
 196  121     .       3       2.233073
 197  122     .       3       .698453
 198  123     .       3       2.504108
 199  125     .       3       .06319
 200  127     .       3       2.231234
 201  131     .       3       .445646
 202  132     .       3       .045511
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 203  134     .       3       .277782
 204  135     .       3       .244367
 205  136     .       3       .100608
 206  138     .       3       .203185
 207  139     .       3       .194058
****    $170
**** LINE    102 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 208  140     .       3       .747075
 209  141     .       3       1.183308
 210  143     .       3       1.321482
****    $170
**** LINE    105 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 211  144     .       3       1.75
 212  145     .       3       .622683
 213  146     .       3       .971427
 214  147     .       3       1.686355
 215  150     .       3       .42525
 216  154     .       3       .635597
 217  100     .       4       .103483
 218  105     .       4       .156274
 219  106     .       4       .110049
 220  107     .       4       .086952
 221  108     .       4       .394176
 222  109     .       4       .234223
 223  110     .       4       1.088738
 224  111     .       4       .389477
 225  112     .       4       .19808
 226  113     .       4       .550598
 227  114     .       4       1.258574
 228  115     .       4       .6002
 229  116     .       4       .359293
 230  117     .       4       2.232269
 231  118     .       4       1.977466
 232  119     .       4       2.611423
 233  121     .       4       2.895597
 234  122     .       4       1.174343
 235  123     .       4       3.942898
 236  125     .       4       .111473
 237  127     .       4       2.299935
 238  131     .       4       .250431
 239  132     .       4       .074629
 240  134     .       4       .347652
 241  135     .       4       .311016
 242  136     .       4       .158262
 243  138     .       4       .242848
 244  139     .       4       .316831
****    $170
**** LINE    139 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 245  140     .       4       1.14106
 246  141     .       4       1.14431
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 247  143     .       4       2.123574
****    $170
**** LINE    142 INCLUDE     /home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
**** LINE     69 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 248  144     .       4       1.508856
 249  145     .       4       .892645
 250  146     .       4       1.266919
 251  147     .       4       1.75744
 252  150     .       4       .624159
 253  154     .       4       .293994
 254  /
 255    foodpov_t1(reg)       food pov line P_t1*Q_t1 ADJUSTED to hit 2150 calories
 256  /
INCLUDE    /home/bjvca/data/data/GAP/Haruna/in/povline_t1_cc.inc
 258  1       431.3452
 259  2       395.3875
 260  3       317.3611
 261  4       417.0559
 262  /
 263    shr(cod,reg)           shares in each basket by region
 264    chkshr(reg)            check that the calculated shares sum to .9
 265    shrmiss(regq,reg)      shares missing in each region pair
 266    povline_food(reg)      food poverty line
 267    perc_chng(reg)         percent change in line
 268    origmiss(reg)          original share of items without price obs in year t1 (e.g. 1996)
 269    finmiss(reg)           final missing shares post optimization procedure
 270    povline_food_fix(reg)  food pov line Q_t1*P_t2 NOT adjusted to 2150 calories
 271   /
INCLUDE    /home/bjvca/data/data/GAP/Haruna/work/povline_food_fix.inc
 273  1       837.8335
 274  2       496.4296
 275  3       735.1486
 276  4       710.7284
 277   /
 278   ;
 279   
 280  Table  price(cod,reg,ptit)  price and related information
 281                          count   price_uw5
INCLUDE    /home/bjvca/data/data/GAP/Haruna/work/price_unit_flex.inc
 283  100     .       1       270     .5074245
 284  100     .       2       64      .2801054
 285  100     .       3       23      .4988728
 286  100     .       4       444     .3546883
 287  105     .       1       306     .253148
 288  105     .       2       218     .2109564
 289  105     .       3       281     .4739078
 290  105     .       4       342     .1815912
 291  106     .       1       5       .1589132
 292  106     .       2       19      .0822436
 293  106     .       3       11      .1794924
 294  106     .       4       12      .1462639
 295  107     .       1       264     .0984313
 296  107     .       2       211     .0535742
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 297  107     .       3       298     .0560229
 298  107     .       4       334     .0598366
 299  108     .       1       66      .4679801
 300  108     .       2       267     .4708041
 301  108     .       3       256     .6013363
 302  108     .       4       194     .3235234
 303  109     .       1       34      .2559442
 304  109     .       2       11      .3409889
 305  109     .       3       3       .9329188
 306  109     .       4       129     .2065729
 307  110     .       1       54      1.989712
 308  110     .       2       79      1.012413
 309  110     .       3       60      1.376698
 310  110     .       4       54      1.253445
 311  111     .       1       15      .2251857
 312  111     .       2       16      .1996361
 313  111     .       3       201     .4606979
 314  111     .       4       27      .343871
 315  112     .       1       108     .4104002
 316  112     .       2       120     .2174019
 317  112     .       3       87      .3240004
 318  112     .       4       108     .2550528
 319  113     .       1       319     1.077043
 320  113     .       2       238     .6386356
 321  113     .       3       391     .8230098
 322  113     .       4       282     .6725507
 323  114     .       1       58      1.924915
 324  114     .       2       66      1.017954
 325  114     .       3       102     1.466963
 326  114     .       4       62      1.012255
 327  115     .       1       24      1.110367
 328  115     .       2       91      .6421999
 329  115     .       3       55      .7170822
 330  115     .       4       124     .7479286
 331  116     .       1       6       .8121275
 332  116     .       2       117     .3693466
 333  116     .       3       534     .5067688
 334  116     .       4       33      .4661861
 335  117     .       1       78      3.812905
 336  117     .       2       121     2.521683
 337  117     .       3       190     3.415871
 338  117     .       4       124     2.546052
 339  118     .       1       36      3.200788
 340  118     .       2       26      2.047246
 341  118     .       3       26      3.313731
 342  118     .       4       51      2.332381
 343  119     .       1       6       3.906803
 344  119     .       2       32      2.414677
 345  119     .       3       54      3.589427
 346  119     .       4       38      2.88537
 347  121     .       1       17      4.187431
 348  121     .       2       48      2.574636
 349  121     .       3       58      4.024446
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 8
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 350  121     .       4       17      3.014909
 351  122     .       1       58      .820943
 352  122     .       2       108     .7156202
 353  122     .       3       56      1.469584
 354  122     .       4       54      .8338939
 355  123     .       1       133     1.416296
 356  123     .       2       198     .693288
 357  123     .       3       268     .9964128
 358  123     .       4       58      .3423894
 359  125     .       1       153     .0758141
 360  125     .       2       145     .0525396
 361  125     .       3       181     .0654769
 362  125     .       4       143     .0511846
 363  127     .       1       264     2.263896
 364  127     .       2       283     1.425161
 365  127     .       3       631     2.866398
 366  127     .       4       123     1.625753
 367  131     .       1       84      .6499739
 368  131     .       2       22      .5950614
 369  131     .       3       24      .729272
 370  131     .       4       130     .3698345
 371  132     .       1       79      .4013342
 372  132     .       2       146     .1652309
 373  132     .       3       136     .2345183
 374  132     .       4       74      .1975535
 375  134     .       1       128     1.154731
 376  134     .       2       102     .9783617
 377  134     .       3       51      .4418103
 378  134     .       4       128     .2546878
 379  135     .       1       314     1.10213
 380  135     .       2       313     .7649037
 381  135     .       3       585     1.042901
 382  135     .       4       357     .7530327
 383  136     .       1       355     1.015713
 384  136     .       2       343     .6795771
 385  136     .       3       347     1.163813
 386  136     .       4       391     .437395
 387  137     .       1       80      .3521306
 388  137     .       2       121     .3350618
 389  137     .       3       150     .6077849
 390  137     .       4       112     .2673859
 391  138     .       1       188     .4162406
 392  138     .       2       252     .2325988
 393  138     .       3       299     .2808345
 394  138     .       4       363     .2119729
 395  140     .       1       89      .9162363
 396  140     .       2       92      1.084379
 397  140     .       3       89      1.49477
 398  140     .       4       182     .8768239
 399  141     .       1       271     1.3659
 400  141     .       2       191     1.033428
 401  141     .       3       724     2.078857
 402  141     .       4       432     1.099761
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                         03/07/14 11:26:46 Page 9
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 403  144     .       1       180     2.190898
 404  144     .       2       92      .9242625
 405  144     .       3       11      1.735983
 406  144     .       4       163     1.462797
 407  145     .       1       5       2.032165
 408  145     .       2       35      1.071573
 409  145     .       3       119     1.773254
 410  145     .       4       17      1.213223
 411  146     .       2       17      1.53859
 412  146     .       3       263     1.670113
 413  146     .       4       4       1.498351
 414  147     .       1       310     2.049743
 415  147     .       2       334     1.419047
 416  147     .       3       294     2.012181
 417  147     .       4       225     1.388063
 418  150     .       1       441     .8013048
 419  150     .       2       471     .5153803
 420  150     .       3       1004    .7253575
 421  150     .       4       603     .6012651
 422  154     .       1       6       .3334954
 423  154     .       2       5       .4523052
 424  154     .       3       157     .3192458
 425  154     .       4       34      .2526606
 426  ;
 427   
 428  Table   quan(cod,reg,qtit)   quantity and related information
 429                             calperg          quan5           calpp      povline_f_flex5
INCLUDE    /home/bjvca/data/data/GAP/Haruna/work/quan_flex.inc
 431  100     .       1       6.8900000e-01   1.5635237e+02   2.2565869e+03   658.8712
 432  105     .       1       1.0164000e+00   3.5264883e+02   2.2565869e+03   658.8712
 433  107     .       1       1.3440000e+00   5.3243719e+02   2.2565869e+03   658.8712
 434  108     .       1       3.1400000e+00   3.4897972e+01   2.2565869e+03   658.8712
 435  110     .       1       3.6100000e+00   4.9594617e+00   2.2565869e+03   658.8712
 436  112     .       1       9.4600000e-01   3.9456203e+01   2.2565869e+03   658.8712
 437  113     .       1       3.6500000e+00   8.1450729e+01   2.2565869e+03   658.8712
 438  114     .       1       2.6600000e+00   5.5625501e+00   2.2565869e+03   658.8712
 439  117     .       1       1.7982000e+00   3.7502258e+00   2.2565869e+03   658.8712
 440  122     .       1       6.1610000e-01   1.0358532e+01   2.2565869e+03   658.8712
 441  123     .       1       3.7500000e+00   8.4952021e+00   2.2565869e+03   658.8712
 442  125     .       1       6.0000000e-01   2.3335483e+02   2.2565869e+03   658.8712
 443  127     .       1       8.8400000e+00   5.1038651e+00   2.2565869e+03   658.8712
 444  132     .       1       4.3310000e-01   2.0395126e+01   2.2565869e+03   658.8712
 445  134     .       1       4.9400000e-01   1.0773477e+01   2.2565869e+03   658.8712
 446  135     .       1       3.6400000e-01   5.8261733e+00   2.2565869e+03   658.8712
 447  136     .       1       1.6380000e-01   1.3444016e+01   2.2565869e+03   658.8712
 448  138     .       1       2.0160000e-01   3.2999004e+01   2.2565869e+03   658.8712
 449  140     .       1       1.0300000e+00   1.7730484e+01   2.2565869e+03   658.8712
 450  141     .       1       3.1300000e+00   3.3212990e+01   2.2565869e+03   658.8712
 451  144     .       1       5.8800000e+00   6.4975829e+00   2.2565869e+03   658.8712
 452  147     .       1       3.8700000e+00   1.7941444e+01   2.2565869e+03   658.8712
 453  100     .       2       6.8900000e-01   2.3991013e+01   2.1924021e+03   378.6755
 454  105     .       2       1.0164000e+00   1.6883804e+02   2.1924021e+03   378.6755
 455  106     .       2       3.4300000e+00   4.5241360e+01   2.1924021e+03   378.6755
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 10
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 456  107     .       2       1.3440000e+00   3.5009326e+02   2.1924021e+03   378.6755
 457  108     .       2       3.1400000e+00   1.4039172e+02   2.1924021e+03   378.6755
 458  110     .       2       3.6100000e+00   5.9871168e+00   2.1924021e+03   378.6755
 459  112     .       2       9.4600000e-01   3.4028164e+01   2.1924021e+03   378.6755
 460  113     .       2       3.6500000e+00   6.4591690e+01   2.1924021e+03   378.6755
 461  115     .       2       3.7800000e+00   1.7475002e+01   2.1924021e+03   378.6755
 462  116     .       2       3.3900000e+00   3.6342937e+01   2.1924021e+03   378.6755
 463  117     .       2       1.7982000e+00   4.8749328e+00   2.1924021e+03   378.6755
 464  121     .       2       1.4835000e+00   2.4175415e+00   2.1924021e+03   378.6755
 465  122     .       2       6.1610000e-01   1.4514835e+01   2.1924021e+03   378.6755
 466  123     .       2       3.7500000e+00   1.7042601e+01   2.1924021e+03   378.6755
 467  125     .       2       6.0000000e-01   1.3257535e+02   2.1924021e+03   378.6755
 468  127     .       2       8.8400000e+00   5.1216202e+00   2.1924021e+03   378.6755
 469  132     .       2       4.3310000e-01   5.3832085e+01   2.1924021e+03   378.6755
 470  134     .       2       4.9400000e-01   4.2576976e+00   2.1924021e+03   378.6755
 471  136     .       2       1.6380000e-01   9.2046528e+00   2.1924021e+03   378.6755
 472  138     .       2       2.0160000e-01   4.3475204e+01   2.1924021e+03   378.6755
 473  140     .       2       1.0300000e+00   7.2884512e+00   2.1924021e+03   378.6755
 474  141     .       2       3.1300000e+00   1.4190257e+01   2.1924021e+03   378.6755
 475  147     .       2       3.8700000e+00   1.3346783e+01   2.1924021e+03   378.6755
 476  150     .       2       0.0000000e+00   8.9667158e+00   2.1924021e+03   378.6755
 477  105     .       3       1.0164000e+00   5.4281929e+01   2.1999929e+03   445.9425
 478  107     .       3       1.3440000e+00   5.4794843e+02   2.1999929e+03   445.9425
 479  108     .       3       3.1400000e+00   6.7533394e+01   2.1999929e+03   445.9425
 480  111     .       3       3.6500000e+00   3.1028055e+01   2.1999929e+03   445.9425
 481  112     .       3       9.4600000e-01   1.8621624e+01   2.1999929e+03   445.9425
 482  113     .       3       3.6500000e+00   4.0794098e+01   2.1999929e+03   445.9425
 483  116     .       3       3.3900000e+00   1.2586672e+02   2.1999929e+03   445.9425
 484  117     .       3       1.7982000e+00   2.8264091e+00   2.1999929e+03   445.9425
 485  121     .       3       1.4835000e+00   1.5944095e+00   2.1999929e+03   445.9425
 486  122     .       3       6.1610000e-01   3.7050130e+00   2.1999929e+03   445.9425
 487  123     .       3       3.7500000e+00   1.1474658e+01   2.1999929e+03   445.9425
 488  125     .       3       6.0000000e-01   1.5102534e+02   2.1999929e+03   445.9425
 489  127     .       3       8.8400000e+00   5.6074462e+00   2.1999929e+03   445.9425
 490  132     .       3       4.3310000e-01   2.4118952e+01   2.1999929e+03   445.9425
 491  135     .       3       3.6400000e-01   4.8665285e+00   2.1999929e+03   445.9425
 492  136     .       3       1.6380000e-01   5.6276121e+00   2.1999929e+03   445.9425
 493  138     .       3       2.0160000e-01   2.3981817e+01   2.1999929e+03   445.9425
 494  140     .       3       1.0300000e+00   4.0149751e+00   2.1999929e+03   445.9425
 495  141     .       3       3.1300000e+00   2.5437525e+01   2.1999929e+03   445.9425
 496  145     .       3       8.1000000e-01   3.4768729e+00   2.1999929e+03   445.9425
 497  146     .       3       5.7300000e+00   7.5197406e+00   2.1999929e+03   445.9425
 498  147     .       3       3.8700000e+00   5.9492493e+00   2.1999929e+03   445.9425
 499  150     .       3       0.0000000e+00   1.0632328e+01   2.1999929e+03   445.9425
 500  154     .       3       8.1000000e-01   2.0081942e+01   2.1999929e+03   445.9425
 501  100     .       4       6.8900000e-01   2.7360489e+02   2.2343252e+03   479.8994
 502  105     .       4       1.0164000e+00   2.5732593e+02   2.2343252e+03   479.8994
 503  107     .       4       1.3440000e+00   5.3835669e+02   2.2343252e+03   479.8994
 504  108     .       4       3.1400000e+00   6.4628952e+01   2.2343252e+03   479.8994
 505  109     .       4       6.4680000e-01   9.1317825e+01   2.2343252e+03   479.8994
 506  112     .       4       9.4600000e-01   3.0795214e+01   2.2343252e+03   479.8994
 507  113     .       4       3.6500000e+00   4.7044151e+01   2.2343252e+03   479.8994
 508  115     .       4       3.7800000e+00   1.6349913e+01   2.2343252e+03   479.8994
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 11
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 509  117     .       4       1.7982000e+00   5.0376287e+00   2.2343252e+03   479.8994
 510  118     .       4       2.3534000e+00   2.3648038e+00   2.2343252e+03   479.8994
 511  119     .       4       1.2210000e+00   1.3865262e+00   2.2343252e+03   479.8994
 512  122     .       4       6.1610000e-01   7.9098606e+00   2.2343252e+03   479.8994
 513  123     .       4       3.7500000e+00   1.2369567e+01   2.2343252e+03   479.8994
 514  125     .       4       6.0000000e-01   1.8208632e+02   2.2343252e+03   479.8994
 515  134     .       4       4.9400000e-01   1.8259539e+01   2.2343252e+03   479.8994
 516  135     .       4       3.6400000e-01   5.3842325e+00   2.2343252e+03   479.8994
 517  136     .       4       1.6380000e-01   1.7952995e+01   2.2343252e+03   479.8994
 518  138     .       4       2.0160000e-01   3.8210609e+01   2.2343252e+03   479.8994
 519  140     .       4       1.0300000e+00   2.7341145e+01   2.2343252e+03   479.8994
 520  141     .       4       3.1300000e+00   4.4246002e+01   2.2343252e+03   479.8994
 521  144     .       4       5.8800000e+00   5.3176265e+00   2.2343252e+03   479.8994
 522  147     .       4       3.8700000e+00   7.2303329e+00   2.2343252e+03   479.8994
 523  150     .       4       0.0000000e+00   1.1358236e+01   2.2343252e+03   479.8994
 524  ;
 525   
 526  *CA March 2009 - adjust fixed bundle line to hit 2150 calories
 527    loop(cod$(ord(cod) eq 1),
 528      povline_food_fix(reg)= povline_food_fix(reg)*2150/quan(cod,reg,'calpp');
 529    );
 530   
 531    shr(cod,reg)$quan(cod,reg,'povline_f_flex5')
 532                        =price(cod,reg,'price_uw5')*quan(cod,reg,'quan5')/
 533                         quan(cod,reg,'povline_f_flex5');
 534   
 535    chkshr(reg)=sum(cod,shr(cod,reg));
 536   
 537  loop(reg,
 538    abort$(abs(chkshr(reg)-.9) gt .0001) "share does not sum to .9", chkshr ;
 539  );
 540   
 541   
 542  *turn on dynamic sets to indicate positive quantities and existence of
 543  *price info for each region
 544   
 545   posprice(cod,reg)$(price(cod,reg,'price_uw5')
 546                        AND price(cod,reg,'count') gt 4) = yes;
 547   
 548   posquan(cod,reg)$quan(cod,reg,'quan5')=yes;
 549   
 550   pmiss_t1(cod,reg)$(NOT price_t1(cod,reg) AND posquan(cod,reg))=yes;
 551   
 552   display pmiss_t1;
 553   
 554    loop(reg,
 555         abort$(foodpov_t1(reg) eq 0) "missing a food poverty line", foodpov_t1;
 556   );
 557   
 558   shrmiss(regq,reg)=sum(cod$(NOT posprice(cod,reg)), shr(cod,regq));
 559   display shrmiss;
 560   
 561   origmiss(reg)=sum(cod$pmiss_t1(cod,reg), shr(cod,reg));
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 12
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 562   display origmiss;
 563   
 564    povline_food(reg)=sum(cod$posquan(cod,reg),price(cod,reg,'price_uw5')*
 565                                             quan(cod,reg,'quan5'))/.9;
 566   
 567    display povline_food;
 568   
 569   
 570  *boost values so shares sum to one;
 571  shr(cod,reg)=shr(cod,reg)/chkshr(reg);
 572   
 573  *fill out price matrix with maximum observed price outside of Maputo
 574   r(reg)=no;
 575   r(reg)$(ord(reg) le 10)=yes;
 576  loop((cod,r)$(NOT posprice(cod,r) AND posquan(cod,r)),
 577           loop(rq,
 578                   price(cod,r,'price_uw5')=max(price(cod,r,'price_uw5'),
 579                                                price(cod,rq,'price_uw5'));
 580           );
 581  );
 582   
 583  *fill out price matrix with maximum observed price within Maputo
 584   r(reg)=no;
 585   r(reg)$(ord(reg) gt 10)=yes;
 586  loop((cod,r)$(NOT posprice(cod,r) AND posquan(cod,r)),
 587           loop(rq,
 588                   price(cod,r,'price_uw5')=max(price(cod,r,'price_uw5'),
 589                                                price(cod,rq,'price_uw5'));
 590           );
 591  );
 592   
 593  *Back to r indexing all regions
 594   r(reg)=yes;
 595   
 596  chkprice(cod,reg)$(NOT price(cod,reg,'price_uw5') AND posquan(cod,reg))=yes;
 597   
 598  display 'should be an empty set', chkprice;
 599   
 600  Variables
 601     z                 objective value
 602     q(cod,reg)        revised maximum entropy quanties in grams
 603     s(cod,reg)        derived maximum entropy shares
 604     povline(regq,reg) estimated revealed preference matrix
 605     povline_t1(regq)  value of estimated bundle at year t1 (e.g. 1996) prices
 606  ;
 607   
 608   
 609  Equations
 610     obj              objective equation
 611     rev(regq,reg)    revealed preference tests
 612     deflin(regq,reg) define revealed preference matrix
 613     defshr(cod,regq) define the endogenous budget shares
 614     deflin_t1(reg)   define the value of the bundle at year t1 (e.g. 1996) prices
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 13
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 615     cals(regq)       ensure that each bundle hits the calorie
 616   
 617  ;
 618   
 619     obj ..  z=e= sum((cod,rq)$posquan(cod,rq),
 620                     s(cod,rq)*log(s(cod,rq)/shr(cod,rq)));
 621   
 622     deflin(rq,r) .. povline(rq,r) =e= sum(cod$posquan(cod,rq),
 623                            q(cod,rq)*price(cod,r,'price_uw5'));
 624   
 625     rev(rq,r) ..    povline(r,rq)=g=povline(rq,rq);
 626   
 627     defshr(cod,rq)$posquan(cod,rq) ..
 628               povline(rq,rq)*s(cod,rq)=e= q(cod,rq)*price(cod,rq,'price_uw5');
 629   
 630     deflin_t1(rq) .. povline_t1(rq)*(.9-sum(cod$pmiss_t1(cod,rq),s(cod,rq))) =e=
 631                         sum(cod$(posquan(cod,rq) AND NOT pmiss_t1(cod,rq)),
 632                           q(cod,rq)*price_t1(cod,rq));
 633   
 634     cals(rq) .. sum(cod$posquan(cod,rq),
 635                      q(cod,rq)*quan(cod,rq,'calperg'))=e=.95*caltarg;
 636   
 637  *set bounds and starting values for variables
 638   
 639    q.lo(cod,reg)=.00001;
 640    q.up(cod,reg)=inf;
 641    q.l(cod,reg)=quan(cod,reg,'quan5');
 642    q.fx(cod,reg)$(NOT posquan(cod,reg))=0;
 643   
 644    povline.l(regq,reg)= sum(cod$posquan(cod,regq),
 645                            q.l(cod,regq)*price(cod,reg,'price_uw5'));
 646   
 647    povline.up(regq,regq)=povline_food_fix(regq)*.9;
 648   
 649    display povline.l;
 650   
 651  *print the revealed preference matrix prior to optimisation;
 652  file povline_rp /work\povline_rp_inout.csv/;
 653  put povline_rp;
 654  povline_rp.pc=5;
 655  povline_rp.nd=0;
 656  put " ";
 657  loop(reg,
 658        put reg.tl;
 659  );
 660  put /;
 661  loop(regq,
 662       put regq.tl;
 663       loop(reg,
 664           put povline.l(regq,reg);
 665       );
 666       put /;
 667  );
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 14
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 668  put /; put /; put /;
 669   
 670     s.l(cod,regq)= q.l(cod,regq)*price(cod,regq,'price_uw5')/povline.l(regq,regq);
 671     s.lo(cod,regq)=.0001;
 672     s.fx(cod,regq)$(NOT posquan(cod,regq))=0;
 673   
 674     povline_t1.l(reg)=1.2*foodpov_t1(reg);
 675     povline_t1.lo(reg)=foodpov_t1(reg);
 676   
 677     model revpref /obj, deflin, rev, defshr, deflin_t1, cals/;
 678     model revprefnotemp /obj, deflin, rev, defshr, cals/;
 679   
 680     revpref.holdfixed=1;
 681   
 682     option limrow=100;
 683   
 684     option nlp=conopt;
 685   
 686  *run procedure on all regions
 687     r(reg)=yes;
 688   
 689  *CAtemp
 690  *Check without temporal conditions  ***NEED TO UNDO THIS!!!!!!!!!!!!!!!!!!!!
 691   
 692  *   solve revpref using nlp minimizing z;
 693   
 694    povline.up(regq,regq)=inf;
 695   
 696     solve revpref using nlp minimizing z;
****                                         $257
**** LINE    268 INPUT       /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
 697   
 698   
 699     abort$(revpref.modelstat ne 2) "Model did not solve properly";
 700   
 701     povline.l(regq,reg)$(NOT rq(regq) OR NOT r(reg))=0;
 702     display "this is without adjustment for calorie target or 90%", povline.l;
 703   
 704  put /;
 705  loop(rq,
 706       put rq.tl;
 707       loop(r,
 708           put povline.l(rq,r);
 709       );
 710       put /;
 711  );
 712  put /;
 713   
 714   
 715     finmiss(r)=sum(cod$pmiss_t1(cod,r),s.l(cod,r));
 716     display finmiss;
 717   
 718  PARAMETERS
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 15
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 719     qent(cod,reg)  entropy quantities with all adjustments accounted for
 720     povline_ent(reg) entropy line that hits calorie targets (100% food expen)
 721    ;
 722  *readjust quantities to hit regional calorie target and calculate line;
 723     qent(cod,r)=q.l(cod,r)*quan(cod,r,'calpp')/caltarg;
 724   
 725     povline_ent(r)=sum(cod$posquan(cod,r),price(cod,r,'price_uw5')*
 726                                             qent(cod,r))/.9;
 727   
 728     perc_chng(r)=100*(povline_ent(r)/povline_food(r)-1);
 729   
 730  *CA March 2009 - adjust fixed bundle line to hit 2150 calories
 731    loop(cod$(ord(cod) eq 1),
 732       povline_food_fix(reg)= povline_food_fix(reg)*quan(cod,reg,'calpp')/2150;
 733    );
 734     display perc_chng, povline_ent, povline_food;
 735   
 736     file res /work\qent.csv/;
 737   
 738     put res;
 739     res.pc=5;
 740     res.nd=6;
 741   
 742  *recall that the basket reflects 90% of expenditure and 95% of calories";
 743     put "spdomain" ;
 744     put "product" ;
 745     put "quan5";
 746     put "qent";
 747     put "price";
 748     put "calperg";
 749   
 750     put /;
 751   
 752     loop(reg,
 753         loop(cod,
 754             put reg.tl;
 755             put cod.tl;
 756             put quan(cod,reg,'quan5');
 757             put qent(cod,reg);
 758             put price(cod,reg,'price_uw5')
 759             put quan(cod,reg,'calperg');
 760             put /;
 761         );
 762     );
 763   
 764     file lin /work\povline_food_ent.csv/;
 765   
 766     put lin;
 767     lin.pc=5;
 768  *Flexible, entropy, and fixed food pov lines at 100% expenditure
 769   
 770     put "spdomain";
 771     put "flex";
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 16
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


 772     put "ent";
 773     put "fix";
 774     put /;
 775   
 776     loop(reg,
 777           put reg.tl;
 778           put povline_food(reg);
 779           put povline_ent(reg);
 780           put povline_food_fix(reg);
 781           put /;
 782     );
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 17
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


170  Domain violation for element
257  Solve statement not checked because of previous errors

**** 9 ERROR(S)   0 WARNING(S)
GAMS 24.1.2  r40979 Released Jun 16, 2013 LEX-LEG x86_64/Linux                                                                                                                                                                        03/07/14 11:26:46 Page 18
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
     2       26 INCLUDE        1      26  ./home/bjvca/data/data/GAP/Haruna/work/product_flex.inc
     3      105 INCLUDE        1      69  ./home/bjvca/data/data/GAP/Haruna/in/price_t1.inc
     4      257 INCLUDE        1      73  ./home/bjvca/data/data/GAP/Haruna/in/povline_t1_cc.inc
     5      272 INCLUDE        1      84  ./home/bjvca/data/data/GAP/Haruna/work/povline_food_fix.inc
     6      282 INCLUDE        1      90  ./home/bjvca/data/data/GAP/Haruna/work/price_unit_flex.inc
     7      430 INCLUDE        1      95  ./home/bjvca/data/data/GAP/Haruna/work/quan_flex.inc


COMPILATION TIME     =        0.005 SECONDS      3 MB  24.1.2 r40979 LEX-LEG


USER: Computer Services                              G130401:1333CP-GEN
      International Food Policy Research Institute               DC2119


**** FILE SUMMARY

Input      /home/bjvca/data/data/GAP/Haruna/new/195a_spat_temp_consistent_bjorn.gms
Output     /home/bjvca/data/data/GAP/Haruna/new/list2.lst

**** USER ERROR(S) ENCOUNTERED
